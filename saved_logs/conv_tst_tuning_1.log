## SLURM PROLOG ###############################################################
##    Job ID : 9448279
##  Job Name : tune.sh
##  Nodelist : gpu2001
##      CPUs : 1
##  Mem/Node : 32768 MB
## Directory : /gpfs/home/isears1/Repos/physionet2023
##   Job Started : Sun Apr  2 13:45:56 EDT 2023
###############################################################################
[32m[I 2023-04-02 13:46:03,299][0m A new study created in memory with name: no-name-908578e0-42b8-419c-9e30-c3dc9bb6e845[0m
Starting trial with params:
{'lr': 2.6744712309151557e-05, 'dropout': 0.43714561381639583, 'd_model_multiplier': 16, 'num_layers': 6, 'n_heads': 4, 'dim_feedforward': 882, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 859 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
830 K     Trainable params
28.8 K    Non-trainable params
859 K     Total params
3.438     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4757084846496582
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6709482669830322
	RegressionCompetitionScore: 0.1411192214111922

Metric val_loss improved. New best score: 0.273


Validation scores:
	RegressionAUROC: 0.6816844940185547
	RegressionCompetitionScore: 0.1978913219789132

Metric val_loss improved by 0.063 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.669857382774353
	RegressionCompetitionScore: 0.23438767234387672



Validation scores:
	RegressionAUROC: 0.6753900051116943
	RegressionCompetitionScore: 0.24655312246553124

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6790026426315308
	RegressionCompetitionScore: 0.29278183292781834



Validation scores:
	RegressionAUROC: 0.695077657699585
	RegressionCompetitionScore: 0.32116788321167883



Validation scores:
	RegressionAUROC: 0.7146625518798828
	RegressionCompetitionScore: 0.36253041362530414



Validation scores:
	RegressionAUROC: 0.7096800804138184
	RegressionCompetitionScore: 0.40145985401459855



Validation scores:
	RegressionAUROC: 0.7138979434967041
	RegressionCompetitionScore: 0.38361719383617193



Validation scores:
	RegressionAUROC: 0.7494343519210815
	RegressionCompetitionScore: 0.35766423357664234



Validation scores:
	RegressionAUROC: 0.7353230714797974
	RegressionCompetitionScore: 0.39416058394160586

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.205. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.24655312246553124
     Test RegressionAUROC            0.6753900051116943
Test RegressionCompetitionScore      0.24655312246553124
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 13:48:55,687][0m Trial 0 finished with value: 0.24655312246553124 and parameters: {'lr': 2.6744712309151557e-05, 'dropout': 0.43714561381639583, 'd_model_multiplier': 16, 'num_layers': 6, 'n_heads': 4, 'dim_feedforward': 882, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 0 with value: 0.24655312246553124.[0m
Starting trial with params:
{'lr': 8.743697197199578e-06, 'dropout': 0.4218037894387267, 'd_model_multiplier': 8, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 702, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.6 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.6 M     Trainable params
0         Non-trainable params
3.6 M     Total params
14.373    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6770467162132263
	RegressionCompetitionScore: 0.35719844357976654

Metric val_loss improved. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.6971487402915955
	RegressionCompetitionScore: 0.2964980544747082

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.7002822160720825
	RegressionCompetitionScore: 0.3019455252918288

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6900629997253418
	RegressionCompetitionScore: 0.29027237354085605



Validation scores:
	RegressionAUROC: 0.6927951574325562
	RegressionCompetitionScore: 0.3027237354085603



Validation scores:
	RegressionAUROC: 0.6854662299156189
	RegressionCompetitionScore: 0.2731517509727626



Validation scores:
	RegressionAUROC: 0.6861291527748108
	RegressionCompetitionScore: 0.28249027237354085



Validation scores:
	RegressionAUROC: 0.677393913269043
	RegressionCompetitionScore: 0.2856031128404669



Validation scores:
	RegressionAUROC: 0.6848864555358887
	RegressionCompetitionScore: 0.28871595330739297



Validation scores:
	RegressionAUROC: 0.681469202041626
	RegressionCompetitionScore: 0.27782101167315176

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3019455252918288
     Test RegressionAUROC            0.7002822160720825
Test RegressionCompetitionScore      0.3019455252918288
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 13:54:02,069][0m Trial 1 finished with value: 0.3019455252918288 and parameters: {'lr': 8.743697197199578e-06, 'dropout': 0.4218037894387267, 'd_model_multiplier': 8, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 702, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 1 with value: 0.3019455252918288.[0m
Starting trial with params:
{'lr': 2.5802397079879255e-06, 'dropout': 0.580032394647197, 'd_model_multiplier': 4, 'num_layers': 8, 'n_heads': 32, 'dim_feedforward': 256, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.2 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.2 M     Trainable params
0         Non-trainable params
1.2 M     Total params
4.775     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.8333333730697632
	RegressionCompetitionScore: 0.6666666666666666



Validation scores:
	RegressionAUROC: 0.5901815295219421
	RegressionCompetitionScore: 0.08719646799116998

Metric val_loss improved. New best score: 0.253


Validation scores:
	RegressionAUROC: 0.6196985244750977
	RegressionCompetitionScore: 0.0739514348785872



Validation scores:
	RegressionAUROC: 0.617920994758606
	RegressionCompetitionScore: 0.11699779249448124

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.6328942775726318
	RegressionCompetitionScore: 0.15562913907284767



Validation scores:
	RegressionAUROC: 0.6454933881759644
	RegressionCompetitionScore: 0.16445916114790288



Validation scores:
	RegressionAUROC: 0.6627184152603149
	RegressionCompetitionScore: 0.08498896247240618



Validation scores:
	RegressionAUROC: 0.6691105365753174
	RegressionCompetitionScore: 0.11810154525386314



Validation scores:
	RegressionAUROC: 0.6739597320556641
	RegressionCompetitionScore: 0.1368653421633554

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.6764552593231201
	RegressionCompetitionScore: 0.11920529801324503



Validation scores:
	RegressionAUROC: 0.6776995658874512
	RegressionCompetitionScore: 0.08057395143487858

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6950491666793823
	RegressionCompetitionScore: 0.17218543046357615

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6947872042655945
	RegressionCompetitionScore: 0.17218543046357615



Validation scores:
	RegressionAUROC: 0.6935703754425049
	RegressionCompetitionScore: 0.2130242825607064



Validation scores:
	RegressionAUROC: 0.6891167163848877
	RegressionCompetitionScore: 0.217439293598234



Validation scores:
	RegressionAUROC: 0.6929017305374146
	RegressionCompetitionScore: 0.18653421633554085



Validation scores:
	RegressionAUROC: 0.6966838836669922
	RegressionCompetitionScore: 0.22958057395143489



Validation scores:
	RegressionAUROC: 0.7046912908554077
	RegressionCompetitionScore: 0.2108167770419426



Validation scores:
	RegressionAUROC: 0.7018746137619019
	RegressionCompetitionScore: 0.18101545253863136

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.195. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.17218543046357615
     Test RegressionAUROC            0.6950491666793823
Test RegressionCompetitionScore      0.17218543046357615
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 14:03:57,291][0m Trial 2 finished with value: 0.17218543046357615 and parameters: {'lr': 2.5802397079879255e-06, 'dropout': 0.580032394647197, 'd_model_multiplier': 4, 'num_layers': 8, 'n_heads': 32, 'dim_feedforward': 256, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 1 with value: 0.3019455252918288.[0m
Starting trial with params:
{'lr': 2.9740106046224262e-06, 'dropout': 0.8418839363641054, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 64, 'dim_feedforward': 751, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 15.1 M
1 | loss_fn | MSELoss | 0     
------------------------------------
14.8 M    Trainable params
230 K     Non-trainable params
15.1 M    Total params
60.282    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.59375
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4588070213794708
	RegressionCompetitionScore: 0.12193126022913257

Metric val_loss improved. New best score: 0.443


Validation scores:
	RegressionAUROC: 0.41246575117111206
	RegressionCompetitionScore: 0.07446808510638298

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.441


Validation scores:
	RegressionAUROC: 0.45085054636001587
	RegressionCompetitionScore: 0.13584288052373159

Metric val_loss improved by 0.074 >= min_delta = 0.0. New best score: 0.366


Validation scores:
	RegressionAUROC: 0.4202602505683899
	RegressionCompetitionScore: 0.08919803600654665



Validation scores:
	RegressionAUROC: 0.39923638105392456
	RegressionCompetitionScore: 0.07528641571194762

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.360


Validation scores:
	RegressionAUROC: 0.43104949593544006
	RegressionCompetitionScore: 0.0662847790507365



Validation scores:
	RegressionAUROC: 0.41843023896217346
	RegressionCompetitionScore: 0.07364975450081833

Metric val_loss improved by 0.027 >= min_delta = 0.0. New best score: 0.333


Validation scores:
	RegressionAUROC: 0.41505134105682373
	RegressionCompetitionScore: 0.11538461538461539



Validation scores:
	RegressionAUROC: 0.42319226264953613
	RegressionCompetitionScore: 0.07855973813420622



Validation scores:
	RegressionAUROC: 0.4206596612930298
	RegressionCompetitionScore: 0.09574468085106383



Validation scores:
	RegressionAUROC: 0.434772253036499
	RegressionCompetitionScore: 0.07201309328968904

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.320


Validation scores:
	RegressionAUROC: 0.4259563684463501
	RegressionCompetitionScore: 0.08101472995090016

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.303


Validation scores:
	RegressionAUROC: 0.4419591426849365
	RegressionCompetitionScore: 0.08019639934533551



Validation scores:
	RegressionAUROC: 0.42954427003860474
	RegressionCompetitionScore: 0.05810147299509002



Validation scores:
	RegressionAUROC: 0.4348905682563782
	RegressionCompetitionScore: 0.07283142389525368

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.301


Validation scores:
	RegressionAUROC: 0.41042715311050415
	RegressionCompetitionScore: 0.04337152209492635

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.290


Validation scores:
	RegressionAUROC: 0.4236162602901459
	RegressionCompetitionScore: 0.04828150572831424

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.269


Validation scores:
	RegressionAUROC: 0.4556066393852234
	RegressionCompetitionScore: 0.054009819967266774



Validation scores:
	RegressionAUROC: 0.4175907075405121
	RegressionCompetitionScore: 0.05237315875613748



Validation scores:
	RegressionAUROC: 0.45549553632736206
	RegressionCompetitionScore: 0.06546644844517185



Validation scores:
	RegressionAUROC: 0.4306543171405792
	RegressionCompetitionScore: 0.05564648117839607



Validation scores:
	RegressionAUROC: 0.4675673842430115
	RegressionCompetitionScore: 0.06137479541734861



Validation scores:
	RegressionAUROC: 0.45267122983932495
	RegressionCompetitionScore: 0.07364975450081833

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.249


Validation scores:
	RegressionAUROC: 0.44910913705825806
	RegressionCompetitionScore: 0.07855973813420622



Validation scores:
	RegressionAUROC: 0.4537011384963989
	RegressionCompetitionScore: 0.060556464811783964

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.44611865282058716
	RegressionCompetitionScore: 0.0851063829787234

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.4750341475009918
	RegressionCompetitionScore: 0.0867430441898527



Validation scores:
	RegressionAUROC: 0.4502692222595215
	RegressionCompetitionScore: 0.07364975450081833



Validation scores:
	RegressionAUROC: 0.4755132496356964
	RegressionCompetitionScore: 0.07937806873977087



Validation scores:
	RegressionAUROC: 0.44800591468811035
	RegressionCompetitionScore: 0.06710310965630115



Validation scores:
	RegressionAUROC: 0.4677870273590088
	RegressionCompetitionScore: 0.05810147299509002



Validation scores:
	RegressionAUROC: 0.4645997881889343
	RegressionCompetitionScore: 0.07201309328968904



Validation scores:
	RegressionAUROC: 0.47701340913772583
	RegressionCompetitionScore: 0.09901800327332243

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.232. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.0851063829787234
     Test RegressionAUROC            0.44611865282058716
Test RegressionCompetitionScore      0.0851063829787234
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 14:43:32,502][0m Trial 3 finished with value: 0.0851063829787234 and parameters: {'lr': 2.9740106046224262e-06, 'dropout': 0.8418839363641054, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 64, 'dim_feedforward': 751, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 1 with value: 0.3019455252918288.[0m
Starting trial with params:
{'lr': 1.6245508101707392e-07, 'dropout': 0.7563857817826463, 'd_model_multiplier': 8, 'num_layers': 2, 'n_heads': 64, 'dim_feedforward': 311, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.2 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.2 M     Trainable params
0         Non-trainable params
3.2 M     Total params
12.923    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5184926390647888
	RegressionCompetitionScore: 0.13562895291637386

Metric val_loss improved. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.5166048407554626
	RegressionCompetitionScore: 0.14546732255797612



Validation scores:
	RegressionAUROC: 0.5151792764663696
	RegressionCompetitionScore: 0.15530569219957835



Validation scores:
	RegressionAUROC: 0.516670286655426
	RegressionCompetitionScore: 0.15881939564300773



Validation scores:
	RegressionAUROC: 0.5171863436698914
	RegressionCompetitionScore: 0.1820098383696416



Validation scores:
	RegressionAUROC: 0.5187848806381226
	RegressionCompetitionScore: 0.18903724525650034



Validation scores:
	RegressionAUROC: 0.5214574933052063
	RegressionCompetitionScore: 0.18552354181307099



Validation scores:
	RegressionAUROC: 0.5208413004875183
	RegressionCompetitionScore: 0.20028109627547436

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.189. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.13562895291637386
     Test RegressionAUROC            0.5184926390647888
Test RegressionCompetitionScore      0.13562895291637386
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 14:46:40,202][0m Trial 4 finished with value: 0.13562895291637386 and parameters: {'lr': 1.6245508101707392e-07, 'dropout': 0.7563857817826463, 'd_model_multiplier': 8, 'num_layers': 2, 'n_heads': 64, 'dim_feedforward': 311, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 1 with value: 0.3019455252918288.[0m
Starting trial with params:
{'lr': 1.2379188558716473e-07, 'dropout': 0.6180470884317278, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 32, 'dim_feedforward': 635, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 5.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
4.9 M     Trainable params
115 K     Non-trainable params
5.0 M     Total params
19.892    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4923248291015625
	RegressionCompetitionScore: 0.10109289617486339

Metric val_loss improved. New best score: 0.290


Validation scores:
	RegressionAUROC: 0.4998774230480194
	RegressionCompetitionScore: 0.10382513661202186



Validation scores:
	RegressionAUROC: 0.5124850273132324
	RegressionCompetitionScore: 0.10837887067395265

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.253


Validation scores:
	RegressionAUROC: 0.5311578512191772
	RegressionCompetitionScore: 0.10655737704918032



Validation scores:
	RegressionAUROC: 0.5129533410072327
	RegressionCompetitionScore: 0.10109289617486339



Validation scores:
	RegressionAUROC: 0.5171282291412354
	RegressionCompetitionScore: 0.10837887067395265



Validation scores:
	RegressionAUROC: 0.5154900550842285
	RegressionCompetitionScore: 0.10837887067395265



Validation scores:
	RegressionAUROC: 0.5052886009216309
	RegressionCompetitionScore: 0.10018214936247723



Validation scores:
	RegressionAUROC: 0.5129760503768921
	RegressionCompetitionScore: 0.11020036429872496



Validation scores:
	RegressionAUROC: 0.5223666429519653
	RegressionCompetitionScore: 0.1029143897996357

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.253. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10837887067395265
     Test RegressionAUROC            0.5124850273132324
Test RegressionCompetitionScore      0.10837887067395265
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 14:52:22,899][0m Trial 5 finished with value: 0.10837887067395265 and parameters: {'lr': 1.2379188558716473e-07, 'dropout': 0.6180470884317278, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 32, 'dim_feedforward': 635, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 1 with value: 0.3019455252918288.[0m
Starting trial with params:
{'lr': 2.0081023547268667e-07, 'dropout': 0.7759376392170061, 'd_model_multiplier': 16, 'num_layers': 8, 'n_heads': 64, 'dim_feedforward': 731, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 46.6 M
1 | loss_fn | MSELoss | 0     
------------------------------------
46.1 M    Trainable params
460 K     Non-trainable params
46.6 M    Total params
186.272   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5433350801467896
	RegressionCompetitionScore: 0.18139841688654354

Metric val_loss improved. New best score: 0.578


Validation scores:
	RegressionAUROC: 0.5402222275733948
	RegressionCompetitionScore: 0.18073878627968337

Metric val_loss improved by 0.305 >= min_delta = 0.0. New best score: 0.273


Validation scores:
	RegressionAUROC: 0.5385463237762451
	RegressionCompetitionScore: 0.1820580474934037

Metric val_loss improved by 0.091 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.5386889576911926
	RegressionCompetitionScore: 0.18601583113456466

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.5406763553619385
	RegressionCompetitionScore: 0.19195250659630606



Validation scores:
	RegressionAUROC: 0.5428479313850403
	RegressionCompetitionScore: 0.19525065963060687



Validation scores:
	RegressionAUROC: 0.5446622371673584
	RegressionCompetitionScore: 0.19722955145118734



Validation scores:
	RegressionAUROC: 0.5465856194496155
	RegressionCompetitionScore: 0.19920844327176782



Validation scores:
	RegressionAUROC: 0.5480164885520935
	RegressionCompetitionScore: 0.2011873350923483



Validation scores:
	RegressionAUROC: 0.5488443374633789
	RegressionCompetitionScore: 0.20448548812664907



Validation scores:
	RegressionAUROC: 0.5501002073287964
	RegressionCompetitionScore: 0.20976253298153033

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.173. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.18601583113456466
     Test RegressionAUROC            0.5386889576911926
Test RegressionCompetitionScore      0.18601583113456466
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 15:07:58,003][0m Trial 6 finished with value: 0.18601583113456466 and parameters: {'lr': 2.0081023547268667e-07, 'dropout': 0.7759376392170061, 'd_model_multiplier': 16, 'num_layers': 8, 'n_heads': 64, 'dim_feedforward': 731, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 1 with value: 0.3019455252918288.[0m
Starting trial with params:
{'lr': 0.006304797003194514, 'dropout': 0.6298375193726446, 'd_model_multiplier': 1, 'num_layers': 13, 'n_heads': 64, 'dim_feedforward': 441, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.0 M     Trainable params
0         Non-trainable params
1.0 M     Total params
4.140     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

[WARNING] OOM for trial with params {'lr': 0.006304797003194514, 'dropout': 0.6298375193726446, 'd_model_multiplier': 1, 'num_layers': 13, 'n_heads': 64, 'dim_feedforward': 441, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}
[32m[I 2023-04-02 15:08:06,423][0m Trial 7 finished with value: 0.0 and parameters: {'lr': 0.006304797003194514, 'dropout': 0.6298375193726446, 'd_model_multiplier': 1, 'num_layers': 13, 'n_heads': 64, 'dim_feedforward': 441, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}. Best is trial 1 with value: 0.3019455252918288.[0m
Starting trial with params:
{'lr': 2.880348745072709e-07, 'dropout': 0.6613502101427098, 'd_model_multiplier': 32, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 868, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 9.5 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
9.5 M     Trainable params
0         Non-trainable params
9.5 M     Total params
37.912    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6356275677680969
	RegressionCompetitionScore: 0.15789473684210525



Validation scores:
	RegressionAUROC: 0.6924359798431396
	RegressionCompetitionScore: 0.3108108108108108

Metric val_loss improved. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.6929945349693298
	RegressionCompetitionScore: 0.30996621621621623



Validation scores:
	RegressionAUROC: 0.6942168474197388
	RegressionCompetitionScore: 0.31672297297297297



Validation scores:
	RegressionAUROC: 0.6961112022399902
	RegressionCompetitionScore: 0.32010135135135137



Validation scores:
	RegressionAUROC: 0.696863055229187
	RegressionCompetitionScore: 0.32094594594594594



Validation scores:
	RegressionAUROC: 0.6978206634521484
	RegressionCompetitionScore: 0.32432432432432434



Validation scores:
	RegressionAUROC: 0.6987388134002686
	RegressionCompetitionScore: 0.32432432432432434



Validation scores:
	RegressionAUROC: 0.6984304785728455
	RegressionCompetitionScore: 0.32010135135135137

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.180. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3108108108108108
     Test RegressionAUROC            0.6924359798431396
Test RegressionCompetitionScore      0.3108108108108108
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 15:11:34,357][0m Trial 8 finished with value: 0.3108108108108108 and parameters: {'lr': 2.880348745072709e-07, 'dropout': 0.6613502101427098, 'd_model_multiplier': 32, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 868, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 8 with value: 0.3108108108108108.[0m
Starting trial with params:
{'lr': 0.0001558761202914687, 'dropout': 0.6802216875500722, 'd_model_multiplier': 2, 'num_layers': 6, 'n_heads': 16, 'dim_feedforward': 156, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 132 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
132 K     Trainable params
0         Non-trainable params
132 K     Total params
0.531     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5580942034721375
	RegressionCompetitionScore: 0.09170305676855896

Metric val_loss improved. New best score: 0.396


Validation scores:
	RegressionAUROC: 0.5566585063934326
	RegressionCompetitionScore: 0.0906113537117904

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.394


Validation scores:
	RegressionAUROC: 0.5573838949203491
	RegressionCompetitionScore: 0.08296943231441048

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.394


Validation scores:
	RegressionAUROC: 0.5543062090873718
	RegressionCompetitionScore: 0.08296943231441048

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.389


Validation scores:
	RegressionAUROC: 0.5726450681686401
	RegressionCompetitionScore: 0.13755458515283842

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.383


Validation scores:
	RegressionAUROC: 0.5762730836868286
	RegressionCompetitionScore: 0.1462882096069869

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.383


Validation scores:
	RegressionAUROC: 0.5674302577972412
	RegressionCompetitionScore: 0.13646288209606988

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.381


Validation scores:
	RegressionAUROC: 0.5861291289329529
	RegressionCompetitionScore: 0.18231441048034935

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.371


Validation scores:
	RegressionAUROC: 0.5815792083740234
	RegressionCompetitionScore: 0.17685589519650655



Validation scores:
	RegressionAUROC: 0.5755239725112915
	RegressionCompetitionScore: 0.16375545851528384



Validation scores:
	RegressionAUROC: 0.5884355306625366
	RegressionCompetitionScore: 0.16266375545851527

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.371


Validation scores:
	RegressionAUROC: 0.59320068359375
	RegressionCompetitionScore: 0.18340611353711792



Validation scores:
	RegressionAUROC: 0.5777782797813416
	RegressionCompetitionScore: 0.17467248908296942

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.360


Validation scores:
	RegressionAUROC: 0.5805057287216187
	RegressionCompetitionScore: 0.185589519650655

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.352


Validation scores:
	RegressionAUROC: 0.5832457542419434
	RegressionCompetitionScore: 0.18340611353711792

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.348


Validation scores:
	RegressionAUROC: 0.590838611125946
	RegressionCompetitionScore: 0.21506550218340612

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.338


Validation scores:
	RegressionAUROC: 0.5895125269889832
	RegressionCompetitionScore: 0.20633187772925765



Validation scores:
	RegressionAUROC: 0.5868741273880005
	RegressionCompetitionScore: 0.1943231441048035

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.326


Validation scores:
	RegressionAUROC: 0.5915640592575073
	RegressionCompetitionScore: 0.19759825327510916



Validation scores:
	RegressionAUROC: 0.5800396203994751
	RegressionCompetitionScore: 0.1703056768558952



Validation scores:
	RegressionAUROC: 0.5932042598724365
	RegressionCompetitionScore: 0.19759825327510916

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.325


Validation scores:
	RegressionAUROC: 0.5979065895080566
	RegressionCompetitionScore: 0.2019650655021834



Validation scores:
	RegressionAUROC: 0.5966455936431885
	RegressionCompetitionScore: 0.19104803493449782

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.319


Validation scores:
	RegressionAUROC: 0.5978794097900391
	RegressionCompetitionScore: 0.19978165938864628



Validation scores:
	RegressionAUROC: 0.5944421291351318
	RegressionCompetitionScore: 0.19541484716157206

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.298


Validation scores:
	RegressionAUROC: 0.6023714542388916
	RegressionCompetitionScore: 0.21506550218340612



Validation scores:
	RegressionAUROC: 0.6041346788406372
	RegressionCompetitionScore: 0.21069868995633187



Validation scores:
	RegressionAUROC: 0.6003270745277405
	RegressionCompetitionScore: 0.2052401746724891

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.292


Validation scores:
	RegressionAUROC: 0.6075910925865173
	RegressionCompetitionScore: 0.2183406113537118



Validation scores:
	RegressionAUROC: 0.6083557605743408
	RegressionCompetitionScore: 0.21397379912663755



Validation scores:
	RegressionAUROC: 0.6125901937484741
	RegressionCompetitionScore: 0.2096069868995633



Validation scores:
	RegressionAUROC: 0.6167258024215698
	RegressionCompetitionScore: 0.20087336244541484



Validation scores:
	RegressionAUROC: 0.6127092242240906
	RegressionCompetitionScore: 0.19759825327510916

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.288


Validation scores:
	RegressionAUROC: 0.61493980884552
	RegressionCompetitionScore: 0.19978165938864628



Validation scores:
	RegressionAUROC: 0.6152945160865784
	RegressionCompetitionScore: 0.19213973799126638

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.286


Validation scores:
	RegressionAUROC: 0.6197081804275513
	RegressionCompetitionScore: 0.185589519650655



Validation scores:
	RegressionAUROC: 0.6175764203071594
	RegressionCompetitionScore: 0.19104803493449782



Validation scores:
	RegressionAUROC: 0.6147085428237915
	RegressionCompetitionScore: 0.18668122270742357

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.284


Validation scores:
	RegressionAUROC: 0.618064284324646
	RegressionCompetitionScore: 0.18231441048034935

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.276


Validation scores:
	RegressionAUROC: 0.6183896064758301
	RegressionCompetitionScore: 0.18777292576419213



Validation scores:
	RegressionAUROC: 0.6177279353141785
	RegressionCompetitionScore: 0.18013100436681223



Validation scores:
	RegressionAUROC: 0.6207637786865234
	RegressionCompetitionScore: 0.1572052401746725



Validation scores:
	RegressionAUROC: 0.6137759685516357
	RegressionCompetitionScore: 0.18449781659388648

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.262


Validation scores:
	RegressionAUROC: 0.6156581044197083
	RegressionCompetitionScore: 0.18668122270742357



Validation scores:
	RegressionAUROC: 0.6159499883651733
	RegressionCompetitionScore: 0.18668122270742357

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.6175822019577026
	RegressionCompetitionScore: 0.1888646288209607



Validation scores:
	RegressionAUROC: 0.6141645908355713
	RegressionCompetitionScore: 0.18777292576419213



Validation scores:
	RegressionAUROC: 0.6103270649909973
	RegressionCompetitionScore: 0.18777292576419213



Validation scores:
	RegressionAUROC: 0.6082599759101868
	RegressionCompetitionScore: 0.17467248908296942



Validation scores:
	RegressionAUROC: 0.6118968725204468
	RegressionCompetitionScore: 0.17576419213973798

`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.18668122270742357
     Test RegressionAUROC            0.6159499883651733
Test RegressionCompetitionScore      0.18668122270742357
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 15:25:08,600][0m Trial 9 finished with value: 0.18668122270742357 and parameters: {'lr': 0.0001558761202914687, 'dropout': 0.6802216875500722, 'd_model_multiplier': 2, 'num_layers': 6, 'n_heads': 16, 'dim_feedforward': 156, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 8 with value: 0.3108108108108108.[0m
Starting trial with params:
{'lr': 0.0004542388971443248, 'dropout': 0.8593839145562634, 'd_model_multiplier': 32, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 1024, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 9.7 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
9.7 M     Trainable params
0         Non-trainable params
9.7 M     Total params
38.914    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.891


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.228 >= min_delta = 0.0. New best score: 1.662


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49582386016845703
	RegressionCompetitionScore: 0.13071474565357372

Metric val_loss improved by 1.454 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.43226540088653564
	RegressionCompetitionScore: 0.13844172569220864



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.208. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.13071474565357372
     Test RegressionAUROC            0.49582386016845703
Test RegressionCompetitionScore      0.13071474565357372
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 15:30:32,581][0m Trial 10 finished with value: 0.13071474565357372 and parameters: {'lr': 0.0004542388971443248, 'dropout': 0.8593839145562634, 'd_model_multiplier': 32, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 1024, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 8 with value: 0.3108108108108108.[0m
Starting trial with params:
{'lr': 4.2693669406749515e-06, 'dropout': 0.4214140128048513, 'd_model_multiplier': 64, 'num_layers': 15, 'n_heads': 8, 'dim_feedforward': 894, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 30.0 M
1 | loss_fn | MSELoss | 0     
------------------------------------
30.0 M    Trainable params
0         Non-trainable params
30.0 M    Total params
120.119   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5410628318786621
	RegressionCompetitionScore: 0.43478260869565216



Validation scores:
	RegressionAUROC: 0.6486061215400696
	RegressionCompetitionScore: 0.42181340341655715

Metric val_loss improved. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7218846082687378
	RegressionCompetitionScore: 0.5032851511169514



Validation scores:
	RegressionAUROC: 0.7341921329498291
	RegressionCompetitionScore: 0.507227332457293



Validation scores:
	RegressionAUROC: 0.7042067646980286
	RegressionCompetitionScore: 0.46254927726675427



Validation scores:
	RegressionAUROC: 0.7600275278091431
	RegressionCompetitionScore: 0.5597897503285151



Validation scores:
	RegressionAUROC: 0.7614969611167908
	RegressionCompetitionScore: 0.5354796320630749



Validation scores:
	RegressionAUROC: 0.7565044164657593
	RegressionCompetitionScore: 0.5229960578186597



Validation scores:
	RegressionAUROC: 0.7900441884994507
	RegressionCompetitionScore: 0.5624178712220762

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.163. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.42181340341655715
     Test RegressionAUROC            0.6486061215400696
Test RegressionCompetitionScore      0.42181340341655715
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 15:36:09,273][0m Trial 11 finished with value: 0.42181340341655715 and parameters: {'lr': 4.2693669406749515e-06, 'dropout': 0.4214140128048513, 'd_model_multiplier': 64, 'num_layers': 15, 'n_heads': 8, 'dim_feedforward': 894, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.6367805282194697e-06, 'dropout': 0.5469781157142958, 'd_model_multiplier': 64, 'num_layers': 15, 'n_heads': 8, 'dim_feedforward': 983, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 31.4 M
1 | loss_fn | MSELoss | 0     
------------------------------------
31.4 M    Trainable params
0         Non-trainable params
31.4 M    Total params
125.593   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.48828125
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5390188097953796
	RegressionCompetitionScore: 0.07317073170731707

Metric val_loss improved. New best score: 0.247


Validation scores:
	RegressionAUROC: 0.5371922254562378
	RegressionCompetitionScore: 0.06504065040650407



Validation scores:
	RegressionAUROC: 0.541198194026947
	RegressionCompetitionScore: 0.06808943089430894



Validation scores:
	RegressionAUROC: 0.5431018471717834
	RegressionCompetitionScore: 0.06910569105691057



Validation scores:
	RegressionAUROC: 0.5428576469421387
	RegressionCompetitionScore: 0.06808943089430894



Validation scores:
	RegressionAUROC: 0.5457779765129089
	RegressionCompetitionScore: 0.06402439024390244



Validation scores:
	RegressionAUROC: 0.551270604133606
	RegressionCompetitionScore: 0.06504065040650407



Validation scores:
	RegressionAUROC: 0.5611715316772461
	RegressionCompetitionScore: 0.06808943089430894

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.247. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.07317073170731707
     Test RegressionAUROC            0.5390188097953796
Test RegressionCompetitionScore      0.07317073170731707
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 15:41:57,831][0m Trial 12 finished with value: 0.07317073170731707 and parameters: {'lr': 1.6367805282194697e-06, 'dropout': 0.5469781157142958, 'd_model_multiplier': 64, 'num_layers': 15, 'n_heads': 8, 'dim_feedforward': 983, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 9.615186719298328e-07, 'dropout': 0.48001286084858374, 'd_model_multiplier': 64, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 849, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 21.6 M
1 | loss_fn | MSELoss | 0     
------------------------------------
21.6 M    Trainable params
0         Non-trainable params
21.6 M    Total params
86.577    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7828570604324341
	RegressionCompetitionScore: 0.76



Validation scores:
	RegressionAUROC: 0.6212775111198425
	RegressionCompetitionScore: 0.2565698478561549

Metric val_loss improved. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6464945673942566
	RegressionCompetitionScore: 0.2544951590594744

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.6712952852249146
	RegressionCompetitionScore: 0.2793914246196404



Validation scores:
	RegressionAUROC: 0.6920130252838135
	RegressionCompetitionScore: 0.3084370677731674



Validation scores:
	RegressionAUROC: 0.7161620855331421
	RegressionCompetitionScore: 0.318118948824343



Validation scores:
	RegressionAUROC: 0.7292234897613525
	RegressionCompetitionScore: 0.3243430152143845



Validation scores:
	RegressionAUROC: 0.7437629699707031
	RegressionCompetitionScore: 0.34024896265560167



Validation scores:
	RegressionAUROC: 0.7471234798431396
	RegressionCompetitionScore: 0.35477178423236516



Validation scores:
	RegressionAUROC: 0.7482006549835205
	RegressionCompetitionScore: 0.355463347164592

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.190. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2544951590594744
     Test RegressionAUROC            0.6464945673942566
Test RegressionCompetitionScore      0.2544951590594744
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 15:46:51,873][0m Trial 13 finished with value: 0.2544951590594744 and parameters: {'lr': 9.615186719298328e-07, 'dropout': 0.48001286084858374, 'd_model_multiplier': 64, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 849, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 2.395134139270909e-05, 'dropout': 0.5195375376958391, 'd_model_multiplier': 32, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 552, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 6.3 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
6.3 M     Trainable params
0         Non-trainable params
6.3 M     Total params
25.101    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6333333253860474
	RegressionCompetitionScore: 0.25



Validation scores:
	RegressionAUROC: 0.5487365126609802
	RegressionCompetitionScore: 0.16003460207612458

Metric val_loss improved. New best score: 0.249


Validation scores:
	RegressionAUROC: 0.548534631729126
	RegressionCompetitionScore: 0.16089965397923875

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.5483751893043518
	RegressionCompetitionScore: 0.15916955017301038

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.547246515750885
	RegressionCompetitionScore: 0.15397923875432526

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.223


Validation scores:
	RegressionAUROC: 0.5456377267837524
	RegressionCompetitionScore: 0.15916955017301038



Validation scores:
	RegressionAUROC: 0.5434515476226807
	RegressionCompetitionScore: 0.157439446366782



Validation scores:
	RegressionAUROC: 0.5393221378326416
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5346577763557434
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5380476713180542
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5436311364173889
	RegressionCompetitionScore: 0.15311418685121106



Validation scores:
	RegressionAUROC: 0.5464513301849365
	RegressionCompetitionScore: 0.15484429065743946

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.223. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.15397923875432526
     Test RegressionAUROC             0.547246515750885
Test RegressionCompetitionScore      0.15397923875432526
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 15:50:59,845][0m Trial 14 finished with value: 0.15397923875432526 and parameters: {'lr': 2.395134139270909e-05, 'dropout': 0.5195375376958391, 'd_model_multiplier': 32, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 552, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 5.624654472566607e-07, 'dropout': 0.40039206245776593, 'd_model_multiplier': 64, 'num_layers': 15, 'n_heads': 8, 'dim_feedforward': 889, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 30.0 M
1 | loss_fn | MSELoss | 0     
------------------------------------
30.0 M    Trainable params
0         Non-trainable params
30.0 M    Total params
119.812   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5470603704452515
	RegressionCompetitionScore: 0.19167217448777263

Metric val_loss improved. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5828498601913452
	RegressionCompetitionScore: 0.24586913417052214



Validation scores:
	RegressionAUROC: 0.5900330543518066
	RegressionCompetitionScore: 0.2762723066754792

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.6175987720489502
	RegressionCompetitionScore: 0.30337078651685395



Validation scores:
	RegressionAUROC: 0.641473650932312
	RegressionCompetitionScore: 0.3218770654329147



Validation scores:
	RegressionAUROC: 0.6433843970298767
	RegressionCompetitionScore: 0.33707865168539325



Validation scores:
	RegressionAUROC: 0.6597750186920166
	RegressionCompetitionScore: 0.33245208195637804



Validation scores:
	RegressionAUROC: 0.6926579475402832
	RegressionCompetitionScore: 0.3734302709847984



Validation scores:
	RegressionAUROC: 0.7247881293296814
	RegressionCompetitionScore: 0.40251156642432256



Validation scores:
	RegressionAUROC: 0.7211136817932129
	RegressionCompetitionScore: 0.4018506278916061

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.213. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2762723066754792
     Test RegressionAUROC            0.5900330543518066
Test RegressionCompetitionScore      0.2762723066754792
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 15:58:03,616][0m Trial 15 finished with value: 0.2762723066754792 and parameters: {'lr': 5.624654472566607e-07, 'dropout': 0.40039206245776593, 'd_model_multiplier': 64, 'num_layers': 15, 'n_heads': 8, 'dim_feedforward': 889, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 7.36922058513304e-06, 'dropout': 0.6817832990446072, 'd_model_multiplier': 32, 'num_layers': 10, 'n_heads': 8, 'dim_feedforward': 478, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 5.3 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
5.3 M     Trainable params
0         Non-trainable params
5.3 M     Total params
21.392    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2901960611343384
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4487380385398865
	RegressionCompetitionScore: 0.09061224489795919

Metric val_loss improved. New best score: 0.233


Validation scores:
	RegressionAUROC: 0.4621713161468506
	RegressionCompetitionScore: 0.09959183673469388

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.4889286756515503
	RegressionCompetitionScore: 0.11346938775510204



Validation scores:
	RegressionAUROC: 0.5238503217697144
	RegressionCompetitionScore: 0.11428571428571428

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5509486198425293
	RegressionCompetitionScore: 0.12326530612244897

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5655975341796875
	RegressionCompetitionScore: 0.13306122448979593

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.5661135911941528
	RegressionCompetitionScore: 0.13714285714285715



Validation scores:
	RegressionAUROC: 0.5701697468757629
	RegressionCompetitionScore: 0.1436734693877551



Validation scores:
	RegressionAUROC: 0.5622844696044922
	RegressionCompetitionScore: 0.14204081632653062



Validation scores:
	RegressionAUROC: 0.5507799386978149
	RegressionCompetitionScore: 0.13142857142857142



Validation scores:
	RegressionAUROC: 0.5605952739715576
	RegressionCompetitionScore: 0.14204081632653062



Validation scores:
	RegressionAUROC: 0.5719609260559082
	RegressionCompetitionScore: 0.14857142857142858



Validation scores:
	RegressionAUROC: 0.5780819058418274
	RegressionCompetitionScore: 0.16

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.207. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.13306122448979593
     Test RegressionAUROC            0.5655975341796875
Test RegressionCompetitionScore      0.13306122448979593
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 16:02:45,037][0m Trial 16 finished with value: 0.13306122448979593 and parameters: {'lr': 7.36922058513304e-06, 'dropout': 0.6817832990446072, 'd_model_multiplier': 32, 'num_layers': 10, 'n_heads': 8, 'dim_feedforward': 478, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 5.865663531645437e-07, 'dropout': 0.49047122124593656, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 4, 'dim_feedforward': 818, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 208 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
208 K     Trainable params
0         Non-trainable params
208 K     Total params
0.835     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.397


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.355 >= min_delta = 0.0. New best score: 1.042


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.286 >= min_delta = 0.0. New best score: 0.756


Validation scores:
	RegressionAUROC: 0.6594211459159851
	RegressionCompetitionScore: 0.14940098661028894

Metric val_loss improved by 0.194 >= min_delta = 0.0. New best score: 0.562


Validation scores:
	RegressionAUROC: 0.6370607614517212
	RegressionCompetitionScore: 0.12473572938689217

Metric val_loss improved by 0.130 >= min_delta = 0.0. New best score: 0.433


Validation scores:
	RegressionAUROC: 0.5992035865783691
	RegressionCompetitionScore: 0.11205073995771671

Metric val_loss improved by 0.049 >= min_delta = 0.0. New best score: 0.384


Validation scores:
	RegressionAUROC: 0.5521199107170105
	RegressionCompetitionScore: 0.10077519379844961

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.360


Validation scores:
	RegressionAUROC: 0.536739706993103
	RegressionCompetitionScore: 0.08668076109936575

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.356


Validation scores:
	RegressionAUROC: 0.5281884074211121
	RegressionCompetitionScore: 0.09090909090909091

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.351


Validation scores:
	RegressionAUROC: 0.49805599451065063
	RegressionCompetitionScore: 0.08456659619450317



Validation scores:
	RegressionAUROC: 0.4952339828014374
	RegressionCompetitionScore: 0.07188160676532769

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.326


Validation scores:
	RegressionAUROC: 0.46308204531669617
	RegressionCompetitionScore: 0.0408738548273432

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.303


Validation scores:
	RegressionAUROC: 0.42740964889526367
	RegressionCompetitionScore: 0.028893587033121917

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.290


Validation scores:
	RegressionAUROC: 0.41160523891448975
	RegressionCompetitionScore: 0.02959830866807611

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.290


Validation scores:
	RegressionAUROC: 0.3927987813949585
	RegressionCompetitionScore: 0.028893587033121917



Validation scores:
	RegressionAUROC: 0.39479461312294006
	RegressionCompetitionScore: 0.040169133192389



Validation scores:
	RegressionAUROC: 0.3890943229198456
	RegressionCompetitionScore: 0.042283298097251586



Validation scores:
	RegressionAUROC: 0.39324450492858887
	RegressionCompetitionScore: 0.041578576462297394



Validation scores:
	RegressionAUROC: 0.38748568296432495
	RegressionCompetitionScore: 0.041578576462297394



Validation scores:
	RegressionAUROC: 0.3957503139972687
	RegressionCompetitionScore: 0.058491895701198025



Validation scores:
	RegressionAUROC: 0.39607009291648865
	RegressionCompetitionScore: 0.05214940098661029

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.290. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.02959830866807611
     Test RegressionAUROC            0.41160523891448975
Test RegressionCompetitionScore      0.02959830866807611
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 16:10:08,456][0m Trial 17 finished with value: 0.02959830866807611 and parameters: {'lr': 5.865663531645437e-07, 'dropout': 0.49047122124593656, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 4, 'dim_feedforward': 818, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 0.08444625057493073, 'dropout': 0.5808797088727855, 'd_model_multiplier': 4, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 949, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 111 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
97.3 K    Trainable params
14.4 K    Non-trainable params
111 K     Total params
0.447     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.551948070526123
	RegressionCompetitionScore: 0.38095238095238093



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.207. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 16:13:44,934][0m Trial 18 finished with value: 0.0 and parameters: {'lr': 0.08444625057493073, 'dropout': 0.5808797088727855, 'd_model_multiplier': 4, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 949, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 3.9430012673330407e-07, 'dropout': 0.4666876786747559, 'd_model_multiplier': 1, 'num_layers': 15, 'n_heads': 8, 'dim_feedforward': 588, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 178 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
178 K     Trainable params
0         Non-trainable params
178 K     Total params
0.714     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.890


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.887


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.883


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.880


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.877


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.873


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.870


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.866


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.863


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.861


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.858


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.855


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.852


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.849


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.846


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.842


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.839


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.836


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.832


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.831


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.828


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.824


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.821


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.818


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.815


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.812


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.808


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.805


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.802


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.800


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.797


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.794


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.790


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.787


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.784


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.781


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.777


Validation scores:
	RegressionAUROC: 0.49961090087890625
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.774


Validation scores:
	RegressionAUROC: 0.49961090087890625
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.771


Validation scores:
	RegressionAUROC: 0.49961090087890625
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.769


Validation scores:
	RegressionAUROC: 0.49961090087890625
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.766


Validation scores:
	RegressionAUROC: 0.49961090087890625
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.762


Validation scores:
	RegressionAUROC: 0.49961090087890625
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.759


Validation scores:
	RegressionAUROC: 0.49961090087890625
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.756


Validation scores:
	RegressionAUROC: 0.49961090087890625
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.753


Validation scores:
	RegressionAUROC: 0.49961090087890625
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.749


Validation scores:
	RegressionAUROC: 0.49961090087890625
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.746


Validation scores:
	RegressionAUROC: 0.49961090087890625
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.743


Validation scores:
	RegressionAUROC: 0.49961090087890625
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.739


Validation scores:
	RegressionAUROC: 0.49961090087890625
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.738
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC            0.49961090087890625
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 16:29:51,958][0m Trial 19 finished with value: 0.0 and parameters: {'lr': 3.9430012673330407e-07, 'dropout': 0.4666876786747559, 'd_model_multiplier': 1, 'num_layers': 15, 'n_heads': 8, 'dim_feedforward': 588, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.184544243277974e-07, 'dropout': 0.5318290605426899, 'd_model_multiplier': 64, 'num_layers': 13, 'n_heads': 4, 'dim_feedforward': 768, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 8.8 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
8.8 M     Trainable params
0         Non-trainable params
8.8 M     Total params
35.244    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.391


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 1.390


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 1.387


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 1.383


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 1.379


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 1.374


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 1.368


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 1.361


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 1.356


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 1.348


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 1.340


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 1.332


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 1.324


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 1.314


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 1.307


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 1.298


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 1.288


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 1.277


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 1.269


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 1.258


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 1.247


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 1.236


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 1.225


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 1.213


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 1.204


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 1.192


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 1.180


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 1.167


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 1.158


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 1.145


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 1.132


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 1.119


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 1.106


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 1.093


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 1.083


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 1.069


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 1.056


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 1.042


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 1.032


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 1.018


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 1.005


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.991


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.977


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.963


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.953


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.939


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.925


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.910


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.900


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.886
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 16:48:14,141][0m Trial 20 finished with value: 0.0 and parameters: {'lr': 1.184544243277974e-07, 'dropout': 0.5318290605426899, 'd_model_multiplier': 64, 'num_layers': 13, 'n_heads': 4, 'dim_feedforward': 768, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 6.0903744125267385e-06, 'dropout': 0.4386895684206537, 'd_model_multiplier': 32, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 681, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 25.0 M
1 | loss_fn | MSELoss | 0     
------------------------------------
25.0 M    Trainable params
0         Non-trainable params
25.0 M    Total params
100.015   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5120773315429688
	RegressionCompetitionScore: 0.4782608695652174



Validation scores:
	RegressionAUROC: 0.5374844074249268
	RegressionCompetitionScore: 0.16154873164218958

Metric val_loss improved. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.6217200756072998
	RegressionCompetitionScore: 0.27236315086782376



Validation scores:
	RegressionAUROC: 0.6324175596237183
	RegressionCompetitionScore: 0.2630173564753004



Validation scores:
	RegressionAUROC: 0.6231461763381958
	RegressionCompetitionScore: 0.2363150867823765

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.654731035232544
	RegressionCompetitionScore: 0.2630173564753004



Validation scores:
	RegressionAUROC: 0.6618441343307495
	RegressionCompetitionScore: 0.2643524699599466



Validation scores:
	RegressionAUROC: 0.6740858554840088
	RegressionCompetitionScore: 0.2817089452603471



Validation scores:
	RegressionAUROC: 0.6774981021881104
	RegressionCompetitionScore: 0.253671562082777



Validation scores:
	RegressionAUROC: 0.6478599309921265
	RegressionCompetitionScore: 0.22830440587449932



Validation scores:
	RegressionAUROC: 0.6475971937179565
	RegressionCompetitionScore: 0.22363150867823764



Validation scores:
	RegressionAUROC: 0.6468707323074341
	RegressionCompetitionScore: 0.22162883845126835

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.166. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2363150867823765
     Test RegressionAUROC            0.6231461763381958
Test RegressionCompetitionScore      0.2363150867823765
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 16:57:01,773][0m Trial 21 finished with value: 0.2363150867823765 and parameters: {'lr': 6.0903744125267385e-06, 'dropout': 0.4386895684206537, 'd_model_multiplier': 32, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 681, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.7894341998045428e-05, 'dropout': 0.4089275099503989, 'd_model_multiplier': 8, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 932, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 4.4 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
4.4 M     Trainable params
0         Non-trainable params
4.4 M     Total params
17.683    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4534412622451782
	RegressionCompetitionScore: 0.05263157894736842



Validation scores:
	RegressionAUROC: 0.615237832069397
	RegressionCompetitionScore: 0.24290220820189273

Metric val_loss improved. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.585585355758667
	RegressionCompetitionScore: 0.17823343848580442



Validation scores:
	RegressionAUROC: 0.6295634508132935
	RegressionCompetitionScore: 0.21845425867507887

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6682453751564026
	RegressionCompetitionScore: 0.24053627760252366



Validation scores:
	RegressionAUROC: 0.7012720704078674
	RegressionCompetitionScore: 0.31230283911671924

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7431584596633911
	RegressionCompetitionScore: 0.361198738170347



Validation scores:
	RegressionAUROC: 0.7477244734764099
	RegressionCompetitionScore: 0.33201892744479494



Validation scores:
	RegressionAUROC: 0.7508001327514648
	RegressionCompetitionScore: 0.3832807570977918

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7588643431663513
	RegressionCompetitionScore: 0.39353312302839116



Validation scores:
	RegressionAUROC: 0.7753422856330872
	RegressionCompetitionScore: 0.39826498422712936



Validation scores:
	RegressionAUROC: 0.7799705862998962
	RegressionCompetitionScore: 0.41246056782334384

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.159


Validation scores:
	RegressionAUROC: 0.7768045663833618
	RegressionCompetitionScore: 0.37618296529968454



Validation scores:
	RegressionAUROC: 0.7829209566116333
	RegressionCompetitionScore: 0.3714511041009464



Validation scores:
	RegressionAUROC: 0.7925014495849609
	RegressionCompetitionScore: 0.40063091482649843

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.153


Validation scores:
	RegressionAUROC: 0.7974221706390381
	RegressionCompetitionScore: 0.4242902208201893



Validation scores:
	RegressionAUROC: 0.7998359203338623
	RegressionCompetitionScore: 0.41246056782334384



Validation scores:
	RegressionAUROC: 0.7990660071372986
	RegressionCompetitionScore: 0.43217665615141954



Validation scores:
	RegressionAUROC: 0.792716383934021
	RegressionCompetitionScore: 0.41324921135646686



Validation scores:
	RegressionAUROC: 0.7919890284538269
	RegressionCompetitionScore: 0.38170347003154576



Validation scores:
	RegressionAUROC: 0.785535454750061
	RegressionCompetitionScore: 0.3714511041009464



Validation scores:
	RegressionAUROC: 0.8023233413696289
	RegressionCompetitionScore: 0.4069400630914827

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.153. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.40063091482649843
     Test RegressionAUROC            0.7925014495849609
Test RegressionCompetitionScore      0.40063091482649843
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 17:07:59,618][0m Trial 22 finished with value: 0.40063091482649843 and parameters: {'lr': 1.7894341998045428e-05, 'dropout': 0.4089275099503989, 'd_model_multiplier': 8, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 932, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.2981986392009952e-06, 'dropout': 0.41479760090893547, 'd_model_multiplier': 64, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 948, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 62.4 M
1 | loss_fn | MSELoss | 0     
------------------------------------
62.4 M    Trainable params
0         Non-trainable params
62.4 M    Total params
249.668   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4588235318660736
	RegressionCompetitionScore: 0.06666666666666667



Validation scores:
	RegressionAUROC: 0.5909246206283569
	RegressionCompetitionScore: 0.20093896713615023

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6085278391838074
	RegressionCompetitionScore: 0.22629107981220659

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6230421662330627
	RegressionCompetitionScore: 0.22347417840375586



Validation scores:
	RegressionAUROC: 0.6621389389038086
	RegressionCompetitionScore: 0.2272300469483568



Validation scores:
	RegressionAUROC: 0.6710551381111145
	RegressionCompetitionScore: 0.22347417840375586



Validation scores:
	RegressionAUROC: 0.6756405830383301
	RegressionCompetitionScore: 0.2187793427230047



Validation scores:
	RegressionAUROC: 0.6763591766357422
	RegressionCompetitionScore: 0.2272300469483568

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6637858152389526
	RegressionCompetitionScore: 0.2300469483568075



Validation scores:
	RegressionAUROC: 0.6622399091720581
	RegressionCompetitionScore: 0.24694835680751173



Validation scores:
	RegressionAUROC: 0.6421957612037659
	RegressionCompetitionScore: 0.2535211267605634



Validation scores:
	RegressionAUROC: 0.6548197865486145
	RegressionCompetitionScore: 0.26948356807511736



Validation scores:
	RegressionAUROC: 0.6797072887420654
	RegressionCompetitionScore: 0.25821596244131456

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6944393515586853
	RegressionCompetitionScore: 0.24882629107981222

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7024377584457397
	RegressionCompetitionScore: 0.2544600938967136



Validation scores:
	RegressionAUROC: 0.7051012516021729
	RegressionCompetitionScore: 0.25258215962441316

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7082562446594238
	RegressionCompetitionScore: 0.2300469483568075



Validation scores:
	RegressionAUROC: 0.6997694969177246
	RegressionCompetitionScore: 0.25727699530516435

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7053754925727844
	RegressionCompetitionScore: 0.26948356807511736



Validation scores:
	RegressionAUROC: 0.7061755657196045
	RegressionCompetitionScore: 0.2704225352112676



Validation scores:
	RegressionAUROC: 0.6894787549972534
	RegressionCompetitionScore: 0.27230046948356806



Validation scores:
	RegressionAUROC: 0.698607861995697
	RegressionCompetitionScore: 0.26291079812206575



Validation scores:
	RegressionAUROC: 0.6949779987335205
	RegressionCompetitionScore: 0.27230046948356806

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7094694375991821
	RegressionCompetitionScore: 0.26666666666666666



Validation scores:
	RegressionAUROC: 0.7137724161148071
	RegressionCompetitionScore: 0.28169014084507044

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.712205171585083
	RegressionCompetitionScore: 0.28732394366197184



Validation scores:
	RegressionAUROC: 0.7133773565292358
	RegressionCompetitionScore: 0.2375586854460094



Validation scores:
	RegressionAUROC: 0.6993458271026611
	RegressionCompetitionScore: 0.28732394366197184



Validation scores:
	RegressionAUROC: 0.696382999420166
	RegressionCompetitionScore: 0.2948356807511737



Validation scores:
	RegressionAUROC: 0.6924741268157959
	RegressionCompetitionScore: 0.29389671361502345



Validation scores:
	RegressionAUROC: 0.689031720161438
	RegressionCompetitionScore: 0.3061032863849765



Validation scores:
	RegressionAUROC: 0.6816041469573975
	RegressionCompetitionScore: 0.21971830985915494

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.28169014084507044
     Test RegressionAUROC            0.7137724161148071
Test RegressionCompetitionScore      0.28169014084507044
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 17:41:22,526][0m Trial 23 finished with value: 0.28169014084507044 and parameters: {'lr': 1.2981986392009952e-06, 'dropout': 0.41479760090893547, 'd_model_multiplier': 64, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 948, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 2.555843672994531e-05, 'dropout': 0.5098089524550655, 'd_model_multiplier': 32, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 826, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 23.3 M
1 | loss_fn | MSELoss | 0     
------------------------------------
23.3 M    Trainable params
0         Non-trainable params
23.3 M    Total params
93.139    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.49567100405693054
	RegressionCompetitionScore: 0.09523809523809523



Validation scores:
	RegressionAUROC: 0.5288189053535461
	RegressionCompetitionScore: 0.2209480122324159

Metric val_loss improved. New best score: 0.398


Validation scores:
	RegressionAUROC: 0.6394587159156799
	RegressionCompetitionScore: 0.26299694189602446

Metric val_loss improved by 0.200 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6080726981163025
	RegressionCompetitionScore: 0.2714067278287462



Validation scores:
	RegressionAUROC: 0.6593402624130249
	RegressionCompetitionScore: 0.28134556574923547

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6825379133224487
	RegressionCompetitionScore: 0.29357798165137616



Validation scores:
	RegressionAUROC: 0.667930006980896
	RegressionCompetitionScore: 0.2798165137614679



Validation scores:
	RegressionAUROC: 0.6893138289451599
	RegressionCompetitionScore: 0.2591743119266055



Validation scores:
	RegressionAUROC: 0.6855359673500061
	RegressionCompetitionScore: 0.327217125382263



Validation scores:
	RegressionAUROC: 0.6699139475822449
	RegressionCompetitionScore: 0.2805810397553517



Validation scores:
	RegressionAUROC: 0.681564211845398
	RegressionCompetitionScore: 0.2874617737003058



Validation scores:
	RegressionAUROC: 0.6860762238502502
	RegressionCompetitionScore: 0.2782874617737003

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.197. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.28134556574923547
     Test RegressionAUROC            0.6593402624130249
Test RegressionCompetitionScore      0.28134556574923547
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 17:49:09,967][0m Trial 24 finished with value: 0.28134556574923547 and parameters: {'lr': 2.555843672994531e-05, 'dropout': 0.5098089524550655, 'd_model_multiplier': 32, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 826, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 4.264130573707238e-07, 'dropout': 0.4595743281120468, 'd_model_multiplier': 8, 'num_layers': 15, 'n_heads': 32, 'dim_feedforward': 950, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 11.5 M
1 | loss_fn | MSELoss | 0     
------------------------------------
11.5 M    Trainable params
0         Non-trainable params
11.5 M    Total params
46.114    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5209579467773438
	RegressionCompetitionScore: 0.16282764098490865

Metric val_loss improved. New best score: 0.552


Validation scores:
	RegressionAUROC: 0.5353593826293945
	RegressionCompetitionScore: 0.16044479745830023

Metric val_loss improved by 0.299 >= min_delta = 0.0. New best score: 0.253


Validation scores:
	RegressionAUROC: 0.5293315649032593
	RegressionCompetitionScore: 0.1517077045274027



Validation scores:
	RegressionAUROC: 0.5498093366622925
	RegressionCompetitionScore: 0.15647339158061954



Validation scores:
	RegressionAUROC: 0.5685470104217529
	RegressionCompetitionScore: 0.16123907863383638

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.240


Validation scores:
	RegressionAUROC: 0.5792150497436523
	RegressionCompetitionScore: 0.16044479745830023

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.5872260332107544
	RegressionCompetitionScore: 0.1596505162827641

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.5930331945419312
	RegressionCompetitionScore: 0.15885623510722796

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.231


Validation scores:
	RegressionAUROC: 0.6002407073974609
	RegressionCompetitionScore: 0.16679904686258937

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.604378879070282
	RegressionCompetitionScore: 0.1691818903891978



Validation scores:
	RegressionAUROC: 0.6063216924667358
	RegressionCompetitionScore: 0.17235901509134233



Validation scores:
	RegressionAUROC: 0.6081818342208862
	RegressionCompetitionScore: 0.17474185861795075



Validation scores:
	RegressionAUROC: 0.6125297546386719
	RegressionCompetitionScore: 0.16838760921366164



Validation scores:
	RegressionAUROC: 0.614224910736084
	RegressionCompetitionScore: 0.16679904686258937



Validation scores:
	RegressionAUROC: 0.6157203912734985
	RegressionCompetitionScore: 0.1691818903891978



Validation scores:
	RegressionAUROC: 0.6167820692062378
	RegressionCompetitionScore: 0.17077045274027006

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.226. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.16679904686258937
     Test RegressionAUROC            0.6002407073974609
Test RegressionCompetitionScore      0.16679904686258937
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 18:05:32,328][0m Trial 25 finished with value: 0.16679904686258937 and parameters: {'lr': 4.264130573707238e-07, 'dropout': 0.4595743281120468, 'd_model_multiplier': 8, 'num_layers': 15, 'n_heads': 32, 'dim_feedforward': 950, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 4.469136381243768e-06, 'dropout': 0.4814246752094581, 'd_model_multiplier': 16, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 897, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 10.4 M
1 | loss_fn | MSELoss | 0     
------------------------------------
10.3 M    Trainable params
115 K     Non-trainable params
10.4 M    Total params
41.584    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5734560489654541
	RegressionCompetitionScore: 0.36685082872928176

Metric val_loss improved. New best score: 0.312


Validation scores:
	RegressionAUROC: 0.5764017105102539
	RegressionCompetitionScore: 0.3541436464088398

Metric val_loss improved by 0.102 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.5697029829025269
	RegressionCompetitionScore: 0.36574585635359114



Validation scores:
	RegressionAUROC: 0.6033428311347961
	RegressionCompetitionScore: 0.37182320441988953

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5602685809135437
	RegressionCompetitionScore: 0.3806629834254144



Validation scores:
	RegressionAUROC: 0.577027440071106
	RegressionCompetitionScore: 0.37403314917127073



Validation scores:
	RegressionAUROC: 0.5770586729049683
	RegressionCompetitionScore: 0.3762430939226519



Validation scores:
	RegressionAUROC: 0.56866854429245
	RegressionCompetitionScore: 0.3651933701657459



Validation scores:
	RegressionAUROC: 0.6015502214431763
	RegressionCompetitionScore: 0.3856353591160221



Validation scores:
	RegressionAUROC: 0.6369537115097046
	RegressionCompetitionScore: 0.4016574585635359



Validation scores:
	RegressionAUROC: 0.5992997884750366
	RegressionCompetitionScore: 0.36408839779005525

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37182320441988953
     Test RegressionAUROC            0.6033428311347961
Test RegressionCompetitionScore      0.37182320441988953
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 18:12:52,193][0m Trial 26 finished with value: 0.37182320441988953 and parameters: {'lr': 4.469136381243768e-06, 'dropout': 0.4814246752094581, 'd_model_multiplier': 16, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 897, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 8.685835564497412e-05, 'dropout': 0.401108686958512, 'd_model_multiplier': 16, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 1009, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 11.2 M
1 | loss_fn | MSELoss | 0     
------------------------------------
11.1 M    Trainable params
115 K     Non-trainable params
11.2 M    Total params
44.802    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5714285969734192
	RegressionCompetitionScore: 0.14285714285714285



Validation scores:
	RegressionAUROC: 0.603807806968689
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 4.063


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5089703798294067
	RegressionCompetitionScore: 0.02418096723868955



Validation scores:
	RegressionAUROC: 0.68989497423172
	RegressionCompetitionScore: 0.22308892355694226

Metric val_loss improved by 3.711 >= min_delta = 0.0. New best score: 0.352


Validation scores:
	RegressionAUROC: 0.7524186372756958
	RegressionCompetitionScore: 0.21996879875195008



Validation scores:
	RegressionAUROC: 0.30687960982322693
	RegressionCompetitionScore: 0.07956318252730109



Validation scores:
	RegressionAUROC: 0.41807711124420166
	RegressionCompetitionScore: 0.08268330733229329



Validation scores:
	RegressionAUROC: 0.6247690916061401
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5078620910644531
	RegressionCompetitionScore: 0.11544461778471139



Validation scores:
	RegressionAUROC: 0.6967047452926636
	RegressionCompetitionScore: 0.1497659906396256

Metric val_loss improved by 0.119 >= min_delta = 0.0. New best score: 0.233


Validation scores:
	RegressionAUROC: 0.7309332489967346
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6157987117767334
	RegressionCompetitionScore: 0.23088923556942278



Validation scores:
	RegressionAUROC: 0.6988400220870972
	RegressionCompetitionScore: 0.28861154446177845



Validation scores:
	RegressionAUROC: 0.6486351490020752
	RegressionCompetitionScore: 0.13884555382215288



Validation scores:
	RegressionAUROC: 0.6639391183853149
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4820234179496765
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6423006653785706
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.233. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1497659906396256
     Test RegressionAUROC            0.6967047452926636
Test RegressionCompetitionScore      0.1497659906396256
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 18:23:50,375][0m Trial 27 finished with value: 0.1497659906396256 and parameters: {'lr': 8.685835564497412e-05, 'dropout': 0.401108686958512, 'd_model_multiplier': 16, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 1009, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 4.12327399959352e-06, 'dropout': 0.4572062182425298, 'd_model_multiplier': 16, 'num_layers': 4, 'n_heads': 16, 'dim_feedforward': 921, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.2 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.1 M     Trainable params
115 K     Non-trainable params
3.2 M     Total params
12.797    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.43914446234703064
	RegressionCompetitionScore: 0.03129657228017884

Metric val_loss improved. New best score: 0.425


Validation scores:
	RegressionAUROC: 0.49512606859207153
	RegressionCompetitionScore: 0.019374068554396422

Metric val_loss improved by 0.050 >= min_delta = 0.0. New best score: 0.375


Validation scores:
	RegressionAUROC: 0.5607014894485474
	RegressionCompetitionScore: 0.02533532041728763

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.338


Validation scores:
	RegressionAUROC: 0.6508009433746338
	RegressionCompetitionScore: 0.042473919523099854

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.322


Validation scores:
	RegressionAUROC: 0.6431419849395752
	RegressionCompetitionScore: 0.029806259314456036

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.291


Validation scores:
	RegressionAUROC: 0.6461812853813171
	RegressionCompetitionScore: 0.05216095380029806



Validation scores:
	RegressionAUROC: 0.6899607181549072
	RegressionCompetitionScore: 0.14381520119225039

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.288


Validation scores:
	RegressionAUROC: 0.6819767355918884
	RegressionCompetitionScore: 0.11400894187779434



Validation scores:
	RegressionAUROC: 0.7415412068367004
	RegressionCompetitionScore: 0.33084947839046197

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.280


Validation scores:
	RegressionAUROC: 0.7531281113624573
	RegressionCompetitionScore: 0.36661698956780925



Validation scores:
	RegressionAUROC: 0.7111717462539673
	RegressionCompetitionScore: 0.22801788375558868



Validation scores:
	RegressionAUROC: 0.6996817588806152
	RegressionCompetitionScore: 0.1751117734724292

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.272


Validation scores:
	RegressionAUROC: 0.7201312780380249
	RegressionCompetitionScore: 0.2660208643815201

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.7280195951461792
	RegressionCompetitionScore: 0.28614008941877794

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.7309233546257019
	RegressionCompetitionScore: 0.29210134128166915

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.231


Validation scores:
	RegressionAUROC: 0.7436924576759338
	RegressionCompetitionScore: 0.3412816691505216



Validation scores:
	RegressionAUROC: 0.7414237260818481
	RegressionCompetitionScore: 0.3107302533532042



Validation scores:
	RegressionAUROC: 0.758112907409668
	RegressionCompetitionScore: 0.36885245901639346



Validation scores:
	RegressionAUROC: 0.7647647261619568
	RegressionCompetitionScore: 0.3830104321907601



Validation scores:
	RegressionAUROC: 0.777759313583374
	RegressionCompetitionScore: 0.4493293591654247



Validation scores:
	RegressionAUROC: 0.7465260028839111
	RegressionCompetitionScore: 0.3166915052160954



Validation scores:
	RegressionAUROC: 0.748270571231842
	RegressionCompetitionScore: 0.3405365126676602

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.231. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.29210134128166915
     Test RegressionAUROC            0.7309233546257019
Test RegressionCompetitionScore      0.29210134128166915
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 18:30:07,431][0m Trial 28 finished with value: 0.29210134128166915 and parameters: {'lr': 4.12327399959352e-06, 'dropout': 0.4572062182425298, 'd_model_multiplier': 16, 'num_layers': 4, 'n_heads': 16, 'dim_feedforward': 921, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.6025785575929137e-05, 'dropout': 0.4452688434968402, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 790, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 6.9 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
6.8 M     Trainable params
115 K     Non-trainable params
6.9 M     Total params
27.795    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6987535357475281
	RegressionCompetitionScore: 0.22616233254531126

Metric val_loss improved. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.6471294164657593
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6669682264328003
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6351965665817261
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6744534373283386
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7183501720428467
	RegressionCompetitionScore: 0.24428684003152087



Validation scores:
	RegressionAUROC: 0.6786870956420898
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6793761253356934
	RegressionCompetitionScore: 0.26713947990543735

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.184. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.22616233254531126
     Test RegressionAUROC            0.6987535357475281
Test RegressionCompetitionScore      0.22616233254531126
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 18:34:09,084][0m Trial 29 finished with value: 0.22616233254531126 and parameters: {'lr': 1.6025785575929137e-05, 'dropout': 0.4452688434968402, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 790, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 5.6772020481661456e-05, 'dropout': 0.4347670206167836, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 4, 'dim_feedforward': 644, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.3 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.2 M     Trainable params
28.8 K    Non-trainable params
1.3 M     Total params
5.102     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6718899011611938
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.356


Validation scores:
	RegressionAUROC: 0.6049472093582153
	RegressionCompetitionScore: 0.16692913385826771

Metric val_loss improved by 0.121 >= min_delta = 0.0. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.6120436191558838
	RegressionCompetitionScore: 0.22755905511811023



Validation scores:
	RegressionAUROC: 0.684151291847229
	RegressionCompetitionScore: 0.22283464566929134



Validation scores:
	RegressionAUROC: 0.673071026802063
	RegressionCompetitionScore: 0.16220472440944883



Validation scores:
	RegressionAUROC: 0.530430793762207
	RegressionCompetitionScore: 0.17716535433070865



Validation scores:
	RegressionAUROC: 0.6281379461288452
	RegressionCompetitionScore: 0.2251968503937008

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.6220768690109253
	RegressionCompetitionScore: 0.2614173228346457



Validation scores:
	RegressionAUROC: 0.6562358140945435
	RegressionCompetitionScore: 0.17874015748031497

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.6709321141242981
	RegressionCompetitionScore: 0.24960629921259841

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6293140053749084
	RegressionCompetitionScore: 0.2874015748031496



Validation scores:
	RegressionAUROC: 0.6943114399909973
	RegressionCompetitionScore: 0.1251968503937008

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6616359353065491
	RegressionCompetitionScore: 0.1125984251968504



Validation scores:
	RegressionAUROC: 0.5949127674102783
	RegressionCompetitionScore: 0.3354330708661417



Validation scores:
	RegressionAUROC: 0.6109500527381897
	RegressionCompetitionScore: 0.30708661417322836



Validation scores:
	RegressionAUROC: 0.6611217260360718
	RegressionCompetitionScore: 0.2692913385826772



Validation scores:
	RegressionAUROC: 0.6108925342559814
	RegressionCompetitionScore: 0.06929133858267716



Validation scores:
	RegressionAUROC: 0.6264786124229431
	RegressionCompetitionScore: 0.27716535433070866



Validation scores:
	RegressionAUROC: 0.6050276160240173
	RegressionCompetitionScore: 0.25826771653543307

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.211. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1251968503937008
     Test RegressionAUROC            0.6943114399909973
Test RegressionCompetitionScore      0.1251968503937008
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 18:41:06,606][0m Trial 30 finished with value: 0.1251968503937008 and parameters: {'lr': 5.6772020481661456e-05, 'dropout': 0.4347670206167836, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 4, 'dim_feedforward': 644, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.8457093777567727e-06, 'dropout': 0.4908433553122819, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 879, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 906 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
892 K     Trainable params
14.4 K    Non-trainable params
906 K     Total params
3.628     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5322872400283813
	RegressionCompetitionScore: 0.11352885525070956

Metric val_loss improved. New best score: 0.527


Validation scores:
	RegressionAUROC: 0.5592938661575317
	RegressionCompetitionScore: 0.10312204351939451

Metric val_loss improved by 0.291 >= min_delta = 0.0. New best score: 0.236


Validation scores:
	RegressionAUROC: 0.5618974566459656
	RegressionCompetitionScore: 0.08325449385052035



Validation scores:
	RegressionAUROC: 0.5565720796585083
	RegressionCompetitionScore: 0.06811731315042574



Validation scores:
	RegressionAUROC: 0.5546082258224487
	RegressionCompetitionScore: 0.06149479659413434



Validation scores:
	RegressionAUROC: 0.5604104995727539
	RegressionCompetitionScore: 0.065279091769158



Validation scores:
	RegressionAUROC: 0.5710378289222717
	RegressionCompetitionScore: 0.07379375591296121



Validation scores:
	RegressionAUROC: 0.5722987651824951
	RegressionCompetitionScore: 0.07663197729422895



Validation scores:
	RegressionAUROC: 0.5798352956771851
	RegressionCompetitionScore: 0.10879848628192999

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.236. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10312204351939451
     Test RegressionAUROC            0.5592938661575317
Test RegressionCompetitionScore      0.10312204351939451
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 18:45:33,901][0m Trial 31 finished with value: 0.10312204351939451 and parameters: {'lr': 1.8457093777567727e-06, 'dropout': 0.4908433553122819, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 879, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.4282135188804614e-05, 'dropout': 0.42867573470651177, 'd_model_multiplier': 8, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 858, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.7 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.7 M     Trainable params
28.8 K    Non-trainable params
1.7 M     Total params
6.938     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5879853367805481
	RegressionCompetitionScore: 0.17847222222222223

Metric val_loss improved. New best score: 0.490


Validation scores:
	RegressionAUROC: 0.5547958612442017
	RegressionCompetitionScore: 0.15069444444444444

Metric val_loss improved by 0.107 >= min_delta = 0.0. New best score: 0.384


Validation scores:
	RegressionAUROC: 0.5672100782394409
	RegressionCompetitionScore: 0.26944444444444443

Metric val_loss improved by 0.090 >= min_delta = 0.0. New best score: 0.294


Validation scores:
	RegressionAUROC: 0.6219013929367065
	RegressionCompetitionScore: 0.3326388888888889



Validation scores:
	RegressionAUROC: 0.5414038300514221
	RegressionCompetitionScore: 0.2423611111111111

Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.264


Validation scores:
	RegressionAUROC: 0.5441163778305054
	RegressionCompetitionScore: 0.25972222222222224

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.261


Validation scores:
	RegressionAUROC: 0.5792064666748047
	RegressionCompetitionScore: 0.2652777777777778



Validation scores:
	RegressionAUROC: 0.5739516019821167
	RegressionCompetitionScore: 0.2847222222222222



Validation scores:
	RegressionAUROC: 0.5677773952484131
	RegressionCompetitionScore: 0.25625

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.255


Validation scores:
	RegressionAUROC: 0.5975713729858398
	RegressionCompetitionScore: 0.25625



Validation scores:
	RegressionAUROC: 0.5567957162857056
	RegressionCompetitionScore: 0.23819444444444443



Validation scores:
	RegressionAUROC: 0.5629028677940369
	RegressionCompetitionScore: 0.2590277777777778

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.253


Validation scores:
	RegressionAUROC: 0.4728921949863434
	RegressionCompetitionScore: 0.18263888888888888



Validation scores:
	RegressionAUROC: 0.6331338286399841
	RegressionCompetitionScore: 0.3541666666666667



Validation scores:
	RegressionAUROC: 0.5722404718399048
	RegressionCompetitionScore: 0.25833333333333336



Validation scores:
	RegressionAUROC: 0.6680666208267212
	RegressionCompetitionScore: 0.4263888888888889



Validation scores:
	RegressionAUROC: 0.5432243943214417
	RegressionCompetitionScore: 0.2048611111111111



Validation scores:
	RegressionAUROC: 0.5711973309516907
	RegressionCompetitionScore: 0.2298611111111111



Validation scores:
	RegressionAUROC: 0.6488389372825623
	RegressionCompetitionScore: 0.3784722222222222

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.253. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2590277777777778
     Test RegressionAUROC            0.5629028677940369
Test RegressionCompetitionScore      0.2590277777777778
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 18:52:09,096][0m Trial 32 finished with value: 0.2590277777777778 and parameters: {'lr': 1.4282135188804614e-05, 'dropout': 0.42867573470651177, 'd_model_multiplier': 8, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 858, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 4.310435759033184e-06, 'dropout': 0.4865097189639617, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 905, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.9 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.9 M     Trainable params
0         Non-trainable params
1.9 M     Total params
7.788     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5301116704940796
	RegressionCompetitionScore: 0.2139446036294174

Metric val_loss improved. New best score: 0.262


Validation scores:
	RegressionAUROC: 0.5477600693702698
	RegressionCompetitionScore: 0.21680993314231137

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.237


Validation scores:
	RegressionAUROC: 0.5555304884910583
	RegressionCompetitionScore: 0.224450811843362



Validation scores:
	RegressionAUROC: 0.5609736442565918
	RegressionCompetitionScore: 0.22349570200573066

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.5620118975639343
	RegressionCompetitionScore: 0.20534861509073543

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.233


Validation scores:
	RegressionAUROC: 0.5849460363388062
	RegressionCompetitionScore: 0.15281757402101243

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.6006405353546143
	RegressionCompetitionScore: 0.14708691499522444



Validation scores:
	RegressionAUROC: 0.6072555780410767
	RegressionCompetitionScore: 0.1318051575931232



Validation scores:
	RegressionAUROC: 0.620255708694458
	RegressionCompetitionScore: 0.13658070678127984



Validation scores:
	RegressionAUROC: 0.6228000521659851
	RegressionCompetitionScore: 0.13658070678127984



Validation scores:
	RegressionAUROC: 0.6243823766708374
	RegressionCompetitionScore: 0.15950334288443171



Validation scores:
	RegressionAUROC: 0.6233593225479126
	RegressionCompetitionScore: 0.19579751671442217



Validation scores:
	RegressionAUROC: 0.636031985282898
	RegressionCompetitionScore: 0.18051575931232092

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.228. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.15281757402101243
     Test RegressionAUROC            0.5849460363388062
Test RegressionCompetitionScore      0.15281757402101243
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 18:58:35,007][0m Trial 33 finished with value: 0.15281757402101243 and parameters: {'lr': 4.310435759033184e-06, 'dropout': 0.4865097189639617, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 905, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 8.94921546305701e-06, 'dropout': 0.5513652280300826, 'd_model_multiplier': 1, 'num_layers': 15, 'n_heads': 8, 'dim_feedforward': 766, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 223 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
223 K     Trainable params
0         Non-trainable params
223 K     Total params
0.895     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5072142481803894
	RegressionCompetitionScore: 0.03640040444893832

Metric val_loss improved. New best score: 0.293


Validation scores:
	RegressionAUROC: 0.49238336086273193
	RegressionCompetitionScore: 0.055611729019211326

Metric val_loss improved by 0.057 >= min_delta = 0.0. New best score: 0.237


Validation scores:
	RegressionAUROC: 0.472241073846817
	RegressionCompetitionScore: 0.055611729019211326



Validation scores:
	RegressionAUROC: 0.46120771765708923
	RegressionCompetitionScore: 0.0525783619817998



Validation scores:
	RegressionAUROC: 0.44829684495925903
	RegressionCompetitionScore: 0.056622851365015166



Validation scores:
	RegressionAUROC: 0.44243547320365906
	RegressionCompetitionScore: 0.056622851365015166

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.4341479539871216
	RegressionCompetitionScore: 0.05358948432760364

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.42774534225463867
	RegressionCompetitionScore: 0.056622851365015166

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.4235522150993347
	RegressionCompetitionScore: 0.05156723963599596

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.4247897267341614
	RegressionCompetitionScore: 0.05358948432760364

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.45535513758659363
	RegressionCompetitionScore: 0.055611729019211326



Validation scores:
	RegressionAUROC: 0.46666768193244934
	RegressionCompetitionScore: 0.0525783619817998



Validation scores:
	RegressionAUROC: 0.46504878997802734
	RegressionCompetitionScore: 0.05055611729019211



Validation scores:
	RegressionAUROC: 0.4633301794528961
	RegressionCompetitionScore: 0.05156723963599596



Validation scores:
	RegressionAUROC: 0.4598597288131714
	RegressionCompetitionScore: 0.042467138523761376



Validation scores:
	RegressionAUROC: 0.4597819745540619
	RegressionCompetitionScore: 0.03640040444893832

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.45375239849090576
	RegressionCompetitionScore: 0.03640040444893832

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.4556445777416229
	RegressionCompetitionScore: 0.03842264914054601

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.4542960822582245
	RegressionCompetitionScore: 0.03943377148634985

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.45604991912841797
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.45208120346069336
	RegressionCompetitionScore: 0.041456016177957536



Validation scores:
	RegressionAUROC: 0.4432695806026459
	RegressionCompetitionScore: 0.041456016177957536



Validation scores:
	RegressionAUROC: 0.4418565630912781
	RegressionCompetitionScore: 0.0455005055611729



Validation scores:
	RegressionAUROC: 0.4449363946914673
	RegressionCompetitionScore: 0.0455005055611729



Validation scores:
	RegressionAUROC: 0.4466124176979065
	RegressionCompetitionScore: 0.04853387259858443



Validation scores:
	RegressionAUROC: 0.4498746395111084
	RegressionCompetitionScore: 0.056622851365015166

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.206. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.03943377148634985
     Test RegressionAUROC            0.4542960822582245
Test RegressionCompetitionScore      0.03943377148634985
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 19:06:59,057][0m Trial 34 finished with value: 0.03943377148634985 and parameters: {'lr': 8.94921546305701e-06, 'dropout': 0.5513652280300826, 'd_model_multiplier': 1, 'num_layers': 15, 'n_heads': 8, 'dim_feedforward': 766, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 2.361688071305162e-06, 'dropout': 0.41357346443309767, 'd_model_multiplier': 8, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 706, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 7.1 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
7.1 M     Trainable params
0         Non-trainable params
7.1 M     Total params
28.578    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6254829168319702
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.418


Validation scores:
	RegressionAUROC: 0.5836090445518494
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: 0.389


Validation scores:
	RegressionAUROC: 0.6357689499855042
	RegressionCompetitionScore: 0.2991040661612681

Metric val_loss improved by 0.161 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.6677600741386414
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6250426769256592
	RegressionCompetitionScore: 0.25982081323225364



Validation scores:
	RegressionAUROC: 0.6100356578826904
	RegressionCompetitionScore: 0.18883528600964852



Validation scores:
	RegressionAUROC: 0.6453213691711426
	RegressionCompetitionScore: 0.23914541695382494



Validation scores:
	RegressionAUROC: 0.6073698997497559
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6237231492996216
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6183446645736694
	RegressionCompetitionScore: 0.19917298414886286

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.228. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2991040661612681
     Test RegressionAUROC            0.6357689499855042
Test RegressionCompetitionScore      0.2991040661612681
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 19:16:02,183][0m Trial 35 finished with value: 0.2991040661612681 and parameters: {'lr': 2.361688071305162e-06, 'dropout': 0.41357346443309767, 'd_model_multiplier': 8, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 706, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.058296903292403e-06, 'dropout': 0.44697898078714376, 'd_model_multiplier': 64, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 341, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 69.6 M
1 | loss_fn | MSELoss | 0     
------------------------------------
69.1 M    Trainable params
460 K     Non-trainable params
69.6 M    Total params
278.354   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.390625
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.44088250398635864
	RegressionCompetitionScore: 0.09626556016597511

Metric val_loss improved. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.4321005046367645
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.43329378962516785
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.43936991691589355
	RegressionCompetitionScore: 0.0946058091286307



Validation scores:
	RegressionAUROC: 0.43895381689071655
	RegressionCompetitionScore: 0.0946058091286307



Validation scores:
	RegressionAUROC: 0.44612523913383484
	RegressionCompetitionScore: 0.0954356846473029



Validation scores:
	RegressionAUROC: 0.4629339277744293
	RegressionCompetitionScore: 0.0995850622406639



Validation scores:
	RegressionAUROC: 0.4813355803489685
	RegressionCompetitionScore: 0.08381742738589211

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.251. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.09626556016597511
     Test RegressionAUROC            0.44088250398635864
Test RegressionCompetitionScore      0.09626556016597511
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 19:26:52,469][0m Trial 36 finished with value: 0.09626556016597511 and parameters: {'lr': 1.058296903292403e-06, 'dropout': 0.44697898078714376, 'd_model_multiplier': 64, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 341, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 3.42334462849834e-06, 'dropout': 0.5093261545800125, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 64, 'dim_feedforward': 973, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 56.7 M
1 | loss_fn | MSELoss | 0     
------------------------------------
56.7 M    Trainable params
0         Non-trainable params
56.7 M    Total params
226.928   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.557876467704773
	RegressionCompetitionScore: 0.05555555555555555

Metric val_loss improved. New best score: 0.259


Validation scores:
	RegressionAUROC: 0.4962903559207916
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5632040500640869
	RegressionCompetitionScore: 0.0847953216374269



Validation scores:
	RegressionAUROC: 0.5743191242218018
	RegressionCompetitionScore: 0.09551656920077972



Validation scores:
	RegressionAUROC: 0.5721324682235718
	RegressionCompetitionScore: 0.09844054580896686



Validation scores:
	RegressionAUROC: 0.5676212310791016
	RegressionCompetitionScore: 0.0847953216374269

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.5709868669509888
	RegressionCompetitionScore: 0.08576998050682261

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.5785269737243652
	RegressionCompetitionScore: 0.07212475633528265



Validation scores:
	RegressionAUROC: 0.579841136932373
	RegressionCompetitionScore: 0.05360623781676413



Validation scores:
	RegressionAUROC: 0.583529531955719
	RegressionCompetitionScore: 0.05263157894736842



Validation scores:
	RegressionAUROC: 0.5897504091262817
	RegressionCompetitionScore: 0.057504873294346975

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.231


Validation scores:
	RegressionAUROC: 0.594017505645752
	RegressionCompetitionScore: 0.06530214424951267



Validation scores:
	RegressionAUROC: 0.5964261293411255
	RegressionCompetitionScore: 0.0847953216374269



Validation scores:
	RegressionAUROC: 0.595772385597229
	RegressionCompetitionScore: 0.09649122807017543

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.5951612591743469
	RegressionCompetitionScore: 0.11598440545808966



Validation scores:
	RegressionAUROC: 0.5924922227859497
	RegressionCompetitionScore: 0.14619883040935672

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.5936405062675476
	RegressionCompetitionScore: 0.16666666666666666



Validation scores:
	RegressionAUROC: 0.5951218605041504
	RegressionCompetitionScore: 0.18031189083820662



Validation scores:
	RegressionAUROC: 0.5983831286430359
	RegressionCompetitionScore: 0.16764132553606237



Validation scores:
	RegressionAUROC: 0.603060245513916
	RegressionCompetitionScore: 0.17543859649122806



Validation scores:
	RegressionAUROC: 0.6068273186683655
	RegressionCompetitionScore: 0.1783625730994152



Validation scores:
	RegressionAUROC: 0.6099814176559448
	RegressionCompetitionScore: 0.18421052631578946



Validation scores:
	RegressionAUROC: 0.6111775636672974
	RegressionCompetitionScore: 0.19980506822612085

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.230. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.14619883040935672
     Test RegressionAUROC            0.5924922227859497
Test RegressionCompetitionScore      0.14619883040935672
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 20:03:59,371][0m Trial 37 finished with value: 0.14619883040935672 and parameters: {'lr': 3.42334462849834e-06, 'dropout': 0.5093261545800125, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 64, 'dim_feedforward': 973, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 2.2983052347276636e-07, 'dropout': 0.568760073760875, 'd_model_multiplier': 8, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 827, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 8.5 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
8.4 M     Trainable params
115 K     Non-trainable params
8.5 M     Total params
34.064    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6113360524177551
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49911919236183167
	RegressionCompetitionScore: 0.1346153846153846

Metric val_loss improved. New best score: 0.538


Validation scores:
	RegressionAUROC: 0.42461955547332764
	RegressionCompetitionScore: 0.1362876254180602

Metric val_loss improved by 0.064 >= min_delta = 0.0. New best score: 0.474


Validation scores:
	RegressionAUROC: 0.4665837287902832
	RegressionCompetitionScore: 0.14214046822742474

Metric val_loss improved by 0.040 >= min_delta = 0.0. New best score: 0.434


Validation scores:
	RegressionAUROC: 0.4550819396972656
	RegressionCompetitionScore: 0.1688963210702341

Metric val_loss improved by 0.034 >= min_delta = 0.0. New best score: 0.400


Validation scores:
	RegressionAUROC: 0.4766882061958313
	RegressionCompetitionScore: 0.16387959866220736

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.387


Validation scores:
	RegressionAUROC: 0.46737557649612427
	RegressionCompetitionScore: 0.17307692307692307

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.375


Validation scores:
	RegressionAUROC: 0.4925510585308075
	RegressionCompetitionScore: 0.17307692307692307

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.363


Validation scores:
	RegressionAUROC: 0.5038273334503174
	RegressionCompetitionScore: 0.16638795986622074



Validation scores:
	RegressionAUROC: 0.48633578419685364
	RegressionCompetitionScore: 0.17558528428093645

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.346


Validation scores:
	RegressionAUROC: 0.5401396155357361
	RegressionCompetitionScore: 0.1588628762541806



Validation scores:
	RegressionAUROC: 0.4962579607963562
	RegressionCompetitionScore: 0.1479933110367893

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.331


Validation scores:
	RegressionAUROC: 0.5048505663871765
	RegressionCompetitionScore: 0.10451505016722408

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.320


Validation scores:
	RegressionAUROC: 0.5529080629348755
	RegressionCompetitionScore: 0.14381270903010032



Validation scores:
	RegressionAUROC: 0.5263941884040833
	RegressionCompetitionScore: 0.15384615384615385

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.306


Validation scores:
	RegressionAUROC: 0.5244583487510681
	RegressionCompetitionScore: 0.1488294314381271

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.302


Validation scores:
	RegressionAUROC: 0.5141536593437195
	RegressionCompetitionScore: 0.15468227424749165



Validation scores:
	RegressionAUROC: 0.5367486476898193
	RegressionCompetitionScore: 0.13795986622073578

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.301


Validation scores:
	RegressionAUROC: 0.5310909748077393
	RegressionCompetitionScore: 0.1505016722408027



Validation scores:
	RegressionAUROC: 0.5239469408988953
	RegressionCompetitionScore: 0.15217391304347827

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.295


Validation scores:
	RegressionAUROC: 0.5594509243965149
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.5089956521987915
	RegressionCompetitionScore: 0.11120401337792642

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.292


Validation scores:
	RegressionAUROC: 0.5170998573303223
	RegressionCompetitionScore: 0.11622073578595318

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.290


Validation scores:
	RegressionAUROC: 0.5627672076225281
	RegressionCompetitionScore: 0.1262541806020067



Validation scores:
	RegressionAUROC: 0.5536379814147949
	RegressionCompetitionScore: 0.14214046822742474

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.282


Validation scores:
	RegressionAUROC: 0.548281192779541
	RegressionCompetitionScore: 0.1245819397993311

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.281


Validation scores:
	RegressionAUROC: 0.5294761657714844
	RegressionCompetitionScore: 0.14715719063545152

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.279


Validation scores:
	RegressionAUROC: 0.5502302050590515
	RegressionCompetitionScore: 0.14214046822742474

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.279


Validation scores:
	RegressionAUROC: 0.5553702712059021
	RegressionCompetitionScore: 0.13795986622073578

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.277


Validation scores:
	RegressionAUROC: 0.5461630821228027
	RegressionCompetitionScore: 0.16555183946488294

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.272


Validation scores:
	RegressionAUROC: 0.5930407047271729
	RegressionCompetitionScore: 0.12290969899665552



Validation scores:
	RegressionAUROC: 0.5568287372589111
	RegressionCompetitionScore: 0.12374581939799331



Validation scores:
	RegressionAUROC: 0.5506881475448608
	RegressionCompetitionScore: 0.13127090301003344



Validation scores:
	RegressionAUROC: 0.5876300930976868
	RegressionCompetitionScore: 0.12207357859531773



Validation scores:
	RegressionAUROC: 0.5826221704483032
	RegressionCompetitionScore: 0.1605351170568562

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.264


Validation scores:
	RegressionAUROC: 0.5729108452796936
	RegressionCompetitionScore: 0.16722408026755853



Validation scores:
	RegressionAUROC: 0.5710650682449341
	RegressionCompetitionScore: 0.18561872909698995



Validation scores:
	RegressionAUROC: 0.5924930572509766
	RegressionCompetitionScore: 0.18561872909698995



Validation scores:
	RegressionAUROC: 0.5860003232955933
	RegressionCompetitionScore: 0.17558528428093645



Validation scores:
	RegressionAUROC: 0.5897276997566223
	RegressionCompetitionScore: 0.19648829431438128



Validation scores:
	RegressionAUROC: 0.6306456327438354
	RegressionCompetitionScore: 0.16220735785953178



Validation scores:
	RegressionAUROC: 0.5972030162811279
	RegressionCompetitionScore: 0.13963210702341136

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.264. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1605351170568562
     Test RegressionAUROC            0.5826221704483032
Test RegressionCompetitionScore      0.1605351170568562
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 20:39:34,291][0m Trial 38 finished with value: 0.1605351170568562 and parameters: {'lr': 2.2983052347276636e-07, 'dropout': 0.568760073760875, 'd_model_multiplier': 8, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 827, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.0603903583948393e-05, 'dropout': 0.6107261549033309, 'd_model_multiplier': 32, 'num_layers': 13, 'n_heads': 4, 'dim_feedforward': 892, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 4.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
4.0 M     Trainable params
0         Non-trainable params
4.0 M     Total params
15.924    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5909090638160706
	RegressionCompetitionScore: 0.2727272727272727



Validation scores:
	RegressionAUROC: 0.49441397190093994
	RegressionCompetitionScore: 0.11892296185489903

Metric val_loss improved. New best score: 0.271


Validation scores:
	RegressionAUROC: 0.4918251633644104
	RegressionCompetitionScore: 0.1219147344801795

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.248


Validation scores:
	RegressionAUROC: 0.5267096161842346
	RegressionCompetitionScore: 0.1211667913238594



Validation scores:
	RegressionAUROC: 0.5566636323928833
	RegressionCompetitionScore: 0.12415856394913986

Metric val_loss improved by 0.039 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5806210041046143
	RegressionCompetitionScore: 0.11742707554225879

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6177550554275513
	RegressionCompetitionScore: 0.11967090501121914



Validation scores:
	RegressionAUROC: 0.6637802124023438
	RegressionCompetitionScore: 0.13986537023186238



Validation scores:
	RegressionAUROC: 0.6844893097877502
	RegressionCompetitionScore: 0.16978309648466716

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6938942074775696
	RegressionCompetitionScore: 0.1944652206432311



Validation scores:
	RegressionAUROC: 0.7017132639884949
	RegressionCompetitionScore: 0.20418848167539266

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.7096570730209351
	RegressionCompetitionScore: 0.23859386686611816

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.7112773656845093
	RegressionCompetitionScore: 0.2393418100224383

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.7121632099151611
	RegressionCompetitionScore: 0.2243829468960359

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.7100769281387329
	RegressionCompetitionScore: 0.19147344801795063



Validation scores:
	RegressionAUROC: 0.7065030336380005
	RegressionCompetitionScore: 0.17651458489154825



Validation scores:
	RegressionAUROC: 0.6981813907623291
	RegressionCompetitionScore: 0.1682872101720269



Validation scores:
	RegressionAUROC: 0.6968492865562439
	RegressionCompetitionScore: 0.175018698578908



Validation scores:
	RegressionAUROC: 0.6841049194335938
	RegressionCompetitionScore: 0.17801047120418848



Validation scores:
	RegressionAUROC: 0.6695018410682678
	RegressionCompetitionScore: 0.16454749439042632



Validation scores:
	RegressionAUROC: 0.6593524813652039
	RegressionCompetitionScore: 0.16529543754674644

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.198. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2243829468960359
     Test RegressionAUROC            0.7121632099151611
Test RegressionCompetitionScore      0.2243829468960359
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 20:45:40,313][0m Trial 39 finished with value: 0.2243829468960359 and parameters: {'lr': 1.0603903583948393e-05, 'dropout': 0.6107261549033309, 'd_model_multiplier': 32, 'num_layers': 13, 'n_heads': 4, 'dim_feedforward': 892, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 2.450512366688861e-07, 'dropout': 0.421956477049807, 'd_model_multiplier': 4, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 735, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 358 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
344 K     Trainable params
14.4 K    Non-trainable params
358 K     Total params
1.434     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.46688953042030334
	RegressionCompetitionScore: 0.09420916162489196

Metric val_loss improved. New best score: 0.506


Validation scores:
	RegressionAUROC: 0.47724053263664246
	RegressionCompetitionScore: 0.10198789974070872

Metric val_loss improved by 0.053 >= min_delta = 0.0. New best score: 0.453


Validation scores:
	RegressionAUROC: 0.5195468664169312
	RegressionCompetitionScore: 0.15038893690579083

Metric val_loss improved by 0.060 >= min_delta = 0.0. New best score: 0.392


Validation scores:
	RegressionAUROC: 0.5356760621070862
	RegressionCompetitionScore: 0.2031114952463267

Metric val_loss improved by 0.062 >= min_delta = 0.0. New best score: 0.330


Validation scores:
	RegressionAUROC: 0.5304415225982666
	RegressionCompetitionScore: 0.2031114952463267



Validation scores:
	RegressionAUROC: 0.5742512941360474
	RegressionCompetitionScore: 0.219533275713051

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.323


Validation scores:
	RegressionAUROC: 0.5215497016906738
	RegressionCompetitionScore: 0.16421780466724287

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.312


Validation scores:
	RegressionAUROC: 0.5656507611274719
	RegressionCompetitionScore: 0.22039757994814174



Validation scores:
	RegressionAUROC: 0.5530898571014404
	RegressionCompetitionScore: 0.1979256698357822



Validation scores:
	RegressionAUROC: 0.5421926975250244
	RegressionCompetitionScore: 0.18409680207433016



Validation scores:
	RegressionAUROC: 0.49206963181495667
	RegressionCompetitionScore: 0.14001728608470182



Validation scores:
	RegressionAUROC: 0.6016610860824585
	RegressionCompetitionScore: 0.1979256698357822

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.306


Validation scores:
	RegressionAUROC: 0.5805063247680664
	RegressionCompetitionScore: 0.22558340535868626



Validation scores:
	RegressionAUROC: 0.5885828733444214
	RegressionCompetitionScore: 0.22731201382886776



Validation scores:
	RegressionAUROC: 0.5878859758377075
	RegressionCompetitionScore: 0.226447709593777



Validation scores:
	RegressionAUROC: 0.6135878562927246
	RegressionCompetitionScore: 0.20916162489196197



Validation scores:
	RegressionAUROC: 0.5593552589416504
	RegressionCompetitionScore: 0.20138288677614521



Validation scores:
	RegressionAUROC: 0.6019891500473022
	RegressionCompetitionScore: 0.22558340535868626



Validation scores:
	RegressionAUROC: 0.5868427753448486
	RegressionCompetitionScore: 0.23595505617977527

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.306. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1979256698357822
     Test RegressionAUROC            0.6016610860824585
Test RegressionCompetitionScore      0.1979256698357822
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 20:53:41,652][0m Trial 40 finished with value: 0.1979256698357822 and parameters: {'lr': 2.450512366688861e-07, 'dropout': 0.421956477049807, 'd_model_multiplier': 4, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 735, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 4.5554770067771226e-05, 'dropout': 0.46930203004433163, 'd_model_multiplier': 8, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 667, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.5 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.5 M     Trainable params
0         Non-trainable params
3.5 M     Total params
13.869    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4736841917037964
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6229110360145569
	RegressionCompetitionScore: 0.0994052676295667

Metric val_loss improved. New best score: 0.254


Validation scores:
	RegressionAUROC: 0.6128784418106079
	RegressionCompetitionScore: 0.22259983007646558

Metric val_loss improved by 0.051 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6248252391815186
	RegressionCompetitionScore: 0.24553950722175022

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6391390562057495
	RegressionCompetitionScore: 0.24808836023789294



Validation scores:
	RegressionAUROC: 0.6712707877159119
	RegressionCompetitionScore: 0.26677994902293967



Validation scores:
	RegressionAUROC: 0.6525200605392456
	RegressionCompetitionScore: 0.23704333050127444



Validation scores:
	RegressionAUROC: 0.6720946431159973
	RegressionCompetitionScore: 0.2965165675446049



Validation scores:
	RegressionAUROC: 0.6471518874168396
	RegressionCompetitionScore: 0.308411214953271



Validation scores:
	RegressionAUROC: 0.6492449045181274
	RegressionCompetitionScore: 0.3288020390824129



Validation scores:
	RegressionAUROC: 0.6973515748977661
	RegressionCompetitionScore: 0.286321155480034

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.197. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.24553950722175022
     Test RegressionAUROC            0.6248252391815186
Test RegressionCompetitionScore      0.24553950722175022
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 20:58:54,485][0m Trial 41 finished with value: 0.24553950722175022 and parameters: {'lr': 4.5554770067771226e-05, 'dropout': 0.46930203004433163, 'd_model_multiplier': 8, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 667, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 2.174486679051061e-06, 'dropout': 0.43512125102485993, 'd_model_multiplier': 8, 'num_layers': 7, 'n_heads': 16, 'dim_feedforward': 791, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
2.0 M     Trainable params
0         Non-trainable params
2.0 M     Total params
8.095     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5507246255874634
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5633598566055298
	RegressionCompetitionScore: 0.24015151515151514

Metric val_loss improved. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5725398063659668
	RegressionCompetitionScore: 0.24393939393939393



Validation scores:
	RegressionAUROC: 0.605061411857605
	RegressionCompetitionScore: 0.278030303030303

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6243762373924255
	RegressionCompetitionScore: 0.28106060606060607

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.638514518737793
	RegressionCompetitionScore: 0.2825757575757576

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6517316102981567
	RegressionCompetitionScore: 0.2765151515151515



Validation scores:
	RegressionAUROC: 0.6554172039031982
	RegressionCompetitionScore: 0.27575757575757576



Validation scores:
	RegressionAUROC: 0.6523984670639038
	RegressionCompetitionScore: 0.22121212121212122



Validation scores:
	RegressionAUROC: 0.6534759998321533
	RegressionCompetitionScore: 0.20075757575757575



Validation scores:
	RegressionAUROC: 0.6563533544540405
	RegressionCompetitionScore: 0.2015151515151515



Validation scores:
	RegressionAUROC: 0.6601816415786743
	RegressionCompetitionScore: 0.20833333333333334

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6692342758178711
	RegressionCompetitionScore: 0.22803030303030303

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6789395809173584
	RegressionCompetitionScore: 0.2196969696969697



Validation scores:
	RegressionAUROC: 0.6876653432846069
	RegressionCompetitionScore: 0.2265151515151515



Validation scores:
	RegressionAUROC: 0.6939526200294495
	RegressionCompetitionScore: 0.24166666666666667



Validation scores:
	RegressionAUROC: 0.6939632892608643
	RegressionCompetitionScore: 0.2318181818181818



Validation scores:
	RegressionAUROC: 0.6968328952789307
	RegressionCompetitionScore: 0.24848484848484848



Validation scores:
	RegressionAUROC: 0.6994596719741821
	RegressionCompetitionScore: 0.21818181818181817



Validation scores:
	RegressionAUROC: 0.6982990503311157
	RegressionCompetitionScore: 0.23636363636363636

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.193. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.22803030303030303
     Test RegressionAUROC            0.6692342758178711
Test RegressionCompetitionScore      0.22803030303030303
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 21:05:11,856][0m Trial 42 finished with value: 0.22803030303030303 and parameters: {'lr': 2.174486679051061e-06, 'dropout': 0.43512125102485993, 'd_model_multiplier': 8, 'num_layers': 7, 'n_heads': 16, 'dim_feedforward': 791, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 6.410427372113911e-06, 'dropout': 0.4021288963807005, 'd_model_multiplier': 8, 'num_layers': 4, 'n_heads': 64, 'dim_feedforward': 1009, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 8.8 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
8.8 M     Trainable params
0         Non-trainable params
8.8 M     Total params
35.346    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.49392712116241455
	RegressionCompetitionScore: 0.05263157894736842



Validation scores:
	RegressionAUROC: 0.5536898970603943
	RegressionCompetitionScore: 0.20491803278688525

Metric val_loss improved. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.5944791436195374
	RegressionCompetitionScore: 0.21385991058122206

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6218916177749634
	RegressionCompetitionScore: 0.2399403874813711

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6328372955322266
	RegressionCompetitionScore: 0.2578241430700447



Validation scores:
	RegressionAUROC: 0.6376502513885498
	RegressionCompetitionScore: 0.27645305514157975

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6513427495956421
	RegressionCompetitionScore: 0.29582712369597614

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6298232078552246
	RegressionCompetitionScore: 0.2697466467958271



Validation scores:
	RegressionAUROC: 0.6484469771385193
	RegressionCompetitionScore: 0.2995529061102832



Validation scores:
	RegressionAUROC: 0.653761088848114
	RegressionCompetitionScore: 0.31296572280178836



Validation scores:
	RegressionAUROC: 0.6474850177764893
	RegressionCompetitionScore: 0.30849478390462



Validation scores:
	RegressionAUROC: 0.6443477869033813
	RegressionCompetitionScore: 0.28688524590163933



Validation scores:
	RegressionAUROC: 0.6469926834106445
	RegressionCompetitionScore: 0.2995529061102832



Validation scores:
	RegressionAUROC: 0.645086944103241
	RegressionCompetitionScore: 0.28315946348733234

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.189. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.29582712369597614
     Test RegressionAUROC            0.6513427495956421
Test RegressionCompetitionScore      0.29582712369597614
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 21:12:44,667][0m Trial 43 finished with value: 0.29582712369597614 and parameters: {'lr': 6.410427372113911e-06, 'dropout': 0.4021288963807005, 'd_model_multiplier': 8, 'num_layers': 4, 'n_heads': 64, 'dim_feedforward': 1009, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.0251286771847895e-07, 'dropout': 0.4620873269146219, 'd_model_multiplier': 8, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 123, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.6 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.6 M     Trainable params
0         Non-trainable params
1.6 M     Total params
6.433     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.34008097648620605
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.31134170293807983
	RegressionCompetitionScore: 0.061611374407582936

Metric val_loss improved. New best score: 0.256


Validation scores:
	RegressionAUROC: 0.3078421950340271
	RegressionCompetitionScore: 0.05687203791469194

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.231


Validation scores:
	RegressionAUROC: 0.30511343479156494
	RegressionCompetitionScore: 0.053712480252764615



Validation scores:
	RegressionAUROC: 0.30584096908569336
	RegressionCompetitionScore: 0.05292259083728278



Validation scores:
	RegressionAUROC: 0.30687007308006287
	RegressionCompetitionScore: 0.053712480252764615



Validation scores:
	RegressionAUROC: 0.30816200375556946
	RegressionCompetitionScore: 0.05608214849921011

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.30810844898223877
	RegressionCompetitionScore: 0.05608214849921011

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.30909237265586853
	RegressionCompetitionScore: 0.05608214849921011

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.31081655621528625
	RegressionCompetitionScore: 0.05845181674565561

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.31237179040908813
	RegressionCompetitionScore: 0.060821484992101105



Validation scores:
	RegressionAUROC: 0.3070400357246399
	RegressionCompetitionScore: 0.053712480252764615



Validation scores:
	RegressionAUROC: 0.30553197860717773
	RegressionCompetitionScore: 0.054502369668246446



Validation scores:
	RegressionAUROC: 0.30716824531555176
	RegressionCompetitionScore: 0.05529225908372828



Validation scores:
	RegressionAUROC: 0.3088742792606354
	RegressionCompetitionScore: 0.05608214849921011



Validation scores:
	RegressionAUROC: 0.31182700395584106
	RegressionCompetitionScore: 0.05924170616113744

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.313616544008255
	RegressionCompetitionScore: 0.0631911532385466

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.3158133029937744
	RegressionCompetitionScore: 0.0679304897314376

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.3172300159931183
	RegressionCompetitionScore: 0.0703001579778831

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.3189699351787567
	RegressionCompetitionScore: 0.07187993680884676

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.32149332761764526
	RegressionCompetitionScore: 0.07345971563981042



Validation scores:
	RegressionAUROC: 0.32010364532470703
	RegressionCompetitionScore: 0.07109004739336493



Validation scores:
	RegressionAUROC: 0.32332563400268555
	RegressionCompetitionScore: 0.0750394944707741



Validation scores:
	RegressionAUROC: 0.32468974590301514
	RegressionCompetitionScore: 0.0750394944707741



Validation scores:
	RegressionAUROC: 0.3271920680999756
	RegressionCompetitionScore: 0.07661927330173776



Validation scores:
	RegressionAUROC: 0.3301074504852295
	RegressionCompetitionScore: 0.07819905213270142

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.332256555557251
	RegressionCompetitionScore: 0.07819905213270142

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.3348138928413391
	RegressionCompetitionScore: 0.08293838862559241

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.3370145559310913
	RegressionCompetitionScore: 0.08451816745655608

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.3398956060409546
	RegressionCompetitionScore: 0.08846761453396525



Validation scores:
	RegressionAUROC: 0.34273290634155273
	RegressionCompetitionScore: 0.09004739336492891



Validation scores:
	RegressionAUROC: 0.3420702815055847
	RegressionCompetitionScore: 0.08846761453396525

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.3432084321975708
	RegressionCompetitionScore: 0.09162717219589257



Validation scores:
	RegressionAUROC: 0.34564489126205444
	RegressionCompetitionScore: 0.09399684044233807



Validation scores:
	RegressionAUROC: 0.3474275469779968
	RegressionCompetitionScore: 0.09636650868878358

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.3495604395866394
	RegressionCompetitionScore: 0.0971563981042654

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.3530815541744232
	RegressionCompetitionScore: 0.10110584518167456

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.3554551601409912
	RegressionCompetitionScore: 0.10110584518167456

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.3580173850059509
	RegressionCompetitionScore: 0.10347551342812006



Validation scores:
	RegressionAUROC: 0.3591437339782715
	RegressionCompetitionScore: 0.10110584518167456



Validation scores:
	RegressionAUROC: 0.36125946044921875
	RegressionCompetitionScore: 0.1018957345971564



Validation scores:
	RegressionAUROC: 0.3613527715206146
	RegressionCompetitionScore: 0.10268562401263823

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.36260443925857544
	RegressionCompetitionScore: 0.10347551342812006



Validation scores:
	RegressionAUROC: 0.3641616106033325
	RegressionCompetitionScore: 0.10347551342812006



Validation scores:
	RegressionAUROC: 0.3683512806892395
	RegressionCompetitionScore: 0.10426540284360189



Validation scores:
	RegressionAUROC: 0.37179723381996155
	RegressionCompetitionScore: 0.10505529225908374

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.3753531873226166
	RegressionCompetitionScore: 0.11295418641390205

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.37942200899124146
	RegressionCompetitionScore: 0.11295418641390205

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.3839820623397827
	RegressionCompetitionScore: 0.11532385466034756



Validation scores:
	RegressionAUROC: 0.38736218214035034
	RegressionCompetitionScore: 0.11611374407582939



Validation scores:
	RegressionAUROC: 0.3903080224990845
	RegressionCompetitionScore: 0.11690363349131122

`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.11295418641390205
     Test RegressionAUROC            0.37942200899124146
Test RegressionCompetitionScore      0.11295418641390205
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 21:38:03,677][0m Trial 44 finished with value: 0.11295418641390205 and parameters: {'lr': 1.0251286771847895e-07, 'dropout': 0.4620873269146219, 'd_model_multiplier': 8, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 123, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.6678409404406432e-05, 'dropout': 0.6682499007271572, 'd_model_multiplier': 64, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 915, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 73.9 M
1 | loss_fn | MSELoss | 0     
------------------------------------
73.9 M    Trainable params
0         Non-trainable params
73.9 M    Total params
295.590   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4375
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49466007947921753
	RegressionCompetitionScore: 0.06064782908339077

Metric val_loss improved. New best score: 0.279


Validation scores:
	RegressionAUROC: 0.5528465509414673
	RegressionCompetitionScore: 0.1536871123363198

Metric val_loss improved by 0.085 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.5862951874732971
	RegressionCompetitionScore: 0.2439696760854583



Validation scores:
	RegressionAUROC: 0.6182888746261597
	RegressionCompetitionScore: 0.3094417643004824



Validation scores:
	RegressionAUROC: 0.6427844762802124
	RegressionCompetitionScore: 0.33218470020675395



Validation scores:
	RegressionAUROC: 0.6439757347106934
	RegressionCompetitionScore: 0.321157822191592



Validation scores:
	RegressionAUROC: 0.6798413395881653
	RegressionCompetitionScore: 0.3439007580978635



Validation scores:
	RegressionAUROC: 0.6504473686218262
	RegressionCompetitionScore: 0.36871123363197794



Validation scores:
	RegressionAUROC: 0.6514133810997009
	RegressionCompetitionScore: 0.3459682977257064

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.194. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1536871123363198
     Test RegressionAUROC            0.5528465509414673
Test RegressionCompetitionScore      0.1536871123363198
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 21:49:55,533][0m Trial 45 finished with value: 0.1536871123363198 and parameters: {'lr': 1.6678409404406432e-05, 'dropout': 0.6682499007271572, 'd_model_multiplier': 64, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 915, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 8.645414478345093e-07, 'dropout': 0.7150519619551361, 'd_model_multiplier': 32, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 579, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 7.6 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
7.6 M     Trainable params
0         Non-trainable params
7.6 M     Total params
30.203    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4736842215061188
	RegressionCompetitionScore: 0.05263157894736842



Validation scores:
	RegressionAUROC: 0.5628924369812012
	RegressionCompetitionScore: 0.07265774378585087

Metric val_loss improved. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.5654054880142212
	RegressionCompetitionScore: 0.07361376673040153

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.5683258771896362
	RegressionCompetitionScore: 0.07648183556405354



Validation scores:
	RegressionAUROC: 0.5674614906311035
	RegressionCompetitionScore: 0.07648183556405354

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.5681275129318237
	RegressionCompetitionScore: 0.07648183556405354

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.5685176253318787
	RegressionCompetitionScore: 0.0745697896749522

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.57081139087677
	RegressionCompetitionScore: 0.07552581261950286



Validation scores:
	RegressionAUROC: 0.5716041922569275
	RegressionCompetitionScore: 0.07552581261950286



Validation scores:
	RegressionAUROC: 0.5689860582351685
	RegressionCompetitionScore: 0.07743785850860421



Validation scores:
	RegressionAUROC: 0.5668714046478271
	RegressionCompetitionScore: 0.07552581261950286



Validation scores:
	RegressionAUROC: 0.5676637887954712
	RegressionCompetitionScore: 0.07552581261950286



Validation scores:
	RegressionAUROC: 0.565202534198761
	RegressionCompetitionScore: 0.07743785850860421



Validation scores:
	RegressionAUROC: 0.5638940334320068
	RegressionCompetitionScore: 0.07839388145315487

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.203. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.0745697896749522
     Test RegressionAUROC            0.5685176253318787
Test RegressionCompetitionScore      0.0745697896749522
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 21:55:21,852][0m Trial 46 finished with value: 0.0745697896749522 and parameters: {'lr': 8.645414478345093e-07, 'dropout': 0.7150519619551361, 'd_model_multiplier': 32, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 579, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 4.629979364792692e-06, 'dropout': 0.4273456155984469, 'd_model_multiplier': 2, 'num_layers': 15, 'n_heads': 64, 'dim_feedforward': 858, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 4.4 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
4.4 M     Trainable params
0         Non-trainable params
4.4 M     Total params
17.767    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4739583432674408
	RegressionCompetitionScore: 0.125

[WARNING] OOM for trial with params {'lr': 4.629979364792692e-06, 'dropout': 0.4273456155984469, 'd_model_multiplier': 2, 'num_layers': 15, 'n_heads': 64, 'dim_feedforward': 858, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
[32m[I 2023-04-02 21:55:30,546][0m Trial 47 finished with value: 0.0 and parameters: {'lr': 4.629979364792692e-06, 'dropout': 0.4273456155984469, 'd_model_multiplier': 2, 'num_layers': 15, 'n_heads': 64, 'dim_feedforward': 858, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 2.5942941497805105e-06, 'dropout': 0.4866036305661785, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 8, 'dim_feedforward': 743, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 205 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
205 K     Trainable params
0         Non-trainable params
205 K     Total params
0.820     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5228940844535828
	RegressionCompetitionScore: 0.13804713804713806

Metric val_loss improved. New best score: 0.538


Validation scores:
	RegressionAUROC: 0.49717575311660767
	RegressionCompetitionScore: 0.11717171717171718

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.532


Validation scores:
	RegressionAUROC: 0.5139814019203186
	RegressionCompetitionScore: 0.1292929292929293

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.523


Validation scores:
	RegressionAUROC: 0.5313730239868164
	RegressionCompetitionScore: 0.12121212121212122



Validation scores:
	RegressionAUROC: 0.5361614227294922
	RegressionCompetitionScore: 0.12390572390572391

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.512


Validation scores:
	RegressionAUROC: 0.5073683857917786
	RegressionCompetitionScore: 0.10909090909090909



Validation scores:
	RegressionAUROC: 0.5359504222869873
	RegressionCompetitionScore: 0.11447811447811448



Validation scores:
	RegressionAUROC: 0.5326579809188843
	RegressionCompetitionScore: 0.12121212121212122

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.497


Validation scores:
	RegressionAUROC: 0.5370038151741028
	RegressionCompetitionScore: 0.12727272727272726



Validation scores:
	RegressionAUROC: 0.5091465711593628
	RegressionCompetitionScore: 0.12727272727272726



Validation scores:
	RegressionAUROC: 0.49554207921028137
	RegressionCompetitionScore: 0.12188552188552189

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.494


Validation scores:
	RegressionAUROC: 0.501775860786438
	RegressionCompetitionScore: 0.10235690235690235



Validation scores:
	RegressionAUROC: 0.49749618768692017
	RegressionCompetitionScore: 0.10101010101010101

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.488


Validation scores:
	RegressionAUROC: 0.524490237236023
	RegressionCompetitionScore: 0.11717171717171718



Validation scores:
	RegressionAUROC: 0.5211834907531738
	RegressionCompetitionScore: 0.11515151515151516

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.481


Validation scores:
	RegressionAUROC: 0.4930545389652252
	RegressionCompetitionScore: 0.1063973063973064

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.479


Validation scores:
	RegressionAUROC: 0.5219663381576538
	RegressionCompetitionScore: 0.10707070707070707

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.474


Validation scores:
	RegressionAUROC: 0.5168532133102417
	RegressionCompetitionScore: 0.10572390572390572

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.465


Validation scores:
	RegressionAUROC: 0.5244932770729065
	RegressionCompetitionScore: 0.10841750841750841



Validation scores:
	RegressionAUROC: 0.5020306706428528
	RegressionCompetitionScore: 0.10437710437710437



Validation scores:
	RegressionAUROC: 0.505165696144104
	RegressionCompetitionScore: 0.12188552188552189



Validation scores:
	RegressionAUROC: 0.48954373598098755
	RegressionCompetitionScore: 0.12390572390572391



Validation scores:
	RegressionAUROC: 0.49376702308654785
	RegressionCompetitionScore: 0.12053872053872054

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.461


Validation scores:
	RegressionAUROC: 0.5085079669952393
	RegressionCompetitionScore: 0.12121212121212122

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.456


Validation scores:
	RegressionAUROC: 0.5032753944396973
	RegressionCompetitionScore: 0.11313131313131314



Validation scores:
	RegressionAUROC: 0.4779111444950104
	RegressionCompetitionScore: 0.1286195286195286

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.450


Validation scores:
	RegressionAUROC: 0.5013622641563416
	RegressionCompetitionScore: 0.11313131313131314

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.441


Validation scores:
	RegressionAUROC: 0.4916083514690399
	RegressionCompetitionScore: 0.11784511784511785



Validation scores:
	RegressionAUROC: 0.4993922710418701
	RegressionCompetitionScore: 0.12188552188552189

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.430


Validation scores:
	RegressionAUROC: 0.5097557902336121
	RegressionCompetitionScore: 0.11245791245791245



Validation scores:
	RegressionAUROC: 0.48840951919555664
	RegressionCompetitionScore: 0.12121212121212122



Validation scores:
	RegressionAUROC: 0.4816705286502838
	RegressionCompetitionScore: 0.1191919191919192



Validation scores:
	RegressionAUROC: 0.500097393989563
	RegressionCompetitionScore: 0.11245791245791245



Validation scores:
	RegressionAUROC: 0.5078878998756409
	RegressionCompetitionScore: 0.1063973063973064



Validation scores:
	RegressionAUROC: 0.5014709234237671
	RegressionCompetitionScore: 0.10976430976430976

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.425


Validation scores:
	RegressionAUROC: 0.49466070532798767
	RegressionCompetitionScore: 0.13063973063973064

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.425


Validation scores:
	RegressionAUROC: 0.510085940361023
	RegressionCompetitionScore: 0.10707070707070707



Validation scores:
	RegressionAUROC: 0.5061293840408325
	RegressionCompetitionScore: 0.10707070707070707

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.414


Validation scores:
	RegressionAUROC: 0.5235995650291443
	RegressionCompetitionScore: 0.10976430976430976



Validation scores:
	RegressionAUROC: 0.5108575224876404
	RegressionCompetitionScore: 0.12121212121212122



Validation scores:
	RegressionAUROC: 0.5044262409210205
	RegressionCompetitionScore: 0.11043771043771043



Validation scores:
	RegressionAUROC: 0.4965645670890808
	RegressionCompetitionScore: 0.11515151515151516



Validation scores:
	RegressionAUROC: 0.5036596059799194
	RegressionCompetitionScore: 0.11245791245791245



Validation scores:
	RegressionAUROC: 0.5189955234527588
	RegressionCompetitionScore: 0.11245791245791245

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.412


Validation scores:
	RegressionAUROC: 0.5100399255752563
	RegressionCompetitionScore: 0.11380471380471381

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.403


Validation scores:
	RegressionAUROC: 0.49660012125968933
	RegressionCompetitionScore: 0.10033670033670034



Validation scores:
	RegressionAUROC: 0.5147552490234375
	RegressionCompetitionScore: 0.10976430976430976



Validation scores:
	RegressionAUROC: 0.5124436616897583
	RegressionCompetitionScore: 0.10505050505050505



Validation scores:
	RegressionAUROC: 0.5170735716819763
	RegressionCompetitionScore: 0.10976430976430976

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.401


Validation scores:
	RegressionAUROC: 0.5153803825378418
	RegressionCompetitionScore: 0.1063973063973064

`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10976430976430976
     Test RegressionAUROC            0.5170735716819763
Test RegressionCompetitionScore      0.10976430976430976
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 22:11:45,447][0m Trial 48 finished with value: 0.10976430976430976 and parameters: {'lr': 2.5942941497805105e-06, 'dropout': 0.4866036305661785, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 8, 'dim_feedforward': 743, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 3.613555364857203e-05, 'dropout': 0.40026558506831306, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 16, 'dim_feedforward': 406, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 5.5 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
5.5 M     Trainable params
0         Non-trainable params
5.5 M     Total params
21.806    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7115724086761475
	RegressionCompetitionScore: 0.26666666666666666

Metric val_loss improved. New best score: 0.261


Validation scores:
	RegressionAUROC: 0.736706018447876
	RegressionCompetitionScore: 0.24977777777777777

Metric val_loss improved by 0.034 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.7252041101455688
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7678024172782898
	RegressionCompetitionScore: 0.2702222222222222

Metric val_loss improved by 0.035 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7766393423080444
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7826991081237793
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7528960108757019
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7716949582099915
	RegressionCompetitionScore: 0.3893333333333333



Validation scores:
	RegressionAUROC: 0.7858932018280029
	RegressionCompetitionScore: 0.4782222222222222



Validation scores:
	RegressionAUROC: 0.7580925822257996
	RegressionCompetitionScore: 0.4391111111111111



Validation scores:
	RegressionAUROC: 0.7919360399246216
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.192. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2702222222222222
     Test RegressionAUROC            0.7678024172782898
Test RegressionCompetitionScore      0.2702222222222222
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 22:17:20,340][0m Trial 49 finished with value: 0.2702222222222222 and parameters: {'lr': 3.613555364857203e-05, 'dropout': 0.40026558506831306, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 16, 'dim_feedforward': 406, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.0881726225443412e-05, 'dropout': 0.4511862563313235, 'd_model_multiplier': 8, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 503, 'batch_size': 512, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.1 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.1 M     Trainable params
28.8 K    Non-trainable params
1.1 M     Total params
4.556     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7198067903518677
	RegressionCompetitionScore: 0.6521739130434783



Validation scores:
	RegressionAUROC: 0.5528752207756042
	RegressionCompetitionScore: 0.18583450210378682

Metric val_loss improved. New best score: 0.637


Validation scores:
	RegressionAUROC: 0.5439673662185669
	RegressionCompetitionScore: 0.18583450210378682

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.611


Validation scores:
	RegressionAUROC: 0.5389055013656616
	RegressionCompetitionScore: 0.1844319775596073

Metric val_loss improved by 0.040 >= min_delta = 0.0. New best score: 0.571


Validation scores:
	RegressionAUROC: 0.538048505783081
	RegressionCompetitionScore: 0.17251051893408134

Metric val_loss improved by 0.051 >= min_delta = 0.0. New best score: 0.520


Validation scores:
	RegressionAUROC: 0.537067174911499
	RegressionCompetitionScore: 0.17391304347826086

Metric val_loss improved by 0.057 >= min_delta = 0.0. New best score: 0.463


Validation scores:
	RegressionAUROC: 0.5367231965065002
	RegressionCompetitionScore: 0.1718092566619916

Metric val_loss improved by 0.044 >= min_delta = 0.0. New best score: 0.420


Validation scores:
	RegressionAUROC: 0.5365458726882935
	RegressionCompetitionScore: 0.1697054698457223

Metric val_loss improved by 0.056 >= min_delta = 0.0. New best score: 0.364


Validation scores:
	RegressionAUROC: 0.5363509654998779
	RegressionCompetitionScore: 0.16199158485273493

Metric val_loss improved by 0.051 >= min_delta = 0.0. New best score: 0.313


Validation scores:
	RegressionAUROC: 0.5361952781677246
	RegressionCompetitionScore: 0.15638148667601684

Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.270


Validation scores:
	RegressionAUROC: 0.5357291102409363
	RegressionCompetitionScore: 0.1570827489481066

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.233


Validation scores:
	RegressionAUROC: 0.535683274269104
	RegressionCompetitionScore: 0.15638148667601684

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.5354053974151611
	RegressionCompetitionScore: 0.15077138849929875

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.534894585609436
	RegressionCompetitionScore: 0.1458625525946704



Validation scores:
	RegressionAUROC: 0.5341651439666748
	RegressionCompetitionScore: 0.1458625525946704



Validation scores:
	RegressionAUROC: 0.5330449342727661
	RegressionCompetitionScore: 0.14516129032258066

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5318280458450317
	RegressionCompetitionScore: 0.1423562412342216

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.5300470590591431
	RegressionCompetitionScore: 0.14375876577840113



Validation scores:
	RegressionAUROC: 0.5284452438354492
	RegressionCompetitionScore: 0.1402524544179523



Validation scores:
	RegressionAUROC: 0.5268856287002563
	RegressionCompetitionScore: 0.1388499298737728



Validation scores:
	RegressionAUROC: 0.5259052515029907
	RegressionCompetitionScore: 0.1332398316970547



Validation scores:
	RegressionAUROC: 0.5265712141990662
	RegressionCompetitionScore: 0.13394109396914447



Validation scores:
	RegressionAUROC: 0.529262900352478
	RegressionCompetitionScore: 0.13113604488078542



Validation scores:
	RegressionAUROC: 0.5326933860778809
	RegressionCompetitionScore: 0.13464235624123422

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5373799204826355
	RegressionCompetitionScore: 0.1402524544179523

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.5419275760650635
	RegressionCompetitionScore: 0.14095371669004209

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.5433860421180725
	RegressionCompetitionScore: 0.14936886395511922



Validation scores:
	RegressionAUROC: 0.5436158180236816
	RegressionCompetitionScore: 0.16760168302945302



Validation scores:
	RegressionAUROC: 0.5425657033920288
	RegressionCompetitionScore: 0.18513323983169705



Validation scores:
	RegressionAUROC: 0.5397007465362549
	RegressionCompetitionScore: 0.20336605890603085



Validation scores:
	RegressionAUROC: 0.5362998247146606
	RegressionCompetitionScore: 0.1949509116409537



Validation scores:
	RegressionAUROC: 0.5352144241333008
	RegressionCompetitionScore: 0.19144460028050492



Validation scores:
	RegressionAUROC: 0.5344791412353516
	RegressionCompetitionScore: 0.182328190743338

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.206. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.14095371669004209
     Test RegressionAUROC            0.5419275760650635
Test RegressionCompetitionScore      0.14095371669004209
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 22:27:40,186][0m Trial 50 finished with value: 0.14095371669004209 and parameters: {'lr': 1.0881726225443412e-05, 'dropout': 0.4511862563313235, 'd_model_multiplier': 8, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 503, 'batch_size': 512, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.8473654646942159e-06, 'dropout': 0.42132351759550285, 'd_model_multiplier': 8, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 726, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 7.9 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
7.9 M     Trainable params
0         Non-trainable params
7.9 M     Total params
31.577    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6666666865348816
	RegressionCompetitionScore: 0.3333333333333333



Validation scores:
	RegressionAUROC: 0.6286224126815796
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.628


Validation scores:
	RegressionAUROC: 0.6321777105331421
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.027 >= min_delta = 0.0. New best score: 0.601


Validation scores:
	RegressionAUROC: 0.6599347591400146
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.635572612285614
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6425145864486694
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6510747075080872
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6450816988945007
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6318607330322266
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6730417609214783
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.116 >= min_delta = 0.0. New best score: 0.485


Validation scores:
	RegressionAUROC: 0.6721705198287964
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6427711248397827
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.055 >= min_delta = 0.0. New best score: 0.430


Validation scores:
	RegressionAUROC: 0.6221820116043091
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.054 >= min_delta = 0.0. New best score: 0.376


Validation scores:
	RegressionAUROC: 0.6373923420906067
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6570277214050293
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6597819924354553
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6599321365356445
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6607731580734253
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6605071425437927
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6702591776847839
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.376. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC            0.6221820116043091
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 22:46:27,265][0m Trial 51 finished with value: 0.0 and parameters: {'lr': 1.8473654646942159e-06, 'dropout': 0.42132351759550285, 'd_model_multiplier': 8, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 726, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 2.4564322596080703e-06, 'dropout': 0.4167971632712098, 'd_model_multiplier': 8, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 680, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 7.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.991    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5970361232757568
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.456


Validation scores:
	RegressionAUROC: 0.6355726718902588
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.066 >= min_delta = 0.0. New best score: 0.390


Validation scores:
	RegressionAUROC: 0.6212527751922607
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.368


Validation scores:
	RegressionAUROC: 0.698192298412323
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6237230896949768
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6015964150428772
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6627666354179382
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6206087470054626
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5601896047592163
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5773645043373108
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.368. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC            0.6212527751922607
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 22:55:11,474][0m Trial 52 finished with value: 0.0 and parameters: {'lr': 2.4564322596080703e-06, 'dropout': 0.4167971632712098, 'd_model_multiplier': 8, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 680, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 7.56302084273671e-07, 'dropout': 0.47055766727130777, 'd_model_multiplier': 8, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 616, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 8.4 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
8.4 M     Trainable params
0         Non-trainable params
8.4 M     Total params
33.512    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.375
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7189731001853943
	RegressionCompetitionScore: 0.0818661971830986

Metric val_loss improved. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.7393118143081665
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7523387670516968
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.754307746887207
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7442702054977417
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7449262142181396
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7727720141410828
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7654736042022705
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.235. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.0818661971830986
     Test RegressionAUROC            0.7189731001853943
Test RegressionCompetitionScore      0.0818661971830986
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-02 23:04:35,150][0m Trial 53 finished with value: 0.0818661971830986 and parameters: {'lr': 7.56302084273671e-07, 'dropout': 0.47055766727130777, 'd_model_multiplier': 8, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 616, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 1.2668490360685568e-06, 'dropout': 0.4481057859042171, 'd_model_multiplier': 64, 'num_layers': 15, 'n_heads': 32, 'dim_feedforward': 713, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 297 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
297 M     Trainable params
0         Non-trainable params
297 M     Total params
1,190.602 Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5121470093727112
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.516


Validation scores:
	RegressionAUROC: 0.5129852294921875
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.351 >= min_delta = 0.0. New best score: 1.165


Validation scores:
	RegressionAUROC: 0.5716940760612488
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.113 >= min_delta = 0.0. New best score: 1.052


Validation scores:
	RegressionAUROC: 0.6672132015228271
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6555036306381226
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.219 >= min_delta = 0.0. New best score: 0.832


Validation scores:
	RegressionAUROC: 0.6653308272361755
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7362185120582581
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.525 >= min_delta = 0.0. New best score: 0.307


Validation scores:
	RegressionAUROC: 0.6989989876747131
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7114592790603638
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.723473310470581
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6886512041091919
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6783765554428101
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7216916084289551
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7370280623435974
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.307. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC            0.7362185120582581
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 00:13:58,184][0m Trial 54 finished with value: 0.0 and parameters: {'lr': 1.2668490360685568e-06, 'dropout': 0.4481057859042171, 'd_model_multiplier': 64, 'num_layers': 15, 'n_heads': 32, 'dim_feedforward': 713, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 6.847471608662745e-06, 'dropout': 0.4157753663740406, 'd_model_multiplier': 32, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 814, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 77.3 M
1 | loss_fn | MSELoss | 0     
------------------------------------
77.3 M    Trainable params
0         Non-trainable params
77.3 M    Total params
309.142   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6508716344833374
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.357


Validation scores:
	RegressionAUROC: 0.6087977886199951
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.067 >= min_delta = 0.0. New best score: 0.289


Validation scores:
	RegressionAUROC: 0.6964246034622192
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.283


Validation scores:
	RegressionAUROC: 0.7198965549468994
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.262


Validation scores:
	RegressionAUROC: 0.6318598985671997
	RegressionCompetitionScore: 0.13022351797862003



Validation scores:
	RegressionAUROC: 0.6850258111953735
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.561109185218811
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7024650573730469
	RegressionCompetitionScore: 0.2886297376093295

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.239


Validation scores:
	RegressionAUROC: 0.7140474319458008
	RegressionCompetitionScore: 0.272108843537415

Metric val_loss improved by 0.039 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.5847052931785583
	RegressionCompetitionScore: 0.32847424684159376



Validation scores:
	RegressionAUROC: 0.605577290058136
	RegressionCompetitionScore: 0.1554907677356657



Validation scores:
	RegressionAUROC: 0.6937578320503235
	RegressionCompetitionScore: 0.2487852283770651



Validation scores:
	RegressionAUROC: 0.7205236554145813
	RegressionCompetitionScore: 0.10884353741496598

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.760244607925415
	RegressionCompetitionScore: 0.32458697764820216



Validation scores:
	RegressionAUROC: 0.6473621129989624
	RegressionCompetitionScore: 0.20602526724975703



Validation scores:
	RegressionAUROC: 0.7181856632232666
	RegressionCompetitionScore: 0.2400388726919339



Validation scores:
	RegressionAUROC: 0.771915853023529
	RegressionCompetitionScore: 0.40233236151603496



Validation scores:
	RegressionAUROC: 0.7195501327514648
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7155057191848755
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7628644704818726
	RegressionCompetitionScore: 0.31584062196307094

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.196. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10884353741496598
     Test RegressionAUROC            0.7205236554145813
Test RegressionCompetitionScore      0.10884353741496598
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 00:48:46,941][0m Trial 55 finished with value: 0.10884353741496598 and parameters: {'lr': 6.847471608662745e-06, 'dropout': 0.4157753663740406, 'd_model_multiplier': 32, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 814, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 4.112360115743904e-06, 'dropout': 0.4967776237788125, 'd_model_multiplier': 8, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 961, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.6 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.6 M     Trainable params
0         Non-trainable params
1.6 M     Total params
6.501     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.46484375
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4327869415283203
	RegressionCompetitionScore: 0.08882309400444116

Metric val_loss improved. New best score: 0.445


Validation scores:
	RegressionAUROC: 0.4322996735572815
	RegressionCompetitionScore: 0.09474463360473723

Metric val_loss improved by 0.053 >= min_delta = 0.0. New best score: 0.393


Validation scores:
	RegressionAUROC: 0.4406452178955078
	RegressionCompetitionScore: 0.0925240562546262

Metric val_loss improved by 0.063 >= min_delta = 0.0. New best score: 0.329


Validation scores:
	RegressionAUROC: 0.47792670130729675
	RegressionCompetitionScore: 0.08808290155440414

Metric val_loss improved by 0.058 >= min_delta = 0.0. New best score: 0.271


Validation scores:
	RegressionAUROC: 0.4724298119544983
	RegressionCompetitionScore: 0.10066617320503331

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.504785418510437
	RegressionCompetitionScore: 0.0925240562546262

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.5270439386367798
	RegressionCompetitionScore: 0.09844559585492228

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5350266695022583
	RegressionCompetitionScore: 0.09918578830495929

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5609400272369385
	RegressionCompetitionScore: 0.11398963730569948



Validation scores:
	RegressionAUROC: 0.573393702507019
	RegressionCompetitionScore: 0.11324944485566248

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.5838190317153931
	RegressionCompetitionScore: 0.13249444855662473

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.5753344297409058
	RegressionCompetitionScore: 0.15025906735751296



Validation scores:
	RegressionAUROC: 0.5970332622528076
	RegressionCompetitionScore: 0.153960029607698



Validation scores:
	RegressionAUROC: 0.5948090553283691
	RegressionCompetitionScore: 0.153219837157661



Validation scores:
	RegressionAUROC: 0.5884929895401001
	RegressionCompetitionScore: 0.15618060695780903



Validation scores:
	RegressionAUROC: 0.5910094380378723
	RegressionCompetitionScore: 0.17838638045891933



Validation scores:
	RegressionAUROC: 0.602314293384552
	RegressionCompetitionScore: 0.16432272390821615



Validation scores:
	RegressionAUROC: 0.5877295732498169
	RegressionCompetitionScore: 0.15840118430792005

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.200. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.13249444855662473
     Test RegressionAUROC            0.5838190317153931
Test RegressionCompetitionScore      0.13249444855662473
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 00:54:48,060][0m Trial 56 finished with value: 0.13249444855662473 and parameters: {'lr': 4.112360115743904e-06, 'dropout': 0.4967776237788125, 'd_model_multiplier': 8, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 961, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 11 with value: 0.42181340341655715.[0m
Starting trial with params:
{'lr': 3.845825494518156e-07, 'dropout': 0.5241791267144841, 'd_model_multiplier': 64, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 933, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 56.0 M
1 | loss_fn | MSELoss | 0     
------------------------------------
56.0 M    Trainable params
0         Non-trainable params
56.0 M    Total params
223.978   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5227272510528564
	RegressionCompetitionScore: 0.045454545454545456



Validation scores:
	RegressionAUROC: 0.37574416399002075
	RegressionCompetitionScore: 0.05

Metric val_loss improved. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.4824860692024231
	RegressionCompetitionScore: 0.05566037735849057

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.241


Validation scores:
	RegressionAUROC: 0.5936453938484192
	RegressionCompetitionScore: 0.08679245283018867

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.6936303377151489
	RegressionCompetitionScore: 0.12452830188679245



Validation scores:
	RegressionAUROC: 0.7314995527267456
	RegressionCompetitionScore: 0.1660377358490566

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.7767680287361145
	RegressionCompetitionScore: 0.35377358490566035

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.7847393751144409
	RegressionCompetitionScore: 0.37641509433962267

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.7856682538986206
	RegressionCompetitionScore: 0.3594339622641509

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.7865713834762573
	RegressionCompetitionScore: 0.3754716981132076



Validation scores:
	RegressionAUROC: 0.7713189721107483
	RegressionCompetitionScore: 0.2990566037735849



Validation scores:
	RegressionAUROC: 0.7850356101989746
	RegressionCompetitionScore: 0.3754716981132076



Validation scores:
	RegressionAUROC: 0.8002851009368896
	RegressionCompetitionScore: 0.4867924528301887



Validation scores:
	RegressionAUROC: 0.8049768209457397
	RegressionCompetitionScore: 0.5179245283018868



Validation scores:
	RegressionAUROC: 0.8069111108779907
	RegressionCompetitionScore: 0.5235849056603774

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.8041002750396729
	RegressionCompetitionScore: 0.519811320754717

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.8041051626205444
	RegressionCompetitionScore: 0.5311320754716982



Validation scores:
	RegressionAUROC: 0.8055624961853027
	RegressionCompetitionScore: 0.5330188679245284

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.8045337200164795
	RegressionCompetitionScore: 0.5311320754716982



Validation scores:
	RegressionAUROC: 0.8028039932250977
	RegressionCompetitionScore: 0.519811320754717

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7962220907211304
	RegressionCompetitionScore: 0.47830188679245284



Validation scores:
	RegressionAUROC: 0.7976192235946655
	RegressionCompetitionScore: 0.4858490566037736



Validation scores:
	RegressionAUROC: 0.8003180027008057
	RegressionCompetitionScore: 0.5216981132075472



Validation scores:
	RegressionAUROC: 0.8015987873077393
	RegressionCompetitionScore: 0.5283018867924528

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.801114022731781
	RegressionCompetitionScore: 0.5320754716981132



Validation scores:
	RegressionAUROC: 0.799994170665741
	RegressionCompetitionScore: 0.5311320754716982



Validation scores:
	RegressionAUROC: 0.7982678413391113
	RegressionCompetitionScore: 0.529245283018868



Validation scores:
	RegressionAUROC: 0.7996324896812439
	RegressionCompetitionScore: 0.5283018867924528



Validation scores:
	RegressionAUROC: 0.8005458116531372
	RegressionCompetitionScore: 0.5273584905660378

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7998875379562378
	RegressionCompetitionScore: 0.5235849056603774



Validation scores:
	RegressionAUROC: 0.7982508540153503
	RegressionCompetitionScore: 0.5207547169811321

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7959724068641663
	RegressionCompetitionScore: 0.5235849056603774



Validation scores:
	RegressionAUROC: 0.7949310541152954
	RegressionCompetitionScore: 0.5254716981132076



Validation scores:
	RegressionAUROC: 0.7948006391525269
	RegressionCompetitionScore: 0.5273584905660378



Validation scores:
	RegressionAUROC: 0.7924430966377258
	RegressionCompetitionScore: 0.5490566037735849



Validation scores:
	RegressionAUROC: 0.7935271263122559
	RegressionCompetitionScore: 0.5386792452830189



Validation scores:
	RegressionAUROC: 0.7943488359451294
	RegressionCompetitionScore: 0.529245283018868



Validation scores:
	RegressionAUROC: 0.7934330701828003
	RegressionCompetitionScore: 0.5349056603773585

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.167. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.5207547169811321
     Test RegressionAUROC            0.7982508540153503
Test RegressionCompetitionScore      0.5207547169811321
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 01:30:24,540][0m Trial 57 finished with value: 0.5207547169811321 and parameters: {'lr': 3.845825494518156e-07, 'dropout': 0.5241791267144841, 'd_model_multiplier': 64, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 933, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 5.129377839083664e-07, 'dropout': 0.5254849308536307, 'd_model_multiplier': 64, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 938, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 92.8 M
1 | loss_fn | MSELoss | 0     
------------------------------------
92.8 M    Trainable params
0         Non-trainable params
92.8 M    Total params
371.358   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6041666865348816
	RegressionCompetitionScore: 0.20833333333333334



Validation scores:
	RegressionAUROC: 0.6010228395462036
	RegressionCompetitionScore: 0.263705759888966

Metric val_loss improved. New best score: 0.266


Validation scores:
	RegressionAUROC: 0.5998423099517822
	RegressionCompetitionScore: 0.260235947258848

Metric val_loss improved by 0.073 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6054947376251221
	RegressionCompetitionScore: 0.2595419847328244



Validation scores:
	RegressionAUROC: 0.6124025583267212
	RegressionCompetitionScore: 0.25537820957668284



Validation scores:
	RegressionAUROC: 0.621482253074646
	RegressionCompetitionScore: 0.2609299097848716



Validation scores:
	RegressionAUROC: 0.6309680938720703
	RegressionCompetitionScore: 0.28591256072172105



Validation scores:
	RegressionAUROC: 0.6401231288909912
	RegressionCompetitionScore: 0.30742539902845245



Validation scores:
	RegressionAUROC: 0.6524892449378967
	RegressionCompetitionScore: 0.2963219986120749



Validation scores:
	RegressionAUROC: 0.6595845818519592
	RegressionCompetitionScore: 0.2886884108258154

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.193. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.260235947258848
     Test RegressionAUROC            0.5998423099517822
Test RegressionCompetitionScore       0.260235947258848
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 01:45:11,065][0m Trial 58 finished with value: 0.260235947258848 and parameters: {'lr': 5.129377839083664e-07, 'dropout': 0.5254849308536307, 'd_model_multiplier': 64, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 938, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 4.201819534424041e-07, 'dropout': 0.4750505936661237, 'd_model_multiplier': 64, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 873, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 54.9 M
1 | loss_fn | MSELoss | 0     
------------------------------------
54.9 M    Trainable params
0         Non-trainable params
54.9 M    Total params
219.552   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4588235318660736
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6040594577789307
	RegressionCompetitionScore: 0.08617021276595745

Metric val_loss improved. New best score: 0.261


Validation scores:
	RegressionAUROC: 0.6303006410598755
	RegressionCompetitionScore: 0.06489361702127659



Validation scores:
	RegressionAUROC: 0.6614953279495239
	RegressionCompetitionScore: 0.07234042553191489

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.233


Validation scores:
	RegressionAUROC: 0.6780192255973816
	RegressionCompetitionScore: 0.08085106382978724

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.6729296445846558
	RegressionCompetitionScore: 0.08404255319148936

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.6759554743766785
	RegressionCompetitionScore: 0.0797872340425532

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6802704334259033
	RegressionCompetitionScore: 0.10212765957446808

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6803617477416992
	RegressionCompetitionScore: 0.11702127659574468

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6834145784378052
	RegressionCompetitionScore: 0.11808510638297873



Validation scores:
	RegressionAUROC: 0.685630202293396
	RegressionCompetitionScore: 0.11702127659574468



Validation scores:
	RegressionAUROC: 0.6748050451278687
	RegressionCompetitionScore: 0.11382978723404255

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6711744070053101
	RegressionCompetitionScore: 0.12127659574468085



Validation scores:
	RegressionAUROC: 0.671785831451416
	RegressionCompetitionScore: 0.11914893617021277



Validation scores:
	RegressionAUROC: 0.6684996485710144
	RegressionCompetitionScore: 0.1276595744680851



Validation scores:
	RegressionAUROC: 0.6632102727890015
	RegressionCompetitionScore: 0.1276595744680851



Validation scores:
	RegressionAUROC: 0.6631303429603577
	RegressionCompetitionScore: 0.125531914893617



Validation scores:
	RegressionAUROC: 0.6662939190864563
	RegressionCompetitionScore: 0.1202127659574468



Validation scores:
	RegressionAUROC: 0.6698762774467468
	RegressionCompetitionScore: 0.11914893617021277

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.11382978723404255
     Test RegressionAUROC            0.6748050451278687
Test RegressionCompetitionScore      0.11382978723404255
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 02:02:28,175][0m Trial 59 finished with value: 0.11382978723404255 and parameters: {'lr': 4.201819534424041e-07, 'dropout': 0.4750505936661237, 'd_model_multiplier': 64, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 873, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 1.2564214731836406e-06, 'dropout': 0.5090452739611646, 'd_model_multiplier': 64, 'num_layers': 3, 'n_heads': 16, 'dim_feedforward': 993, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 19.7 M
1 | loss_fn | MSELoss | 0     
------------------------------------
19.2 M    Trainable params
460 K     Non-trainable params
19.7 M    Total params
78.687    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6521738767623901
	RegressionCompetitionScore: 0.30434782608695654



Validation scores:
	RegressionAUROC: 0.5438926219940186
	RegressionCompetitionScore: 0.24936868686868688

Metric val_loss improved. New best score: 0.258


Validation scores:
	RegressionAUROC: 0.5797507762908936
	RegressionCompetitionScore: 0.2702020202020202

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.6207084059715271
	RegressionCompetitionScore: 0.3188131313131313



Validation scores:
	RegressionAUROC: 0.6500145196914673
	RegressionCompetitionScore: 0.36237373737373735



Validation scores:
	RegressionAUROC: 0.6499286890029907
	RegressionCompetitionScore: 0.3661616161616162



Validation scores:
	RegressionAUROC: 0.6697355508804321
	RegressionCompetitionScore: 0.3768939393939394



Validation scores:
	RegressionAUROC: 0.6764638423919678
	RegressionCompetitionScore: 0.3806818181818182



Validation scores:
	RegressionAUROC: 0.6801490187644958
	RegressionCompetitionScore: 0.37941919191919193



Validation scores:
	RegressionAUROC: 0.6812885999679565
	RegressionCompetitionScore: 0.380050505050505

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.234. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2702020202020202
     Test RegressionAUROC            0.5797507762908936
Test RegressionCompetitionScore      0.2702020202020202
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 02:06:12,814][0m Trial 60 finished with value: 0.2702020202020202 and parameters: {'lr': 1.2564214731836406e-06, 'dropout': 0.5090452739611646, 'd_model_multiplier': 64, 'num_layers': 3, 'n_heads': 16, 'dim_feedforward': 993, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 1.5619680010725477e-07, 'dropout': 0.4429436575952965, 'd_model_multiplier': 64, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 846, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 54.4 M
1 | loss_fn | MSELoss | 0     
------------------------------------
54.4 M    Trainable params
0         Non-trainable params
54.4 M    Total params
217.560   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4267244338989258
	RegressionCompetitionScore: 0.07720930232558139

Metric val_loss improved. New best score: 0.245


Validation scores:
	RegressionAUROC: 0.49892744421958923
	RegressionCompetitionScore: 0.09488372093023256

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.233


Validation scores:
	RegressionAUROC: 0.5712490081787109
	RegressionCompetitionScore: 0.12

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.6177480220794678
	RegressionCompetitionScore: 0.1572093023255814

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.6427044868469238
	RegressionCompetitionScore: 0.1841860465116279

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.6544540524482727
	RegressionCompetitionScore: 0.20372093023255813



Validation scores:
	RegressionAUROC: 0.6665690541267395
	RegressionCompetitionScore: 0.22232558139534883



Validation scores:
	RegressionAUROC: 0.6724324226379395
	RegressionCompetitionScore: 0.23255813953488372



Validation scores:
	RegressionAUROC: 0.678338885307312
	RegressionCompetitionScore: 0.25395348837209303



Validation scores:
	RegressionAUROC: 0.6835247278213501
	RegressionCompetitionScore: 0.2576744186046512



Validation scores:
	RegressionAUROC: 0.6934609413146973
	RegressionCompetitionScore: 0.28651162790697676



Validation scores:
	RegressionAUROC: 0.6962535381317139
	RegressionCompetitionScore: 0.30697674418604654

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.222. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1841860465116279
     Test RegressionAUROC            0.6427044868469238
Test RegressionCompetitionScore      0.1841860465116279
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 02:18:03,767][0m Trial 61 finished with value: 0.1841860465116279 and parameters: {'lr': 1.5619680010725477e-07, 'dropout': 0.4429436575952965, 'd_model_multiplier': 64, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 846, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 2.671131520842867e-07, 'dropout': 0.460477683188785, 'd_model_multiplier': 32, 'num_layers': 7, 'n_heads': 4, 'dim_feedforward': 214, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 985 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
985 K     Trainable params
0         Non-trainable params
985 K     Total params
3.943     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.222


Validation scores:
	RegressionAUROC: 0.503551721572876
	RegressionCompetitionScore: 0.018697225572979495

Metric val_loss improved by 0.392 >= min_delta = 0.0. New best score: 0.830


Validation scores:
	RegressionAUROC: 0.5585885047912598
	RegressionCompetitionScore: 0.18998793727382388

Metric val_loss improved by 0.296 >= min_delta = 0.0. New best score: 0.534


Validation scores:
	RegressionAUROC: 0.553787112236023
	RegressionCompetitionScore: 0.18395657418576597

Metric val_loss improved by 0.198 >= min_delta = 0.0. New best score: 0.335


Validation scores:
	RegressionAUROC: 0.5535277128219604
	RegressionCompetitionScore: 0.18455971049457176

Metric val_loss improved by 0.070 >= min_delta = 0.0. New best score: 0.265


Validation scores:
	RegressionAUROC: 0.5564200282096863
	RegressionCompetitionScore: 0.18697225572979492

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.258


Validation scores:
	RegressionAUROC: 0.5622183084487915
	RegressionCompetitionScore: 0.18938480096501809



Validation scores:
	RegressionAUROC: 0.5663164854049683
	RegressionCompetitionScore: 0.19360675512665862



Validation scores:
	RegressionAUROC: 0.5687035322189331
	RegressionCompetitionScore: 0.1948130277442702



Validation scores:
	RegressionAUROC: 0.5724080204963684
	RegressionCompetitionScore: 0.19963811821471653



Validation scores:
	RegressionAUROC: 0.5756089091300964
	RegressionCompetitionScore: 0.19662243667068757



Validation scores:
	RegressionAUROC: 0.5815985798835754
	RegressionCompetitionScore: 0.19843184559710494

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.5857551097869873
	RegressionCompetitionScore: 0.20024125452352232



Validation scores:
	RegressionAUROC: 0.5910836458206177
	RegressionCompetitionScore: 0.2014475271411339



Validation scores:
	RegressionAUROC: 0.5959741473197937
	RegressionCompetitionScore: 0.20446320868516285



Validation scores:
	RegressionAUROC: 0.6033127307891846
	RegressionCompetitionScore: 0.20627261761158022



Validation scores:
	RegressionAUROC: 0.6090302467346191
	RegressionCompetitionScore: 0.20868516284680338



Validation scores:
	RegressionAUROC: 0.6140151619911194
	RegressionCompetitionScore: 0.218335343787696



Validation scores:
	RegressionAUROC: 0.613496720790863
	RegressionCompetitionScore: 0.22135102533172496

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.238. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.19843184559710494
     Test RegressionAUROC            0.5815985798835754
Test RegressionCompetitionScore      0.19843184559710494
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 02:23:01,614][0m Trial 62 finished with value: 0.19843184559710494 and parameters: {'lr': 2.671131520842867e-07, 'dropout': 0.460477683188785, 'd_model_multiplier': 32, 'num_layers': 7, 'n_heads': 4, 'dim_feedforward': 214, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 7.655136550292108e-07, 'dropout': 0.4329370646982554, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 792, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 7.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.836    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4583333432674408
	RegressionCompetitionScore: 0.041666666666666664



Validation scores:
	RegressionAUROC: 0.5692909955978394
	RegressionCompetitionScore: 0.194150591163659

Metric val_loss improved. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.632490336894989
	RegressionCompetitionScore: 0.20784069695084006

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.661585807800293
	RegressionCompetitionScore: 0.2725575606720597

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7207040786743164
	RegressionCompetitionScore: 0.3148724331051649



Validation scores:
	RegressionAUROC: 0.7339626550674438
	RegressionCompetitionScore: 0.3273179838207841

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.745296835899353
	RegressionCompetitionScore: 0.39079029247044184

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7412170171737671
	RegressionCompetitionScore: 0.4225264467952707



Validation scores:
	RegressionAUROC: 0.7571696639060974
	RegressionCompetitionScore: 0.45737398879900437



Validation scores:
	RegressionAUROC: 0.7663578987121582
	RegressionCompetitionScore: 0.4337274424393279



Validation scores:
	RegressionAUROC: 0.764833390712738
	RegressionCompetitionScore: 0.4355942750466708



Validation scores:
	RegressionAUROC: 0.7607697248458862
	RegressionCompetitionScore: 0.44679527069072805

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.147


Validation scores:
	RegressionAUROC: 0.7595416307449341
	RegressionCompetitionScore: 0.4505289359054138

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.141


Validation scores:
	RegressionAUROC: 0.7583504915237427
	RegressionCompetitionScore: 0.4418170504044804



Validation scores:
	RegressionAUROC: 0.7611469030380249
	RegressionCompetitionScore: 0.4355942750466708



Validation scores:
	RegressionAUROC: 0.7635180354118347
	RegressionCompetitionScore: 0.4206596141879278



Validation scores:
	RegressionAUROC: 0.7668286561965942
	RegressionCompetitionScore: 0.4169259489732421



Validation scores:
	RegressionAUROC: 0.7681024670600891
	RegressionCompetitionScore: 0.4405724953329185



Validation scores:
	RegressionAUROC: 0.7688602209091187
	RegressionCompetitionScore: 0.4579962663347853



Validation scores:
	RegressionAUROC: 0.7732247114181519
	RegressionCompetitionScore: 0.46795270690728064

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.141. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4505289359054138
     Test RegressionAUROC            0.7595416307449341
Test RegressionCompetitionScore      0.4505289359054138
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 02:31:47,237][0m Trial 63 finished with value: 0.4505289359054138 and parameters: {'lr': 7.655136550292108e-07, 'dropout': 0.4329370646982554, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 792, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 8.172690078504221e-07, 'dropout': 0.4786666136220682, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 796, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 7.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
7.0 M     Trainable params
0         Non-trainable params
7.0 M     Total params
27.918    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.37142854928970337
	RegressionCompetitionScore: 0.32



Validation scores:
	RegressionAUROC: 0.4253101646900177
	RegressionCompetitionScore: 0.09930313588850175

Metric val_loss improved. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.4757307171821594
	RegressionCompetitionScore: 0.09988385598141696

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.5343965888023376
	RegressionCompetitionScore: 0.11033681765389082

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.579370379447937
	RegressionCompetitionScore: 0.1445993031358885

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.6079729795455933
	RegressionCompetitionScore: 0.15563298490127758



Validation scores:
	RegressionAUROC: 0.6244670152664185
	RegressionCompetitionScore: 0.19396051103368175



Validation scores:
	RegressionAUROC: 0.6337599754333496
	RegressionCompetitionScore: 0.1957026713124274



Validation scores:
	RegressionAUROC: 0.6312398910522461
	RegressionCompetitionScore: 0.1835075493612079



Validation scores:
	RegressionAUROC: 0.6419771313667297
	RegressionCompetitionScore: 0.20209059233449478



Validation scores:
	RegressionAUROC: 0.6371529698371887
	RegressionCompetitionScore: 0.19686411149825783



Validation scores:
	RegressionAUROC: 0.6522573828697205
	RegressionCompetitionScore: 0.24332171893147503

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.152


Validation scores:
	RegressionAUROC: 0.6694478988647461
	RegressionCompetitionScore: 0.3240418118466899



Validation scores:
	RegressionAUROC: 0.6767328381538391
	RegressionCompetitionScore: 0.38559814169570267



Validation scores:
	RegressionAUROC: 0.6815470457077026
	RegressionCompetitionScore: 0.39605110336817656



Validation scores:
	RegressionAUROC: 0.681983232498169
	RegressionCompetitionScore: 0.37398373983739835



Validation scores:
	RegressionAUROC: 0.6809616088867188
	RegressionCompetitionScore: 0.33914053426248547



Validation scores:
	RegressionAUROC: 0.6885213255882263
	RegressionCompetitionScore: 0.3821138211382114



Validation scores:
	RegressionAUROC: 0.6915359497070312
	RegressionCompetitionScore: 0.3629500580720093

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.152. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.24332171893147503
     Test RegressionAUROC            0.6522573828697205
Test RegressionCompetitionScore      0.24332171893147503
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 02:40:10,084][0m Trial 64 finished with value: 0.24332171893147503 and parameters: {'lr': 8.172690078504221e-07, 'dropout': 0.4786666136220682, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 796, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 6.261187118527552e-07, 'dropout': 0.437862190471796, 'd_model_multiplier': 16, 'num_layers': 8, 'n_heads': 16, 'dim_feedforward': 919, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 6.1 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
6.1 M     Trainable params
0         Non-trainable params
6.1 M     Total params
24.555    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4736841917037964
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.33654850721359253
	RegressionCompetitionScore: 0.024193548387096774

Metric val_loss improved. New best score: 0.285


Validation scores:
	RegressionAUROC: 0.3606971502304077
	RegressionCompetitionScore: 0.0467741935483871

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.270


Validation scores:
	RegressionAUROC: 0.3907020688056946
	RegressionCompetitionScore: 0.06612903225806452

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.262


Validation scores:
	RegressionAUROC: 0.41451168060302734
	RegressionCompetitionScore: 0.0717741935483871

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.260


Validation scores:
	RegressionAUROC: 0.4309285879135132
	RegressionCompetitionScore: 0.07903225806451612

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.247


Validation scores:
	RegressionAUROC: 0.44454848766326904
	RegressionCompetitionScore: 0.07983870967741935



Validation scores:
	RegressionAUROC: 0.4595431089401245
	RegressionCompetitionScore: 0.0935483870967742

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.246


Validation scores:
	RegressionAUROC: 0.47327470779418945
	RegressionCompetitionScore: 0.10080645161290322

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.240


Validation scores:
	RegressionAUROC: 0.47970888018608093
	RegressionCompetitionScore: 0.10725806451612903



Validation scores:
	RegressionAUROC: 0.49343302845954895
	RegressionCompetitionScore: 0.10564516129032259

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.4941704571247101
	RegressionCompetitionScore: 0.1153225806451613



Validation scores:
	RegressionAUROC: 0.5025995969772339
	RegressionCompetitionScore: 0.10887096774193548



Validation scores:
	RegressionAUROC: 0.502636730670929
	RegressionCompetitionScore: 0.12016129032258065



Validation scores:
	RegressionAUROC: 0.5032476782798767
	RegressionCompetitionScore: 0.12661290322580646



Validation scores:
	RegressionAUROC: 0.512648344039917
	RegressionCompetitionScore: 0.12258064516129032



Validation scores:
	RegressionAUROC: 0.5165151953697205
	RegressionCompetitionScore: 0.11774193548387096



Validation scores:
	RegressionAUROC: 0.5161119699478149
	RegressionCompetitionScore: 0.12016129032258065

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.238. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10564516129032259
     Test RegressionAUROC            0.49343302845954895
Test RegressionCompetitionScore      0.10564516129032259
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 02:47:12,813][0m Trial 65 finished with value: 0.10564516129032259 and parameters: {'lr': 6.261187118527552e-07, 'dropout': 0.437862190471796, 'd_model_multiplier': 16, 'num_layers': 8, 'n_heads': 16, 'dim_feedforward': 919, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 3.1162236998243556e-07, 'dropout': 0.5024202361800292, 'd_model_multiplier': 16, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 975, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 11.0 M
1 | loss_fn | MSELoss | 0     
------------------------------------
11.0 M    Trainable params
0         Non-trainable params
11.0 M    Total params
43.825    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4941176772117615
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.45848479866981506
	RegressionCompetitionScore: 0.12104430379746836

Metric val_loss improved. New best score: 0.244


Validation scores:
	RegressionAUROC: 0.44788336753845215
	RegressionCompetitionScore: 0.10680379746835443



Validation scores:
	RegressionAUROC: 0.5018231868743896
	RegressionCompetitionScore: 0.10838607594936708

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.548048734664917
	RegressionCompetitionScore: 0.1115506329113924

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.5640763640403748
	RegressionCompetitionScore: 0.14319620253164558



Validation scores:
	RegressionAUROC: 0.5750601291656494
	RegressionCompetitionScore: 0.14794303797468356

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.5846619009971619
	RegressionCompetitionScore: 0.16772151898734178

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.5850816965103149
	RegressionCompetitionScore: 0.20727848101265822



Validation scores:
	RegressionAUROC: 0.5837056636810303
	RegressionCompetitionScore: 0.2231012658227848



Validation scores:
	RegressionAUROC: 0.5819888114929199
	RegressionCompetitionScore: 0.22784810126582278



Validation scores:
	RegressionAUROC: 0.5783063769340515
	RegressionCompetitionScore: 0.22626582278481014

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5834355354309082
	RegressionCompetitionScore: 0.23022151898734178

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5800679326057434
	RegressionCompetitionScore: 0.23575949367088608

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5840140581130981
	RegressionCompetitionScore: 0.2412974683544304

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.58058762550354
	RegressionCompetitionScore: 0.23496835443037975



Validation scores:
	RegressionAUROC: 0.5906018614768982
	RegressionCompetitionScore: 0.23575949367088608



Validation scores:
	RegressionAUROC: 0.5989143252372742
	RegressionCompetitionScore: 0.23655063291139242



Validation scores:
	RegressionAUROC: 0.6044481992721558
	RegressionCompetitionScore: 0.23734177215189872



Validation scores:
	RegressionAUROC: 0.6091275215148926
	RegressionCompetitionScore: 0.24050632911392406

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.613743782043457
	RegressionCompetitionScore: 0.24050632911392406



Validation scores:
	RegressionAUROC: 0.611491322517395
	RegressionCompetitionScore: 0.2389240506329114

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.612897515296936
	RegressionCompetitionScore: 0.2444620253164557

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.6152650117874146
	RegressionCompetitionScore: 0.24604430379746836



Validation scores:
	RegressionAUROC: 0.622267484664917
	RegressionCompetitionScore: 0.24604430379746836



Validation scores:
	RegressionAUROC: 0.618012547492981
	RegressionCompetitionScore: 0.2444620253164557

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6248239278793335
	RegressionCompetitionScore: 0.24920886075949367



Validation scores:
	RegressionAUROC: 0.6391793489456177
	RegressionCompetitionScore: 0.24367088607594936



Validation scores:
	RegressionAUROC: 0.6482509970664978
	RegressionCompetitionScore: 0.24287974683544303



Validation scores:
	RegressionAUROC: 0.6530799865722656
	RegressionCompetitionScore: 0.247626582278481



Validation scores:
	RegressionAUROC: 0.6577880382537842
	RegressionCompetitionScore: 0.25



Validation scores:
	RegressionAUROC: 0.6439741253852844
	RegressionCompetitionScore: 0.2563291139240506

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6446337699890137
	RegressionCompetitionScore: 0.24525316455696203



Validation scores:
	RegressionAUROC: 0.6417558193206787
	RegressionCompetitionScore: 0.23813291139240506



Validation scores:
	RegressionAUROC: 0.6449992656707764
	RegressionCompetitionScore: 0.24050632911392406



Validation scores:
	RegressionAUROC: 0.6466084718704224
	RegressionCompetitionScore: 0.24920886075949367



Validation scores:
	RegressionAUROC: 0.653511643409729
	RegressionCompetitionScore: 0.2563291139240506



Validation scores:
	RegressionAUROC: 0.6522400379180908
	RegressionCompetitionScore: 0.25316455696202533



Validation scores:
	RegressionAUROC: 0.6539627909660339
	RegressionCompetitionScore: 0.24920886075949367

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.207. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2563291139240506
     Test RegressionAUROC            0.6439741253852844
Test RegressionCompetitionScore      0.2563291139240506
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 03:10:10,945][0m Trial 66 finished with value: 0.2563291139240506 and parameters: {'lr': 3.1162236998243556e-07, 'dropout': 0.5024202361800292, 'd_model_multiplier': 16, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 975, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 1.732500513558161e-07, 'dropout': 0.5401348208076046, 'd_model_multiplier': 4, 'num_layers': 8, 'n_heads': 16, 'dim_feedforward': 884, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.1 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.1 M     Trainable params
28.8 K    Non-trainable params
1.1 M     Total params
4.492     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.950


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.932


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.908


Validation scores:
	RegressionAUROC: 0.5010330677032471
	RegressionCompetitionScore: 0.002066115702479339

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.880


Validation scores:
	RegressionAUROC: 0.5037878751754761
	RegressionCompetitionScore: 0.007575757575757576

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.849


Validation scores:
	RegressionAUROC: 0.506718099117279
	RegressionCompetitionScore: 0.01652892561983471

Metric val_loss improved by 0.033 >= min_delta = 0.0. New best score: 0.816


Validation scores:
	RegressionAUROC: 0.5150241851806641
	RegressionCompetitionScore: 0.04132231404958678

Metric val_loss improved by 0.035 >= min_delta = 0.0. New best score: 0.781


Validation scores:
	RegressionAUROC: 0.5182191133499146
	RegressionCompetitionScore: 0.06887052341597796

Metric val_loss improved by 0.036 >= min_delta = 0.0. New best score: 0.745


Validation scores:
	RegressionAUROC: 0.517752468585968
	RegressionCompetitionScore: 0.10192837465564739

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.707


Validation scores:
	RegressionAUROC: 0.521543562412262
	RegressionCompetitionScore: 0.10192837465564739

Metric val_loss improved by 0.038 >= min_delta = 0.0. New best score: 0.670


Validation scores:
	RegressionAUROC: 0.5242729187011719
	RegressionCompetitionScore: 0.10055096418732783

Metric val_loss improved by 0.040 >= min_delta = 0.0. New best score: 0.629


Validation scores:
	RegressionAUROC: 0.5343766212463379
	RegressionCompetitionScore: 0.09848484848484848

Metric val_loss improved by 0.038 >= min_delta = 0.0. New best score: 0.592


Validation scores:
	RegressionAUROC: 0.5282942056655884
	RegressionCompetitionScore: 0.09641873278236915

Metric val_loss improved by 0.038 >= min_delta = 0.0. New best score: 0.554


Validation scores:
	RegressionAUROC: 0.5269715785980225
	RegressionCompetitionScore: 0.0943526170798898

Metric val_loss improved by 0.036 >= min_delta = 0.0. New best score: 0.518


Validation scores:
	RegressionAUROC: 0.5277944803237915
	RegressionCompetitionScore: 0.09366391184573003

Metric val_loss improved by 0.035 >= min_delta = 0.0. New best score: 0.482


Validation scores:
	RegressionAUROC: 0.5262789130210876
	RegressionCompetitionScore: 0.08953168044077135

Metric val_loss improved by 0.034 >= min_delta = 0.0. New best score: 0.448


Validation scores:
	RegressionAUROC: 0.5256367325782776
	RegressionCompetitionScore: 0.08884297520661157

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.416


Validation scores:
	RegressionAUROC: 0.5252301096916199
	RegressionCompetitionScore: 0.0881542699724518

Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.385


Validation scores:
	RegressionAUROC: 0.5249773859977722
	RegressionCompetitionScore: 0.08884297520661157

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.357


Validation scores:
	RegressionAUROC: 0.5246602296829224
	RegressionCompetitionScore: 0.0881542699724518

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.331


Validation scores:
	RegressionAUROC: 0.5243796110153198
	RegressionCompetitionScore: 0.08953168044077135

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.306


Validation scores:
	RegressionAUROC: 0.5239908695220947
	RegressionCompetitionScore: 0.09228650137741047

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.286


Validation scores:
	RegressionAUROC: 0.5233017802238464
	RegressionCompetitionScore: 0.09090909090909091

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.268


Validation scores:
	RegressionAUROC: 0.5228207111358643
	RegressionCompetitionScore: 0.09090909090909091

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.253


Validation scores:
	RegressionAUROC: 0.5221291184425354
	RegressionCompetitionScore: 0.0881542699724518

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.241


Validation scores:
	RegressionAUROC: 0.5218287706375122
	RegressionCompetitionScore: 0.0881542699724518

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.233


Validation scores:
	RegressionAUROC: 0.5215005874633789
	RegressionCompetitionScore: 0.087465564738292

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.5213348269462585
	RegressionCompetitionScore: 0.08608815426997245

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.5215538740158081
	RegressionCompetitionScore: 0.08677685950413223

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.5219587087631226
	RegressionCompetitionScore: 0.08677685950413223



Validation scores:
	RegressionAUROC: 0.5218703150749207
	RegressionCompetitionScore: 0.08677685950413223



Validation scores:
	RegressionAUROC: 0.5215374231338501
	RegressionCompetitionScore: 0.08677685950413223



Validation scores:
	RegressionAUROC: 0.5213449001312256
	RegressionCompetitionScore: 0.08608815426997245



Validation scores:
	RegressionAUROC: 0.5214686989784241
	RegressionCompetitionScore: 0.08608815426997245



Validation scores:
	RegressionAUROC: 0.5213820934295654
	RegressionCompetitionScore: 0.0881542699724518



Validation scores:
	RegressionAUROC: 0.520992636680603
	RegressionCompetitionScore: 0.087465564738292

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.224. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.08677685950413223
     Test RegressionAUROC            0.5215538740158081
Test RegressionCompetitionScore      0.08677685950413223
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 03:22:59,294][0m Trial 67 finished with value: 0.08677685950413223 and parameters: {'lr': 1.732500513558161e-07, 'dropout': 0.5401348208076046, 'd_model_multiplier': 4, 'num_layers': 8, 'n_heads': 16, 'dim_feedforward': 884, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 2.0925829747285952e-05, 'dropout': 0.45356817992458237, 'd_model_multiplier': 16, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 842, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.8 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.8 M     Trainable params
0         Non-trainable params
3.8 M     Total params
15.256    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5916666984558105
	RegressionCompetitionScore: 0.25



Validation scores:
	RegressionAUROC: 0.7156990766525269
	RegressionCompetitionScore: 0.3757621951219512

Metric val_loss improved. New best score: 0.248


Validation scores:
	RegressionAUROC: 0.76543790102005
	RegressionCompetitionScore: 0.4298780487804878

Metric val_loss improved by 0.067 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7586315870285034
	RegressionCompetitionScore: 0.43140243902439024



Validation scores:
	RegressionAUROC: 0.7626585960388184
	RegressionCompetitionScore: 0.4192073170731707

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.761824369430542
	RegressionCompetitionScore: 0.4009146341463415



Validation scores:
	RegressionAUROC: 0.7684668302536011
	RegressionCompetitionScore: 0.4138719512195122

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.771588921546936
	RegressionCompetitionScore: 0.4222560975609756



Validation scores:
	RegressionAUROC: 0.7618342638015747
	RegressionCompetitionScore: 0.3856707317073171



Validation scores:
	RegressionAUROC: 0.7413334846496582
	RegressionCompetitionScore: 0.3620426829268293



Validation scores:
	RegressionAUROC: 0.7321449518203735
	RegressionCompetitionScore: 0.3475609756097561



Validation scores:
	RegressionAUROC: 0.7436997890472412
	RegressionCompetitionScore: 0.37347560975609756



Validation scores:
	RegressionAUROC: 0.7357605695724487
	RegressionCompetitionScore: 0.3879573170731707



Validation scores:
	RegressionAUROC: 0.7307817935943604
	RegressionCompetitionScore: 0.39176829268292684

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4138719512195122
     Test RegressionAUROC            0.7684668302536011
Test RegressionCompetitionScore      0.4138719512195122
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 03:27:52,472][0m Trial 68 finished with value: 0.4138719512195122 and parameters: {'lr': 2.0925829747285952e-05, 'dropout': 0.45356817992458237, 'd_model_multiplier': 16, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 842, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 2.1865630625173505e-05, 'dropout': 0.5194747292034892, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 839, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.5 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.5 M     Trainable params
0         Non-trainable params
3.5 M     Total params
14.086    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6458690166473389
	RegressionCompetitionScore: 0.33403508771929824

Metric val_loss improved. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.6644540429115295
	RegressionCompetitionScore: 0.3424561403508772

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.6707977056503296
	RegressionCompetitionScore: 0.3452631578947368



Validation scores:
	RegressionAUROC: 0.7009745836257935
	RegressionCompetitionScore: 0.30666666666666664

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.6926047801971436
	RegressionCompetitionScore: 0.3080701754385965



Validation scores:
	RegressionAUROC: 0.7162397503852844
	RegressionCompetitionScore: 0.3368421052631579



Validation scores:
	RegressionAUROC: 0.7215441465377808
	RegressionCompetitionScore: 0.4287719298245614



Validation scores:
	RegressionAUROC: 0.6818865537643433
	RegressionCompetitionScore: 0.3880701754385965



Validation scores:
	RegressionAUROC: 0.7202196717262268
	RegressionCompetitionScore: 0.43859649122807015



Validation scores:
	RegressionAUROC: 0.7389682531356812
	RegressionCompetitionScore: 0.4533333333333333



Validation scores:
	RegressionAUROC: 0.711595356464386
	RegressionCompetitionScore: 0.42596491228070177

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.159


Validation scores:
	RegressionAUROC: 0.7327921390533447
	RegressionCompetitionScore: 0.4568421052631579

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.153


Validation scores:
	RegressionAUROC: 0.7186362743377686
	RegressionCompetitionScore: 0.4336842105263158



Validation scores:
	RegressionAUROC: 0.7284270524978638
	RegressionCompetitionScore: 0.40421052631578946



Validation scores:
	RegressionAUROC: 0.7244465947151184
	RegressionCompetitionScore: 0.4056140350877193



Validation scores:
	RegressionAUROC: 0.7198857069015503
	RegressionCompetitionScore: 0.4343859649122807



Validation scores:
	RegressionAUROC: 0.7204800844192505
	RegressionCompetitionScore: 0.46035087719298246



Validation scores:
	RegressionAUROC: 0.729095995426178
	RegressionCompetitionScore: 0.4554385964912281



Validation scores:
	RegressionAUROC: 0.7298991084098816
	RegressionCompetitionScore: 0.4631578947368421

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.153. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4568421052631579
     Test RegressionAUROC            0.7327921390533447
Test RegressionCompetitionScore      0.4568421052631579
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 03:34:28,278][0m Trial 69 finished with value: 0.4568421052631579 and parameters: {'lr': 2.1865630625173505e-05, 'dropout': 0.5194747292034892, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 839, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 2.5665052906776073e-05, 'dropout': 0.5245684174439368, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 835, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.5 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.5 M     Trainable params
0         Non-trainable params
3.5 M     Total params
14.037    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.55859375
	RegressionCompetitionScore: 0.0625



Validation scores:
	RegressionAUROC: 0.6054360270500183
	RegressionCompetitionScore: 0.1315570358034971

Metric val_loss improved. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.6498874425888062
	RegressionCompetitionScore: 0.2581182348043297

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.669392466545105
	RegressionCompetitionScore: 0.2289758534554538



Validation scores:
	RegressionAUROC: 0.6729367971420288
	RegressionCompetitionScore: 0.2248126561199001



Validation scores:
	RegressionAUROC: 0.7020281553268433
	RegressionCompetitionScore: 0.19150707743547044



Validation scores:
	RegressionAUROC: 0.710625410079956
	RegressionCompetitionScore: 0.28975853455453787

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.7233790159225464
	RegressionCompetitionScore: 0.21149042464612822



Validation scores:
	RegressionAUROC: 0.731877326965332
	RegressionCompetitionScore: 0.1990008326394671



Validation scores:
	RegressionAUROC: 0.7461991310119629
	RegressionCompetitionScore: 0.29142381348875934

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.7595354318618774
	RegressionCompetitionScore: 0.3005828476269775



Validation scores:
	RegressionAUROC: 0.7404964566230774
	RegressionCompetitionScore: 0.302248126561199



Validation scores:
	RegressionAUROC: 0.7427627444267273
	RegressionCompetitionScore: 0.33222314737718567

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7647756934165955
	RegressionCompetitionScore: 0.3463780183180683

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7538082003593445
	RegressionCompetitionScore: 0.3547044129891757

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7485469579696655
	RegressionCompetitionScore: 0.3488759367194005



Validation scores:
	RegressionAUROC: 0.741645097732544
	RegressionCompetitionScore: 0.347210657785179



Validation scores:
	RegressionAUROC: 0.7557616829872131
	RegressionCompetitionScore: 0.33638634471273937



Validation scores:
	RegressionAUROC: 0.744996190071106
	RegressionCompetitionScore: 0.34138218151540384



Validation scores:
	RegressionAUROC: 0.7573521733283997
	RegressionCompetitionScore: 0.33971690258118237



Validation scores:
	RegressionAUROC: 0.7629366517066956
	RegressionCompetitionScore: 0.3430474604496253



Validation scores:
	RegressionAUROC: 0.753252387046814
	RegressionCompetitionScore: 0.34554537885095754

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.185. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3547044129891757
     Test RegressionAUROC            0.7538082003593445
Test RegressionCompetitionScore      0.3547044129891757
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 03:41:48,532][0m Trial 70 finished with value: 0.3547044129891757 and parameters: {'lr': 2.5665052906776073e-05, 'dropout': 0.5245684174439368, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 835, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 2.511495031783199e-05, 'dropout': 0.5200172790271281, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 836, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.5 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.5 M     Trainable params
0         Non-trainable params
3.5 M     Total params
14.049    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.643002450466156
	RegressionCompetitionScore: 0.2056135770234987

Metric val_loss improved. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6942172050476074
	RegressionCompetitionScore: 0.3185378590078329



Validation scores:
	RegressionAUROC: 0.6415964365005493
	RegressionCompetitionScore: 0.1912532637075718



Validation scores:
	RegressionAUROC: 0.7117044925689697
	RegressionCompetitionScore: 0.347911227154047

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.7333168983459473
	RegressionCompetitionScore: 0.43276762402088775

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6599034070968628
	RegressionCompetitionScore: 0.1814621409921671



Validation scores:
	RegressionAUROC: 0.7207908034324646
	RegressionCompetitionScore: 0.3968668407310705



Validation scores:
	RegressionAUROC: 0.744186520576477
	RegressionCompetitionScore: 0.4765013054830287

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7402772307395935
	RegressionCompetitionScore: 0.4614882506527415



Validation scores:
	RegressionAUROC: 0.7647156715393066
	RegressionCompetitionScore: 0.49738903394255873



Validation scores:
	RegressionAUROC: 0.7719463109970093
	RegressionCompetitionScore: 0.49738903394255873

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7638188600540161
	RegressionCompetitionScore: 0.4993472584856397



Validation scores:
	RegressionAUROC: 0.7521132230758667
	RegressionCompetitionScore: 0.48237597911227154



Validation scores:
	RegressionAUROC: 0.7482823133468628
	RegressionCompetitionScore: 0.4810704960835509



Validation scores:
	RegressionAUROC: 0.7239320874214172
	RegressionCompetitionScore: 0.4386422976501306



Validation scores:
	RegressionAUROC: 0.7424958944320679
	RegressionCompetitionScore: 0.46279373368146215



Validation scores:
	RegressionAUROC: 0.7338492274284363
	RegressionCompetitionScore: 0.4425587467362924



Validation scores:
	RegressionAUROC: 0.7614798545837402
	RegressionCompetitionScore: 0.4856396866840731

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.183. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.49738903394255873
     Test RegressionAUROC            0.7719463109970093
Test RegressionCompetitionScore      0.49738903394255873
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 03:48:21,380][0m Trial 71 finished with value: 0.49738903394255873 and parameters: {'lr': 2.511495031783199e-05, 'dropout': 0.5200172790271281, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 836, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 1.8760947971233382e-05, 'dropout': 0.5139103350405811, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 8, 'dim_feedforward': 932, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.2 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.2 M     Trainable params
0         Non-trainable params
3.2 M     Total params
12.784    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5129870176315308
	RegressionCompetitionScore: 0.09523809523809523



Validation scores:
	RegressionAUROC: 0.6526214480400085
	RegressionCompetitionScore: 0.17222222222222222

Metric val_loss improved. New best score: 0.261


Validation scores:
	RegressionAUROC: 0.6656129956245422
	RegressionCompetitionScore: 0.2326388888888889

Metric val_loss improved by 0.059 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6812129020690918
	RegressionCompetitionScore: 0.28888888888888886

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6929864883422852
	RegressionCompetitionScore: 0.34097222222222223

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7144306302070618
	RegressionCompetitionScore: 0.3368055555555556



Validation scores:
	RegressionAUROC: 0.7308293581008911
	RegressionCompetitionScore: 0.30972222222222223



Validation scores:
	RegressionAUROC: 0.7505803108215332
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7440870404243469
	RegressionCompetitionScore: 0.3173611111111111

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.744611382484436
	RegressionCompetitionScore: 0.31180555555555556

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7557151317596436
	RegressionCompetitionScore: 0.31666666666666665



Validation scores:
	RegressionAUROC: 0.7632188200950623
	RegressionCompetitionScore: 0.34305555555555556



Validation scores:
	RegressionAUROC: 0.7596836686134338
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7631384134292603
	RegressionCompetitionScore: 0.325



Validation scores:
	RegressionAUROC: 0.7645400762557983
	RegressionCompetitionScore: 0.325



Validation scores:
	RegressionAUROC: 0.755496621131897
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7680758833885193
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.31180555555555556
     Test RegressionAUROC             0.744611382484436
Test RegressionCompetitionScore      0.31180555555555556
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 03:53:42,487][0m Trial 72 finished with value: 0.31180555555555556 and parameters: {'lr': 1.8760947971233382e-05, 'dropout': 0.5139103350405811, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 8, 'dim_feedforward': 932, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 1.0747127357580025e-05, 'dropout': 0.49485257119518034, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 1023, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 4.1 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
4.1 M     Trainable params
0         Non-trainable params
4.1 M     Total params
16.356    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2916666865348816
	RegressionCompetitionScore: 0.20833333333333334



Validation scores:
	RegressionAUROC: 0.6147667169570923
	RegressionCompetitionScore: 0.21201716738197424

Metric val_loss improved. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.6421153545379639
	RegressionCompetitionScore: 0.2240343347639485

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.248


Validation scores:
	RegressionAUROC: 0.6554687023162842
	RegressionCompetitionScore: 0.20772532188841203

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.6639033555984497
	RegressionCompetitionScore: 0.19313304721030042



Validation scores:
	RegressionAUROC: 0.6704025268554688
	RegressionCompetitionScore: 0.1982832618025751

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6719710826873779
	RegressionCompetitionScore: 0.20600858369098712

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6776381731033325
	RegressionCompetitionScore: 0.20515021459227467



Validation scores:
	RegressionAUROC: 0.6723380088806152
	RegressionCompetitionScore: 0.21974248927038625



Validation scores:
	RegressionAUROC: 0.6601542234420776
	RegressionCompetitionScore: 0.255793991416309



Validation scores:
	RegressionAUROC: 0.6633553504943848
	RegressionCompetitionScore: 0.263519313304721



Validation scores:
	RegressionAUROC: 0.6698689460754395
	RegressionCompetitionScore: 0.263519313304721



Validation scores:
	RegressionAUROC: 0.6842460036277771
	RegressionCompetitionScore: 0.2738197424892704



Validation scores:
	RegressionAUROC: 0.6866286993026733
	RegressionCompetitionScore: 0.27896995708154504

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.203. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.20600858369098712
     Test RegressionAUROC            0.6719710826873779
Test RegressionCompetitionScore      0.20600858369098712
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 03:58:26,410][0m Trial 73 finished with value: 0.20600858369098712 and parameters: {'lr': 1.0747127357580025e-05, 'dropout': 0.49485257119518034, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 1023, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 2.8332825059557623e-05, 'dropout': 0.4845357070894709, 'd_model_multiplier': 16, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 894, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 4.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
4.0 M     Trainable params
0         Non-trainable params
4.0 M     Total params
15.951    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6212854385375977
	RegressionCompetitionScore: 0.2811791383219955

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6568892002105713
	RegressionCompetitionScore: 0.3204837490551776

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6625572443008423
	RegressionCompetitionScore: 0.3340891912320484



Validation scores:
	RegressionAUROC: 0.704012393951416
	RegressionCompetitionScore: 0.36281179138321995



Validation scores:
	RegressionAUROC: 0.6796991229057312
	RegressionCompetitionScore: 0.328042328042328

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7101582288742065
	RegressionCompetitionScore: 0.4270597127739985



Validation scores:
	RegressionAUROC: 0.7199684977531433
	RegressionCompetitionScore: 0.42025699168556313



Validation scores:
	RegressionAUROC: 0.7148218154907227
	RegressionCompetitionScore: 0.4036281179138322

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7240720391273499
	RegressionCompetitionScore: 0.3960695389266818



Validation scores:
	RegressionAUROC: 0.7098072171211243
	RegressionCompetitionScore: 0.3839758125472411



Validation scores:
	RegressionAUROC: 0.7213165760040283
	RegressionCompetitionScore: 0.3922902494331066



Validation scores:
	RegressionAUROC: 0.7140747308731079
	RegressionCompetitionScore: 0.37188208616780044



Validation scores:
	RegressionAUROC: 0.7179437875747681
	RegressionCompetitionScore: 0.3930461073318216



Validation scores:
	RegressionAUROC: 0.7293185591697693
	RegressionCompetitionScore: 0.40287226001511717



Validation scores:
	RegressionAUROC: 0.722025454044342
	RegressionCompetitionScore: 0.3960695389266818

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.188. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4036281179138322
     Test RegressionAUROC            0.7148218154907227
Test RegressionCompetitionScore      0.4036281179138322
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 04:04:07,350][0m Trial 74 finished with value: 0.4036281179138322 and parameters: {'lr': 2.8332825059557623e-05, 'dropout': 0.4845357070894709, 'd_model_multiplier': 16, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 894, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 3.4221590651996906e-05, 'dropout': 0.45703868482003296, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 797, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.1 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.1 M     Trainable params
0         Non-trainable params
3.1 M     Total params
12.482    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5254901647567749
	RegressionCompetitionScore: 0.17647058823529413



Validation scores:
	RegressionAUROC: 0.5138635635375977
	RegressionCompetitionScore: 0.12838427947598252

Metric val_loss improved. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.5544658899307251
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.586170494556427
	RegressionCompetitionScore: 0.13187772925764193

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.6062583327293396
	RegressionCompetitionScore: 0.13275109170305677



Validation scores:
	RegressionAUROC: 0.6303178668022156
	RegressionCompetitionScore: 0.14323144104803492



Validation scores:
	RegressionAUROC: 0.6536100506782532
	RegressionCompetitionScore: 0.1467248908296943

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.6362015008926392
	RegressionCompetitionScore: 0.13624454148471615



Validation scores:
	RegressionAUROC: 0.6481858491897583
	RegressionCompetitionScore: 0.13973799126637554



Validation scores:
	RegressionAUROC: 0.6638893485069275
	RegressionCompetitionScore: 0.15982532751091702



Validation scores:
	RegressionAUROC: 0.6623578667640686
	RegressionCompetitionScore: 0.18340611353711792

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6570249795913696
	RegressionCompetitionScore: 0.1703056768558952



Validation scores:
	RegressionAUROC: 0.6975984573364258
	RegressionCompetitionScore: 0.18777292576419213



Validation scores:
	RegressionAUROC: 0.6623228788375854
	RegressionCompetitionScore: 0.1615720524017467



Validation scores:
	RegressionAUROC: 0.6913065910339355
	RegressionCompetitionScore: 0.1781659388646288



Validation scores:
	RegressionAUROC: 0.6647173166275024
	RegressionCompetitionScore: 0.17554585152838428



Validation scores:
	RegressionAUROC: 0.7165995836257935
	RegressionCompetitionScore: 0.21397379912663755



Validation scores:
	RegressionAUROC: 0.6881173849105835
	RegressionCompetitionScore: 0.1903930131004367

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.203. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.18340611353711792
     Test RegressionAUROC            0.6623578667640686
Test RegressionCompetitionScore      0.18340611353711792
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 04:09:44,393][0m Trial 75 finished with value: 0.18340611353711792 and parameters: {'lr': 3.4221590651996906e-05, 'dropout': 0.45703868482003296, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 797, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 6.54007674739045e-05, 'dropout': 0.47841757399152146, 'd_model_multiplier': 16, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 859, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.9 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.9 M     Trainable params
0         Non-trainable params
3.9 M     Total params
15.483    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.35428568720817566
	RegressionCompetitionScore: 0.2



Validation scores:
	RegressionAUROC: 0.6197196245193481
	RegressionCompetitionScore: 0.33984867591424966

Metric val_loss improved. New best score: 0.374


Validation scores:
	RegressionAUROC: 0.6559222340583801
	RegressionCompetitionScore: 0.2938209331651955

Metric val_loss improved by 0.165 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5895003080368042
	RegressionCompetitionScore: 0.31588902900378313



Validation scores:
	RegressionAUROC: 0.6646265983581543
	RegressionCompetitionScore: 0.2698612862547289



Validation scores:
	RegressionAUROC: 0.6606006622314453
	RegressionCompetitionScore: 0.2786885245901639



Validation scores:
	RegressionAUROC: 0.6560529470443726
	RegressionCompetitionScore: 0.26292559899117274



Validation scores:
	RegressionAUROC: 0.6364191770553589
	RegressionCompetitionScore: 0.2957124842370744

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6042231321334839
	RegressionCompetitionScore: 0.28877679697351827



Validation scores:
	RegressionAUROC: 0.6153461337089539
	RegressionCompetitionScore: 0.29823455233291296



Validation scores:
	RegressionAUROC: 0.5820896625518799
	RegressionCompetitionScore: 0.2906683480453972



Validation scores:
	RegressionAUROC: 0.6159468293190002
	RegressionCompetitionScore: 0.3209331651954603

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6351225972175598
	RegressionCompetitionScore: 0.30958385876418665



Validation scores:
	RegressionAUROC: 0.650221586227417
	RegressionCompetitionScore: 0.30706179066834804



Validation scores:
	RegressionAUROC: 0.6403285264968872
	RegressionCompetitionScore: 0.29760403530895335

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6472828388214111
	RegressionCompetitionScore: 0.30580075662042877



Validation scores:
	RegressionAUROC: 0.6492406129837036
	RegressionCompetitionScore: 0.30706179066834804



Validation scores:
	RegressionAUROC: 0.6426035761833191
	RegressionCompetitionScore: 0.3184110970996217



Validation scores:
	RegressionAUROC: 0.6553720235824585
	RegressionCompetitionScore: 0.3467843631778058



Validation scores:
	RegressionAUROC: 0.6419143080711365
	RegressionCompetitionScore: 0.33354350567465324



Validation scores:
	RegressionAUROC: 0.6390818953514099
	RegressionCompetitionScore: 0.33354350567465324



Validation scores:
	RegressionAUROC: 0.6457719206809998
	RegressionCompetitionScore: 0.349936948297604

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.189. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.29760403530895335
     Test RegressionAUROC            0.6403285264968872
Test RegressionCompetitionScore      0.29760403530895335
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 04:17:36,291][0m Trial 76 finished with value: 0.29760403530895335 and parameters: {'lr': 6.54007674739045e-05, 'dropout': 0.47841757399152146, 'd_model_multiplier': 16, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 859, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 0.0001535467319846465, 'dropout': 0.5377443555268147, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 8, 'dim_feedforward': 898, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.8 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
2.8 M     Trainable params
0         Non-trainable params
2.8 M     Total params
11.245    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.1875
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7038916349411011
	RegressionCompetitionScore: 0.2999299229152067

Metric val_loss improved. New best score: 0.231


Validation scores:
	RegressionAUROC: 0.6655398607254028
	RegressionCompetitionScore: 0.2662929222144359

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.6563935875892639
	RegressionCompetitionScore: 0.271198318149965

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5138908624649048
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5030993223190308
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6421363353729248
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6684920787811279
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.660852313041687
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6685178875923157
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.212. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.271198318149965
     Test RegressionAUROC            0.6563935875892639
Test RegressionCompetitionScore       0.271198318149965
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 04:21:00,381][0m Trial 77 finished with value: 0.271198318149965 and parameters: {'lr': 0.0001535467319846465, 'dropout': 0.5377443555268147, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 8, 'dim_feedforward': 898, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 1.9587714331174545e-05, 'dropout': 0.5189854489934886, 'd_model_multiplier': 16, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 814, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.7 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.7 M     Trainable params
0         Non-trainable params
3.7 M     Total params
14.882    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5669589042663574
	RegressionCompetitionScore: 0.3260025873221216

Metric val_loss improved. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.5907223224639893
	RegressionCompetitionScore: 0.32858990944372574



Validation scores:
	RegressionAUROC: 0.624748170375824
	RegressionCompetitionScore: 0.3260025873221216

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.6479190587997437
	RegressionCompetitionScore: 0.34346701164294957



Validation scores:
	RegressionAUROC: 0.6533205509185791
	RegressionCompetitionScore: 0.36610608020698576



Validation scores:
	RegressionAUROC: 0.6568032503128052
	RegressionCompetitionScore: 0.3576972833117723



Validation scores:
	RegressionAUROC: 0.6717231869697571
	RegressionCompetitionScore: 0.3667529107373868



Validation scores:
	RegressionAUROC: 0.680047333240509
	RegressionCompetitionScore: 0.37904269081500647



Validation scores:
	RegressionAUROC: 0.6768490076065063
	RegressionCompetitionScore: 0.3576972833117723



Validation scores:
	RegressionAUROC: 0.6821506023406982
	RegressionCompetitionScore: 0.34670116429495473

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.187. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3260025873221216
     Test RegressionAUROC             0.624748170375824
Test RegressionCompetitionScore      0.3260025873221216
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 04:24:44,230][0m Trial 78 finished with value: 0.3260025873221216 and parameters: {'lr': 1.9587714331174545e-05, 'dropout': 0.5189854489934886, 'd_model_multiplier': 16, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 814, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 2.8356719258513067e-05, 'dropout': 0.5537609006689111, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 8, 'dim_feedforward': 772, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.8 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
2.8 M     Trainable params
0         Non-trainable params
2.8 M     Total params
11.139    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5454545617103577
	RegressionCompetitionScore: 0.09090909090909091



Validation scores:
	RegressionAUROC: 0.655147910118103
	RegressionCompetitionScore: 0.22213622291021673

Metric val_loss improved. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6896767020225525
	RegressionCompetitionScore: 0.25232198142414863



Validation scores:
	RegressionAUROC: 0.6844210624694824
	RegressionCompetitionScore: 0.24148606811145512

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6867756843566895
	RegressionCompetitionScore: 0.2608359133126935

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.7036142349243164
	RegressionCompetitionScore: 0.28095975232198145

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7044342756271362
	RegressionCompetitionScore: 0.30572755417956654



Validation scores:
	RegressionAUROC: 0.6965771913528442
	RegressionCompetitionScore: 0.31501547987616096



Validation scores:
	RegressionAUROC: 0.696704626083374
	RegressionCompetitionScore: 0.32972136222910214



Validation scores:
	RegressionAUROC: 0.6773754358291626
	RegressionCompetitionScore: 0.29876160990712075



Validation scores:
	RegressionAUROC: 0.6737418174743652
	RegressionCompetitionScore: 0.2801857585139319



Validation scores:
	RegressionAUROC: 0.6938695311546326
	RegressionCompetitionScore: 0.27941176470588236



Validation scores:
	RegressionAUROC: 0.68757164478302
	RegressionCompetitionScore: 0.32894736842105265

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.194. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.28095975232198145
     Test RegressionAUROC            0.7036142349243164
Test RegressionCompetitionScore      0.28095975232198145
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 04:28:37,427][0m Trial 79 finished with value: 0.28095975232198145 and parameters: {'lr': 2.8356719258513067e-05, 'dropout': 0.5537609006689111, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 8, 'dim_feedforward': 772, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 1.3187045848537465e-05, 'dropout': 0.49933017164717725, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 940, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 449 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
449 K     Trainable params
0         Non-trainable params
449 K     Total params
1.798     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5409090518951416
	RegressionCompetitionScore: 0.18181818181818182



Validation scores:
	RegressionAUROC: 0.4281155467033386
	RegressionCompetitionScore: 0.07928197456993269

Metric val_loss improved. New best score: 0.410


Validation scores:
	RegressionAUROC: 0.46195927262306213
	RegressionCompetitionScore: 0.07853403141361257

Metric val_loss improved by 0.111 >= min_delta = 0.0. New best score: 0.299


Validation scores:
	RegressionAUROC: 0.4865274429321289
	RegressionCompetitionScore: 0.08975317875841436

Metric val_loss improved by 0.064 >= min_delta = 0.0. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.5043869614601135
	RegressionCompetitionScore: 0.15407629020194466

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.527452826499939
	RegressionCompetitionScore: 0.16978309648466716

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.5553743839263916
	RegressionCompetitionScore: 0.15856394913986538



Validation scores:
	RegressionAUROC: 0.5757148265838623
	RegressionCompetitionScore: 0.1974569932685116



Validation scores:
	RegressionAUROC: 0.5769237279891968
	RegressionCompetitionScore: 0.18025430067314885



Validation scores:
	RegressionAUROC: 0.5784205198287964
	RegressionCompetitionScore: 0.17801047120418848



Validation scores:
	RegressionAUROC: 0.5805604457855225
	RegressionCompetitionScore: 0.1824981301421092



Validation scores:
	RegressionAUROC: 0.582378089427948
	RegressionCompetitionScore: 0.18324607329842932



Validation scores:
	RegressionAUROC: 0.5834478139877319
	RegressionCompetitionScore: 0.1944652206432311

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.203. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.16978309648466716
     Test RegressionAUROC             0.527452826499939
Test RegressionCompetitionScore      0.16978309648466716
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 04:32:45,035][0m Trial 80 finished with value: 0.16978309648466716 and parameters: {'lr': 1.3187045848537465e-05, 'dropout': 0.49933017164717725, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 940, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 8.029417917668652e-06, 'dropout': 0.46845543121535893, 'd_model_multiplier': 16, 'num_layers': 14, 'n_heads': 8, 'dim_feedforward': 905, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 4.3 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.295    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5870445370674133
	RegressionCompetitionScore: 0.10526315789473684



Validation scores:
	RegressionAUROC: 0.6238226294517517
	RegressionCompetitionScore: 0.22157676348547717

Metric val_loss improved. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6609714031219482
	RegressionCompetitionScore: 0.23568464730290456



Validation scores:
	RegressionAUROC: 0.6572559475898743
	RegressionCompetitionScore: 0.34854771784232363

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.7056430578231812
	RegressionCompetitionScore: 0.36016597510373444



Validation scores:
	RegressionAUROC: 0.7055875062942505
	RegressionCompetitionScore: 0.3253112033195021

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.7501628398895264
	RegressionCompetitionScore: 0.37344398340248963

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7261476516723633
	RegressionCompetitionScore: 0.2979253112033195



Validation scores:
	RegressionAUROC: 0.7168987393379211
	RegressionCompetitionScore: 0.3103734439834025



Validation scores:
	RegressionAUROC: 0.7488387823104858
	RegressionCompetitionScore: 0.33443983402489624



Validation scores:
	RegressionAUROC: 0.722297191619873
	RegressionCompetitionScore: 0.3236514522821577

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.732093095779419
	RegressionCompetitionScore: 0.31950207468879666



Validation scores:
	RegressionAUROC: 0.7388100624084473
	RegressionCompetitionScore: 0.33526970954356844



Validation scores:
	RegressionAUROC: 0.7501745223999023
	RegressionCompetitionScore: 0.35684647302904565



Validation scores:
	RegressionAUROC: 0.7540549039840698
	RegressionCompetitionScore: 0.35435684647302906



Validation scores:
	RegressionAUROC: 0.7602855563163757
	RegressionCompetitionScore: 0.35601659751037346



Validation scores:
	RegressionAUROC: 0.7611037492752075
	RegressionCompetitionScore: 0.34854771784232363



Validation scores:
	RegressionAUROC: 0.7444709539413452
	RegressionCompetitionScore: 0.3369294605809129

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3236514522821577
     Test RegressionAUROC             0.722297191619873
Test RegressionCompetitionScore      0.3236514522821577
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 04:39:27,381][0m Trial 81 finished with value: 0.3236514522821577 and parameters: {'lr': 8.029417917668652e-06, 'dropout': 0.46845543121535893, 'd_model_multiplier': 16, 'num_layers': 14, 'n_heads': 8, 'dim_feedforward': 905, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 5.520164041855166e-05, 'dropout': 0.42893929415148285, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 877, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.6 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.6 M     Trainable params
57.6 K    Non-trainable params
3.6 M     Total params
14.555    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4909090995788574
	RegressionCompetitionScore: 0.09090909090909091



Validation scores:
	RegressionAUROC: 0.5212611556053162
	RegressionCompetitionScore: 0.2012779552715655

Metric val_loss improved. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.5295456051826477
	RegressionCompetitionScore: 0.2563897763578275



Validation scores:
	RegressionAUROC: 0.610201895236969
	RegressionCompetitionScore: 0.31549520766773165

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.6281352639198303
	RegressionCompetitionScore: 0.30431309904153353



Validation scores:
	RegressionAUROC: 0.6634579300880432
	RegressionCompetitionScore: 0.33626198083067094

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.6734884977340698
	RegressionCompetitionScore: 0.3498402555910543



Validation scores:
	RegressionAUROC: 0.6868367195129395
	RegressionCompetitionScore: 0.36741214057507987



Validation scores:
	RegressionAUROC: 0.680355966091156
	RegressionCompetitionScore: 0.3450479233226837



Validation scores:
	RegressionAUROC: 0.6947258710861206
	RegressionCompetitionScore: 0.3634185303514377



Validation scores:
	RegressionAUROC: 0.6878851652145386
	RegressionCompetitionScore: 0.4145367412140575

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.7043944597244263
	RegressionCompetitionScore: 0.40894568690095845



Validation scores:
	RegressionAUROC: 0.6980016827583313
	RegressionCompetitionScore: 0.4217252396166134

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.7081282734870911
	RegressionCompetitionScore: 0.4353035143769968



Validation scores:
	RegressionAUROC: 0.7081995010375977
	RegressionCompetitionScore: 0.41134185303514376



Validation scores:
	RegressionAUROC: 0.7012678384780884
	RegressionCompetitionScore: 0.3977635782747604



Validation scores:
	RegressionAUROC: 0.7085493206977844
	RegressionCompetitionScore: 0.45527156549520764



Validation scores:
	RegressionAUROC: 0.7169814705848694
	RegressionCompetitionScore: 0.476038338658147



Validation scores:
	RegressionAUROC: 0.7188165187835693
	RegressionCompetitionScore: 0.48003194888178913



Validation scores:
	RegressionAUROC: 0.7170391082763672
	RegressionCompetitionScore: 0.4720447284345048

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.206. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4217252396166134
     Test RegressionAUROC            0.6980016827583313
Test RegressionCompetitionScore      0.4217252396166134
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 04:46:02,411][0m Trial 82 finished with value: 0.4217252396166134 and parameters: {'lr': 5.520164041855166e-05, 'dropout': 0.42893929415148285, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 877, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 7.649103794508071e-05, 'dropout': 0.4371082256685402, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 842, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.5 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.5 M     Trainable params
0         Non-trainable params
3.5 M     Total params
14.123    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5923019051551819
	RegressionCompetitionScore: 0.12388162422573985

Metric val_loss improved. New best score: 0.262


Validation scores:
	RegressionAUROC: 0.6448379755020142
	RegressionCompetitionScore: 0.17894012388162422

Metric val_loss improved by 0.077 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.6860712766647339
	RegressionCompetitionScore: 0.2677219545767378



Validation scores:
	RegressionAUROC: 0.706275224685669
	RegressionCompetitionScore: 0.20853406744666209



Validation scores:
	RegressionAUROC: 0.7096223831176758
	RegressionCompetitionScore: 0.19201651754989676



Validation scores:
	RegressionAUROC: 0.6931273937225342
	RegressionCompetitionScore: 0.20302821748107364



Validation scores:
	RegressionAUROC: 0.6939876079559326
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7038191556930542
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7031960487365723
	RegressionCompetitionScore: 0.29456297315898144

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.186. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.17894012388162422
     Test RegressionAUROC            0.6448379755020142
Test RegressionCompetitionScore      0.17894012388162422
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 04:49:22,476][0m Trial 83 finished with value: 0.17894012388162422 and parameters: {'lr': 7.649103794508071e-05, 'dropout': 0.4371082256685402, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 842, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 57 with value: 0.5207547169811321.[0m
Starting trial with params:
{'lr': 0.00011198471743100309, 'dropout': 0.4521001461576951, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 766, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.0 M     Trainable params
57.6 K    Non-trainable params
3.0 M     Total params
12.132    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5058823227882385
	RegressionCompetitionScore: 0.11764705882352941



Validation scores:
	RegressionAUROC: 0.7198902368545532
	RegressionCompetitionScore: 0.3294301327088212

Metric val_loss improved. New best score: 0.254


Validation scores:
	RegressionAUROC: 0.753873348236084
	RegressionCompetitionScore: 0.41139734582357534

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.236


Validation scores:
	RegressionAUROC: 0.7451679706573486
	RegressionCompetitionScore: 0.3708040593286495

Metric val_loss improved by 0.038 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.7392646670341492
	RegressionCompetitionScore: 0.4332552693208431

Metric val_loss improved by 0.040 >= min_delta = 0.0. New best score: 0.158


Validation scores:
	RegressionAUROC: 0.7391630411148071
	RegressionCompetitionScore: 0.43950039032006244



Validation scores:
	RegressionAUROC: 0.7441855669021606
	RegressionCompetitionScore: 0.4527712724434036

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.150


Validation scores:
	RegressionAUROC: 0.763548731803894
	RegressionCompetitionScore: 0.4722872755659641

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.147


Validation scores:
	RegressionAUROC: 0.7674061059951782
	RegressionCompetitionScore: 0.4129586260733802



Validation scores:
	RegressionAUROC: 0.7356827259063721
	RegressionCompetitionScore: 0.468384074941452



Validation scores:
	RegressionAUROC: 0.7601335644721985
	RegressionCompetitionScore: 0.49024199843871974



Validation scores:
	RegressionAUROC: 0.763397753238678
	RegressionCompetitionScore: 0.46291959406713507



Validation scores:
	RegressionAUROC: 0.7795794010162354
	RegressionCompetitionScore: 0.5206869633099142



Validation scores:
	RegressionAUROC: 0.7868130803108215
	RegressionCompetitionScore: 0.49882903981264637

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.144


Validation scores:
	RegressionAUROC: 0.7941538691520691
	RegressionCompetitionScore: 0.5050741608118657



Validation scores:
	RegressionAUROC: 0.7926058173179626
	RegressionCompetitionScore: 0.49414519906323184

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.140


Validation scores:
	RegressionAUROC: 0.7869868874549866
	RegressionCompetitionScore: 0.5339578454332553

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.131


Validation scores:
	RegressionAUROC: 0.7913246154785156
	RegressionCompetitionScore: 0.5604996096799375



Validation scores:
	RegressionAUROC: 0.8036278486251831
	RegressionCompetitionScore: 0.5698672911787666



Validation scores:
	RegressionAUROC: 0.7948053479194641
	RegressionCompetitionScore: 0.5433255269320844



Validation scores:
	RegressionAUROC: 0.7846931219100952
	RegressionCompetitionScore: 0.5042935206869633



Validation scores:
	RegressionAUROC: 0.7820664048194885
	RegressionCompetitionScore: 0.550351288056206



Validation scores:
	RegressionAUROC: 0.7936052680015564
	RegressionCompetitionScore: 0.5347384855581577



Validation scores:
	RegressionAUROC: 0.8011078834533691
	RegressionCompetitionScore: 0.5604996096799375

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.131. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.5339578454332553
     Test RegressionAUROC            0.7869868874549866
Test RegressionCompetitionScore      0.5339578454332553
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 04:57:03,731][0m Trial 84 finished with value: 0.5339578454332553 and parameters: {'lr': 0.00011198471743100309, 'dropout': 0.4521001461576951, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 766, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 84 with value: 0.5339578454332553.[0m
Starting trial with params:
{'lr': 4.887109680953641e-05, 'dropout': 0.42867988580714445, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 760, 'batch_size': 1024, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.0 M     Trainable params
57.6 K    Non-trainable params
3.0 M     Total params
12.064    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.3941900432109833
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.513


Validation scores:
	RegressionAUROC: 0.6090090274810791
	RegressionCompetitionScore: 0.17664092664092665

Metric val_loss improved by 0.249 >= min_delta = 0.0. New best score: 0.265


Validation scores:
	RegressionAUROC: 0.5908801555633545
	RegressionCompetitionScore: 0.1891891891891892

Metric val_loss improved by 0.034 >= min_delta = 0.0. New best score: 0.231


Validation scores:
	RegressionAUROC: 0.6587235927581787
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6123124361038208
	RegressionCompetitionScore: 0.14285714285714285

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.47302091121673584
	RegressionCompetitionScore: 0.13803088803088803



Validation scores:
	RegressionAUROC: 0.4611208438873291
	RegressionCompetitionScore: 0.13706563706563707



Validation scores:
	RegressionAUROC: 0.4987306296825409
	RegressionCompetitionScore: 0.13996138996138996



Validation scores:
	RegressionAUROC: 0.6273229122161865
	RegressionCompetitionScore: 0.1361003861003861



Validation scores:
	RegressionAUROC: 0.6718466281890869
	RegressionCompetitionScore: 0.12162162162162163



Validation scores:
	RegressionAUROC: 0.6858252882957458
	RegressionCompetitionScore: 0.25965250965250963



Validation scores:
	RegressionAUROC: 0.64200758934021
	RegressionCompetitionScore: 0.21621621621621623

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.207. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.14285714285714285
     Test RegressionAUROC            0.6123124361038208
Test RegressionCompetitionScore      0.14285714285714285
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:01:13,056][0m Trial 85 finished with value: 0.14285714285714285 and parameters: {'lr': 4.887109680953641e-05, 'dropout': 0.42867988580714445, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 760, 'batch_size': 1024, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 84 with value: 0.5339578454332553.[0m
Starting trial with params:
{'lr': 8.75266782562738e-05, 'dropout': 0.45711151539342887, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 865, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 3.3 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
3.3 M     Trainable params
57.6 K    Non-trainable params
3.3 M     Total params
13.251    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.48051947355270386
	RegressionCompetitionScore: 0.047619047619047616



Validation scores:
	RegressionAUROC: 0.5850443840026855
	RegressionCompetitionScore: 0.1927888153053716

Metric val_loss improved. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6321274042129517
	RegressionCompetitionScore: 0.22369389256806477



Validation scores:
	RegressionAUROC: 0.6533774733543396
	RegressionCompetitionScore: 0.24944812362030905

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6666682958602905
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6744108200073242
	RegressionCompetitionScore: 0.3038999264164827



Validation scores:
	RegressionAUROC: 0.7165442705154419
	RegressionCompetitionScore: 0.3031640912435614



Validation scores:
	RegressionAUROC: 0.7143192887306213
	RegressionCompetitionScore: 0.32891832229580575



Validation scores:
	RegressionAUROC: 0.7655560970306396
	RegressionCompetitionScore: 0.37601177336276675



Validation scores:
	RegressionAUROC: 0.7711527943611145
	RegressionCompetitionScore: 0.37748344370860926



Validation scores:
	RegressionAUROC: 0.7607101798057556
	RegressionCompetitionScore: 0.40765268579838115

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.198. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.24944812362030905
     Test RegressionAUROC            0.6533774733543396
Test RegressionCompetitionScore      0.24944812362030905
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:04:44,665][0m Trial 86 finished with value: 0.24944812362030905 and parameters: {'lr': 8.75266782562738e-05, 'dropout': 0.45711151539342887, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 8, 'dim_feedforward': 865, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 84 with value: 0.5339578454332553.[0m
Starting trial with params:
{'lr': 5.304536526015988e-05, 'dropout': 0.44365244002641196, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 8, 'dim_feedforward': 816, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.9 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
2.8 M     Trainable params
57.6 K    Non-trainable params
2.9 M     Total params
11.591    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7673090696334839
	RegressionCompetitionScore: 0.24806949806949807

Metric val_loss improved. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.7618095874786377
	RegressionCompetitionScore: 0.21428571428571427



Validation scores:
	RegressionAUROC: 0.7796865701675415
	RegressionCompetitionScore: 0.20945945945945946

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.788854718208313
	RegressionCompetitionScore: 0.25386100386100385

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7837271690368652
	RegressionCompetitionScore: 0.2606177606177606



Validation scores:
	RegressionAUROC: 0.786341667175293
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7867017984390259
	RegressionCompetitionScore: 0.2548262548262548

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7784829139709473
	RegressionCompetitionScore: 0.2055984555984556



Validation scores:
	RegressionAUROC: 0.7532457709312439
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7491061091423035
	RegressionCompetitionScore: 0.22876447876447875



Validation scores:
	RegressionAUROC: 0.7663492560386658
	RegressionCompetitionScore: 0.2857142857142857



Validation scores:
	RegressionAUROC: 0.7689977884292603
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7722146511077881
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7830199599266052
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2548262548262548
     Test RegressionAUROC            0.7867017984390259
Test RegressionCompetitionScore      0.2548262548262548
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:09:17,658][0m Trial 87 finished with value: 0.2548262548262548 and parameters: {'lr': 5.304536526015988e-05, 'dropout': 0.44365244002641196, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 8, 'dim_feedforward': 816, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 84 with value: 0.5339578454332553.[0m
Starting trial with params:
{'lr': 0.0003938518406964333, 'dropout': 0.490903645818117, 'd_model_multiplier': 1, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 782, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 187 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
183 K     Trainable params
3.6 K     Non-trainable params
187 K     Total params
0.748     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.46455052495002747
	RegressionCompetitionScore: 0.11665387567152724

Metric val_loss improved. New best score: 0.267


Validation scores:
	RegressionAUROC: 0.4707633852958679
	RegressionCompetitionScore: 0.12356101304681504



Validation scores:
	RegressionAUROC: 0.46322792768478394
	RegressionCompetitionScore: 0.12432847275518036



Validation scores:
	RegressionAUROC: 0.4581456184387207
	RegressionCompetitionScore: 0.11665387567152724



Validation scores:
	RegressionAUROC: 0.47220245003700256
	RegressionCompetitionScore: 0.1204911742133538



Validation scores:
	RegressionAUROC: 0.4947892129421234
	RegressionCompetitionScore: 0.11972371450498849

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.236


Validation scores:
	RegressionAUROC: 0.49842333793640137
	RegressionCompetitionScore: 0.12509593246354567

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.5527554750442505
	RegressionCompetitionScore: 0.13123561013046814

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.618888258934021
	RegressionCompetitionScore: 0.12509593246354567



Validation scores:
	RegressionAUROC: 0.6015837788581848
	RegressionCompetitionScore: 0.11895625479662318

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5045145153999329
	RegressionCompetitionScore: 0.10207214121258634



Validation scores:
	RegressionAUROC: 0.5022912621498108
	RegressionCompetitionScore: 0.10360706062931696



Validation scores:
	RegressionAUROC: 0.49460944533348083
	RegressionCompetitionScore: 0.0844205679201842



Validation scores:
	RegressionAUROC: 0.45123451948165894
	RegressionCompetitionScore: 0.08979278587874137



Validation scores:
	RegressionAUROC: 0.4621431827545166
	RegressionCompetitionScore: 0.10360706062931696



Validation scores:
	RegressionAUROC: 0.47035619616508484
	RegressionCompetitionScore: 0.11051419800460476



Validation scores:
	RegressionAUROC: 0.4667884409427643
	RegressionCompetitionScore: 0.11511895625479662

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.11895625479662318
     Test RegressionAUROC            0.6015837788581848
Test RegressionCompetitionScore      0.11895625479662318
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:14:29,774][0m Trial 88 finished with value: 0.11895625479662318 and parameters: {'lr': 0.0003938518406964333, 'dropout': 0.490903645818117, 'd_model_multiplier': 1, 'num_layers': 12, 'n_heads': 8, 'dim_feedforward': 782, 'batch_size': 64, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 84 with value: 0.5339578454332553.[0m
Starting trial with params:
{'lr': 0.00011832288286998962, 'dropout': 0.42662707540684947, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 8, 'dim_feedforward': 749, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.7 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
2.7 M     Trainable params
57.6 K    Non-trainable params
2.7 M     Total params
10.903    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4655870497226715
	RegressionCompetitionScore: 0.10526315789473684



Validation scores:
	RegressionAUROC: 0.6581424474716187
	RegressionCompetitionScore: 0.03378921962992759

Metric val_loss improved. New best score: 0.301


Validation scores:
	RegressionAUROC: 0.706560492515564
	RegressionCompetitionScore: 0.035398230088495575

Metric val_loss improved by 0.075 >= min_delta = 0.0. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.7616709470748901
	RegressionCompetitionScore: 0.36524537409493163

Metric val_loss improved by 0.033 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7776870131492615
	RegressionCompetitionScore: 0.413515687851971



Validation scores:
	RegressionAUROC: 0.7883597612380981
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7873108386993408
	RegressionCompetitionScore: 0.3990345937248592

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7765860557556152
	RegressionCompetitionScore: 0.34432823813354785



Validation scores:
	RegressionAUROC: 0.7807749509811401
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7717889547348022
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7794885635375977
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.8035130500793457
	RegressionCompetitionScore: 0.5245374094931617

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7651278972625732
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.8067288398742676
	RegressionCompetitionScore: 0.5108608205953339

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7988777756690979
	RegressionCompetitionScore: 0.5181013676588898



Validation scores:
	RegressionAUROC: 0.7870655655860901
	RegressionCompetitionScore: 0.5156878519710378



Validation scores:
	RegressionAUROC: 0.7933711409568787
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7749202251434326
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.794304609298706
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7720745801925659
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7881541848182678
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.171. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.5108608205953339
     Test RegressionAUROC            0.8067288398742676
Test RegressionCompetitionScore      0.5108608205953339
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:21:01,066][0m Trial 89 finished with value: 0.5108608205953339 and parameters: {'lr': 0.00011832288286998962, 'dropout': 0.42662707540684947, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 8, 'dim_feedforward': 749, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 84 with value: 0.5339578454332553.[0m
Starting trial with params:
{'lr': 0.0001277073263286313, 'dropout': 0.4245693255139813, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 64, 'dim_feedforward': 749, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 58.3 M
1 | loss_fn | MSELoss | 0     
------------------------------------
57.9 M    Trainable params
460 K     Non-trainable params
58.3 M    Total params
233.358   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5021645426750183
	RegressionCompetitionScore: 0.09523809523809523

[WARNING] OOM for trial with params {'lr': 0.0001277073263286313, 'dropout': 0.4245693255139813, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 64, 'dim_feedforward': 749, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
[32m[I 2023-04-03 05:21:11,666][0m Trial 90 finished with value: 0.0 and parameters: {'lr': 0.0001277073263286313, 'dropout': 0.4245693255139813, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 64, 'dim_feedforward': 749, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 84 with value: 0.5339578454332553.[0m
Starting trial with params:
{'lr': 3.44516749516897e-05, 'dropout': 0.41267074039556045, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 8, 'dim_feedforward': 886, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.8 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
2.7 M     Trainable params
57.6 K    Non-trainable params
2.8 M     Total params
11.134    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.30909091234207153
	RegressionCompetitionScore: 0.13636363636363635



Validation scores:
	RegressionAUROC: 0.5417576432228088
	RegressionCompetitionScore: 0.22275641025641027

Metric val_loss improved. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.7430756688117981
	RegressionCompetitionScore: 0.328525641025641

Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.7465876340866089
	RegressionCompetitionScore: 0.33253205128205127

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.7573695182800293
	RegressionCompetitionScore: 0.37099358974358976



Validation scores:
	RegressionAUROC: 0.7826012372970581
	RegressionCompetitionScore: 0.4479166666666667



Validation scores:
	RegressionAUROC: 0.7967658638954163
	RegressionCompetitionScore: 0.4735576923076923



Validation scores:
	RegressionAUROC: 0.8110056519508362
	RegressionCompetitionScore: 0.5705128205128205

Metric val_loss improved by 0.036 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.8014734983444214
	RegressionCompetitionScore: 0.48878205128205127



Validation scores:
	RegressionAUROC: 0.782417893409729
	RegressionCompetitionScore: 0.44150641025641024



Validation scores:
	RegressionAUROC: 0.7627109289169312
	RegressionCompetitionScore: 0.452724358974359



Validation scores:
	RegressionAUROC: 0.7960196137428284
	RegressionCompetitionScore: 0.4983974358974359



Validation scores:
	RegressionAUROC: 0.8046408891677856
	RegressionCompetitionScore: 0.5064102564102564



Validation scores:
	RegressionAUROC: 0.8017109036445618
	RegressionCompetitionScore: 0.5032051282051282



Validation scores:
	RegressionAUROC: 0.8081230521202087
	RegressionCompetitionScore: 0.5168269230769231

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.162. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.5705128205128205
     Test RegressionAUROC            0.8110056519508362
Test RegressionCompetitionScore      0.5705128205128205
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:25:31,979][0m Trial 91 finished with value: 0.5705128205128205 and parameters: {'lr': 3.44516749516897e-05, 'dropout': 0.41267074039556045, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 8, 'dim_feedforward': 886, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 91 with value: 0.5705128205128205.[0m
Starting trial with params:
{'lr': 3.847218752639867e-05, 'dropout': 0.41284525836260244, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 8, 'dim_feedforward': 837, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.7 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
2.6 M     Trainable params
57.6 K    Non-trainable params
2.7 M     Total params
10.680    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.40454545617103577
	RegressionCompetitionScore: 0.18181818181818182



Validation scores:
	RegressionAUROC: 0.6551517248153687
	RegressionCompetitionScore: 0.3390431187241583

Metric val_loss improved. New best score: 0.343


Validation scores:
	RegressionAUROC: 0.6793403625488281
	RegressionCompetitionScore: 0.42114589486119314

Metric val_loss improved by 0.177 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.6616342067718506
	RegressionCompetitionScore: 0.3951565268753692



Validation scores:
	RegressionAUROC: 0.7193442583084106
	RegressionCompetitionScore: 0.45126993502658



Validation scores:
	RegressionAUROC: 0.6918848752975464
	RegressionCompetitionScore: 0.45776727702303605



Validation scores:
	RegressionAUROC: 0.7149091362953186
	RegressionCompetitionScore: 0.4654459539279386



Validation scores:
	RegressionAUROC: 0.7009469270706177
	RegressionCompetitionScore: 0.4873006497341996



Validation scores:
	RegressionAUROC: 0.7314457893371582
	RegressionCompetitionScore: 0.47844063792085056



Validation scores:
	RegressionAUROC: 0.6678566932678223
	RegressionCompetitionScore: 0.45540460720614295

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.166. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.42114589486119314
     Test RegressionAUROC            0.6793403625488281
Test RegressionCompetitionScore      0.42114589486119314
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:28:29,157][0m Trial 92 finished with value: 0.42114589486119314 and parameters: {'lr': 3.847218752639867e-05, 'dropout': 0.41284525836260244, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 8, 'dim_feedforward': 837, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 91 with value: 0.5705128205128205.[0m
Starting trial with params:
{'lr': 0.00010439784100688213, 'dropout': 0.4069578654817674, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 8, 'dim_feedforward': 798, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.6 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
2.5 M     Trainable params
57.6 K    Non-trainable params
2.6 M     Total params
10.319    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4375
	RegressionCompetitionScore: 0.15



Validation scores:
	RegressionAUROC: 0.5711337924003601
	RegressionCompetitionScore: 0.1269968051118211

Metric val_loss improved. New best score: 0.242


Validation scores:
	RegressionAUROC: 0.6956536769866943
	RegressionCompetitionScore: 0.2971246006389776

Metric val_loss improved by 0.033 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.7388216257095337
	RegressionCompetitionScore: 0.31309904153354634

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.7636942863464355
	RegressionCompetitionScore: 0.3722044728434505

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7640981674194336
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7661798000335693
	RegressionCompetitionScore: 0.31389776357827476



Validation scores:
	RegressionAUROC: 0.7746070027351379
	RegressionCompetitionScore: 0.44009584664536744



Validation scores:
	RegressionAUROC: 0.8073698282241821
	RegressionCompetitionScore: 0.43210862619808305



Validation scores:
	RegressionAUROC: 0.7717213034629822
	RegressionCompetitionScore: 0.39217252396166136



Validation scores:
	RegressionAUROC: 0.7634900808334351
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7992649078369141
	RegressionCompetitionScore: 0.39057507987220447

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.181. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3722044728434505
     Test RegressionAUROC            0.7636942863464355
Test RegressionCompetitionScore      0.3722044728434505
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:31:59,558][0m Trial 93 finished with value: 0.3722044728434505 and parameters: {'lr': 0.00010439784100688213, 'dropout': 0.4069578654817674, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 8, 'dim_feedforward': 798, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 91 with value: 0.5705128205128205.[0m
Starting trial with params:
{'lr': 4.5560869226673594e-05, 'dropout': 0.41230182915274866, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 8, 'dim_feedforward': 867, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.7 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
2.7 M     Trainable params
57.6 K    Non-trainable params
2.7 M     Total params
10.958    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5072463750839233
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.7015235424041748
	RegressionCompetitionScore: 0.10508757297748124

Metric val_loss improved. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6754547357559204
	RegressionCompetitionScore: 0.11009174311926606



Validation scores:
	RegressionAUROC: 0.707721471786499
	RegressionCompetitionScore: 0.371976647206005



Validation scores:
	RegressionAUROC: 0.7241238355636597
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7258068919181824
	RegressionCompetitionScore: 0.4078398665554629



Validation scores:
	RegressionAUROC: 0.7332947850227356
	RegressionCompetitionScore: 0.4286905754795663

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7558561563491821
	RegressionCompetitionScore: 0.4670558798999166

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7689440250396729
	RegressionCompetitionScore: 0.5145954962468724



Validation scores:
	RegressionAUROC: 0.7573758959770203
	RegressionCompetitionScore: 0.47039199332777315



Validation scores:
	RegressionAUROC: 0.704544186592102
	RegressionCompetitionScore: 0.3944954128440367



Validation scores:
	RegressionAUROC: 0.7656898498535156
	RegressionCompetitionScore: 0.46205170975813176



Validation scores:
	RegressionAUROC: 0.7661816477775574
	RegressionCompetitionScore: 0.4987489574645538



Validation scores:
	RegressionAUROC: 0.7604813575744629
	RegressionCompetitionScore: 0.4829024186822352



Validation scores:
	RegressionAUROC: 0.7652173042297363
	RegressionCompetitionScore: 0.48040033361134277

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.169. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4670558798999166
     Test RegressionAUROC            0.7558561563491821
Test RegressionCompetitionScore      0.4670558798999166
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:36:22,383][0m Trial 94 finished with value: 0.4670558798999166 and parameters: {'lr': 4.5560869226673594e-05, 'dropout': 0.41230182915274866, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 8, 'dim_feedforward': 867, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 91 with value: 0.5705128205128205.[0m
Starting trial with params:
{'lr': 0.00019345057234835563, 'dropout': 0.4319796855685859, 'd_model_multiplier': 64, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 873, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 14.1 M
1 | loss_fn | MSELoss | 0     
------------------------------------
13.9 M    Trainable params
230 K     Non-trainable params
14.1 M    Total params
56.491    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2958333194255829
	RegressionCompetitionScore: 0.1



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.649


Validation scores:
	RegressionAUROC: 0.7593998908996582
	RegressionCompetitionScore: 0.44028103044496486

Metric val_loss improved by 0.221 >= min_delta = 0.0. New best score: 0.428


Validation scores:
	RegressionAUROC: 0.7420662641525269
	RegressionCompetitionScore: 0.4012490241998439

Metric val_loss improved by 0.134 >= min_delta = 0.0. New best score: 0.294


Validation scores:
	RegressionAUROC: 0.7071359157562256
	RegressionCompetitionScore: 0.19672131147540983

Metric val_loss improved by 0.081 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.7641198635101318
	RegressionCompetitionScore: 0.15300546448087432



Validation scores:
	RegressionAUROC: 0.8004065752029419
	RegressionCompetitionScore: 0.3629976580796253



Validation scores:
	RegressionAUROC: 0.718474805355072
	RegressionCompetitionScore: 0.3153786104605777



Validation scores:
	RegressionAUROC: 0.7939653396606445
	RegressionCompetitionScore: 0.34270101483216237



Validation scores:
	RegressionAUROC: 0.7163348197937012
	RegressionCompetitionScore: 0.38953942232630756



Validation scores:
	RegressionAUROC: 0.7231394052505493
	RegressionCompetitionScore: 0.4137392661982826



Validation scores:
	RegressionAUROC: 0.7131282091140747
	RegressionCompetitionScore: 0.42857142857142855

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.213. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.19672131147540983
     Test RegressionAUROC            0.7071359157562256
Test RegressionCompetitionScore      0.19672131147540983
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:40:52,955][0m Trial 95 finished with value: 0.19672131147540983 and parameters: {'lr': 0.00019345057234835563, 'dropout': 0.4319796855685859, 'd_model_multiplier': 64, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 873, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 91 with value: 0.5705128205128205.[0m
Starting trial with params:
{'lr': 7.25834692143935e-05, 'dropout': 0.4105460241129731, 'd_model_multiplier': 16, 'num_layers': 8, 'n_heads': 8, 'dim_feedforward': 954, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.6 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
2.6 M     Trainable params
57.6 K    Non-trainable params
2.6 M     Total params
10.515    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.32083332538604736
	RegressionCompetitionScore: 0.05



Validation scores:
	RegressionAUROC: 0.7487286329269409
	RegressionCompetitionScore: 0.3299406276505513

Metric val_loss improved. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.6775990724563599
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6998780965805054
	RegressionCompetitionScore: 0.25190839694656486



Validation scores:
	RegressionAUROC: 0.7365691661834717
	RegressionCompetitionScore: 0.3240033927056828

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.723096489906311
	RegressionCompetitionScore: 0.3977947413061917



Validation scores:
	RegressionAUROC: 0.7306491136550903
	RegressionCompetitionScore: 0.3231552162849873



Validation scores:
	RegressionAUROC: 0.7153410911560059
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7494038343429565
	RegressionCompetitionScore: 0.37659033078880405



Validation scores:
	RegressionAUROC: 0.7361371517181396
	RegressionCompetitionScore: 0.3782866836301951



Validation scores:
	RegressionAUROC: 0.7102910280227661
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7416624426841736
	RegressionCompetitionScore: 0.3706530958439355

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3240033927056828
     Test RegressionAUROC            0.7365691661834717
Test RegressionCompetitionScore      0.3240033927056828
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:44:10,012][0m Trial 96 finished with value: 0.3240033927056828 and parameters: {'lr': 7.25834692143935e-05, 'dropout': 0.4105460241129731, 'd_model_multiplier': 16, 'num_layers': 8, 'n_heads': 8, 'dim_feedforward': 954, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 91 with value: 0.5705128205128205.[0m
Starting trial with params:
{'lr': 4.4624208478009526e-05, 'dropout': 0.4227040097797778, 'd_model_multiplier': 64, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 718, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 5.9 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
5.8 M     Trainable params
115 K     Non-trainable params
5.9 M     Total params
23.786    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5208333134651184
	RegressionCompetitionScore: 0.041666666666666664



Validation scores:
	RegressionAUROC: 0.7484930157661438
	RegressionCompetitionScore: 0.3590971272229822

Metric val_loss improved. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.7271836400032043
	RegressionCompetitionScore: 0.41928864569083446

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.7551051378250122
	RegressionCompetitionScore: 0.4172366621067031

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.7814866900444031
	RegressionCompetitionScore: 0.4466484268125855



Validation scores:
	RegressionAUROC: 0.7877591848373413
	RegressionCompetitionScore: 0.46443228454172364

Metric val_loss improved by 0.036 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.8024077415466309
	RegressionCompetitionScore: 0.4794801641586867



Validation scores:
	RegressionAUROC: 0.812669575214386
	RegressionCompetitionScore: 0.48632010943912446



Validation scores:
	RegressionAUROC: 0.807741641998291
	RegressionCompetitionScore: 0.5041039671682627



Validation scores:
	RegressionAUROC: 0.8149746656417847
	RegressionCompetitionScore: 0.5437756497948016



Validation scores:
	RegressionAUROC: 0.8120037317276001
	RegressionCompetitionScore: 0.47058823529411764



Validation scores:
	RegressionAUROC: 0.8228697776794434
	RegressionCompetitionScore: 0.5355677154582763

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.149


Validation scores:
	RegressionAUROC: 0.825098991394043
	RegressionCompetitionScore: 0.47537619699042405



Validation scores:
	RegressionAUROC: 0.815314769744873
	RegressionCompetitionScore: 0.47674418604651164



Validation scores:
	RegressionAUROC: 0.8237487077713013
	RegressionCompetitionScore: 0.5198358413132695



Validation scores:
	RegressionAUROC: 0.8141813278198242
	RegressionCompetitionScore: 0.493844049247606



Validation scores:
	RegressionAUROC: 0.8227871656417847
	RegressionCompetitionScore: 0.47674418604651164



Validation scores:
	RegressionAUROC: 0.8272464871406555
	RegressionCompetitionScore: 0.5465116279069767



Validation scores:
	RegressionAUROC: 0.8431636691093445
	RegressionCompetitionScore: 0.5403556771545828

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.149. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.5355677154582763
     Test RegressionAUROC            0.8228697776794434
Test RegressionCompetitionScore      0.5355677154582763
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:49:34,822][0m Trial 97 finished with value: 0.5355677154582763 and parameters: {'lr': 4.4624208478009526e-05, 'dropout': 0.4227040097797778, 'd_model_multiplier': 64, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 718, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 91 with value: 0.5705128205128205.[0m
Starting trial with params:
{'lr': 3.2701678917048405e-05, 'dropout': 0.40321762468606115, 'd_model_multiplier': 64, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 647, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 5.6 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
5.5 M     Trainable params
115 K     Non-trainable params
5.6 M     Total params
22.475    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3136363923549652
	RegressionCompetitionScore: 0.18181818181818182



Validation scores:
	RegressionAUROC: 0.6249206066131592
	RegressionCompetitionScore: 0.14381520119225039

Metric val_loss improved. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.6691412925720215
	RegressionCompetitionScore: 0.22131147540983606



Validation scores:
	RegressionAUROC: 0.7257004976272583
	RegressionCompetitionScore: 0.30700447093889716

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6322944164276123
	RegressionCompetitionScore: 0.22280178837555886



Validation scores:
	RegressionAUROC: 0.7164230942726135
	RegressionCompetitionScore: 0.29284649776453053



Validation scores:
	RegressionAUROC: 0.719221293926239
	RegressionCompetitionScore: 0.3144560357675112



Validation scores:
	RegressionAUROC: 0.7245901823043823
	RegressionCompetitionScore: 0.31594634873323396



Validation scores:
	RegressionAUROC: 0.7305532693862915
	RegressionCompetitionScore: 0.334575260804769



Validation scores:
	RegressionAUROC: 0.72529137134552
	RegressionCompetitionScore: 0.3502235469448584



Validation scores:
	RegressionAUROC: 0.7448070049285889
	RegressionCompetitionScore: 0.36363636363636365

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.204. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.30700447093889716
     Test RegressionAUROC            0.7257004976272583
Test RegressionCompetitionScore      0.30700447093889716
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:52:38,292][0m Trial 98 finished with value: 0.30700447093889716 and parameters: {'lr': 3.2701678917048405e-05, 'dropout': 0.40321762468606115, 'd_model_multiplier': 64, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 647, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 91 with value: 0.5705128205128205.[0m
Starting trial with params:
{'lr': 1.4394759365466278e-05, 'dropout': 0.4217214632617525, 'd_model_multiplier': 64, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 694, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/home/isears1/Repos/physionet2023/lightning_logs/version_9448279/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 6.5 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
6.3 M     Trainable params
115 K     Non-trainable params
6.5 M     Total params
25.825    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3490195870399475
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5323882699012756
	RegressionCompetitionScore: 0.027664768104149716

Metric val_loss improved. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.5539776086807251
	RegressionCompetitionScore: 0.0935720097640358

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5651792883872986
	RegressionCompetitionScore: 0.1529698942229455

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.56551194190979
	RegressionCompetitionScore: 0.1790073230268511



Validation scores:
	RegressionAUROC: 0.5716065168380737
	RegressionCompetitionScore: 0.19853539462978032



Validation scores:
	RegressionAUROC: 0.5802668333053589
	RegressionCompetitionScore: 0.26037428803905616



Validation scores:
	RegressionAUROC: 0.5944638252258301
	RegressionCompetitionScore: 0.21399511798209928



Validation scores:
	RegressionAUROC: 0.6239580512046814
	RegressionCompetitionScore: 0.23026851098454026



Validation scores:
	RegressionAUROC: 0.6168410778045654
	RegressionCompetitionScore: 0.23189585028478438

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6619700193405151
	RegressionCompetitionScore: 0.24735557363710334



Validation scores:
	RegressionAUROC: 0.6041715145111084
	RegressionCompetitionScore: 0.2082994304312449



Validation scores:
	RegressionAUROC: 0.5976159572601318
	RegressionCompetitionScore: 0.20260374288039057



Validation scores:
	RegressionAUROC: 0.6119776964187622
	RegressionCompetitionScore: 0.21806346623270953



Validation scores:
	RegressionAUROC: 0.6063961982727051
	RegressionCompetitionScore: 0.20748576078112285



Validation scores:
	RegressionAUROC: 0.6197199821472168
	RegressionCompetitionScore: 0.22213181448331978



Validation scores:
	RegressionAUROC: 0.6395865678787231
	RegressionCompetitionScore: 0.23515052888527258

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.191. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.23189585028478438
     Test RegressionAUROC            0.6168410778045654
Test RegressionCompetitionScore      0.23189585028478438
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 05:57:40,095][0m Trial 99 finished with value: 0.23189585028478438 and parameters: {'lr': 1.4394759365466278e-05, 'dropout': 0.4217214632617525, 'd_model_multiplier': 64, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 694, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 91 with value: 0.5705128205128205.[0m
Best trial:
  Value: 0.5705128205128205
  Params: 
    lr: 3.44516749516897e-05
    dropout: 0.41267074039556045
    d_model_multiplier: 16
    num_layers: 9
    n_heads: 8
    dim_feedforward: 886
    batch_size: 16
    pos_encoding: fixed
    activation: gelu
    norm: LayerNorm
    optimizer_name: AdamW
    weight_decay: 0.001
