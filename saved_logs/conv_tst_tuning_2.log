## SLURM PROLOG ###############################################################
##    Job ID : 9453124
##  Job Name : tune.sh
##  Nodelist : gpu2001
##      CPUs : 1
##  Mem/Node : 32768 MB
## Directory : /gpfs/home/isears1/Repos/physionet2023
##   Job Started : Mon Apr  3 10:52:58 EDT 2023
###############################################################################
[32m[I 2023-04-03 10:53:13,511][0m A new study created in memory with name: no-name-fb9ba038-d2b4-464c-95fd-07da84245936[0m
Starting trial with params:
{'lr': 0.009499686058717571, 'dropout': 0.7480445867412935, 'd_model_multiplier': 32, 'num_layers': 11, 'n_heads': 4, 'dim_feedforward': 353, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.9 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.8 M     Trainable params
57.6 K    Non-trainable params
1.9 M     Total params
7.461     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 2.704


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 2.704. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 10:57:23,720][0m Trial 0 finished with value: 0.0 and parameters: {'lr': 0.009499686058717571, 'dropout': 0.7480445867412935, 'd_model_multiplier': 32, 'num_layers': 11, 'n_heads': 4, 'dim_feedforward': 353, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 0 with value: 0.0.[0m
Starting trial with params:
{'lr': 2.2024039332021423e-06, 'dropout': 0.659951804083627, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 64, 'dim_feedforward': 498, 'batch_size': 512, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 63.6 M
1 | loss_fn | MSELoss | 0     
------------------------------------
63.2 M    Trainable params
460 K     Non-trainable params
63.6 M    Total params
254.577   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4637680649757385
	RegressionCompetitionScore: 0.0

[WARNING] OOM for trial with params {'lr': 2.2024039332021423e-06, 'dropout': 0.659951804083627, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 64, 'dim_feedforward': 498, 'batch_size': 512, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
[32m[I 2023-04-03 10:57:32,805][0m Trial 1 finished with value: 0.0 and parameters: {'lr': 2.2024039332021423e-06, 'dropout': 0.659951804083627, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 64, 'dim_feedforward': 498, 'batch_size': 512, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 0 with value: 0.0.[0m
Starting trial with params:
{'lr': 1.9981225777104726e-06, 'dropout': 0.6463520608599039, 'd_model_multiplier': 32, 'num_layers': 11, 'n_heads': 64, 'dim_feedforward': 810, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 223 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
222 M     Trainable params
921 K     Non-trainable params
223 M     Total params
892.619   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5870383977890015
	RegressionCompetitionScore: 0.20705521472392638

Metric val_loss improved. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.6565840244293213
	RegressionCompetitionScore: 0.2549079754601227



Validation scores:
	RegressionAUROC: 0.660733699798584
	RegressionCompetitionScore: 0.29233128834355826



Validation scores:
	RegressionAUROC: 0.6562719941139221
	RegressionCompetitionScore: 0.18987730061349692



Validation scores:
	RegressionAUROC: 0.6709277033805847
	RegressionCompetitionScore: 0.2420245398773006



Validation scores:
	RegressionAUROC: 0.6718788146972656
	RegressionCompetitionScore: 0.25306748466257667



Validation scores:
	RegressionAUROC: 0.6732692122459412
	RegressionCompetitionScore: 0.3098159509202454



Validation scores:
	RegressionAUROC: 0.6666485667228699
	RegressionCompetitionScore: 0.3128834355828221

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.229. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.20705521472392638
     Test RegressionAUROC            0.5870383977890015
Test RegressionCompetitionScore      0.20705521472392638
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 11:38:32,283][0m Trial 2 finished with value: 0.20705521472392638 and parameters: {'lr': 1.9981225777104726e-06, 'dropout': 0.6463520608599039, 'd_model_multiplier': 32, 'num_layers': 11, 'n_heads': 64, 'dim_feedforward': 810, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}. Best is trial 2 with value: 0.20705521472392638.[0m
Starting trial with params:
{'lr': 9.261612776626699e-05, 'dropout': 0.8920535625611703, 'd_model_multiplier': 64, 'num_layers': 8, 'n_heads': 64, 'dim_feedforward': 920, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 601 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
601 M     Trainable params
0         Non-trainable params
601 M     Total params
2,404.987 Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6666667461395264
	RegressionCompetitionScore: 0.34782608695652173

[WARNING] OOM for trial with params {'lr': 9.261612776626699e-05, 'dropout': 0.8920535625611703, 'd_model_multiplier': 64, 'num_layers': 8, 'n_heads': 64, 'dim_feedforward': 920, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
[32m[I 2023-04-03 11:38:45,333][0m Trial 3 finished with value: 0.0 and parameters: {'lr': 9.261612776626699e-05, 'dropout': 0.8920535625611703, 'd_model_multiplier': 64, 'num_layers': 8, 'n_heads': 64, 'dim_feedforward': 920, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 2 with value: 0.20705521472392638.[0m
Starting trial with params:
{'lr': 0.03980831411234062, 'dropout': 0.528289321005462, 'd_model_multiplier': 32, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 238, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 66.6 M
1 | loss_fn | MSELoss | 0     
------------------------------------
66.6 M    Trainable params
0         Non-trainable params
66.6 M    Total params
266.535   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5386473536491394
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 83175456.000


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 64491200.000 >= min_delta = 0.0. New best score: 18684256.000


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 13333191.000 >= min_delta = 0.0. New best score: 5351065.000


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 2295087.000 >= min_delta = 0.0. New best score: 3055978.000


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 720652.750 >= min_delta = 0.0. New best score: 2335325.250


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 2332578.000 >= min_delta = 0.0. New best score: 2747.266


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 2747.266. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 12:09:58,488][0m Trial 4 finished with value: 0.0 and parameters: {'lr': 0.03980831411234062, 'dropout': 0.528289321005462, 'd_model_multiplier': 32, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 238, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 2 with value: 0.20705521472392638.[0m
Starting trial with params:
{'lr': 7.073562623252219e-06, 'dropout': 0.7150310904562214, 'd_model_multiplier': 8, 'num_layers': 5, 'n_heads': 4, 'dim_feedforward': 907, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 362 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
347 K     Trainable params
14.4 K    Non-trainable params
362 K     Total params
1.449     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4999206066131592
	RegressionCompetitionScore: 0.0834355828220859

Metric val_loss improved. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.5115290880203247
	RegressionCompetitionScore: 0.08987730061349693

Metric val_loss improved by 0.033 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5291193127632141
	RegressionCompetitionScore: 0.10368098159509202



Validation scores:
	RegressionAUROC: 0.5368075370788574
	RegressionCompetitionScore: 0.11196319018404909



Validation scores:
	RegressionAUROC: 0.5489560961723328
	RegressionCompetitionScore: 0.11687116564417178



Validation scores:
	RegressionAUROC: 0.5656690001487732
	RegressionCompetitionScore: 0.14079754601226993



Validation scores:
	RegressionAUROC: 0.5679913759231567
	RegressionCompetitionScore: 0.14478527607361963



Validation scores:
	RegressionAUROC: 0.5699812769889832
	RegressionCompetitionScore: 0.14539877300613496



Validation scores:
	RegressionAUROC: 0.5765112638473511
	RegressionCompetitionScore: 0.14785276073619633

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.218. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.08987730061349693
     Test RegressionAUROC            0.5115290880203247
Test RegressionCompetitionScore      0.08987730061349693
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 12:13:54,764][0m Trial 5 finished with value: 0.08987730061349693 and parameters: {'lr': 7.073562623252219e-06, 'dropout': 0.7150310904562214, 'd_model_multiplier': 8, 'num_layers': 5, 'n_heads': 4, 'dim_feedforward': 907, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 2 with value: 0.20705521472392638.[0m
Starting trial with params:
{'lr': 0.005958674405049946, 'dropout': 0.8204890849279105, 'd_model_multiplier': 1, 'num_layers': 8, 'n_heads': 16, 'dim_feedforward': 925, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 284 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
284 K     Trainable params
0         Non-trainable params
284 K     Total params
1.138     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.36231884360313416
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.001


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5259496569633484
	RegressionCompetitionScore: 0.06503067484662577

Metric val_loss improved by 0.787 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.4631210267543793
	RegressionCompetitionScore: 0.09325153374233129



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.214. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.06503067484662577
     Test RegressionAUROC            0.5259496569633484
Test RegressionCompetitionScore      0.06503067484662577
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 12:19:00,031][0m Trial 6 finished with value: 0.06503067484662577 and parameters: {'lr': 0.005958674405049946, 'dropout': 0.8204890849279105, 'd_model_multiplier': 1, 'num_layers': 8, 'n_heads': 16, 'dim_feedforward': 925, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 2 with value: 0.20705521472392638.[0m
Starting trial with params:
{'lr': 5.110083063157264e-05, 'dropout': 0.7649701353410387, 'd_model_multiplier': 16, 'num_layers': 7, 'n_heads': 4, 'dim_feedforward': 103, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 286 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
257 K     Trainable params
28.8 K    Non-trainable params
286 K     Total params
1.147     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5625
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6081438064575195
	RegressionCompetitionScore: 0.2134969325153374

Metric val_loss improved. New best score: 0.440


Validation scores:
	RegressionAUROC: 0.5725575089454651
	RegressionCompetitionScore: 0.15920245398773006

Metric val_loss improved by 0.051 >= min_delta = 0.0. New best score: 0.389


Validation scores:
	RegressionAUROC: 0.5891914367675781
	RegressionCompetitionScore: 0.2058282208588957

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.352


Validation scores:
	RegressionAUROC: 0.600236177444458
	RegressionCompetitionScore: 0.24662576687116564

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.337


Validation scores:
	RegressionAUROC: 0.5952495336532593
	RegressionCompetitionScore: 0.22208588957055214

Metric val_loss improved by 0.042 >= min_delta = 0.0. New best score: 0.295


Validation scores:
	RegressionAUROC: 0.601926863193512
	RegressionCompetitionScore: 0.2432515337423313

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.279


Validation scores:
	RegressionAUROC: 0.49060559272766113
	RegressionCompetitionScore: 0.09601226993865031



Validation scores:
	RegressionAUROC: 0.472696453332901
	RegressionCompetitionScore: 0.06993865030674846



Validation scores:
	RegressionAUROC: 0.46425849199295044
	RegressionCompetitionScore: 0.06349693251533742

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.277


Validation scores:
	RegressionAUROC: 0.5241543054580688
	RegressionCompetitionScore: 0.09601226993865031

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.266


Validation scores:
	RegressionAUROC: 0.611220121383667
	RegressionCompetitionScore: 0.19969325153374234

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.263


Validation scores:
	RegressionAUROC: 0.6019306182861328
	RegressionCompetitionScore: 0.18220858895705522

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.249


Validation scores:
	RegressionAUROC: 0.5802300572395325
	RegressionCompetitionScore: 0.1530674846625767



Validation scores:
	RegressionAUROC: 0.6043620705604553
	RegressionCompetitionScore: 0.20797546012269938



Validation scores:
	RegressionAUROC: 0.5818573236465454
	RegressionCompetitionScore: 0.14355828220858896



Validation scores:
	RegressionAUROC: 0.588904082775116
	RegressionCompetitionScore: 0.20030674846625768



Validation scores:
	RegressionAUROC: 0.5874280333518982
	RegressionCompetitionScore: 0.15766871165644172



Validation scores:
	RegressionAUROC: 0.5738645792007446
	RegressionCompetitionScore: 0.19355828220858895



Validation scores:
	RegressionAUROC: 0.5668699741363525
	RegressionCompetitionScore: 0.19294478527607362

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.249. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.18220858895705522
     Test RegressionAUROC            0.6019306182861328
Test RegressionCompetitionScore      0.18220858895705522
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 12:27:59,982][0m Trial 7 finished with value: 0.18220858895705522 and parameters: {'lr': 5.110083063157264e-05, 'dropout': 0.7649701353410387, 'd_model_multiplier': 16, 'num_layers': 7, 'n_heads': 4, 'dim_feedforward': 103, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}. Best is trial 2 with value: 0.20705521472392638.[0m
Starting trial with params:
{'lr': 1.7057890685961063e-07, 'dropout': 0.6684011978445488, 'd_model_multiplier': 32, 'num_layers': 1, 'n_heads': 4, 'dim_feedforward': 982, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 452 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
395 K     Trainable params
57.6 K    Non-trainable params
452 K     Total params
1.812     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.39371979236602783
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.468901127576828
	RegressionCompetitionScore: 0.0736196319018405

Metric val_loss improved. New best score: 0.494


Validation scores:
	RegressionAUROC: 0.4946339428424835
	RegressionCompetitionScore: 0.09325153374233129

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.474


Validation scores:
	RegressionAUROC: 0.4967212677001953
	RegressionCompetitionScore: 0.09478527607361963

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.465


Validation scores:
	RegressionAUROC: 0.5006937980651855
	RegressionCompetitionScore: 0.09294478527607362

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.452


Validation scores:
	RegressionAUROC: 0.506354570388794
	RegressionCompetitionScore: 0.09785276073619632

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.450


Validation scores:
	RegressionAUROC: 0.5030702352523804
	RegressionCompetitionScore: 0.09662576687116564

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.447


Validation scores:
	RegressionAUROC: 0.497303307056427
	RegressionCompetitionScore: 0.09171779141104294



Validation scores:
	RegressionAUROC: 0.48600202798843384
	RegressionCompetitionScore: 0.08742331288343558



Validation scores:
	RegressionAUROC: 0.5028537511825562
	RegressionCompetitionScore: 0.09631901840490797

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.447


Validation scores:
	RegressionAUROC: 0.5038420557975769
	RegressionCompetitionScore: 0.0950920245398773

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.447


Validation scores:
	RegressionAUROC: 0.48002123832702637
	RegressionCompetitionScore: 0.0794478527607362



Validation scores:
	RegressionAUROC: 0.4997180104255676
	RegressionCompetitionScore: 0.09355828220858896



Validation scores:
	RegressionAUROC: 0.4967939853668213
	RegressionCompetitionScore: 0.08865030674846626

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.445


Validation scores:
	RegressionAUROC: 0.5092579126358032
	RegressionCompetitionScore: 0.09539877300613497

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.437


Validation scores:
	RegressionAUROC: 0.5137330293655396
	RegressionCompetitionScore: 0.1

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.436


Validation scores:
	RegressionAUROC: 0.5049439668655396
	RegressionCompetitionScore: 0.09570552147239264



Validation scores:
	RegressionAUROC: 0.500349223613739
	RegressionCompetitionScore: 0.09202453987730061



Validation scores:
	RegressionAUROC: 0.494276762008667
	RegressionCompetitionScore: 0.09079754601226994



Validation scores:
	RegressionAUROC: 0.5047755241394043
	RegressionCompetitionScore: 0.09325153374233129



Validation scores:
	RegressionAUROC: 0.5077473521232605
	RegressionCompetitionScore: 0.09478527607361963



Validation scores:
	RegressionAUROC: 0.478836327791214
	RegressionCompetitionScore: 0.08098159509202454



Validation scores:
	RegressionAUROC: 0.5029754638671875
	RegressionCompetitionScore: 0.09141104294478528

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.436. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.1
     Test RegressionAUROC            0.5137330293655396
Test RegressionCompetitionScore              0.1
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 12:36:56,328][0m Trial 8 finished with value: 0.1 and parameters: {'lr': 1.7057890685961063e-07, 'dropout': 0.6684011978445488, 'd_model_multiplier': 32, 'num_layers': 1, 'n_heads': 4, 'dim_feedforward': 982, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 2 with value: 0.20705521472392638.[0m
Starting trial with params:
{'lr': 0.015735880652470377, 'dropout': 0.6073412873655353, 'd_model_multiplier': 64, 'num_layers': 1, 'n_heads': 4, 'dim_feedforward': 614, 'batch_size': 1024, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 830 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
715 K     Trainable params
115 K     Non-trainable params
830 K     Total params
3.324     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.260869562625885
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 201910.719


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 181146.938 >= min_delta = 0.0. New best score: 20763.775


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 10998.139 >= min_delta = 0.0. New best score: 9765.637


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 9156.047 >= min_delta = 0.0. New best score: 609.590


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 609.590. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 12:42:46,812][0m Trial 9 finished with value: 0.0 and parameters: {'lr': 0.015735880652470377, 'dropout': 0.6073412873655353, 'd_model_multiplier': 64, 'num_layers': 1, 'n_heads': 4, 'dim_feedforward': 614, 'batch_size': 1024, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 2 with value: 0.20705521472392638.[0m
Starting trial with params:
{'lr': 1.1712469690883585e-07, 'dropout': 0.41467156776526437, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 8, 'dim_feedforward': 683, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 362 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
362 K     Trainable params
0         Non-trainable params
362 K     Total params
1.451     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.1458333283662796
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.43425339460372925
	RegressionCompetitionScore: 0.049079754601226995

Metric val_loss improved. New best score: 0.223


Validation scores:
	RegressionAUROC: 0.43443530797958374
	RegressionCompetitionScore: 0.049079754601226995

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.223


Validation scores:
	RegressionAUROC: 0.4346380829811096
	RegressionCompetitionScore: 0.049079754601226995



Validation scores:
	RegressionAUROC: 0.43492287397384644
	RegressionCompetitionScore: 0.048466257668711654



Validation scores:
	RegressionAUROC: 0.4351208806037903
	RegressionCompetitionScore: 0.04877300613496933

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.223


Validation scores:
	RegressionAUROC: 0.4353260397911072
	RegressionCompetitionScore: 0.049079754601226995

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.43541187047958374
	RegressionCompetitionScore: 0.049079754601226995

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.4355854094028473
	RegressionCompetitionScore: 0.048466257668711654

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.43582624197006226
	RegressionCompetitionScore: 0.048466257668711654

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.4359612464904785
	RegressionCompetitionScore: 0.048466257668711654



Validation scores:
	RegressionAUROC: 0.4361909329891205
	RegressionCompetitionScore: 0.048466257668711654

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.43647271394729614
	RegressionCompetitionScore: 0.048466257668711654



Validation scores:
	RegressionAUROC: 0.4367913007736206
	RegressionCompetitionScore: 0.048466257668711654



Validation scores:
	RegressionAUROC: 0.43702971935272217
	RegressionCompetitionScore: 0.048466257668711654



Validation scores:
	RegressionAUROC: 0.43721669912338257
	RegressionCompetitionScore: 0.048466257668711654



Validation scores:
	RegressionAUROC: 0.4373741149902344
	RegressionCompetitionScore: 0.048466257668711654

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.4376489818096161
	RegressionCompetitionScore: 0.048466257668711654

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.4379303455352783
	RegressionCompetitionScore: 0.04815950920245399

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.4381701648235321
	RegressionCompetitionScore: 0.04815950920245399

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.4383421838283539
	RegressionCompetitionScore: 0.048466257668711654

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.4386023283004761
	RegressionCompetitionScore: 0.048466257668711654

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.4388422966003418
	RegressionCompetitionScore: 0.04815950920245399



Validation scores:
	RegressionAUROC: 0.43920212984085083
	RegressionCompetitionScore: 0.04785276073619632



Validation scores:
	RegressionAUROC: 0.439444899559021
	RegressionCompetitionScore: 0.04815950920245399



Validation scores:
	RegressionAUROC: 0.43977466225624084
	RegressionCompetitionScore: 0.048466257668711654



Validation scores:
	RegressionAUROC: 0.4400680661201477
	RegressionCompetitionScore: 0.048466257668711654

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.44022679328918457
	RegressionCompetitionScore: 0.049079754601226995

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.44047003984451294
	RegressionCompetitionScore: 0.04938650306748466

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.44050705432891846
	RegressionCompetitionScore: 0.04938650306748466

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.44057536125183105
	RegressionCompetitionScore: 0.05



Validation scores:
	RegressionAUROC: 0.4409686326980591
	RegressionCompetitionScore: 0.04938650306748466

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.4413222074508667
	RegressionCompetitionScore: 0.04938650306748466



Validation scores:
	RegressionAUROC: 0.44171202182769775
	RegressionCompetitionScore: 0.049079754601226995



Validation scores:
	RegressionAUROC: 0.44199109077453613
	RegressionCompetitionScore: 0.04938650306748466



Validation scores:
	RegressionAUROC: 0.4423138499259949
	RegressionCompetitionScore: 0.04938650306748466



Validation scores:
	RegressionAUROC: 0.44239670038223267
	RegressionCompetitionScore: 0.04938650306748466



Validation scores:
	RegressionAUROC: 0.44261619448661804
	RegressionCompetitionScore: 0.05

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.4428243637084961
	RegressionCompetitionScore: 0.05030674846625767

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.4430280923843384
	RegressionCompetitionScore: 0.050920245398773004

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.4431777000427246
	RegressionCompetitionScore: 0.050920245398773004

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.44348666071891785
	RegressionCompetitionScore: 0.050920245398773004

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.44386303424835205
	RegressionCompetitionScore: 0.05030674846625767



Validation scores:
	RegressionAUROC: 0.44418206810951233
	RegressionCompetitionScore: 0.05



Validation scores:
	RegressionAUROC: 0.44453269243240356
	RegressionCompetitionScore: 0.05



Validation scores:
	RegressionAUROC: 0.4447689652442932
	RegressionCompetitionScore: 0.05



Validation scores:
	RegressionAUROC: 0.44514626264572144
	RegressionCompetitionScore: 0.05030674846625767



Validation scores:
	RegressionAUROC: 0.44543594121932983
	RegressionCompetitionScore: 0.05061349693251534



Validation scores:
	RegressionAUROC: 0.44564270973205566
	RegressionCompetitionScore: 0.05122699386503068

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.4457688331604004
	RegressionCompetitionScore: 0.05122699386503068

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.4458881616592407
	RegressionCompetitionScore: 0.05122699386503068

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.215
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.05122699386503068
     Test RegressionAUROC            0.4458881616592407
Test RegressionCompetitionScore      0.05122699386503068
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 13:09:01,382][0m Trial 10 finished with value: 0.05122699386503068 and parameters: {'lr': 1.1712469690883585e-07, 'dropout': 0.41467156776526437, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 8, 'dim_feedforward': 683, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 2 with value: 0.20705521472392638.[0m
Starting trial with params:
{'lr': 8.470791428715898e-05, 'dropout': 0.7765326655021307, 'd_model_multiplier': 4, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 65, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.9 M     Trainable params
115 K     Non-trainable params
2.0 M     Total params
8.153     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5983803272247314
	RegressionCompetitionScore: 0.24049079754601227

Metric val_loss improved. New best score: 0.290


Validation scores:
	RegressionAUROC: 0.5629873275756836
	RegressionCompetitionScore: 0.16012269938650306

Metric val_loss improved by 0.068 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.5708396434783936
	RegressionCompetitionScore: 0.19325153374233128

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.6047182679176331
	RegressionCompetitionScore: 0.2598159509202454

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5367604494094849
	RegressionCompetitionScore: 0.13159509202453987

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5286827087402344
	RegressionCompetitionScore: 0.1254601226993865



Validation scores:
	RegressionAUROC: 0.5762788653373718
	RegressionCompetitionScore: 0.11717791411042945



Validation scores:
	RegressionAUROC: 0.5958910584449768
	RegressionCompetitionScore: 0.24386503067484663



Validation scores:
	RegressionAUROC: 0.5892689824104309
	RegressionCompetitionScore: 0.20705521472392638



Validation scores:
	RegressionAUROC: 0.5895430445671082
	RegressionCompetitionScore: 0.21993865030674847



Validation scores:
	RegressionAUROC: 0.5935415029525757
	RegressionCompetitionScore: 0.20644171779141104



Validation scores:
	RegressionAUROC: 0.591323733329773
	RegressionCompetitionScore: 0.21871165644171778

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.13159509202453987
     Test RegressionAUROC            0.5367604494094849
Test RegressionCompetitionScore      0.13159509202453987
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 13:21:08,504][0m Trial 11 finished with value: 0.13159509202453987 and parameters: {'lr': 8.470791428715898e-05, 'dropout': 0.7765326655021307, 'd_model_multiplier': 4, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 65, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}. Best is trial 2 with value: 0.20705521472392638.[0m
Starting trial with params:
{'lr': 6.792472663930524e-06, 'dropout': 0.5955353593687781, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 769, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 6.8 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
6.7 M     Trainable params
115 K     Non-trainable params
6.8 M     Total params
27.364    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5833333134651184
	RegressionCompetitionScore: 0.16666666666666666



Validation scores:
	RegressionAUROC: 0.5359017848968506
	RegressionCompetitionScore: 0.11993865030674847

Metric val_loss improved. New best score: 0.254


Validation scores:
	RegressionAUROC: 0.5731137990951538
	RegressionCompetitionScore: 0.17515337423312882



Validation scores:
	RegressionAUROC: 0.5981776118278503
	RegressionCompetitionScore: 0.21809815950920244

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.4959094524383545
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6093069314956665
	RegressionCompetitionScore: 0.19355828220858895

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.520573616027832
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6148717403411865
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.591326892375946
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6283859014511108
	RegressionCompetitionScore: 0.26012269938650306



Validation scores:
	RegressionAUROC: 0.6295183300971985
	RegressionCompetitionScore: 0.26533742331288346

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.6256470680236816
	RegressionCompetitionScore: 0.2549079754601227

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6267672777175903
	RegressionCompetitionScore: 0.27177914110429446



Validation scores:
	RegressionAUROC: 0.5939822196960449
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5178409218788147
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5484190583229065
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5840072631835938
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6045489311218262
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6304614543914795
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.204. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2549079754601227
     Test RegressionAUROC            0.6256470680236816
Test RegressionCompetitionScore      0.2549079754601227
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 13:33:11,868][0m Trial 12 finished with value: 0.2549079754601227 and parameters: {'lr': 6.792472663930524e-06, 'dropout': 0.5955353593687781, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 769, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}. Best is trial 12 with value: 0.2549079754601227.[0m
Starting trial with params:
{'lr': 2.262222690264046e-06, 'dropout': 0.5731709217504066, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 16, 'dim_feedforward': 733, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 7.3 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
7.2 M     Trainable params
115 K     Non-trainable params
7.3 M     Total params
29.187    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.45410627126693726
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5554025173187256
	RegressionCompetitionScore: 0.1361963190184049

Metric val_loss improved. New best score: 0.327


Validation scores:
	RegressionAUROC: 0.5680620670318604
	RegressionCompetitionScore: 0.15828220858895706

Metric val_loss improved by 0.070 >= min_delta = 0.0. New best score: 0.257


Validation scores:
	RegressionAUROC: 0.5674751996994019
	RegressionCompetitionScore: 0.15184049079754602

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.241


Validation scores:
	RegressionAUROC: 0.5767607688903809
	RegressionCompetitionScore: 0.15766871165644172

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5711513757705688
	RegressionCompetitionScore: 0.1441717791411043



Validation scores:
	RegressionAUROC: 0.5917912721633911
	RegressionCompetitionScore: 0.17668711656441718



Validation scores:
	RegressionAUROC: 0.5953469276428223
	RegressionCompetitionScore: 0.18742331288343558

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.615039587020874
	RegressionCompetitionScore: 0.2098159509202454

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6214950680732727
	RegressionCompetitionScore: 0.20337423312883435



Validation scores:
	RegressionAUROC: 0.6299031376838684
	RegressionCompetitionScore: 0.2273006134969325

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6194279193878174
	RegressionCompetitionScore: 0.23067484662576687



Validation scores:
	RegressionAUROC: 0.6372746229171753
	RegressionCompetitionScore: 0.24141104294478527



Validation scores:
	RegressionAUROC: 0.6385475397109985
	RegressionCompetitionScore: 0.24631901840490797

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6401619911193848
	RegressionCompetitionScore: 0.23957055214723927



Validation scores:
	RegressionAUROC: 0.6405444145202637
	RegressionCompetitionScore: 0.22883435582822087

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6474004983901978
	RegressionCompetitionScore: 0.2392638036809816



Validation scores:
	RegressionAUROC: 0.6493313312530518
	RegressionCompetitionScore: 0.24938650306748467



Validation scores:
	RegressionAUROC: 0.6525511145591736
	RegressionCompetitionScore: 0.25828220858895706



Validation scores:
	RegressionAUROC: 0.6565800905227661
	RegressionCompetitionScore: 0.25030674846625767

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6601711511611938
	RegressionCompetitionScore: 0.2588957055214724

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.642991304397583
	RegressionCompetitionScore: 0.2656441717791411



Validation scores:
	RegressionAUROC: 0.6546807289123535
	RegressionCompetitionScore: 0.26411042944785273



Validation scores:
	RegressionAUROC: 0.6576073169708252
	RegressionCompetitionScore: 0.26380368098159507



Validation scores:
	RegressionAUROC: 0.6576476097106934
	RegressionCompetitionScore: 0.25766871165644173



Validation scores:
	RegressionAUROC: 0.6536354422569275
	RegressionCompetitionScore: 0.25



Validation scores:
	RegressionAUROC: 0.6586465835571289
	RegressionCompetitionScore: 0.25429447852760734



Validation scores:
	RegressionAUROC: 0.6563472151756287
	RegressionCompetitionScore: 0.2665644171779141

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6561499834060669
	RegressionCompetitionScore: 0.2745398773006135

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.66015625
	RegressionCompetitionScore: 0.2674846625766871



Validation scores:
	RegressionAUROC: 0.6625581383705139
	RegressionCompetitionScore: 0.27791411042944786

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6516458988189697
	RegressionCompetitionScore: 0.2831288343558282



Validation scores:
	RegressionAUROC: 0.6580984592437744
	RegressionCompetitionScore: 0.27361963190184047



Validation scores:
	RegressionAUROC: 0.6607223749160767
	RegressionCompetitionScore: 0.2748466257668712



Validation scores:
	RegressionAUROC: 0.6597609519958496
	RegressionCompetitionScore: 0.27269938650306746



Validation scores:
	RegressionAUROC: 0.6561201810836792
	RegressionCompetitionScore: 0.26901840490797546



Validation scores:
	RegressionAUROC: 0.6637076139450073
	RegressionCompetitionScore: 0.2757668711656442



Validation scores:
	RegressionAUROC: 0.6647434234619141
	RegressionCompetitionScore: 0.2831288343558282

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6623989343643188
	RegressionCompetitionScore: 0.2803680981595092



Validation scores:
	RegressionAUROC: 0.6685858368873596
	RegressionCompetitionScore: 0.2733128834355828



Validation scores:
	RegressionAUROC: 0.6689436435699463
	RegressionCompetitionScore: 0.2800613496932515

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.6583437919616699
	RegressionCompetitionScore: 0.28190184049079753



Validation scores:
	RegressionAUROC: 0.6622976064682007
	RegressionCompetitionScore: 0.2748466257668712



Validation scores:
	RegressionAUROC: 0.6656152009963989
	RegressionCompetitionScore: 0.2889570552147239



Validation scores:
	RegressionAUROC: 0.662010669708252
	RegressionCompetitionScore: 0.2748466257668712



Validation scores:
	RegressionAUROC: 0.6605648994445801
	RegressionCompetitionScore: 0.26993865030674846



Validation scores:
	RegressionAUROC: 0.6665714383125305
	RegressionCompetitionScore: 0.27975460122699386



Validation scores:
	RegressionAUROC: 0.6731814742088318
	RegressionCompetitionScore: 0.2665644171779141

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.190. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2800613496932515
     Test RegressionAUROC            0.6689436435699463
Test RegressionCompetitionScore      0.2800613496932515
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 14:03:06,686][0m Trial 13 finished with value: 0.2800613496932515 and parameters: {'lr': 2.262222690264046e-06, 'dropout': 0.5731709217504066, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 16, 'dim_feedforward': 733, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}. Best is trial 13 with value: 0.2800613496932515.[0m
Starting trial with params:
{'lr': 0.0008907098036109428, 'dropout': 0.5708717419925297, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 16, 'dim_feedforward': 730, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 7.3 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
7.2 M     Trainable params
115 K     Non-trainable params
7.3 M     Total params
29.119    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5420585870742798
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.352


Validation scores:
	RegressionAUROC: 0.566095232963562
	RegressionCompetitionScore: 0.2098159509202454

Metric val_loss improved by 0.083 >= min_delta = 0.0. New best score: 0.270


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6714228391647339
	RegressionCompetitionScore: 0.18711656441717792

Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4992331266403198
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.47494831681251526
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6141071319580078
	RegressionCompetitionScore: 0.27392638036809813



Validation scores:
	RegressionAUROC: 0.6146969795227051
	RegressionCompetitionScore: 0.2674846625766871



Validation scores:
	RegressionAUROC: 0.551053524017334
	RegressionCompetitionScore: 0.15644171779141106

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4959409236907959
	RegressionCompetitionScore: 0.1361963190184049

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.218. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.15644171779141106
     Test RegressionAUROC             0.551053524017334
Test RegressionCompetitionScore      0.15644171779141106
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 14:14:49,139][0m Trial 14 finished with value: 0.15644171779141106 and parameters: {'lr': 0.0008907098036109428, 'dropout': 0.5708717419925297, 'd_model_multiplier': 16, 'num_layers': 11, 'n_heads': 16, 'dim_feedforward': 730, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}. Best is trial 13 with value: 0.2800613496932515.[0m
Starting trial with params:
{'lr': 1.1055493841088379e-05, 'dropout': 0.5196130514529055, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 509, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 5.5 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
5.4 M     Trainable params
115 K     Non-trainable params
5.5 M     Total params
22.029    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5807068943977356
	RegressionCompetitionScore: 0.13895705521472393

Metric val_loss improved. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.6209399104118347
	RegressionCompetitionScore: 0.21441717791411044



Validation scores:
	RegressionAUROC: 0.6356818079948425
	RegressionCompetitionScore: 0.18558282208588958

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.6463167071342468
	RegressionCompetitionScore: 0.20613496932515338

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.223


Validation scores:
	RegressionAUROC: 0.6527459621429443
	RegressionCompetitionScore: 0.18865030674846625



Validation scores:
	RegressionAUROC: 0.657798171043396
	RegressionCompetitionScore: 0.17300613496932515



Validation scores:
	RegressionAUROC: 0.679755449295044
	RegressionCompetitionScore: 0.2147239263803681



Validation scores:
	RegressionAUROC: 0.6811224222183228
	RegressionCompetitionScore: 0.21196319018404908



Validation scores:
	RegressionAUROC: 0.6757389307022095
	RegressionCompetitionScore: 0.2285276073619632



Validation scores:
	RegressionAUROC: 0.6948182582855225
	RegressionCompetitionScore: 0.27208588957055213

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.696053683757782
	RegressionCompetitionScore: 0.3159509202453988



Validation scores:
	RegressionAUROC: 0.6916729211807251
	RegressionCompetitionScore: 0.21932515337423314

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6770294904708862
	RegressionCompetitionScore: 0.17515337423312882



Validation scores:
	RegressionAUROC: 0.6668446063995361
	RegressionCompetitionScore: 0.12975460122699387



Validation scores:
	RegressionAUROC: 0.6809640526771545
	RegressionCompetitionScore: 0.19907975460122698



Validation scores:
	RegressionAUROC: 0.6682678461074829
	RegressionCompetitionScore: 0.15030674846625766



Validation scores:
	RegressionAUROC: 0.6828649044036865
	RegressionCompetitionScore: 0.20950920245398774



Validation scores:
	RegressionAUROC: 0.6708396673202515
	RegressionCompetitionScore: 0.1628834355828221



Validation scores:
	RegressionAUROC: 0.695510745048523
	RegressionCompetitionScore: 0.28404907975460125

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.211. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.21932515337423314
     Test RegressionAUROC            0.6916729211807251
Test RegressionCompetitionScore      0.21932515337423314
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 14:26:18,758][0m Trial 15 finished with value: 0.21932515337423314 and parameters: {'lr': 1.1055493841088379e-05, 'dropout': 0.5196130514529055, 'd_model_multiplier': 16, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 509, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 13 with value: 0.2800613496932515.[0m
Starting trial with params:
{'lr': 8.564468731063262e-07, 'dropout': 0.4732131797058652, 'd_model_multiplier': 16, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 797, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 10.4 M
1 | loss_fn | MSELoss | 0     
------------------------------------
10.2 M    Trainable params
115 K     Non-trainable params
10.4 M    Total params
41.405    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6275466680526733
	RegressionCompetitionScore: 0.27116564417177913

Metric val_loss improved. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.6589341163635254
	RegressionCompetitionScore: 0.27269938650306746



Validation scores:
	RegressionAUROC: 0.656352162361145
	RegressionCompetitionScore: 0.19693251533742331



Validation scores:
	RegressionAUROC: 0.6651673316955566
	RegressionCompetitionScore: 0.2570552147239264



Validation scores:
	RegressionAUROC: 0.6545259356498718
	RegressionCompetitionScore: 0.21809815950920244



Validation scores:
	RegressionAUROC: 0.6054896116256714
	RegressionCompetitionScore: 0.17392638036809815



Validation scores:
	RegressionAUROC: 0.652759313583374
	RegressionCompetitionScore: 0.22024539877300614



Validation scores:
	RegressionAUROC: 0.6440675258636475
	RegressionCompetitionScore: 0.18926380368098158

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.212. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.27116564417177913
     Test RegressionAUROC            0.6275466680526733
Test RegressionCompetitionScore      0.27116564417177913
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 14:35:19,277][0m Trial 16 finished with value: 0.27116564417177913 and parameters: {'lr': 8.564468731063262e-07, 'dropout': 0.4732131797058652, 'd_model_multiplier': 16, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 797, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}. Best is trial 13 with value: 0.2800613496932515.[0m
Starting trial with params:
{'lr': 5.754442940766262e-07, 'dropout': 0.4495036546601201, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 622, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.5 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.5 M     Trainable params
28.8 K    Non-trainable params
1.5 M     Total params
6.132     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5284001231193542
	RegressionCompetitionScore: 0.11042944785276074

Metric val_loss improved. New best score: 0.516


Validation scores:
	RegressionAUROC: 0.553292989730835
	RegressionCompetitionScore: 0.10398773006134969

Metric val_loss improved by 0.155 >= min_delta = 0.0. New best score: 0.361


Validation scores:
	RegressionAUROC: 0.5465255379676819
	RegressionCompetitionScore: 0.10061349693251534

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.329


Validation scores:
	RegressionAUROC: 0.5581090450286865
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5546463131904602
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5527240037918091
	RegressionCompetitionScore: 0.11012269938650307

Metric val_loss improved by 0.035 >= min_delta = 0.0. New best score: 0.295


Validation scores:
	RegressionAUROC: 0.5513296127319336
	RegressionCompetitionScore: 0.11779141104294479

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.287


Validation scores:
	RegressionAUROC: 0.5344126224517822
	RegressionCompetitionScore: 0.09693251533742331



Validation scores:
	RegressionAUROC: 0.5436202883720398
	RegressionCompetitionScore: 0.11257668711656442



Validation scores:
	RegressionAUROC: 0.5602493286132812
	RegressionCompetitionScore: 0.11595092024539877

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.286


Validation scores:
	RegressionAUROC: 0.5217219591140747
	RegressionCompetitionScore: 0.10153374233128834

Metric val_loss improved by 0.036 >= min_delta = 0.0. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.5530253052711487
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5269112586975098
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5521460175514221
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5497361421585083
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5476607084274292
	RegressionCompetitionScore: 0.11104294478527607



Validation scores:
	RegressionAUROC: 0.5487302541732788
	RegressionCompetitionScore: 0.11380368098159509



Validation scores:
	RegressionAUROC: 0.5304940938949585
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.250. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10153374233128834
     Test RegressionAUROC            0.5217219591140747
Test RegressionCompetitionScore      0.10153374233128834
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 14:52:17,006][0m Trial 17 finished with value: 0.10153374233128834 and parameters: {'lr': 5.754442940766262e-07, 'dropout': 0.4495036546601201, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 622, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}. Best is trial 13 with value: 0.2800613496932515.[0m
Starting trial with params:
{'lr': 7.376745754289587e-07, 'dropout': 0.47353800814495584, 'd_model_multiplier': 1, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 820, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 795 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
795 K     Trainable params
0         Non-trainable params
795 K     Total params
3.182     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4000000059604645
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5817790031433105
	RegressionCompetitionScore: 0.18987730061349692

Metric val_loss improved. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5829876065254211
	RegressionCompetitionScore: 0.19417177914110428



Validation scores:
	RegressionAUROC: 0.5473499298095703
	RegressionCompetitionScore: 0.17392638036809815



Validation scores:
	RegressionAUROC: 0.5552408695220947
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5643265843391418
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5652051568031311
	RegressionCompetitionScore: 0.19263803680981595



Validation scores:
	RegressionAUROC: 0.6009778380393982
	RegressionCompetitionScore: 0.2174846625766871



Validation scores:
	RegressionAUROC: 0.5854352712631226
	RegressionCompetitionScore: 0.19417177914110428

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.213. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.18987730061349692
     Test RegressionAUROC            0.5817790031433105
Test RegressionCompetitionScore      0.18987730061349692
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 15:01:24,846][0m Trial 18 finished with value: 0.18987730061349692 and parameters: {'lr': 7.376745754289587e-07, 'dropout': 0.47353800814495584, 'd_model_multiplier': 1, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 820, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}. Best is trial 13 with value: 0.2800613496932515.[0m
Starting trial with params:
{'lr': 3.968639653864175e-07, 'dropout': 0.5088936682782078, 'd_model_multiplier': 2, 'num_layers': 15, 'n_heads': 8, 'dim_feedforward': 422, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 257 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
250 K     Trainable params
7.2 K     Non-trainable params
257 K     Total params
1.029     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5289855003356934
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.45619526505470276
	RegressionCompetitionScore: 0.100920245398773

Metric val_loss improved. New best score: 0.469


Validation scores:
	RegressionAUROC: 0.38852566480636597
	RegressionCompetitionScore: 0.044171779141104296



Validation scores:
	RegressionAUROC: 0.39006567001342773
	RegressionCompetitionScore: 0.04631901840490798



Validation scores:
	RegressionAUROC: 0.3900853395462036
	RegressionCompetitionScore: 0.05061349693251534



Validation scores:
	RegressionAUROC: 0.4040783941745758
	RegressionCompetitionScore: 0.04325153374233129



Validation scores:
	RegressionAUROC: 0.39901670813560486
	RegressionCompetitionScore: 0.046625766871165646



Validation scores:
	RegressionAUROC: 0.3874225616455078
	RegressionCompetitionScore: 0.05245398773006135



Validation scores:
	RegressionAUROC: 0.3888075649738312
	RegressionCompetitionScore: 0.05460122699386503

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.465


Validation scores:
	RegressionAUROC: 0.3908212184906006
	RegressionCompetitionScore: 0.04294478527607362



Validation scores:
	RegressionAUROC: 0.38234764337539673
	RegressionCompetitionScore: 0.04539877300613497



Validation scores:
	RegressionAUROC: 0.40650245547294617
	RegressionCompetitionScore: 0.06533742331288343

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.451


Validation scores:
	RegressionAUROC: 0.385635107755661
	RegressionCompetitionScore: 0.04570552147239264



Validation scores:
	RegressionAUROC: 0.38928720355033875
	RegressionCompetitionScore: 0.04570552147239264



Validation scores:
	RegressionAUROC: 0.40024635195732117
	RegressionCompetitionScore: 0.04141104294478527



Validation scores:
	RegressionAUROC: 0.3952654004096985
	RegressionCompetitionScore: 0.039570552147239264



Validation scores:
	RegressionAUROC: 0.3949940800666809
	RegressionCompetitionScore: 0.037116564417177915



Validation scores:
	RegressionAUROC: 0.3862340450286865
	RegressionCompetitionScore: 0.046625766871165646



Validation scores:
	RegressionAUROC: 0.3834841847419739
	RegressionCompetitionScore: 0.045092024539877304

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.451. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.06533742331288343
     Test RegressionAUROC            0.40650245547294617
Test RegressionCompetitionScore      0.06533742331288343
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 15:10:34,239][0m Trial 19 finished with value: 0.06533742331288343 and parameters: {'lr': 3.968639653864175e-07, 'dropout': 0.5088936682782078, 'd_model_multiplier': 2, 'num_layers': 15, 'n_heads': 8, 'dim_feedforward': 422, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 13 with value: 0.2800613496932515.[0m
Starting trial with params:
{'lr': 2.2451596743420925e-05, 'dropout': 0.4233613795713328, 'd_model_multiplier': 8, 'num_layers': 4, 'n_heads': 16, 'dim_feedforward': 620, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
980 K     Trainable params
57.6 K    Non-trainable params
1.0 M     Total params
4.152     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5616532564163208
	RegressionCompetitionScore: 0.11349693251533742

Metric val_loss improved. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6255515813827515
	RegressionCompetitionScore: 0.15644171779141106

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.6791936159133911
	RegressionCompetitionScore: 0.24877300613496933

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.5450577139854431
	RegressionCompetitionScore: 0.12361963190184048



Validation scores:
	RegressionAUROC: 0.5754356384277344
	RegressionCompetitionScore: 0.1588957055214724



Validation scores:
	RegressionAUROC: 0.6742311716079712
	RegressionCompetitionScore: 0.31349693251533745



Validation scores:
	RegressionAUROC: 0.7249098420143127
	RegressionCompetitionScore: 0.38588957055214723

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7029625177383423
	RegressionCompetitionScore: 0.33680981595092024



Validation scores:
	RegressionAUROC: 0.7098673582077026
	RegressionCompetitionScore: 0.3355828220858896



Validation scores:
	RegressionAUROC: 0.7376047372817993
	RegressionCompetitionScore: 0.345398773006135



Validation scores:
	RegressionAUROC: 0.7347376942634583
	RegressionCompetitionScore: 0.3300613496932515



Validation scores:
	RegressionAUROC: 0.6716406345367432
	RegressionCompetitionScore: 0.18619631901840492



Validation scores:
	RegressionAUROC: 0.6076115369796753
	RegressionCompetitionScore: 0.1325153374233129



Validation scores:
	RegressionAUROC: 0.5714097619056702
	RegressionCompetitionScore: 0.1794478527607362

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.183. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38588957055214723
     Test RegressionAUROC            0.7249098420143127
Test RegressionCompetitionScore      0.38588957055214723
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 15:18:00,631][0m Trial 20 finished with value: 0.38588957055214723 and parameters: {'lr': 2.2451596743420925e-05, 'dropout': 0.4233613795713328, 'd_model_multiplier': 8, 'num_layers': 4, 'n_heads': 16, 'dim_feedforward': 620, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 2.1358245252747934e-05, 'dropout': 0.4266548701108417, 'd_model_multiplier': 8, 'num_layers': 3, 'n_heads': 16, 'dim_feedforward': 613, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 806 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
748 K     Trainable params
57.6 K    Non-trainable params
806 K     Total params
3.226     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6074997186660767
	RegressionCompetitionScore: 0.17638036809815952

Metric val_loss improved. New best score: 0.268


Validation scores:
	RegressionAUROC: 0.6570740938186646
	RegressionCompetitionScore: 0.2656441717791411

Metric val_loss improved by 0.053 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.7058061361312866
	RegressionCompetitionScore: 0.2874233128834356



Validation scores:
	RegressionAUROC: 0.6895296573638916
	RegressionCompetitionScore: 0.2076687116564417



Validation scores:
	RegressionAUROC: 0.7169109582901001
	RegressionCompetitionScore: 0.27269938650306746



Validation scores:
	RegressionAUROC: 0.7282724380493164
	RegressionCompetitionScore: 0.2607361963190184



Validation scores:
	RegressionAUROC: 0.7256731390953064
	RegressionCompetitionScore: 0.29570552147239265



Validation scores:
	RegressionAUROC: 0.7301968336105347
	RegressionCompetitionScore: 0.30552147239263805



Validation scores:
	RegressionAUROC: 0.6828186511993408
	RegressionCompetitionScore: 0.24049079754601227

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.215. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2656441717791411
     Test RegressionAUROC            0.6570740938186646
Test RegressionCompetitionScore      0.2656441717791411
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 15:22:28,441][0m Trial 21 finished with value: 0.2656441717791411 and parameters: {'lr': 2.1358245252747934e-05, 'dropout': 0.4266548701108417, 'd_model_multiplier': 8, 'num_layers': 3, 'n_heads': 16, 'dim_feedforward': 613, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 2.197969842524904e-06, 'dropout': 0.4020064604719216, 'd_model_multiplier': 8, 'num_layers': 5, 'n_heads': 16, 'dim_feedforward': 848, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.6 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.5 M     Trainable params
57.6 K    Non-trainable params
1.6 M     Total params
6.228     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6007386445999146
	RegressionCompetitionScore: 0.20306748466257668

Metric val_loss improved. New best score: 0.287


Validation scores:
	RegressionAUROC: 0.5755087733268738
	RegressionCompetitionScore: 0.1656441717791411

Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.245


Validation scores:
	RegressionAUROC: 0.564348042011261
	RegressionCompetitionScore: 0.16042944785276073



Validation scores:
	RegressionAUROC: 0.5887060761451721
	RegressionCompetitionScore: 0.18159509202453988



Validation scores:
	RegressionAUROC: 0.56444251537323
	RegressionCompetitionScore: 0.16134969325153375



Validation scores:
	RegressionAUROC: 0.6057563424110413
	RegressionCompetitionScore: 0.18251533742331288



Validation scores:
	RegressionAUROC: 0.631309449672699
	RegressionCompetitionScore: 0.22607361963190184



Validation scores:
	RegressionAUROC: 0.6065754890441895
	RegressionCompetitionScore: 0.20797546012269938



Validation scores:
	RegressionAUROC: 0.639748752117157
	RegressionCompetitionScore: 0.2411042944785276

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.245. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1656441717791411
     Test RegressionAUROC            0.5755087733268738
Test RegressionCompetitionScore      0.1656441717791411
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 15:27:40,074][0m Trial 22 finished with value: 0.1656441717791411 and parameters: {'lr': 2.197969842524904e-06, 'dropout': 0.4020064604719216, 'd_model_multiplier': 8, 'num_layers': 5, 'n_heads': 16, 'dim_feedforward': 848, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 0.00033807044634990283, 'dropout': 0.4718629542386283, 'd_model_multiplier': 8, 'num_layers': 3, 'n_heads': 16, 'dim_feedforward': 690, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 865 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
808 K     Trainable params
57.6 K    Non-trainable params
865 K     Total params
3.464     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4458962082862854
	RegressionCompetitionScore: 0.12116564417177914

Metric val_loss improved. New best score: 0.249


Validation scores:
	RegressionAUROC: 0.6416042447090149
	RegressionCompetitionScore: 0.31257668711656444



Validation scores:
	RegressionAUROC: 0.6328117251396179
	RegressionCompetitionScore: 0.1411042944785276



Validation scores:
	RegressionAUROC: 0.6565582752227783
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5000880360603333
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.47738057374954224
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7198725938796997
	RegressionCompetitionScore: 0.3300613496932515



Validation scores:
	RegressionAUROC: 0.6727676391601562
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.249. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.12116564417177914
     Test RegressionAUROC            0.4458962082862854
Test RegressionCompetitionScore      0.12116564417177914
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 15:31:41,343][0m Trial 23 finished with value: 0.12116564417177914 and parameters: {'lr': 0.00033807044634990283, 'dropout': 0.4718629542386283, 'd_model_multiplier': 8, 'num_layers': 3, 'n_heads': 16, 'dim_feedforward': 690, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 2.667287176016314e-05, 'dropout': 0.4714885625481914, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 556, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 5.2 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
5.1 M     Trainable params
115 K     Non-trainable params
5.2 M     Total params
20.794    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5659865140914917
	RegressionCompetitionScore: 0.17668711656441718

Metric val_loss improved. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.6252135634422302
	RegressionCompetitionScore: 0.2156441717791411



Validation scores:
	RegressionAUROC: 0.6412968635559082
	RegressionCompetitionScore: 0.26319018404907973



Validation scores:
	RegressionAUROC: 0.6634632349014282
	RegressionCompetitionScore: 0.25214723926380367



Validation scores:
	RegressionAUROC: 0.6560118794441223
	RegressionCompetitionScore: 0.2392638036809816



Validation scores:
	RegressionAUROC: 0.6658738851547241
	RegressionCompetitionScore: 0.24785276073619633



Validation scores:
	RegressionAUROC: 0.6755143404006958
	RegressionCompetitionScore: 0.27699386503067486



Validation scores:
	RegressionAUROC: 0.666445255279541
	RegressionCompetitionScore: 0.27177914110429446

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.215. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.17668711656441718
     Test RegressionAUROC            0.5659865140914917
Test RegressionCompetitionScore      0.17668711656441718
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 15:36:35,834][0m Trial 24 finished with value: 0.17668711656441718 and parameters: {'lr': 2.667287176016314e-05, 'dropout': 0.4714885625481914, 'd_model_multiplier': 16, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 556, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 3.975322391380244e-06, 'dropout': 0.5592321379874312, 'd_model_multiplier': 16, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 713, 'batch_size': 512, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 8.4 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
8.3 M     Trainable params
115 K     Non-trainable params
8.4 M     Total params
33.777    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5255125164985657
	RegressionCompetitionScore: 0.11687116564417178

Metric val_loss improved. New best score: 0.445


Validation scores:
	RegressionAUROC: 0.5294679999351501
	RegressionCompetitionScore: 0.12147239263803682



Validation scores:
	RegressionAUROC: 0.530348002910614
	RegressionCompetitionScore: 0.12392638036809817



Validation scores:
	RegressionAUROC: 0.5303436517715454
	RegressionCompetitionScore: 0.11809815950920245



Validation scores:
	RegressionAUROC: 0.5348185896873474
	RegressionCompetitionScore: 0.12085889570552147



Validation scores:
	RegressionAUROC: 0.5327459573745728
	RegressionCompetitionScore: 0.1254601226993865



Validation scores:
	RegressionAUROC: 0.5313376784324646
	RegressionCompetitionScore: 0.1325153374233129

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.424


Validation scores:
	RegressionAUROC: 0.5218011736869812
	RegressionCompetitionScore: 0.12975460122699387

Metric val_loss improved by 0.034 >= min_delta = 0.0. New best score: 0.390


Validation scores:
	RegressionAUROC: 0.5312426090240479
	RegressionCompetitionScore: 0.13711656441717793

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.389


Validation scores:
	RegressionAUROC: 0.5333973169326782
	RegressionCompetitionScore: 0.1273006134969325

Metric val_loss improved by 0.027 >= min_delta = 0.0. New best score: 0.361


Validation scores:
	RegressionAUROC: 0.5329306125640869
	RegressionCompetitionScore: 0.1245398773006135



Validation scores:
	RegressionAUROC: 0.5346096754074097
	RegressionCompetitionScore: 0.12607361963190183



Validation scores:
	RegressionAUROC: 0.5356264710426331
	RegressionCompetitionScore: 0.1343558282208589



Validation scores:
	RegressionAUROC: 0.5390198230743408
	RegressionCompetitionScore: 0.1322085889570552

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.361


Validation scores:
	RegressionAUROC: 0.547172486782074
	RegressionCompetitionScore: 0.13496932515337423

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.359


Validation scores:
	RegressionAUROC: 0.5463950634002686
	RegressionCompetitionScore: 0.1374233128834356

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.352


Validation scores:
	RegressionAUROC: 0.5429487824440002
	RegressionCompetitionScore: 0.14294478527607363

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.352


Validation scores:
	RegressionAUROC: 0.5426169633865356
	RegressionCompetitionScore: 0.13680981595092023

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.341


Validation scores:
	RegressionAUROC: 0.5506479740142822
	RegressionCompetitionScore: 0.14049079754601226



Validation scores:
	RegressionAUROC: 0.5552608966827393
	RegressionCompetitionScore: 0.13803680981595093

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.329


Validation scores:
	RegressionAUROC: 0.5547550320625305
	RegressionCompetitionScore: 0.12883435582822086



Validation scores:
	RegressionAUROC: 0.5586099624633789
	RegressionCompetitionScore: 0.1352760736196319



Validation scores:
	RegressionAUROC: 0.5565781593322754
	RegressionCompetitionScore: 0.14171779141104293



Validation scores:
	RegressionAUROC: 0.5653434991836548
	RegressionCompetitionScore: 0.13282208588957056



Validation scores:
	RegressionAUROC: 0.5734879374504089
	RegressionCompetitionScore: 0.1361963190184049



Validation scores:
	RegressionAUROC: 0.5641335248947144
	RegressionCompetitionScore: 0.14263803680981596



Validation scores:
	RegressionAUROC: 0.5652679800987244
	RegressionCompetitionScore: 0.14570552147239263

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.329. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.13803680981595093
     Test RegressionAUROC            0.5552608966827393
Test RegressionCompetitionScore      0.13803680981595093
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 15:56:39,514][0m Trial 25 finished with value: 0.13803680981595093 and parameters: {'lr': 3.975322391380244e-06, 'dropout': 0.5592321379874312, 'd_model_multiplier': 16, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 713, 'batch_size': 512, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 1.1635269098786602e-06, 'dropout': 0.4007381250999873, 'd_model_multiplier': 8, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 1013, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 517 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
517 K     Trainable params
0         Non-trainable params
517 K     Total params
2.072     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.41787439584732056
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.4998512268066406
	RegressionCompetitionScore: 0.09417177914110429

Metric val_loss improved. New best score: 0.591


Validation scores:
	RegressionAUROC: 0.5006908178329468
	RegressionCompetitionScore: 0.10153374233128834

Metric val_loss improved by 0.080 >= min_delta = 0.0. New best score: 0.511


Validation scores:
	RegressionAUROC: 0.5104012489318848
	RegressionCompetitionScore: 0.10705521472392639

Metric val_loss improved by 0.079 >= min_delta = 0.0. New best score: 0.432


Validation scores:
	RegressionAUROC: 0.5337383151054382
	RegressionCompetitionScore: 0.11349693251533742

Metric val_loss improved by 0.071 >= min_delta = 0.0. New best score: 0.361


Validation scores:
	RegressionAUROC: 0.5578763484954834
	RegressionCompetitionScore: 0.1147239263803681

Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.319


Validation scores:
	RegressionAUROC: 0.5605307817459106
	RegressionCompetitionScore: 0.11380368098159509

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.303


Validation scores:
	RegressionAUROC: 0.5719634890556335
	RegressionCompetitionScore: 0.11871165644171779

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.302


Validation scores:
	RegressionAUROC: 0.5757104158401489
	RegressionCompetitionScore: 0.11226993865030675



Validation scores:
	RegressionAUROC: 0.5896940231323242
	RegressionCompetitionScore: 0.12576687116564417

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.301


Validation scores:
	RegressionAUROC: 0.5959146022796631
	RegressionCompetitionScore: 0.13466257668711656



Validation scores:
	RegressionAUROC: 0.6088586449623108
	RegressionCompetitionScore: 0.1325153374233129



Validation scores:
	RegressionAUROC: 0.5999629497528076
	RegressionCompetitionScore: 0.1285276073619632

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.299


Validation scores:
	RegressionAUROC: 0.5995904803276062
	RegressionCompetitionScore: 0.12484662576687117

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.291


Validation scores:
	RegressionAUROC: 0.6091125011444092
	RegressionCompetitionScore: 0.1352760736196319

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.274


Validation scores:
	RegressionAUROC: 0.6201043128967285
	RegressionCompetitionScore: 0.15276073619631902

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.271


Validation scores:
	RegressionAUROC: 0.6132432818412781
	RegressionCompetitionScore: 0.13895705521472393



Validation scores:
	RegressionAUROC: 0.6160686016082764
	RegressionCompetitionScore: 0.14263803680981596



Validation scores:
	RegressionAUROC: 0.6146656274795532
	RegressionCompetitionScore: 0.13466257668711656



Validation scores:
	RegressionAUROC: 0.6218063235282898
	RegressionCompetitionScore: 0.15061349693251533



Validation scores:
	RegressionAUROC: 0.6254493594169617
	RegressionCompetitionScore: 0.1549079754601227



Validation scores:
	RegressionAUROC: 0.6269145011901855
	RegressionCompetitionScore: 0.1411042944785276



Validation scores:
	RegressionAUROC: 0.6236786842346191
	RegressionCompetitionScore: 0.13987730061349693

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.271. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.15276073619631902
     Test RegressionAUROC            0.6201043128967285
Test RegressionCompetitionScore      0.15276073619631902
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 16:05:53,018][0m Trial 26 finished with value: 0.15276073619631902 and parameters: {'lr': 1.1635269098786602e-06, 'dropout': 0.4007381250999873, 'd_model_multiplier': 8, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 1013, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 1.5035480460045973e-05, 'dropout': 0.4994981559019782, 'd_model_multiplier': 16, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 425, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 19.8 M
1 | loss_fn | MSELoss | 0     
------------------------------------
19.6 M    Trainable params
230 K     Non-trainable params
19.8 M    Total params
79.365    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5809788703918457
	RegressionCompetitionScore: 0.1950920245398773

Metric val_loss improved. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.5442985892295837
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4987565577030182
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5865589380264282
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6783317923545837
	RegressionCompetitionScore: 0.21809815950920244



Validation scores:
	RegressionAUROC: 0.6004135608673096
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6116880178451538
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5981113314628601
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.226. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1950920245398773
     Test RegressionAUROC            0.5809788703918457
Test RegressionCompetitionScore      0.1950920245398773
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 16:19:22,915][0m Trial 27 finished with value: 0.1950920245398773 and parameters: {'lr': 1.5035480460045973e-05, 'dropout': 0.4994981559019782, 'd_model_multiplier': 16, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 425, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 3.075006510868883e-07, 'dropout': 0.4390478494880731, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 16, 'dim_feedforward': 770, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 163 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
156 K     Trainable params
7.2 K     Non-trainable params
163 K     Total params
0.655     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5087932348251343
	RegressionCompetitionScore: 0.04539877300613497

Metric val_loss improved. New best score: 0.759


Validation scores:
	RegressionAUROC: 0.5515838861465454
	RegressionCompetitionScore: 0.13312883435582823

Metric val_loss improved by 0.092 >= min_delta = 0.0. New best score: 0.667


Validation scores:
	RegressionAUROC: 0.5895748734474182
	RegressionCompetitionScore: 0.10797546012269939

Metric val_loss improved by 0.119 >= min_delta = 0.0. New best score: 0.548


Validation scores:
	RegressionAUROC: 0.5605930089950562
	RegressionCompetitionScore: 0.10889570552147239

Metric val_loss improved by 0.091 >= min_delta = 0.0. New best score: 0.457


Validation scores:
	RegressionAUROC: 0.5420359969139099
	RegressionCompetitionScore: 0.10797546012269939

Metric val_loss improved by 0.083 >= min_delta = 0.0. New best score: 0.374


Validation scores:
	RegressionAUROC: 0.533597469329834
	RegressionCompetitionScore: 0.1107361963190184

Metric val_loss improved by 0.035 >= min_delta = 0.0. New best score: 0.339


Validation scores:
	RegressionAUROC: 0.5476492643356323
	RegressionCompetitionScore: 0.10828220858895705

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.327


Validation scores:
	RegressionAUROC: 0.5192159414291382
	RegressionCompetitionScore: 0.11104294478527607

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.303


Validation scores:
	RegressionAUROC: 0.5271393060684204
	RegressionCompetitionScore: 0.10920245398773006

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.295


Validation scores:
	RegressionAUROC: 0.5764416456222534
	RegressionCompetitionScore: 0.10950920245398774



Validation scores:
	RegressionAUROC: 0.5441417694091797
	RegressionCompetitionScore: 0.11012269938650307



Validation scores:
	RegressionAUROC: 0.5463757514953613
	RegressionCompetitionScore: 0.11012269938650307

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.271


Validation scores:
	RegressionAUROC: 0.5789580345153809
	RegressionCompetitionScore: 0.11042944785276074

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.265


Validation scores:
	RegressionAUROC: 0.561481773853302
	RegressionCompetitionScore: 0.11012269938650307

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.256


Validation scores:
	RegressionAUROC: 0.5658754706382751
	RegressionCompetitionScore: 0.11533742331288344

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.5714980959892273
	RegressionCompetitionScore: 0.1147239263803681



Validation scores:
	RegressionAUROC: 0.6059778928756714
	RegressionCompetitionScore: 0.11012269938650307



Validation scores:
	RegressionAUROC: 0.5841057896614075
	RegressionCompetitionScore: 0.11411042944785275



Validation scores:
	RegressionAUROC: 0.5994582772254944
	RegressionCompetitionScore: 0.11809815950920245



Validation scores:
	RegressionAUROC: 0.6420485377311707
	RegressionCompetitionScore: 0.12822085889570553



Validation scores:
	RegressionAUROC: 0.6029472351074219
	RegressionCompetitionScore: 0.10889570552147239



Validation scores:
	RegressionAUROC: 0.6102373003959656
	RegressionCompetitionScore: 0.11993865030674847

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.251. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.11533742331288344
     Test RegressionAUROC            0.5658754706382751
Test RegressionCompetitionScore      0.11533742331288344
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 16:31:10,694][0m Trial 28 finished with value: 0.11533742331288344 and parameters: {'lr': 3.075006510868883e-07, 'dropout': 0.4390478494880731, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 16, 'dim_feedforward': 770, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 3.812255857610806e-06, 'dropout': 0.5353852143276311, 'd_model_multiplier': 4, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 297, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 572 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
543 K     Trainable params
28.8 K    Non-trainable params
572 K     Total params
2.290     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.41304346919059753
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5099093317985535
	RegressionCompetitionScore: 0.06503067484662577

Metric val_loss improved. New best score: 0.479


Validation scores:
	RegressionAUROC: 0.5539194941520691
	RegressionCompetitionScore: 0.08558282208588958

Metric val_loss improved by 0.136 >= min_delta = 0.0. New best score: 0.343


Validation scores:
	RegressionAUROC: 0.5565744042396545
	RegressionCompetitionScore: 0.09171779141104294



Validation scores:
	RegressionAUROC: 0.5669788122177124
	RegressionCompetitionScore: 0.10521472392638037

Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.313


Validation scores:
	RegressionAUROC: 0.5755404233932495
	RegressionCompetitionScore: 0.1383435582822086



Validation scores:
	RegressionAUROC: 0.5757601857185364
	RegressionCompetitionScore: 0.10398773006134969



Validation scores:
	RegressionAUROC: 0.5851539969444275
	RegressionCompetitionScore: 0.10337423312883436



Validation scores:
	RegressionAUROC: 0.5809906721115112
	RegressionCompetitionScore: 0.09754601226993866



Validation scores:
	RegressionAUROC: 0.6049653887748718
	RegressionCompetitionScore: 0.12085889570552147



Validation scores:
	RegressionAUROC: 0.6022188663482666
	RegressionCompetitionScore: 0.15061349693251533



Validation scores:
	RegressionAUROC: 0.5831644535064697
	RegressionCompetitionScore: 0.14539877300613496

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.313. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10521472392638037
     Test RegressionAUROC            0.5669788122177124
Test RegressionCompetitionScore      0.10521472392638037
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 16:37:16,975][0m Trial 29 finished with value: 0.10521472392638037 and parameters: {'lr': 3.812255857610806e-06, 'dropout': 0.5353852143276311, 'd_model_multiplier': 4, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 297, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 1.2941609818768513e-06, 'dropout': 0.48709550609762586, 'd_model_multiplier': 64, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 862, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 72.6 M
1 | loss_fn | MSELoss | 0     
------------------------------------
72.1 M    Trainable params
460 K     Non-trainable params
72.6 M    Total params
290.378   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4106280207633972
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.41196227073669434
	RegressionCompetitionScore: 0.10061349693251534

Metric val_loss improved. New best score: 0.256


Validation scores:
	RegressionAUROC: 0.45627811551094055
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4711136817932129
	RegressionCompetitionScore: 0.11748466257668712

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.239


Validation scores:
	RegressionAUROC: 0.5265864729881287
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5722744464874268
	RegressionCompetitionScore: 0.17116564417177915

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.5985232591629028
	RegressionCompetitionScore: 0.18036809815950922



Validation scores:
	RegressionAUROC: 0.5658662915229797
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6396326422691345
	RegressionCompetitionScore: 0.1950920245398773

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6264690160751343
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6642918586730957
	RegressionCompetitionScore: 0.2371165644171779



Validation scores:
	RegressionAUROC: 0.6678086519241333
	RegressionCompetitionScore: 0.25337423312883434



Validation scores:
	RegressionAUROC: 0.6427435874938965
	RegressionCompetitionScore: 0.20460122699386504



Validation scores:
	RegressionAUROC: 0.6442111730575562
	RegressionCompetitionScore: 0.20429447852760735



Validation scores:
	RegressionAUROC: 0.6629241704940796
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6510456800460815
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1950920245398773
     Test RegressionAUROC            0.6396326422691345
Test RegressionCompetitionScore      0.1950920245398773
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 17:03:30,763][0m Trial 30 finished with value: 0.1950920245398773 and parameters: {'lr': 1.2941609818768513e-06, 'dropout': 0.48709550609762586, 'd_model_multiplier': 64, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 862, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 1.8902930214719352e-05, 'dropout': 0.4401132229294119, 'd_model_multiplier': 8, 'num_layers': 3, 'n_heads': 16, 'dim_feedforward': 618, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 810 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
752 K     Trainable params
57.6 K    Non-trainable params
810 K     Total params
3.242     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.581093430519104
	RegressionCompetitionScore: 0.11748466257668712

Metric val_loss improved. New best score: 0.307


Validation scores:
	RegressionAUROC: 0.6548340320587158
	RegressionCompetitionScore: 0.17515337423312882

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.303


Validation scores:
	RegressionAUROC: 0.6640380620956421
	RegressionCompetitionScore: 0.17699386503067485

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.301


Validation scores:
	RegressionAUROC: 0.6218797564506531
	RegressionCompetitionScore: 0.1411042944785276



Validation scores:
	RegressionAUROC: 0.651875376701355
	RegressionCompetitionScore: 0.1705521472392638

Metric val_loss improved by 0.053 >= min_delta = 0.0. New best score: 0.248


Validation scores:
	RegressionAUROC: 0.7247559428215027
	RegressionCompetitionScore: 0.3104294478527607



Validation scores:
	RegressionAUROC: 0.7335513830184937
	RegressionCompetitionScore: 0.3450920245398773



Validation scores:
	RegressionAUROC: 0.69477778673172
	RegressionCompetitionScore: 0.31809815950920245



Validation scores:
	RegressionAUROC: 0.6720157861709595
	RegressionCompetitionScore: 0.25920245398773006



Validation scores:
	RegressionAUROC: 0.7086225152015686
	RegressionCompetitionScore: 0.2352760736196319



Validation scores:
	RegressionAUROC: 0.7033827900886536
	RegressionCompetitionScore: 0.20061349693251534



Validation scores:
	RegressionAUROC: 0.6915253400802612
	RegressionCompetitionScore: 0.28680981595092025

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.248. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1705521472392638
     Test RegressionAUROC             0.651875376701355
Test RegressionCompetitionScore      0.1705521472392638
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 17:09:19,307][0m Trial 31 finished with value: 0.1705521472392638 and parameters: {'lr': 1.8902930214719352e-05, 'dropout': 0.4401132229294119, 'd_model_multiplier': 8, 'num_layers': 3, 'n_heads': 16, 'dim_feedforward': 618, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 6.265516501815343e-06, 'dropout': 0.448688034198749, 'd_model_multiplier': 8, 'num_layers': 2, 'n_heads': 16, 'dim_feedforward': 567, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 558 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
501 K     Trainable params
57.6 K    Non-trainable params
558 K     Total params
2.235     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.46666669845581055
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.567318856716156
	RegressionCompetitionScore: 0.1098159509202454

Metric val_loss improved. New best score: 0.305


Validation scores:
	RegressionAUROC: 0.6046536564826965
	RegressionCompetitionScore: 0.11717791411042945

Metric val_loss improved by 0.053 >= min_delta = 0.0. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.6239899396896362
	RegressionCompetitionScore: 0.10950920245398774

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.6096473932266235
	RegressionCompetitionScore: 0.12024539877300613



Validation scores:
	RegressionAUROC: 0.6591153144836426
	RegressionCompetitionScore: 0.15828220858895706



Validation scores:
	RegressionAUROC: 0.6774500608444214
	RegressionCompetitionScore: 0.2236196319018405

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.6937711238861084
	RegressionCompetitionScore: 0.2659509202453988



Validation scores:
	RegressionAUROC: 0.706641674041748
	RegressionCompetitionScore: 0.27699386503067486



Validation scores:
	RegressionAUROC: 0.6861833333969116
	RegressionCompetitionScore: 0.22392638036809817



Validation scores:
	RegressionAUROC: 0.7149829864501953
	RegressionCompetitionScore: 0.299079754601227



Validation scores:
	RegressionAUROC: 0.6691230535507202
	RegressionCompetitionScore: 0.1628834355828221

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.247


Validation scores:
	RegressionAUROC: 0.6929436922073364
	RegressionCompetitionScore: 0.2331288343558282

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.6846557855606079
	RegressionCompetitionScore: 0.20306748466257668



Validation scores:
	RegressionAUROC: 0.6684802174568176
	RegressionCompetitionScore: 0.18466257668711655



Validation scores:
	RegressionAUROC: 0.6922170519828796
	RegressionCompetitionScore: 0.24570552147239264



Validation scores:
	RegressionAUROC: 0.6502811908721924
	RegressionCompetitionScore: 0.16257668711656442



Validation scores:
	RegressionAUROC: 0.7081325054168701
	RegressionCompetitionScore: 0.2889570552147239



Validation scores:
	RegressionAUROC: 0.7098597288131714
	RegressionCompetitionScore: 0.28343558282208586



Validation scores:
	RegressionAUROC: 0.7088280916213989
	RegressionCompetitionScore: 0.298159509202454

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.222. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2331288343558282
     Test RegressionAUROC            0.6929436922073364
Test RegressionCompetitionScore      0.2331288343558282
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 17:17:50,855][0m Trial 32 finished with value: 0.2331288343558282 and parameters: {'lr': 6.265516501815343e-06, 'dropout': 0.448688034198749, 'd_model_multiplier': 8, 'num_layers': 2, 'n_heads': 16, 'dim_feedforward': 567, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 2.5935506281131024e-05, 'dropout': 0.4267845421708229, 'd_model_multiplier': 8, 'num_layers': 4, 'n_heads': 16, 'dim_feedforward': 446, 'batch_size': 512, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 859 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
801 K     Trainable params
57.6 K    Non-trainable params
859 K     Total params
3.436     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5490640997886658
	RegressionCompetitionScore: 0.1656441717791411

Metric val_loss improved. New best score: 0.669


Validation scores:
	RegressionAUROC: 0.5510563850402832
	RegressionCompetitionScore: 0.16441717791411042

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.667


Validation scores:
	RegressionAUROC: 0.5377034544944763
	RegressionCompetitionScore: 0.16319018404907976

Metric val_loss improved by 0.055 >= min_delta = 0.0. New best score: 0.613


Validation scores:
	RegressionAUROC: 0.5350813269615173
	RegressionCompetitionScore: 0.16809815950920245

Metric val_loss improved by 0.036 >= min_delta = 0.0. New best score: 0.577


Validation scores:
	RegressionAUROC: 0.5296977758407593
	RegressionCompetitionScore: 0.17024539877300612

Metric val_loss improved by 0.055 >= min_delta = 0.0. New best score: 0.521


Validation scores:
	RegressionAUROC: 0.5319311618804932
	RegressionCompetitionScore: 0.16717791411042945

Metric val_loss improved by 0.066 >= min_delta = 0.0. New best score: 0.455


Validation scores:
	RegressionAUROC: 0.5375273823738098
	RegressionCompetitionScore: 0.15920245398773006

Metric val_loss improved by 0.074 >= min_delta = 0.0. New best score: 0.381


Validation scores:
	RegressionAUROC: 0.5336753129959106
	RegressionCompetitionScore: 0.15153374233128836

Metric val_loss improved by 0.035 >= min_delta = 0.0. New best score: 0.346


Validation scores:
	RegressionAUROC: 0.5550884008407593
	RegressionCompetitionScore: 0.1558282208588957

Metric val_loss improved by 0.044 >= min_delta = 0.0. New best score: 0.301


Validation scores:
	RegressionAUROC: 0.5667882561683655
	RegressionCompetitionScore: 0.16104294478527606



Validation scores:
	RegressionAUROC: 0.5325314402580261
	RegressionCompetitionScore: 0.1530674846625767



Validation scores:
	RegressionAUROC: 0.5617305040359497
	RegressionCompetitionScore: 0.1628834355828221



Validation scores:
	RegressionAUROC: 0.5545394420623779
	RegressionCompetitionScore: 0.16349693251533742



Validation scores:
	RegressionAUROC: 0.5729454159736633
	RegressionCompetitionScore: 0.17576687116564418



Validation scores:
	RegressionAUROC: 0.584631085395813
	RegressionCompetitionScore: 0.18496932515337422



Validation scores:
	RegressionAUROC: 0.5758052468299866
	RegressionCompetitionScore: 0.1785276073619632

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.301. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1558282208588957
     Test RegressionAUROC            0.5550884008407593
Test RegressionCompetitionScore      0.1558282208588957
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 17:24:39,975][0m Trial 33 finished with value: 0.1558282208588957 and parameters: {'lr': 2.5935506281131024e-05, 'dropout': 0.4267845421708229, 'd_model_multiplier': 8, 'num_layers': 4, 'n_heads': 16, 'dim_feedforward': 446, 'batch_size': 512, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 2.470287243526947e-06, 'dropout': 0.4974527410778935, 'd_model_multiplier': 8, 'num_layers': 4, 'n_heads': 64, 'dim_feedforward': 671, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 7.5 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
7.2 M     Trainable params
230 K     Non-trainable params
7.5 M     Total params
29.802    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6384071111679077
	RegressionCompetitionScore: 0.2561349693251534

Metric val_loss improved. New best score: 0.438


Validation scores:
	RegressionAUROC: 0.6569950580596924
	RegressionCompetitionScore: 0.27024539877300613



Validation scores:
	RegressionAUROC: 0.6926407814025879
	RegressionCompetitionScore: 0.2733128834355828

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.417


Validation scores:
	RegressionAUROC: 0.6962730884552002
	RegressionCompetitionScore: 0.2552147239263804



Validation scores:
	RegressionAUROC: 0.6581109166145325
	RegressionCompetitionScore: 0.2941717791411043



Validation scores:
	RegressionAUROC: 0.6796338558197021
	RegressionCompetitionScore: 0.2800613496932515



Validation scores:
	RegressionAUROC: 0.6675513982772827
	RegressionCompetitionScore: 0.28680981595092025



Validation scores:
	RegressionAUROC: 0.6430558562278748
	RegressionCompetitionScore: 0.18711656441717792



Validation scores:
	RegressionAUROC: 0.676530122756958
	RegressionCompetitionScore: 0.3202453987730061



Validation scores:
	RegressionAUROC: 0.6467419862747192
	RegressionCompetitionScore: 0.32331288343558284

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.417. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2733128834355828
     Test RegressionAUROC            0.6926407814025879
Test RegressionCompetitionScore      0.2733128834355828
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 17:33:18,918][0m Trial 34 finished with value: 0.2733128834355828 and parameters: {'lr': 2.470287243526947e-06, 'dropout': 0.4974527410778935, 'd_model_multiplier': 8, 'num_layers': 4, 'n_heads': 64, 'dim_feedforward': 671, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 1.6164396164799852e-06, 'dropout': 0.5468841637878338, 'd_model_multiplier': 16, 'num_layers': 7, 'n_heads': 64, 'dim_feedforward': 779, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 41.6 M
1 | loss_fn | MSELoss | 0     
------------------------------------
41.1 M    Trainable params
460 K     Non-trainable params
41.6 M    Total params
166.221   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5546951293945312
	RegressionCompetitionScore: 0.08588957055214724

Metric val_loss improved. New best score: 0.255


Validation scores:
	RegressionAUROC: 0.6002461910247803
	RegressionCompetitionScore: 0.1116564417177914

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.6201801300048828
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6201879382133484
	RegressionCompetitionScore: 0.14877300613496933



Validation scores:
	RegressionAUROC: 0.6373586654663086
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6622511148452759
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6835939288139343
	RegressionCompetitionScore: 0.2846625766871166

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.6827473640441895
	RegressionCompetitionScore: 0.2812883435582822



Validation scores:
	RegressionAUROC: 0.671421468257904
	RegressionCompetitionScore: 0.2647239263803681



Validation scores:
	RegressionAUROC: 0.6611769795417786
	RegressionCompetitionScore: 0.23404907975460124

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.6633902788162231
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6292427778244019
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6725403070449829
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6952918767929077
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6452648639678955
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6676266193389893
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6963971853256226
	RegressionCompetitionScore: 0.296319018404908

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.221. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.23404907975460124
     Test RegressionAUROC            0.6611769795417786
Test RegressionCompetitionScore      0.23404907975460124
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 18:05:38,491][0m Trial 35 finished with value: 0.23404907975460124 and parameters: {'lr': 1.6164396164799852e-06, 'dropout': 0.5468841637878338, 'd_model_multiplier': 16, 'num_layers': 7, 'n_heads': 64, 'dim_feedforward': 779, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 8.062420600322864e-07, 'dropout': 0.5088426725384194, 'd_model_multiplier': 32, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 674, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 119 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
119 M     Trainable params
0         Non-trainable params
119 M     Total params
476.962   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4975845515727997
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.527707040309906
	RegressionCompetitionScore: 0.10061349693251534

Metric val_loss improved. New best score: 0.554


Validation scores:
	RegressionAUROC: 0.5874581336975098
	RegressionCompetitionScore: 0.1392638036809816

Metric val_loss improved by 0.130 >= min_delta = 0.0. New best score: 0.423


Validation scores:
	RegressionAUROC: 0.6168219447135925
	RegressionCompetitionScore: 0.1588957055214724

Metric val_loss improved by 0.056 >= min_delta = 0.0. New best score: 0.368


Validation scores:
	RegressionAUROC: 0.6218617558479309
	RegressionCompetitionScore: 0.18220858895705522



Validation scores:
	RegressionAUROC: 0.6319531798362732
	RegressionCompetitionScore: 0.2184049079754601

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.356


Validation scores:
	RegressionAUROC: 0.6275271773338318
	RegressionCompetitionScore: 0.20521472392638038

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.349


Validation scores:
	RegressionAUROC: 0.6310669183731079
	RegressionCompetitionScore: 0.19478527607361965

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.347


Validation scores:
	RegressionAUROC: 0.6431116461753845
	RegressionCompetitionScore: 0.19386503067484662



Validation scores:
	RegressionAUROC: 0.6561845541000366
	RegressionCompetitionScore: 0.22607361963190184



Validation scores:
	RegressionAUROC: 0.6550470590591431
	RegressionCompetitionScore: 0.2432515337423313



Validation scores:
	RegressionAUROC: 0.6497241854667664
	RegressionCompetitionScore: 0.22515337423312884



Validation scores:
	RegressionAUROC: 0.6500091552734375
	RegressionCompetitionScore: 0.2625766871165644

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.316


Validation scores:
	RegressionAUROC: 0.6461104154586792
	RegressionCompetitionScore: 0.26196319018404907

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.301


Validation scores:
	RegressionAUROC: 0.6489633321762085
	RegressionCompetitionScore: 0.2800613496932515

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.282


Validation scores:
	RegressionAUROC: 0.6581787467002869
	RegressionCompetitionScore: 0.28588957055214725

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.277


Validation scores:
	RegressionAUROC: 0.6638544797897339
	RegressionCompetitionScore: 0.25030674846625767

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.273


Validation scores:
	RegressionAUROC: 0.6647336483001709
	RegressionCompetitionScore: 0.2846625766871166



Validation scores:
	RegressionAUROC: 0.6728876829147339
	RegressionCompetitionScore: 0.2665644171779141



Validation scores:
	RegressionAUROC: 0.6752894520759583
	RegressionCompetitionScore: 0.27883435582822086



Validation scores:
	RegressionAUROC: 0.6704604029655457
	RegressionCompetitionScore: 0.28496932515337425

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.270


Validation scores:
	RegressionAUROC: 0.6720981597900391
	RegressionCompetitionScore: 0.29141104294478526



Validation scores:
	RegressionAUROC: 0.6651278138160706
	RegressionCompetitionScore: 0.29141104294478526

Metric val_loss improved by 0.027 >= min_delta = 0.0. New best score: 0.243


Validation scores:
	RegressionAUROC: 0.673275887966156
	RegressionCompetitionScore: 0.26932515337423313

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.6698246002197266
	RegressionCompetitionScore: 0.27975460122699386

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.680683970451355
	RegressionCompetitionScore: 0.29570552147239265

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.6815007328987122
	RegressionCompetitionScore: 0.298159509202454



Validation scores:
	RegressionAUROC: 0.6837848424911499
	RegressionCompetitionScore: 0.2926380368098159



Validation scores:
	RegressionAUROC: 0.681537389755249
	RegressionCompetitionScore: 0.29662576687116565



Validation scores:
	RegressionAUROC: 0.6881346702575684
	RegressionCompetitionScore: 0.2901840490797546



Validation scores:
	RegressionAUROC: 0.6851274371147156
	RegressionCompetitionScore: 0.299079754601227



Validation scores:
	RegressionAUROC: 0.6866012215614319
	RegressionCompetitionScore: 0.296319018404908



Validation scores:
	RegressionAUROC: 0.6763303279876709
	RegressionCompetitionScore: 0.3150306748466258

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.6784968376159668
	RegressionCompetitionScore: 0.3042944785276074

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6761693358421326
	RegressionCompetitionScore: 0.3052147239263804

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.683998703956604
	RegressionCompetitionScore: 0.3033742331288344

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6955808997154236
	RegressionCompetitionScore: 0.2616564417177914



Validation scores:
	RegressionAUROC: 0.6951414346694946
	RegressionCompetitionScore: 0.2852760736196319



Validation scores:
	RegressionAUROC: 0.6947814226150513
	RegressionCompetitionScore: 0.2865030674846626



Validation scores:
	RegressionAUROC: 0.6965566873550415
	RegressionCompetitionScore: 0.28680981595092025



Validation scores:
	RegressionAUROC: 0.6960281133651733
	RegressionCompetitionScore: 0.28282208588957053



Validation scores:
	RegressionAUROC: 0.7000435590744019
	RegressionCompetitionScore: 0.2822085889570552



Validation scores:
	RegressionAUROC: 0.6883348226547241
	RegressionCompetitionScore: 0.31012269938650305

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6979234218597412
	RegressionCompetitionScore: 0.2773006134969325

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6866230368614197
	RegressionCompetitionScore: 0.30552147239263805



Validation scores:
	RegressionAUROC: 0.6952742338180542
	RegressionCompetitionScore: 0.29049079754601226



Validation scores:
	RegressionAUROC: 0.6986902356147766
	RegressionCompetitionScore: 0.27975460122699386



Validation scores:
	RegressionAUROC: 0.6923573017120361
	RegressionCompetitionScore: 0.28865030674846626



Validation scores:
	RegressionAUROC: 0.6988919973373413
	RegressionCompetitionScore: 0.27116564417177913



Validation scores:
	RegressionAUROC: 0.6901698112487793
	RegressionCompetitionScore: 0.3015337423312883



Validation scores:
	RegressionAUROC: 0.6996238827705383
	RegressionCompetitionScore: 0.2800613496932515

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.189. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2773006134969325
     Test RegressionAUROC            0.6979234218597412
Test RegressionCompetitionScore      0.2773006134969325
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 20:17:51,504][0m Trial 36 finished with value: 0.2773006134969325 and parameters: {'lr': 8.062420600322864e-07, 'dropout': 0.5088426725384194, 'd_model_multiplier': 32, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 674, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 3.6085874100725466e-06, 'dropout': 0.5079186869078518, 'd_model_multiplier': 32, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 676, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 119 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
119 M     Trainable params
0         Non-trainable params
119 M     Total params
477.159   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5017314553260803
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.626


Validation scores:
	RegressionAUROC: 0.5733189582824707
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.293 >= min_delta = 0.0. New best score: 0.333


Validation scores:
	RegressionAUROC: 0.6385032534599304
	RegressionCompetitionScore: 0.19386503067484662

Metric val_loss improved by 0.074 >= min_delta = 0.0. New best score: 0.259


Validation scores:
	RegressionAUROC: 0.6756075620651245
	RegressionCompetitionScore: 0.2634969325153374

Metric val_loss improved by 0.057 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.687393844127655
	RegressionCompetitionScore: 0.2361963190184049



Validation scores:
	RegressionAUROC: 0.6925955414772034
	RegressionCompetitionScore: 0.2343558282208589

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7050718069076538
	RegressionCompetitionScore: 0.24478527607361963

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7007420063018799
	RegressionCompetitionScore: 0.23006134969325154



Validation scores:
	RegressionAUROC: 0.7116233706474304
	RegressionCompetitionScore: 0.27361963190184047

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7143389582633972
	RegressionCompetitionScore: 0.24141104294478527



Validation scores:
	RegressionAUROC: 0.7159639596939087
	RegressionCompetitionScore: 0.24969325153374233



Validation scores:
	RegressionAUROC: 0.7156438827514648
	RegressionCompetitionScore: 0.253680981595092

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7071784138679504
	RegressionCompetitionScore: 0.2312883435582822



Validation scores:
	RegressionAUROC: 0.7147033214569092
	RegressionCompetitionScore: 0.26411042944785273



Validation scores:
	RegressionAUROC: 0.7171515822410583
	RegressionCompetitionScore: 0.27423312883435585



Validation scores:
	RegressionAUROC: 0.7127904891967773
	RegressionCompetitionScore: 0.23588957055214724



Validation scores:
	RegressionAUROC: 0.7178358435630798
	RegressionCompetitionScore: 0.2917177914110429



Validation scores:
	RegressionAUROC: 0.7016656398773193
	RegressionCompetitionScore: 0.21012269938650308



Validation scores:
	RegressionAUROC: 0.7162900567054749
	RegressionCompetitionScore: 0.2837423312883436

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.181. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.253680981595092
     Test RegressionAUROC            0.7156438827514648
Test RegressionCompetitionScore       0.253680981595092
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 21:06:22,552][0m Trial 37 finished with value: 0.253680981595092 and parameters: {'lr': 3.6085874100725466e-06, 'dropout': 0.5079186869078518, 'd_model_multiplier': 32, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 676, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 3.262553460456009e-07, 'dropout': 0.5300016097536892, 'd_model_multiplier': 32, 'num_layers': 4, 'n_heads': 64, 'dim_feedforward': 514, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 77.5 M
1 | loss_fn | MSELoss | 0     
------------------------------------
77.5 M    Trainable params
0         Non-trainable params
77.5 M    Total params
310.017   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5215245485305786
	RegressionCompetitionScore: 0.14846625766871166

Metric val_loss improved. New best score: 0.476


Validation scores:
	RegressionAUROC: 0.5278028249740601
	RegressionCompetitionScore: 0.16165644171779142

Metric val_loss improved by 0.052 >= min_delta = 0.0. New best score: 0.424


Validation scores:
	RegressionAUROC: 0.529106616973877
	RegressionCompetitionScore: 0.1794478527607362

Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: 0.395


Validation scores:
	RegressionAUROC: 0.5183970928192139
	RegressionCompetitionScore: 0.15030674846625766

Metric val_loss improved by 0.059 >= min_delta = 0.0. New best score: 0.337


Validation scores:
	RegressionAUROC: 0.5180004835128784
	RegressionCompetitionScore: 0.14049079754601226

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.329


Validation scores:
	RegressionAUROC: 0.4694167971611023
	RegressionCompetitionScore: 0.09110429447852761

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.328


Validation scores:
	RegressionAUROC: 0.4506502151489258
	RegressionCompetitionScore: 0.08742331288343558



Validation scores:
	RegressionAUROC: 0.4629155099391937
	RegressionCompetitionScore: 0.08742331288343558



Validation scores:
	RegressionAUROC: 0.47610920667648315
	RegressionCompetitionScore: 0.08957055214723926

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.322


Validation scores:
	RegressionAUROC: 0.4486573338508606
	RegressionCompetitionScore: 0.08865030674846626



Validation scores:
	RegressionAUROC: 0.43429529666900635
	RegressionCompetitionScore: 0.08650306748466258



Validation scores:
	RegressionAUROC: 0.4628838300704956
	RegressionCompetitionScore: 0.08466257668711656

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.309


Validation scores:
	RegressionAUROC: 0.4702712893486023
	RegressionCompetitionScore: 0.0843558282208589

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.306


Validation scores:
	RegressionAUROC: 0.48828670382499695
	RegressionCompetitionScore: 0.08558282208588958

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.285


Validation scores:
	RegressionAUROC: 0.5151839256286621
	RegressionCompetitionScore: 0.08834355828220859



Validation scores:
	RegressionAUROC: 0.4952142834663391
	RegressionCompetitionScore: 0.08650306748466258

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.279


Validation scores:
	RegressionAUROC: 0.5133800506591797
	RegressionCompetitionScore: 0.08588957055214724



Validation scores:
	RegressionAUROC: 0.5195891857147217
	RegressionCompetitionScore: 0.08466257668711656



Validation scores:
	RegressionAUROC: 0.5605666637420654
	RegressionCompetitionScore: 0.08711656441717791

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.275


Validation scores:
	RegressionAUROC: 0.5651146173477173
	RegressionCompetitionScore: 0.08895705521472393



Validation scores:
	RegressionAUROC: 0.5627931356430054
	RegressionCompetitionScore: 0.09539877300613497



Validation scores:
	RegressionAUROC: 0.5779842734336853
	RegressionCompetitionScore: 0.09263803680981596

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.270


Validation scores:
	RegressionAUROC: 0.577386200428009
	RegressionCompetitionScore: 0.09263803680981596

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.267


Validation scores:
	RegressionAUROC: 0.6116481423377991
	RegressionCompetitionScore: 0.10214723926380367

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.247


Validation scores:
	RegressionAUROC: 0.6522555947303772
	RegressionCompetitionScore: 0.16257668711656442



Validation scores:
	RegressionAUROC: 0.624439001083374
	RegressionCompetitionScore: 0.10644171779141104

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.243


Validation scores:
	RegressionAUROC: 0.6468789577484131
	RegressionCompetitionScore: 0.1312883435582822



Validation scores:
	RegressionAUROC: 0.6562912464141846
	RegressionCompetitionScore: 0.147239263803681



Validation scores:
	RegressionAUROC: 0.663068413734436
	RegressionCompetitionScore: 0.14877300613496933



Validation scores:
	RegressionAUROC: 0.6606884002685547
	RegressionCompetitionScore: 0.147239263803681



Validation scores:
	RegressionAUROC: 0.6518667936325073
	RegressionCompetitionScore: 0.14693251533742333



Validation scores:
	RegressionAUROC: 0.6552427411079407
	RegressionCompetitionScore: 0.13773006134969326

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.239


Validation scores:
	RegressionAUROC: 0.6356421709060669
	RegressionCompetitionScore: 0.10920245398773006

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.6619511246681213
	RegressionCompetitionScore: 0.1441717791411043

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.6878130435943604
	RegressionCompetitionScore: 0.2067484662576687



Validation scores:
	RegressionAUROC: 0.6669245958328247
	RegressionCompetitionScore: 0.15368098159509203

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6766149997711182
	RegressionCompetitionScore: 0.17668711656441718



Validation scores:
	RegressionAUROC: 0.6852397918701172
	RegressionCompetitionScore: 0.20521472392638038



Validation scores:
	RegressionAUROC: 0.6893081068992615
	RegressionCompetitionScore: 0.21012269938650308

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6952864527702332
	RegressionCompetitionScore: 0.2361963190184049



Validation scores:
	RegressionAUROC: 0.6874322891235352
	RegressionCompetitionScore: 0.2196319018404908



Validation scores:
	RegressionAUROC: 0.6842966079711914
	RegressionCompetitionScore: 0.202760736196319



Validation scores:
	RegressionAUROC: 0.6845277547836304
	RegressionCompetitionScore: 0.19785276073619631



Validation scores:
	RegressionAUROC: 0.6944997906684875
	RegressionCompetitionScore: 0.2263803680981595

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.7038879990577698
	RegressionCompetitionScore: 0.27208588957055213



Validation scores:
	RegressionAUROC: 0.6923271417617798
	RegressionCompetitionScore: 0.21993865030674847

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.7009131908416748
	RegressionCompetitionScore: 0.25153374233128833



Validation scores:
	RegressionAUROC: 0.697007417678833
	RegressionCompetitionScore: 0.23865030674846627



Validation scores:
	RegressionAUROC: 0.7003270983695984
	RegressionCompetitionScore: 0.24478527607361963



Validation scores:
	RegressionAUROC: 0.7030676603317261
	RegressionCompetitionScore: 0.25644171779141106

`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.21993865030674847
     Test RegressionAUROC            0.6923271417617798
Test RegressionCompetitionScore      0.21993865030674847
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 22:33:48,064][0m Trial 38 finished with value: 0.21993865030674847 and parameters: {'lr': 3.262553460456009e-07, 'dropout': 0.5300016097536892, 'd_model_multiplier': 32, 'num_layers': 4, 'n_heads': 64, 'dim_feedforward': 514, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 2.2237039866771396e-06, 'dropout': 0.5869660802910259, 'd_model_multiplier': 32, 'num_layers': 7, 'n_heads': 64, 'dim_feedforward': 648, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 138 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
138 M     Trainable params
0         Non-trainable params
138 M     Total params
552.208   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.727053165435791
	RegressionCompetitionScore: 0.5217391304347826



Validation scores:
	RegressionAUROC: 0.631959855556488
	RegressionCompetitionScore: 0.20061349693251534

Metric val_loss improved. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.6412788033485413
	RegressionCompetitionScore: 0.24846625766871167

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6528651714324951
	RegressionCompetitionScore: 0.19447852760736195



Validation scores:
	RegressionAUROC: 0.6565110087394714
	RegressionCompetitionScore: 0.25

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6610975861549377
	RegressionCompetitionScore: 0.2076687116564417



Validation scores:
	RegressionAUROC: 0.6665427088737488
	RegressionCompetitionScore: 0.21196319018404908



Validation scores:
	RegressionAUROC: 0.6667217016220093
	RegressionCompetitionScore: 0.25337423312883434



Validation scores:
	RegressionAUROC: 0.6678011417388916
	RegressionCompetitionScore: 0.20337423312883435



Validation scores:
	RegressionAUROC: 0.6680630445480347
	RegressionCompetitionScore: 0.26288343558282207



Validation scores:
	RegressionAUROC: 0.6672546863555908
	RegressionCompetitionScore: 0.2116564417177914



Validation scores:
	RegressionAUROC: 0.6747029423713684
	RegressionCompetitionScore: 0.24877300613496933

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.198. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                  0.25
     Test RegressionAUROC            0.6565110087394714
Test RegressionCompetitionScore             0.25
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-03 23:06:58,596][0m Trial 39 finished with value: 0.25 and parameters: {'lr': 2.2237039866771396e-06, 'dropout': 0.5869660802910259, 'd_model_multiplier': 32, 'num_layers': 7, 'n_heads': 64, 'dim_feedforward': 648, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 9.377430903551371e-06, 'dropout': 0.6234688547205087, 'd_model_multiplier': 32, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 736, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 120 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
120 M     Trainable params
0         Non-trainable params
120 M     Total params
483.058   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4661835730075836
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.4924418330192566
	RegressionCompetitionScore: 0.07392638036809816

Metric val_loss improved. New best score: 0.593


Validation scores:
	RegressionAUROC: 0.4762905240058899
	RegressionCompetitionScore: 0.07116564417177915



Validation scores:
	RegressionAUROC: 0.4727424681186676
	RegressionCompetitionScore: 0.0687116564417178



Validation scores:
	RegressionAUROC: 0.46822354197502136
	RegressionCompetitionScore: 0.0745398773006135



Validation scores:
	RegressionAUROC: 0.4718707501888275
	RegressionCompetitionScore: 0.07668711656441718



Validation scores:
	RegressionAUROC: 0.45857593417167664
	RegressionCompetitionScore: 0.07883435582822086

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.574


Validation scores:
	RegressionAUROC: 0.44468802213668823
	RegressionCompetitionScore: 0.07791411042944785

Metric val_loss improved by 0.038 >= min_delta = 0.0. New best score: 0.536


Validation scores:
	RegressionAUROC: 0.4446263313293457
	RegressionCompetitionScore: 0.08496932515337423

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.528


Validation scores:
	RegressionAUROC: 0.44599124789237976
	RegressionCompetitionScore: 0.08742331288343558

Metric val_loss improved by 0.048 >= min_delta = 0.0. New best score: 0.480


Validation scores:
	RegressionAUROC: 0.44360172748565674
	RegressionCompetitionScore: 0.08895705521472393

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.478


Validation scores:
	RegressionAUROC: 0.4368576109409332
	RegressionCompetitionScore: 0.08803680981595093



Validation scores:
	RegressionAUROC: 0.445733904838562
	RegressionCompetitionScore: 0.09417177914110429

Metric val_loss improved by 0.053 >= min_delta = 0.0. New best score: 0.425


Validation scores:
	RegressionAUROC: 0.44439664483070374
	RegressionCompetitionScore: 0.09539877300613497

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.423


Validation scores:
	RegressionAUROC: 0.4556726813316345
	RegressionCompetitionScore: 0.10122699386503067

Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.380


Validation scores:
	RegressionAUROC: 0.46225035190582275
	RegressionCompetitionScore: 0.1049079754601227



Validation scores:
	RegressionAUROC: 0.44835031032562256
	RegressionCompetitionScore: 0.10214723926380367

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.366


Validation scores:
	RegressionAUROC: 0.4366200268268585
	RegressionCompetitionScore: 0.09447852760736196



Validation scores:
	RegressionAUROC: 0.4310019314289093
	RegressionCompetitionScore: 0.09570552147239264



Validation scores:
	RegressionAUROC: 0.42786291241645813
	RegressionCompetitionScore: 0.09110429447852761



Validation scores:
	RegressionAUROC: 0.418800950050354
	RegressionCompetitionScore: 0.08251533742331288



Validation scores:
	RegressionAUROC: 0.4124763011932373
	RegressionCompetitionScore: 0.07975460122699386



Validation scores:
	RegressionAUROC: 0.4089432954788208
	RegressionCompetitionScore: 0.07484662576687116



Validation scores:
	RegressionAUROC: 0.40625375509262085
	RegressionCompetitionScore: 0.07208588957055215

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.366. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10214723926380367
     Test RegressionAUROC            0.44835031032562256
Test RegressionCompetitionScore      0.10214723926380367
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 00:08:52,305][0m Trial 40 finished with value: 0.10214723926380367 and parameters: {'lr': 9.377430903551371e-06, 'dropout': 0.6234688547205087, 'd_model_multiplier': 32, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 736, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 8.483037447007705e-07, 'dropout': 0.4882560684588889, 'd_model_multiplier': 2, 'num_layers': 4, 'n_heads': 64, 'dim_feedforward': 567, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 983 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
983 K     Trainable params
0         Non-trainable params
983 K     Total params
3.934     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49237990379333496
	RegressionCompetitionScore: 0.0696319018404908

Metric val_loss improved. New best score: 0.613


Validation scores:
	RegressionAUROC: 0.4730326533317566
	RegressionCompetitionScore: 0.07331288343558282

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.596


Validation scores:
	RegressionAUROC: 0.4626184105873108
	RegressionCompetitionScore: 0.08374233128834356

Metric val_loss improved by 0.042 >= min_delta = 0.0. New best score: 0.553


Validation scores:
	RegressionAUROC: 0.46081557869911194
	RegressionCompetitionScore: 0.10245398773006135

Metric val_loss improved by 0.047 >= min_delta = 0.0. New best score: 0.506


Validation scores:
	RegressionAUROC: 0.4942869544029236
	RegressionCompetitionScore: 0.13067484662576687

Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: 0.477


Validation scores:
	RegressionAUROC: 0.46953436732292175
	RegressionCompetitionScore: 0.1263803680981595

Metric val_loss improved by 0.033 >= min_delta = 0.0. New best score: 0.444


Validation scores:
	RegressionAUROC: 0.4593828618526459
	RegressionCompetitionScore: 0.1196319018404908

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.440


Validation scores:
	RegressionAUROC: 0.4566940665245056
	RegressionCompetitionScore: 0.1196319018404908



Validation scores:
	RegressionAUROC: 0.4724440276622772
	RegressionCompetitionScore: 0.1205521472392638

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.420


Validation scores:
	RegressionAUROC: 0.448128879070282
	RegressionCompetitionScore: 0.11533742331288344



Validation scores:
	RegressionAUROC: 0.4253388047218323
	RegressionCompetitionScore: 0.1107361963190184



Validation scores:
	RegressionAUROC: 0.4400298595428467
	RegressionCompetitionScore: 0.11380368098159509

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.413


Validation scores:
	RegressionAUROC: 0.439510703086853
	RegressionCompetitionScore: 0.1147239263803681

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.409


Validation scores:
	RegressionAUROC: 0.45015454292297363
	RegressionCompetitionScore: 0.11441717791411044

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.388


Validation scores:
	RegressionAUROC: 0.4652024209499359
	RegressionCompetitionScore: 0.11871165644171779



Validation scores:
	RegressionAUROC: 0.4524357318878174
	RegressionCompetitionScore: 0.11319018404907975

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.383


Validation scores:
	RegressionAUROC: 0.4468482434749603
	RegressionCompetitionScore: 0.1147239263803681



Validation scores:
	RegressionAUROC: 0.4490446448326111
	RegressionCompetitionScore: 0.1147239263803681



Validation scores:
	RegressionAUROC: 0.4617164134979248
	RegressionCompetitionScore: 0.11717791411042945



Validation scores:
	RegressionAUROC: 0.4578261077404022
	RegressionCompetitionScore: 0.11840490797546012



Validation scores:
	RegressionAUROC: 0.43582266569137573
	RegressionCompetitionScore: 0.1107361963190184



Validation scores:
	RegressionAUROC: 0.4597865343093872
	RegressionCompetitionScore: 0.11748466257668712

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.378


Validation scores:
	RegressionAUROC: 0.45925891399383545
	RegressionCompetitionScore: 0.11809815950920245

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.376


Validation scores:
	RegressionAUROC: 0.47013890743255615
	RegressionCompetitionScore: 0.11809815950920245

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.362


Validation scores:
	RegressionAUROC: 0.5010842084884644
	RegressionCompetitionScore: 0.12699386503067484



Validation scores:
	RegressionAUROC: 0.48410046100616455
	RegressionCompetitionScore: 0.11932515337423313

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.360


Validation scores:
	RegressionAUROC: 0.49346092343330383
	RegressionCompetitionScore: 0.11840490797546012



Validation scores:
	RegressionAUROC: 0.4975300133228302
	RegressionCompetitionScore: 0.11932515337423313



Validation scores:
	RegressionAUROC: 0.5098116993904114
	RegressionCompetitionScore: 0.12515337423312883

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.357


Validation scores:
	RegressionAUROC: 0.5028368830680847
	RegressionCompetitionScore: 0.12484662576687117



Validation scores:
	RegressionAUROC: 0.48535776138305664
	RegressionCompetitionScore: 0.11533742331288344



Validation scores:
	RegressionAUROC: 0.49390044808387756
	RegressionCompetitionScore: 0.12300613496932515

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.350


Validation scores:
	RegressionAUROC: 0.4902791380882263
	RegressionCompetitionScore: 0.11871165644171779

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.347


Validation scores:
	RegressionAUROC: 0.5112176537513733
	RegressionCompetitionScore: 0.11840490797546012

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.334


Validation scores:
	RegressionAUROC: 0.5382897257804871
	RegressionCompetitionScore: 0.13190184049079753



Validation scores:
	RegressionAUROC: 0.5156407952308655
	RegressionCompetitionScore: 0.11932515337423313

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.326


Validation scores:
	RegressionAUROC: 0.5349642038345337
	RegressionCompetitionScore: 0.1325153374233129



Validation scores:
	RegressionAUROC: 0.5338331460952759
	RegressionCompetitionScore: 0.12668711656441717



Validation scores:
	RegressionAUROC: 0.5416375994682312
	RegressionCompetitionScore: 0.12515337423312883



Validation scores:
	RegressionAUROC: 0.5488107800483704
	RegressionCompetitionScore: 0.13190184049079753



Validation scores:
	RegressionAUROC: 0.5218082070350647
	RegressionCompetitionScore: 0.1276073619631902



Validation scores:
	RegressionAUROC: 0.5488535165786743
	RegressionCompetitionScore: 0.1303680981595092

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.322


Validation scores:
	RegressionAUROC: 0.5413253903388977
	RegressionCompetitionScore: 0.12576687116564417

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.321


Validation scores:
	RegressionAUROC: 0.553219199180603
	RegressionCompetitionScore: 0.13404907975460123

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.304


Validation scores:
	RegressionAUROC: 0.5847858190536499
	RegressionCompetitionScore: 0.15950920245398773



Validation scores:
	RegressionAUROC: 0.5568025708198547
	RegressionCompetitionScore: 0.13680981595092023

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.303


Validation scores:
	RegressionAUROC: 0.5807318687438965
	RegressionCompetitionScore: 0.15521472392638036



Validation scores:
	RegressionAUROC: 0.5759084820747375
	RegressionCompetitionScore: 0.14754601226993866



Validation scores:
	RegressionAUROC: 0.5915163159370422
	RegressionCompetitionScore: 0.14938650306748466



Validation scores:
	RegressionAUROC: 0.5957424640655518
	RegressionCompetitionScore: 0.15920245398773006

`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.13680981595092023
     Test RegressionAUROC            0.5568025708198547
Test RegressionCompetitionScore      0.13680981595092023
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 00:41:20,682][0m Trial 41 finished with value: 0.13680981595092023 and parameters: {'lr': 8.483037447007705e-07, 'dropout': 0.4882560684588889, 'd_model_multiplier': 2, 'num_layers': 4, 'n_heads': 64, 'dim_feedforward': 567, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 2.4541538477920945e-07, 'dropout': 0.544824306179146, 'd_model_multiplier': 8, 'num_layers': 5, 'n_heads': 64, 'dim_feedforward': 889, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 10.3 M
1 | loss_fn | MSELoss | 0     
------------------------------------
10.3 M    Trainable params
0         Non-trainable params
10.3 M    Total params
41.235    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6048362851142883
	RegressionCompetitionScore: 0.13374233128834356

Metric val_loss improved. New best score: 0.525


Validation scores:
	RegressionAUROC: 0.6087839603424072
	RegressionCompetitionScore: 0.12515337423312883

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.519


Validation scores:
	RegressionAUROC: 0.607441782951355
	RegressionCompetitionScore: 0.11748466257668712

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.502


Validation scores:
	RegressionAUROC: 0.6197323799133301
	RegressionCompetitionScore: 0.147239263803681

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.484


Validation scores:
	RegressionAUROC: 0.6274858713150024
	RegressionCompetitionScore: 0.1668711656441718

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.466


Validation scores:
	RegressionAUROC: 0.6116776466369629
	RegressionCompetitionScore: 0.12791411042944786

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.440


Validation scores:
	RegressionAUROC: 0.6042773127555847
	RegressionCompetitionScore: 0.12515337423312883

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.438


Validation scores:
	RegressionAUROC: 0.6054888963699341
	RegressionCompetitionScore: 0.12177914110429448

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.425


Validation scores:
	RegressionAUROC: 0.6094850301742554
	RegressionCompetitionScore: 0.1263803680981595

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.404


Validation scores:
	RegressionAUROC: 0.5997424125671387
	RegressionCompetitionScore: 0.11625766871165644

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.402


Validation scores:
	RegressionAUROC: 0.5856565237045288
	RegressionCompetitionScore: 0.09754601226993866



Validation scores:
	RegressionAUROC: 0.6011314988136292
	RegressionCompetitionScore: 0.11411042944785275

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.401


Validation scores:
	RegressionAUROC: 0.5901888012886047
	RegressionCompetitionScore: 0.09723926380368098

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.382


Validation scores:
	RegressionAUROC: 0.5991766452789307
	RegressionCompetitionScore: 0.11319018404907975

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.350


Validation scores:
	RegressionAUROC: 0.6154035925865173
	RegressionCompetitionScore: 0.14846625766871166

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.349


Validation scores:
	RegressionAUROC: 0.580298125743866
	RegressionCompetitionScore: 0.09171779141104294

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.334


Validation scores:
	RegressionAUROC: 0.5688601732254028
	RegressionCompetitionScore: 0.0950920245398773



Validation scores:
	RegressionAUROC: 0.5656936168670654
	RegressionCompetitionScore: 0.09662576687116564



Validation scores:
	RegressionAUROC: 0.5690276026725769
	RegressionCompetitionScore: 0.09447852760736196



Validation scores:
	RegressionAUROC: 0.5587313771247864
	RegressionCompetitionScore: 0.09294478527607362



Validation scores:
	RegressionAUROC: 0.54237300157547
	RegressionCompetitionScore: 0.09110429447852761



Validation scores:
	RegressionAUROC: 0.5634714365005493
	RegressionCompetitionScore: 0.0950920245398773



Validation scores:
	RegressionAUROC: 0.5561947822570801
	RegressionCompetitionScore: 0.09355828220858896

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.334. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.09171779141104294
     Test RegressionAUROC             0.580298125743866
Test RegressionCompetitionScore      0.09171779141104294
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 01:03:57,578][0m Trial 42 finished with value: 0.09171779141104294 and parameters: {'lr': 2.4541538477920945e-07, 'dropout': 0.544824306179146, 'd_model_multiplier': 8, 'num_layers': 5, 'n_heads': 64, 'dim_feedforward': 889, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 6.318339527571373e-07, 'dropout': 0.46326721554914857, 'd_model_multiplier': 64, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 829, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 42.3 M
1 | loss_fn | MSELoss | 0     
------------------------------------
41.4 M    Trainable params
921 K     Non-trainable params
42.3 M    Total params
169.130   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.48792269825935364
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5003514289855957
	RegressionCompetitionScore: 0.12024539877300613

Metric val_loss improved. New best score: 0.546


Validation scores:
	RegressionAUROC: 0.5376133322715759
	RegressionCompetitionScore: 0.12484662576687117

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.542


Validation scores:
	RegressionAUROC: 0.5430795550346375
	RegressionCompetitionScore: 0.1205521472392638



Validation scores:
	RegressionAUROC: 0.5751563310623169
	RegressionCompetitionScore: 0.12269938650306748

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.541


Validation scores:
	RegressionAUROC: 0.6171474456787109
	RegressionCompetitionScore: 0.15920245398773006



Validation scores:
	RegressionAUROC: 0.5705348253250122
	RegressionCompetitionScore: 0.1423312883435583

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.532


Validation scores:
	RegressionAUROC: 0.5786707401275635
	RegressionCompetitionScore: 0.1383435582822086

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.525


Validation scores:
	RegressionAUROC: 0.6090567111968994
	RegressionCompetitionScore: 0.16840490797546012



Validation scores:
	RegressionAUROC: 0.648110032081604
	RegressionCompetitionScore: 0.24478527607361963



Validation scores:
	RegressionAUROC: 0.6614874601364136
	RegressionCompetitionScore: 0.24754601226993864

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.519


Validation scores:
	RegressionAUROC: 0.5685032606124878
	RegressionCompetitionScore: 0.147239263803681

Metric val_loss improved by 0.074 >= min_delta = 0.0. New best score: 0.446


Validation scores:
	RegressionAUROC: 0.6555230617523193
	RegressionCompetitionScore: 0.20153374233128835



Validation scores:
	RegressionAUROC: 0.6535409688949585
	RegressionCompetitionScore: 0.20122699386503068



Validation scores:
	RegressionAUROC: 0.6279584765434265
	RegressionCompetitionScore: 0.16717791411042945



Validation scores:
	RegressionAUROC: 0.6625943183898926
	RegressionCompetitionScore: 0.25122699386503067



Validation scores:
	RegressionAUROC: 0.6317841410636902
	RegressionCompetitionScore: 0.17392638036809815



Validation scores:
	RegressionAUROC: 0.6560205221176147
	RegressionCompetitionScore: 0.20368098159509201



Validation scores:
	RegressionAUROC: 0.6490755677223206
	RegressionCompetitionScore: 0.22392638036809817

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.446. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.147239263803681
     Test RegressionAUROC            0.5685032606124878
Test RegressionCompetitionScore       0.147239263803681
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 01:19:05,245][0m Trial 43 finished with value: 0.147239263803681 and parameters: {'lr': 6.318339527571373e-07, 'dropout': 0.46326721554914857, 'd_model_multiplier': 64, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 829, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 2.2524408033002055e-06, 'dropout': 0.4981701613091048, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 4, 'dim_feedforward': 955, 'batch_size': 1024, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.8 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.7 M     Trainable params
28.8 K    Non-trainable params
1.8 M     Total params
7.028     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.238


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.135 >= min_delta = 0.0. New best score: 1.103


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.064 >= min_delta = 0.0. New best score: 1.039


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.120 >= min_delta = 0.0. New best score: 0.919


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.056 >= min_delta = 0.0. New best score: 0.863


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.105 >= min_delta = 0.0. New best score: 0.758


Validation scores:
	RegressionAUROC: 0.4993342161178589
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.096 >= min_delta = 0.0. New best score: 0.662


Validation scores:
	RegressionAUROC: 0.4947391450405121
	RegressionCompetitionScore: 0.018098159509202454

Metric val_loss improved by 0.044 >= min_delta = 0.0. New best score: 0.618


Validation scores:
	RegressionAUROC: 0.42825382947921753
	RegressionCompetitionScore: 0.049079754601226995

Metric val_loss improved by 0.081 >= min_delta = 0.0. New best score: 0.537


Validation scores:
	RegressionAUROC: 0.42759618163108826
	RegressionCompetitionScore: 0.04754601226993865

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.500


Validation scores:
	RegressionAUROC: 0.4283476769924164
	RegressionCompetitionScore: 0.04386503067484662

Metric val_loss improved by 0.066 >= min_delta = 0.0. New best score: 0.434


Validation scores:
	RegressionAUROC: 0.4279695153236389
	RegressionCompetitionScore: 0.041104294478527606

Metric val_loss improved by 0.058 >= min_delta = 0.0. New best score: 0.376


Validation scores:
	RegressionAUROC: 0.4278894066810608
	RegressionCompetitionScore: 0.04079754601226994

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.350


Validation scores:
	RegressionAUROC: 0.4272357225418091
	RegressionCompetitionScore: 0.042024539877300614

Metric val_loss improved by 0.045 >= min_delta = 0.0. New best score: 0.306


Validation scores:
	RegressionAUROC: 0.42620936036109924
	RegressionCompetitionScore: 0.04325153374233129

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.287


Validation scores:
	RegressionAUROC: 0.42274177074432373
	RegressionCompetitionScore: 0.04877300613496933

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.255


Validation scores:
	RegressionAUROC: 0.4206736087799072
	RegressionCompetitionScore: 0.048466257668711654

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.4199739098548889
	RegressionCompetitionScore: 0.046625766871165646

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.41945117712020874
	RegressionCompetitionScore: 0.04785276073619632

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.4194117486476898
	RegressionCompetitionScore: 0.04785276073619632

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.4196935296058655
	RegressionCompetitionScore: 0.04969325153374233



Validation scores:
	RegressionAUROC: 0.42017126083374023
	RegressionCompetitionScore: 0.05184049079754601



Validation scores:
	RegressionAUROC: 0.4208405017852783
	RegressionCompetitionScore: 0.05122699386503068



Validation scores:
	RegressionAUROC: 0.4221304655075073
	RegressionCompetitionScore: 0.05061349693251534



Validation scores:
	RegressionAUROC: 0.4225769639015198
	RegressionCompetitionScore: 0.05030674846625767



Validation scores:
	RegressionAUROC: 0.42293280363082886
	RegressionCompetitionScore: 0.05



Validation scores:
	RegressionAUROC: 0.42291367053985596
	RegressionCompetitionScore: 0.05030674846625767

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.214. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.04785276073619632
     Test RegressionAUROC            0.4194117486476898
Test RegressionCompetitionScore      0.04785276073619632
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 01:30:43,551][0m Trial 44 finished with value: 0.04785276073619632 and parameters: {'lr': 2.2524408033002055e-06, 'dropout': 0.4981701613091048, 'd_model_multiplier': 16, 'num_layers': 12, 'n_heads': 4, 'dim_feedforward': 955, 'batch_size': 1024, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 1.3283583829494651e-07, 'dropout': 0.5632389057383144, 'd_model_multiplier': 32, 'num_layers': 8, 'n_heads': 64, 'dim_feedforward': 659, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 157 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
157 M     Trainable params
0         Non-trainable params
157 M     Total params
631.452   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5981371402740479
	RegressionCompetitionScore: 0.22668711656441717

Metric val_loss improved. New best score: 0.338


Validation scores:
	RegressionAUROC: 0.6014467477798462
	RegressionCompetitionScore: 0.2334355828220859

Metric val_loss improved by 0.051 >= min_delta = 0.0. New best score: 0.287


Validation scores:
	RegressionAUROC: 0.6046969294548035
	RegressionCompetitionScore: 0.23742331288343557

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.270


Validation scores:
	RegressionAUROC: 0.6100358963012695
	RegressionCompetitionScore: 0.24723926380368097

Metric val_loss improved by 0.040 >= min_delta = 0.0. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.6181817650794983
	RegressionCompetitionScore: 0.25122699386503067

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.6237618923187256
	RegressionCompetitionScore: 0.24877300613496933

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.630888819694519
	RegressionCompetitionScore: 0.2371165644171779



Validation scores:
	RegressionAUROC: 0.6350176334381104
	RegressionCompetitionScore: 0.22883435582822087



Validation scores:
	RegressionAUROC: 0.6405792236328125
	RegressionCompetitionScore: 0.2303680981595092

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6405608654022217
	RegressionCompetitionScore: 0.2263803680981595

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.642799973487854
	RegressionCompetitionScore: 0.21012269938650308



Validation scores:
	RegressionAUROC: 0.6475756168365479
	RegressionCompetitionScore: 0.22300613496932514



Validation scores:
	RegressionAUROC: 0.6514698266983032
	RegressionCompetitionScore: 0.2322085889570552



Validation scores:
	RegressionAUROC: 0.6544860601425171
	RegressionCompetitionScore: 0.24570552147239264

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6590967178344727
	RegressionCompetitionScore: 0.249079754601227

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6549941301345825
	RegressionCompetitionScore: 0.2334355828220859

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6568243503570557
	RegressionCompetitionScore: 0.23159509202453987



Validation scores:
	RegressionAUROC: 0.6599369049072266
	RegressionCompetitionScore: 0.23282208588957054



Validation scores:
	RegressionAUROC: 0.6636692881584167
	RegressionCompetitionScore: 0.23957055214723927

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.661937415599823
	RegressionCompetitionScore: 0.23650306748466257



Validation scores:
	RegressionAUROC: 0.6656254529953003
	RegressionCompetitionScore: 0.22392638036809817



Validation scores:
	RegressionAUROC: 0.6657867431640625
	RegressionCompetitionScore: 0.23742331288343557



Validation scores:
	RegressionAUROC: 0.6651066541671753
	RegressionCompetitionScore: 0.2343558282208589



Validation scores:
	RegressionAUROC: 0.6689507961273193
	RegressionCompetitionScore: 0.24447852760736197

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6732441186904907
	RegressionCompetitionScore: 0.250920245398773

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6688474416732788
	RegressionCompetitionScore: 0.23803680981595093



Validation scores:
	RegressionAUROC: 0.6707440614700317
	RegressionCompetitionScore: 0.23588957055214724



Validation scores:
	RegressionAUROC: 0.6732800006866455
	RegressionCompetitionScore: 0.23190184049079754



Validation scores:
	RegressionAUROC: 0.6773391366004944
	RegressionCompetitionScore: 0.24723926380368097

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6768266558647156
	RegressionCompetitionScore: 0.24233128834355827



Validation scores:
	RegressionAUROC: 0.6785445213317871
	RegressionCompetitionScore: 0.22699386503067484



Validation scores:
	RegressionAUROC: 0.6795895099639893
	RegressionCompetitionScore: 0.24263803680981594



Validation scores:
	RegressionAUROC: 0.6775124073028564
	RegressionCompetitionScore: 0.24294478527607363



Validation scores:
	RegressionAUROC: 0.6790965795516968
	RegressionCompetitionScore: 0.2552147239263804

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.68390291929245
	RegressionCompetitionScore: 0.2579754601226994

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.678513765335083
	RegressionCompetitionScore: 0.24662576687116564

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6808936595916748
	RegressionCompetitionScore: 0.25061349693251533



Validation scores:
	RegressionAUROC: 0.6832488775253296
	RegressionCompetitionScore: 0.24662576687116564



Validation scores:
	RegressionAUROC: 0.6857029795646667
	RegressionCompetitionScore: 0.2647239263803681



Validation scores:
	RegressionAUROC: 0.6845031380653381
	RegressionCompetitionScore: 0.2616564417177914



Validation scores:
	RegressionAUROC: 0.6851966977119446
	RegressionCompetitionScore: 0.25153374233128833



Validation scores:
	RegressionAUROC: 0.6861454248428345
	RegressionCompetitionScore: 0.25061349693251533



Validation scores:
	RegressionAUROC: 0.6849691867828369
	RegressionCompetitionScore: 0.24723926380368097

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.193. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.24662576687116564
     Test RegressionAUROC             0.678513765335083
Test RegressionCompetitionScore      0.24662576687116564
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 04:01:22,977][0m Trial 45 finished with value: 0.24662576687116564 and parameters: {'lr': 1.3283583829494651e-07, 'dropout': 0.5632389057383144, 'd_model_multiplier': 32, 'num_layers': 8, 'n_heads': 64, 'dim_feedforward': 659, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 1.221175276098111e-06, 'dropout': 0.5272114818609985, 'd_model_multiplier': 16, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 748, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.7 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.6 M     Trainable params
57.6 K    Non-trainable params
1.7 M     Total params
6.750     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5515989065170288
	RegressionCompetitionScore: 0.1312883435582822

Metric val_loss improved. New best score: 0.263


Validation scores:
	RegressionAUROC: 0.5673211812973022
	RegressionCompetitionScore: 0.1647239263803681

Metric val_loss improved by 0.039 >= min_delta = 0.0. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.5437033176422119
	RegressionCompetitionScore: 0.1352760736196319



Validation scores:
	RegressionAUROC: 0.561970055103302
	RegressionCompetitionScore: 0.15337423312883436



Validation scores:
	RegressionAUROC: 0.5757365226745605
	RegressionCompetitionScore: 0.15613496932515336



Validation scores:
	RegressionAUROC: 0.5603675842285156
	RegressionCompetitionScore: 0.12975460122699387



Validation scores:
	RegressionAUROC: 0.5931283235549927
	RegressionCompetitionScore: 0.147239263803681



Validation scores:
	RegressionAUROC: 0.5853838920593262
	RegressionCompetitionScore: 0.1432515337423313



Validation scores:
	RegressionAUROC: 0.6136163473129272
	RegressionCompetitionScore: 0.15245398773006136

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.225. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1647239263803681
     Test RegressionAUROC            0.5673211812973022
Test RegressionCompetitionScore      0.1647239263803681
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 04:06:47,598][0m Trial 46 finished with value: 0.1647239263803681 and parameters: {'lr': 1.221175276098111e-06, 'dropout': 0.5272114818609985, 'd_model_multiplier': 16, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 748, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 4.833815117560704e-07, 'dropout': 0.45780148147284344, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 64, 'dim_feedforward': 788, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.7 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.7 M     Trainable params
28.8 K    Non-trainable params
1.7 M     Total params
6.942     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

[WARNING] OOM for trial with params {'lr': 4.833815117560704e-07, 'dropout': 0.45780148147284344, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 64, 'dim_feedforward': 788, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}
[32m[I 2023-04-04 04:06:56,007][0m Trial 47 finished with value: 0.0 and parameters: {'lr': 4.833815117560704e-07, 'dropout': 0.45780148147284344, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 64, 'dim_feedforward': 788, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.001}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 7.561199178492652e-06, 'dropout': 0.48615762341423413, 'd_model_multiplier': 8, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 713, 'batch_size': 512, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 502 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
487 K     Trainable params
14.4 K    Non-trainable params
502 K     Total params
2.009     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.37681159377098083
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.37098658084869385
	RegressionCompetitionScore: 0.05030674846625767

Metric val_loss improved. New best score: 0.255


Validation scores:
	RegressionAUROC: 0.37282150983810425
	RegressionCompetitionScore: 0.048466257668711654

Metric val_loss improved by 0.035 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.37688788771629333
	RegressionCompetitionScore: 0.045092024539877304



Validation scores:
	RegressionAUROC: 0.3879603445529938
	RegressionCompetitionScore: 0.04447852760736196



Validation scores:
	RegressionAUROC: 0.4044872522354126
	RegressionCompetitionScore: 0.04693251533742331



Validation scores:
	RegressionAUROC: 0.41971951723098755
	RegressionCompetitionScore: 0.050920245398773004



Validation scores:
	RegressionAUROC: 0.437610924243927
	RegressionCompetitionScore: 0.05644171779141104

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.4526106119155884
	RegressionCompetitionScore: 0.06993865030674846

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.46908122301101685
	RegressionCompetitionScore: 0.0754601226993865



Validation scores:
	RegressionAUROC: 0.4824126660823822
	RegressionCompetitionScore: 0.08067484662576688



Validation scores:
	RegressionAUROC: 0.49966001510620117
	RegressionCompetitionScore: 0.08374233128834356

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5135012865066528
	RegressionCompetitionScore: 0.08895705521472393

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.5286549925804138
	RegressionCompetitionScore: 0.10122699386503067



Validation scores:
	RegressionAUROC: 0.5453137159347534
	RegressionCompetitionScore: 0.11717791411042945



Validation scores:
	RegressionAUROC: 0.5574944615364075
	RegressionCompetitionScore: 0.1343558282208589



Validation scores:
	RegressionAUROC: 0.5668812394142151
	RegressionCompetitionScore: 0.1588957055214724



Validation scores:
	RegressionAUROC: 0.5763338208198547
	RegressionCompetitionScore: 0.18527607361963191

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5826669931411743
	RegressionCompetitionScore: 0.19907975460122698

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5881158113479614
	RegressionCompetitionScore: 0.21871165644171778



Validation scores:
	RegressionAUROC: 0.5930945873260498
	RegressionCompetitionScore: 0.23067484662576687



Validation scores:
	RegressionAUROC: 0.5982959866523743
	RegressionCompetitionScore: 0.25



Validation scores:
	RegressionAUROC: 0.6008628010749817
	RegressionCompetitionScore: 0.25674846625766873

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6029089689254761
	RegressionCompetitionScore: 0.26042944785276073



Validation scores:
	RegressionAUROC: 0.6048768758773804
	RegressionCompetitionScore: 0.26809815950920246



Validation scores:
	RegressionAUROC: 0.6068308353424072
	RegressionCompetitionScore: 0.27177914110429446



Validation scores:
	RegressionAUROC: 0.6086491346359253
	RegressionCompetitionScore: 0.2766871165644172



Validation scores:
	RegressionAUROC: 0.6107645630836487
	RegressionCompetitionScore: 0.2822085889570552

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6123542785644531
	RegressionCompetitionScore: 0.28588957055214725

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6139205694198608
	RegressionCompetitionScore: 0.29233128834355826



Validation scores:
	RegressionAUROC: 0.6155259609222412
	RegressionCompetitionScore: 0.2969325153374233



Validation scores:
	RegressionAUROC: 0.6170836091041565
	RegressionCompetitionScore: 0.3006134969325153



Validation scores:
	RegressionAUROC: 0.6177551746368408
	RegressionCompetitionScore: 0.3006134969325153



Validation scores:
	RegressionAUROC: 0.6181973218917847
	RegressionCompetitionScore: 0.3006134969325153

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6186279058456421
	RegressionCompetitionScore: 0.30030674846625766



Validation scores:
	RegressionAUROC: 0.6191726922988892
	RegressionCompetitionScore: 0.30122699386503066



Validation scores:
	RegressionAUROC: 0.619695782661438
	RegressionCompetitionScore: 0.3006134969325153



Validation scores:
	RegressionAUROC: 0.6205703020095825
	RegressionCompetitionScore: 0.300920245398773



Validation scores:
	RegressionAUROC: 0.6215116381645203
	RegressionCompetitionScore: 0.3033742331288344

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6227356195449829
	RegressionCompetitionScore: 0.3067484662576687



Validation scores:
	RegressionAUROC: 0.6240917444229126
	RegressionCompetitionScore: 0.30920245398773005



Validation scores:
	RegressionAUROC: 0.6251428723335266
	RegressionCompetitionScore: 0.31012269938650305



Validation scores:
	RegressionAUROC: 0.6256170272827148
	RegressionCompetitionScore: 0.3122699386503067



Validation scores:
	RegressionAUROC: 0.6259416341781616
	RegressionCompetitionScore: 0.31012269938650305

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6262828707695007
	RegressionCompetitionScore: 0.31104294478527605



Validation scores:
	RegressionAUROC: 0.6267393231391907
	RegressionCompetitionScore: 0.31257668711656444



Validation scores:
	RegressionAUROC: 0.6273826360702515
	RegressionCompetitionScore: 0.3141104294478528



Validation scores:
	RegressionAUROC: 0.6285609006881714
	RegressionCompetitionScore: 0.3156441717791411



Validation scores:
	RegressionAUROC: 0.6296378970146179
	RegressionCompetitionScore: 0.3168711656441718

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6308687925338745
	RegressionCompetitionScore: 0.31809815950920245



Validation scores:
	RegressionAUROC: 0.6319044828414917
	RegressionCompetitionScore: 0.3196319018404908

`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3168711656441718
     Test RegressionAUROC            0.6296378970146179
Test RegressionCompetitionScore      0.3168711656441718
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 04:26:59,731][0m Trial 48 finished with value: 0.3168711656441718 and parameters: {'lr': 7.561199178492652e-06, 'dropout': 0.48615762341423413, 'd_model_multiplier': 8, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 713, 'batch_size': 512, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 4.43788916633917e-05, 'dropout': 0.5188906124749585, 'd_model_multiplier': 8, 'num_layers': 7, 'n_heads': 4, 'dim_feedforward': 477, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 293 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
293 K     Trainable params
0         Non-trainable params
293 K     Total params
1.173     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4251207709312439
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.48708513379096985
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.477


Validation scores:
	RegressionAUROC: 0.47777146100997925
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.047 >= min_delta = 0.0. New best score: 0.429


Validation scores:
	RegressionAUROC: 0.562088668346405
	RegressionCompetitionScore: 0.1628834355828221

Metric val_loss improved by 0.214 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5816640853881836
	RegressionCompetitionScore: 0.17883435582822085

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.5951209664344788
	RegressionCompetitionScore: 0.19233128834355828



Validation scores:
	RegressionAUROC: 0.6069567203521729
	RegressionCompetitionScore: 0.20368098159509201



Validation scores:
	RegressionAUROC: 0.6307961940765381
	RegressionCompetitionScore: 0.22975460122699387

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6507776975631714
	RegressionCompetitionScore: 0.24478527607361963



Validation scores:
	RegressionAUROC: 0.666385293006897
	RegressionCompetitionScore: 0.24079754601226994

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6793074607849121
	RegressionCompetitionScore: 0.2411042944785276



Validation scores:
	RegressionAUROC: 0.6903258562088013
	RegressionCompetitionScore: 0.24447852760736197



Validation scores:
	RegressionAUROC: 0.6903159618377686
	RegressionCompetitionScore: 0.2392638036809816



Validation scores:
	RegressionAUROC: 0.6923657655715942
	RegressionCompetitionScore: 0.23895705521472393



Validation scores:
	RegressionAUROC: 0.6953833103179932
	RegressionCompetitionScore: 0.2392638036809816

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6963590979576111
	RegressionCompetitionScore: 0.24386503067484663



Validation scores:
	RegressionAUROC: 0.6961343288421631
	RegressionCompetitionScore: 0.2469325153374233

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7003067135810852
	RegressionCompetitionScore: 0.24785276073619633



Validation scores:
	RegressionAUROC: 0.7040401697158813
	RegressionCompetitionScore: 0.2254601226993865



Validation scores:
	RegressionAUROC: 0.7064118981361389
	RegressionCompetitionScore: 0.23067484662576687



Validation scores:
	RegressionAUROC: 0.708881676197052
	RegressionCompetitionScore: 0.2223926380368098



Validation scores:
	RegressionAUROC: 0.7107337713241577
	RegressionCompetitionScore: 0.2401840490797546



Validation scores:
	RegressionAUROC: 0.7091343402862549
	RegressionCompetitionScore: 0.25950920245398773



Validation scores:
	RegressionAUROC: 0.7100191116333008
	RegressionCompetitionScore: 0.2625766871165644

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7122693061828613
	RegressionCompetitionScore: 0.25920245398773006



Validation scores:
	RegressionAUROC: 0.7114421129226685
	RegressionCompetitionScore: 0.2684049079754601



Validation scores:
	RegressionAUROC: 0.7109666466712952
	RegressionCompetitionScore: 0.27883435582822086

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7159197330474854
	RegressionCompetitionScore: 0.26042944785276073



Validation scores:
	RegressionAUROC: 0.7180619835853577
	RegressionCompetitionScore: 0.2665644171779141



Validation scores:
	RegressionAUROC: 0.7201201319694519
	RegressionCompetitionScore: 0.26932515337423313



Validation scores:
	RegressionAUROC: 0.7217933535575867
	RegressionCompetitionScore: 0.2552147239263804



Validation scores:
	RegressionAUROC: 0.7236426472663879
	RegressionCompetitionScore: 0.2644171779141104



Validation scores:
	RegressionAUROC: 0.7240219116210938
	RegressionCompetitionScore: 0.27515337423312886



Validation scores:
	RegressionAUROC: 0.7246222496032715
	RegressionCompetitionScore: 0.2754601226993865

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.181. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.27883435582822086
     Test RegressionAUROC            0.7109666466712952
Test RegressionCompetitionScore      0.27883435582822086
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 04:40:24,362][0m Trial 49 finished with value: 0.27883435582822086 and parameters: {'lr': 4.43788916633917e-05, 'dropout': 0.5188906124749585, 'd_model_multiplier': 8, 'num_layers': 7, 'n_heads': 4, 'dim_feedforward': 477, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 4.367882398427057e-05, 'dropout': 0.5712507650223962, 'd_model_multiplier': 8, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 473, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 361 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
361 K     Trainable params
0         Non-trainable params
361 K     Total params
1.447     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6280192732810974
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.4824789762496948
	RegressionCompetitionScore: 0.11687116564417178

Metric val_loss improved. New best score: 0.304


Validation scores:
	RegressionAUROC: 0.4814493656158447
	RegressionCompetitionScore: 0.1067484662576687



Validation scores:
	RegressionAUROC: 0.47544705867767334
	RegressionCompetitionScore: 0.11503067484662577

Metric val_loss improved by 0.094 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5029789805412292
	RegressionCompetitionScore: 0.1107361963190184



Validation scores:
	RegressionAUROC: 0.5857955813407898
	RegressionCompetitionScore: 0.10460122699386504



Validation scores:
	RegressionAUROC: 0.6100319027900696
	RegressionCompetitionScore: 0.15122699386503066



Validation scores:
	RegressionAUROC: 0.6061208248138428
	RegressionCompetitionScore: 0.19938650306748465



Validation scores:
	RegressionAUROC: 0.6017313599586487
	RegressionCompetitionScore: 0.20398773006134968



Validation scores:
	RegressionAUROC: 0.6047875285148621
	RegressionCompetitionScore: 0.2067484662576687

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6079995632171631
	RegressionCompetitionScore: 0.21104294478527608



Validation scores:
	RegressionAUROC: 0.6163036823272705
	RegressionCompetitionScore: 0.21932515337423314



Validation scores:
	RegressionAUROC: 0.624172568321228
	RegressionCompetitionScore: 0.2107361963190184



Validation scores:
	RegressionAUROC: 0.624016284942627
	RegressionCompetitionScore: 0.2116564417177914

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.620993971824646
	RegressionCompetitionScore: 0.2107361963190184



Validation scores:
	RegressionAUROC: 0.6167933344841003
	RegressionCompetitionScore: 0.20644171779141104



Validation scores:
	RegressionAUROC: 0.6168544292449951
	RegressionCompetitionScore: 0.20950920245398774

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6250842809677124
	RegressionCompetitionScore: 0.21196319018404908



Validation scores:
	RegressionAUROC: 0.635150134563446
	RegressionCompetitionScore: 0.2116564417177914



Validation scores:
	RegressionAUROC: 0.6457397937774658
	RegressionCompetitionScore: 0.22177914110429447



Validation scores:
	RegressionAUROC: 0.6523392200469971
	RegressionCompetitionScore: 0.22423312883435584



Validation scores:
	RegressionAUROC: 0.6559897661209106
	RegressionCompetitionScore: 0.2263803680981595

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.658237099647522
	RegressionCompetitionScore: 0.2352760736196319



Validation scores:
	RegressionAUROC: 0.6603596210479736
	RegressionCompetitionScore: 0.23773006134969324



Validation scores:
	RegressionAUROC: 0.6633858680725098
	RegressionCompetitionScore: 0.23895705521472393

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6666767597198486
	RegressionCompetitionScore: 0.24294478527607363



Validation scores:
	RegressionAUROC: 0.6703661680221558
	RegressionCompetitionScore: 0.25214723926380367



Validation scores:
	RegressionAUROC: 0.6764225363731384
	RegressionCompetitionScore: 0.25337423312883434



Validation scores:
	RegressionAUROC: 0.6808421015739441
	RegressionCompetitionScore: 0.251840490797546



Validation scores:
	RegressionAUROC: 0.6855599284172058
	RegressionCompetitionScore: 0.24785276073619633



Validation scores:
	RegressionAUROC: 0.688323974609375
	RegressionCompetitionScore: 0.24938650306748467



Validation scores:
	RegressionAUROC: 0.6904418468475342
	RegressionCompetitionScore: 0.26288343558282207

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.196. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.23895705521472393
     Test RegressionAUROC            0.6633858680725098
Test RegressionCompetitionScore      0.23895705521472393
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 04:53:08,050][0m Trial 50 finished with value: 0.23895705521472393 and parameters: {'lr': 4.367882398427057e-05, 'dropout': 0.5712507650223962, 'd_model_multiplier': 8, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 473, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 1.0613883951552014e-05, 'dropout': 0.5177543496001435, 'd_model_multiplier': 8, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 579, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 465 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
465 K     Trainable params
0         Non-trainable params
465 K     Total params
1.863     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5165408253669739
	RegressionCompetitionScore: 0.06503067484662577

Metric val_loss improved. New best score: 0.639


Validation scores:
	RegressionAUROC: 0.41030174493789673
	RegressionCompetitionScore: 0.11288343558282209

Metric val_loss improved by 0.246 >= min_delta = 0.0. New best score: 0.393


Validation scores:
	RegressionAUROC: 0.41324013471603394
	RegressionCompetitionScore: 0.11196319018404909

Metric val_loss improved by 0.141 >= min_delta = 0.0. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.4180215895175934
	RegressionCompetitionScore: 0.1107361963190184

Metric val_loss improved by 0.039 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.42866677045822144
	RegressionCompetitionScore: 0.10122699386503067



Validation scores:
	RegressionAUROC: 0.45053350925445557
	RegressionCompetitionScore: 0.09846625766871166



Validation scores:
	RegressionAUROC: 0.49409130215644836
	RegressionCompetitionScore: 0.09355828220858896



Validation scores:
	RegressionAUROC: 0.5327208042144775
	RegressionCompetitionScore: 0.09417177914110429

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5598387718200684
	RegressionCompetitionScore: 0.09723926380368098



Validation scores:
	RegressionAUROC: 0.5727311372756958
	RegressionCompetitionScore: 0.09907975460122699



Validation scores:
	RegressionAUROC: 0.5823410153388977
	RegressionCompetitionScore: 0.1067484662576687



Validation scores:
	RegressionAUROC: 0.5868792533874512
	RegressionCompetitionScore: 0.11226993865030675

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.591528058052063
	RegressionCompetitionScore: 0.11809815950920245



Validation scores:
	RegressionAUROC: 0.597166895866394
	RegressionCompetitionScore: 0.13711656441717793



Validation scores:
	RegressionAUROC: 0.602725625038147
	RegressionCompetitionScore: 0.1530674846625767



Validation scores:
	RegressionAUROC: 0.6054275035858154
	RegressionCompetitionScore: 0.16717791411042945



Validation scores:
	RegressionAUROC: 0.604906439781189
	RegressionCompetitionScore: 0.1628834355828221



Validation scores:
	RegressionAUROC: 0.6011296510696411
	RegressionCompetitionScore: 0.1521472392638037

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.598628044128418
	RegressionCompetitionScore: 0.1460122699386503



Validation scores:
	RegressionAUROC: 0.5989630222320557
	RegressionCompetitionScore: 0.14355828220858896



Validation scores:
	RegressionAUROC: 0.6006559133529663
	RegressionCompetitionScore: 0.14846625766871166

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6035302877426147
	RegressionCompetitionScore: 0.1460122699386503



Validation scores:
	RegressionAUROC: 0.607542872428894
	RegressionCompetitionScore: 0.16349693251533742



Validation scores:
	RegressionAUROC: 0.6099945306777954
	RegressionCompetitionScore: 0.17730061349693252



Validation scores:
	RegressionAUROC: 0.6097949743270874
	RegressionCompetitionScore: 0.17975460122699385



Validation scores:
	RegressionAUROC: 0.6085202097892761
	RegressionCompetitionScore: 0.18312883435582822



Validation scores:
	RegressionAUROC: 0.6062642335891724
	RegressionCompetitionScore: 0.18435582822085889

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6069437861442566
	RegressionCompetitionScore: 0.18742331288343558

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6089866161346436
	RegressionCompetitionScore: 0.1950920245398773

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6115360260009766
	RegressionCompetitionScore: 0.19539877300613498



Validation scores:
	RegressionAUROC: 0.6149336099624634
	RegressionCompetitionScore: 0.19539877300613498



Validation scores:
	RegressionAUROC: 0.6188270449638367
	RegressionCompetitionScore: 0.19785276073619631



Validation scores:
	RegressionAUROC: 0.6215054392814636
	RegressionCompetitionScore: 0.19938650306748465



Validation scores:
	RegressionAUROC: 0.6224673390388489
	RegressionCompetitionScore: 0.200920245398773



Validation scores:
	RegressionAUROC: 0.6223496198654175
	RegressionCompetitionScore: 0.20337423312883435



Validation scores:
	RegressionAUROC: 0.6215769648551941
	RegressionCompetitionScore: 0.20736196319018405

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6214065551757812
	RegressionCompetitionScore: 0.20705521472392638

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6225749850273132
	RegressionCompetitionScore: 0.20828220858895705

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.623816192150116
	RegressionCompetitionScore: 0.21042944785276074



Validation scores:
	RegressionAUROC: 0.6243836879730225
	RegressionCompetitionScore: 0.2107361963190184



Validation scores:
	RegressionAUROC: 0.6253296136856079
	RegressionCompetitionScore: 0.21104294478527608



Validation scores:
	RegressionAUROC: 0.6266893148422241
	RegressionCompetitionScore: 0.2116564417177914



Validation scores:
	RegressionAUROC: 0.6274391412734985
	RegressionCompetitionScore: 0.21380368098159508



Validation scores:
	RegressionAUROC: 0.62785404920578
	RegressionCompetitionScore: 0.21380368098159508



Validation scores:
	RegressionAUROC: 0.6277066469192505
	RegressionCompetitionScore: 0.2147239263803681

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.202. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.20828220858895705
     Test RegressionAUROC            0.6225749850273132
Test RegressionCompetitionScore      0.20828220858895705
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 05:11:18,420][0m Trial 51 finished with value: 0.20828220858895705 and parameters: {'lr': 1.0613883951552014e-05, 'dropout': 0.5177543496001435, 'd_model_multiplier': 8, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 579, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 5.0161466329168106e-06, 'dropout': 0.49379894607254515, 'd_model_multiplier': 8, 'num_layers': 7, 'n_heads': 4, 'dim_feedforward': 383, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 250 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
250 K     Trainable params
0         Non-trainable params
250 K     Total params
1.002     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4927535951137543
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.42551320791244507
	RegressionCompetitionScore: 0.07515337423312883

Metric val_loss improved. New best score: 0.454


Validation scores:
	RegressionAUROC: 0.4267772436141968
	RegressionCompetitionScore: 0.07392638036809816

Metric val_loss improved by 0.089 >= min_delta = 0.0. New best score: 0.365


Validation scores:
	RegressionAUROC: 0.42787694931030273
	RegressionCompetitionScore: 0.07269938650306748

Metric val_loss improved by 0.068 >= min_delta = 0.0. New best score: 0.297


Validation scores:
	RegressionAUROC: 0.42917269468307495
	RegressionCompetitionScore: 0.0736196319018405

Metric val_loss improved by 0.048 >= min_delta = 0.0. New best score: 0.249


Validation scores:
	RegressionAUROC: 0.4309554100036621
	RegressionCompetitionScore: 0.07239263803680981

Metric val_loss improved by 0.027 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.43302738666534424
	RegressionCompetitionScore: 0.07239263803680981

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.43699660897254944
	RegressionCompetitionScore: 0.07423312883435583



Validation scores:
	RegressionAUROC: 0.4418399930000305
	RegressionCompetitionScore: 0.07699386503067485



Validation scores:
	RegressionAUROC: 0.4472895860671997
	RegressionCompetitionScore: 0.07730061349693251



Validation scores:
	RegressionAUROC: 0.45355573296546936
	RegressionCompetitionScore: 0.0785276073619632



Validation scores:
	RegressionAUROC: 0.4629066586494446
	RegressionCompetitionScore: 0.07791411042944785



Validation scores:
	RegressionAUROC: 0.47262436151504517
	RegressionCompetitionScore: 0.07699386503067485



Validation scores:
	RegressionAUROC: 0.4838758111000061
	RegressionCompetitionScore: 0.0794478527607362

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.214. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.07239263803680981
     Test RegressionAUROC            0.43302738666534424
Test RegressionCompetitionScore      0.07239263803680981
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 05:16:55,102][0m Trial 52 finished with value: 0.07239263803680981 and parameters: {'lr': 5.0161466329168106e-06, 'dropout': 0.49379894607254515, 'd_model_multiplier': 8, 'num_layers': 7, 'n_heads': 4, 'dim_feedforward': 383, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 8.301871101351932e-06, 'dropout': 0.5151882987480895, 'd_model_multiplier': 8, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 526, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 431 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
431 K     Trainable params
0         Non-trainable params
431 K     Total params
1.726     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6521738767623901
	RegressionCompetitionScore: 0.43478260869565216



Validation scores:
	RegressionAUROC: 0.5099698305130005
	RegressionCompetitionScore: 0.07515337423312883

Metric val_loss improved. New best score: 0.269


Validation scores:
	RegressionAUROC: 0.5159198045730591
	RegressionCompetitionScore: 0.08711656441717791

Metric val_loss improved by 0.058 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.5191093683242798
	RegressionCompetitionScore: 0.09693251533742331



Validation scores:
	RegressionAUROC: 0.5230869650840759
	RegressionCompetitionScore: 0.1049079754601227



Validation scores:
	RegressionAUROC: 0.5265119671821594
	RegressionCompetitionScore: 0.1098159509202454



Validation scores:
	RegressionAUROC: 0.5294439792633057
	RegressionCompetitionScore: 0.11104294478527607



Validation scores:
	RegressionAUROC: 0.5329179167747498
	RegressionCompetitionScore: 0.10797546012269939



Validation scores:
	RegressionAUROC: 0.5354900360107422
	RegressionCompetitionScore: 0.10797546012269939

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5378819704055786
	RegressionCompetitionScore: 0.1107361963190184

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5406166911125183
	RegressionCompetitionScore: 0.11411042944785275

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.543665885925293
	RegressionCompetitionScore: 0.11779141104294479

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5453382134437561
	RegressionCompetitionScore: 0.12300613496932515



Validation scores:
	RegressionAUROC: 0.54693603515625
	RegressionCompetitionScore: 0.1325153374233129



Validation scores:
	RegressionAUROC: 0.5489223003387451
	RegressionCompetitionScore: 0.1343558282208589



Validation scores:
	RegressionAUROC: 0.5509644746780396
	RegressionCompetitionScore: 0.14141104294478526



Validation scores:
	RegressionAUROC: 0.5526868104934692
	RegressionCompetitionScore: 0.14049079754601226



Validation scores:
	RegressionAUROC: 0.5548473596572876
	RegressionCompetitionScore: 0.13773006134969326



Validation scores:
	RegressionAUROC: 0.5565004348754883
	RegressionCompetitionScore: 0.13680981595092023

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.208. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.11779141104294479
     Test RegressionAUROC             0.543665885925293
Test RegressionCompetitionScore      0.11779141104294479
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 05:24:31,310][0m Trial 53 finished with value: 0.11779141104294479 and parameters: {'lr': 8.301871101351932e-06, 'dropout': 0.5151882987480895, 'd_model_multiplier': 8, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 526, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 6.43223331576533e-05, 'dropout': 0.5442409128954497, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 4, 'dim_feedforward': 701, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 445 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
445 K     Trainable params
0         Non-trainable params
445 K     Total params
1.781     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7004830837249756
	RegressionCompetitionScore: 0.5217391304347826



Validation scores:
	RegressionAUROC: 0.5596368312835693
	RegressionCompetitionScore: 0.0843558282208589

Metric val_loss improved. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.4335693418979645
	RegressionCompetitionScore: 0.09263803680981596



Validation scores:
	RegressionAUROC: 0.44668859243392944
	RegressionCompetitionScore: 0.09631901840490797



Validation scores:
	RegressionAUROC: 0.4797866642475128
	RegressionCompetitionScore: 0.09417177914110429



Validation scores:
	RegressionAUROC: 0.5442396402359009
	RegressionCompetitionScore: 0.09662576687116564



Validation scores:
	RegressionAUROC: 0.6010704040527344
	RegressionCompetitionScore: 0.13374233128834356

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6326220035552979
	RegressionCompetitionScore: 0.21993865030674847

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6382389068603516
	RegressionCompetitionScore: 0.21595092024539878

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6170623302459717
	RegressionCompetitionScore: 0.11748466257668712



Validation scores:
	RegressionAUROC: 0.5960097312927246
	RegressionCompetitionScore: 0.11288343558282209



Validation scores:
	RegressionAUROC: 0.6272890567779541
	RegressionCompetitionScore: 0.1245398773006135



Validation scores:
	RegressionAUROC: 0.6584903001785278
	RegressionCompetitionScore: 0.2411042944785276



Validation scores:
	RegressionAUROC: 0.663602888584137
	RegressionCompetitionScore: 0.26901840490797546

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6655669212341309
	RegressionCompetitionScore: 0.28496932515337425



Validation scores:
	RegressionAUROC: 0.6652873158454895
	RegressionCompetitionScore: 0.2558282208588957

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6541405916213989
	RegressionCompetitionScore: 0.19171779141104295



Validation scores:
	RegressionAUROC: 0.6604950428009033
	RegressionCompetitionScore: 0.2156441717791411

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6666537523269653
	RegressionCompetitionScore: 0.2450920245398773



Validation scores:
	RegressionAUROC: 0.671244740486145
	RegressionCompetitionScore: 0.26134969325153373

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6675384044647217
	RegressionCompetitionScore: 0.2196319018404908



Validation scores:
	RegressionAUROC: 0.6746135354042053
	RegressionCompetitionScore: 0.24049079754601227



Validation scores:
	RegressionAUROC: 0.6427110433578491
	RegressionCompetitionScore: 0.14141104294478526



Validation scores:
	RegressionAUROC: 0.6397199630737305
	RegressionCompetitionScore: 0.148159509202454



Validation scores:
	RegressionAUROC: 0.672899603843689
	RegressionCompetitionScore: 0.20950920245398774



Validation scores:
	RegressionAUROC: 0.690609335899353
	RegressionCompetitionScore: 0.3015337423312883



Validation scores:
	RegressionAUROC: 0.6957343816757202
	RegressionCompetitionScore: 0.347239263803681

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.6877484321594238
	RegressionCompetitionScore: 0.2598159509202454



Validation scores:
	RegressionAUROC: 0.6715005040168762
	RegressionCompetitionScore: 0.1950920245398773



Validation scores:
	RegressionAUROC: 0.6786602139472961
	RegressionCompetitionScore: 0.2107361963190184



Validation scores:
	RegressionAUROC: 0.6931389570236206
	RegressionCompetitionScore: 0.2822085889570552



Validation scores:
	RegressionAUROC: 0.7001621723175049
	RegressionCompetitionScore: 0.3294478527607362



Validation scores:
	RegressionAUROC: 0.6794366836547852
	RegressionCompetitionScore: 0.20705521472392638



Validation scores:
	RegressionAUROC: 0.6850800514221191
	RegressionCompetitionScore: 0.22607361963190184

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.184. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.347239263803681
     Test RegressionAUROC            0.6957343816757202
Test RegressionCompetitionScore       0.347239263803681
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 05:37:45,068][0m Trial 54 finished with value: 0.347239263803681 and parameters: {'lr': 6.43223331576533e-05, 'dropout': 0.5442409128954497, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 4, 'dim_feedforward': 701, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 0.00013627849730982647, 'dropout': 0.5494536868384515, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 4, 'dim_feedforward': 708, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 448 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
448 K     Trainable params
0         Non-trainable params
448 K     Total params
1.796     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6086956262588501
	RegressionCompetitionScore: 0.391304347826087



Validation scores:
	RegressionAUROC: 0.4661341905593872
	RegressionCompetitionScore: 0.09417177914110429

Metric val_loss improved. New best score: 0.237


Validation scores:
	RegressionAUROC: 0.5994752049446106
	RegressionCompetitionScore: 0.1



Validation scores:
	RegressionAUROC: 0.6110644936561584
	RegressionCompetitionScore: 0.27208588957055213



Validation scores:
	RegressionAUROC: 0.6056466102600098
	RegressionCompetitionScore: 0.2579754601226994

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6151923537254333
	RegressionCompetitionScore: 0.26625766871165646



Validation scores:
	RegressionAUROC: 0.6514752507209778
	RegressionCompetitionScore: 0.23558282208588957



Validation scores:
	RegressionAUROC: 0.669140636920929
	RegressionCompetitionScore: 0.21104294478527608



Validation scores:
	RegressionAUROC: 0.6619183421134949
	RegressionCompetitionScore: 0.2223926380368098



Validation scores:
	RegressionAUROC: 0.6555043458938599
	RegressionCompetitionScore: 0.2233128834355828

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6615575551986694
	RegressionCompetitionScore: 0.21503067484662577



Validation scores:
	RegressionAUROC: 0.6276628971099854
	RegressionCompetitionScore: 0.23466257668711657



Validation scores:
	RegressionAUROC: 0.6493874788284302
	RegressionCompetitionScore: 0.2322085889570552

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6400911808013916
	RegressionCompetitionScore: 0.147239263803681



Validation scores:
	RegressionAUROC: 0.647134006023407
	RegressionCompetitionScore: 0.19233128834355828



Validation scores:
	RegressionAUROC: 0.6635597944259644
	RegressionCompetitionScore: 0.2392638036809816



Validation scores:
	RegressionAUROC: 0.6475712060928345
	RegressionCompetitionScore: 0.24662576687116564



Validation scores:
	RegressionAUROC: 0.646438717842102
	RegressionCompetitionScore: 0.24570552147239264



Validation scores:
	RegressionAUROC: 0.6602145433425903
	RegressionCompetitionScore: 0.2401840490797546



Validation scores:
	RegressionAUROC: 0.6733422875404358
	RegressionCompetitionScore: 0.24294478527607363

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6859728097915649
	RegressionCompetitionScore: 0.26380368098159507



Validation scores:
	RegressionAUROC: 0.6875015497207642
	RegressionCompetitionScore: 0.27085889570552146

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6987693905830383
	RegressionCompetitionScore: 0.252760736196319



Validation scores:
	RegressionAUROC: 0.7029788494110107
	RegressionCompetitionScore: 0.2889570552147239



Validation scores:
	RegressionAUROC: 0.69842529296875
	RegressionCompetitionScore: 0.28190184049079753



Validation scores:
	RegressionAUROC: 0.6846919059753418
	RegressionCompetitionScore: 0.28957055214723926

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.6956243515014648
	RegressionCompetitionScore: 0.2880368098159509



Validation scores:
	RegressionAUROC: 0.7054623961448669
	RegressionCompetitionScore: 0.28957055214723926

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.711229681968689
	RegressionCompetitionScore: 0.2883435582822086



Validation scores:
	RegressionAUROC: 0.7142505645751953
	RegressionCompetitionScore: 0.3098159509202454

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.714547872543335
	RegressionCompetitionScore: 0.3122699386503067



Validation scores:
	RegressionAUROC: 0.7108917236328125
	RegressionCompetitionScore: 0.3303680981595092



Validation scores:
	RegressionAUROC: 0.7114217877388
	RegressionCompetitionScore: 0.34570552147239264



Validation scores:
	RegressionAUROC: 0.7329232096672058
	RegressionCompetitionScore: 0.3193251533742331



Validation scores:
	RegressionAUROC: 0.7334502935409546
	RegressionCompetitionScore: 0.32699386503067485



Validation scores:
	RegressionAUROC: 0.730709433555603
	RegressionCompetitionScore: 0.3309815950920245



Validation scores:
	RegressionAUROC: 0.7287286520004272
	RegressionCompetitionScore: 0.32423312883435584

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.184. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3098159509202454
     Test RegressionAUROC            0.7142505645751953
Test RegressionCompetitionScore      0.3098159509202454
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 05:52:12,601][0m Trial 55 finished with value: 0.3098159509202454 and parameters: {'lr': 0.00013627849730982647, 'dropout': 0.5494536868384515, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 4, 'dim_feedforward': 708, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 8.48345241301116e-05, 'dropout': 0.5880425301634777, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 4, 'dim_feedforward': 717, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 453 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
453 K     Trainable params
0         Non-trainable params
453 K     Total params
1.814     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.487922728061676
	RegressionCompetitionScore: 0.391304347826087



Validation scores:
	RegressionAUROC: 0.49808910489082336
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.483


Validation scores:
	RegressionAUROC: 0.5228436589241028
	RegressionCompetitionScore: 0.1401840490797546

Metric val_loss improved by 0.272 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.5380498170852661
	RegressionCompetitionScore: 0.1539877300613497



Validation scores:
	RegressionAUROC: 0.5353461503982544
	RegressionCompetitionScore: 0.11748466257668712



Validation scores:
	RegressionAUROC: 0.5394200682640076
	RegressionCompetitionScore: 0.10736196319018405

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5766080021858215
	RegressionCompetitionScore: 0.11380368098159509



Validation scores:
	RegressionAUROC: 0.5936364531517029
	RegressionCompetitionScore: 0.10552147239263804

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6092284917831421
	RegressionCompetitionScore: 0.1098159509202454



Validation scores:
	RegressionAUROC: 0.6222437620162964
	RegressionCompetitionScore: 0.17914110429447852



Validation scores:
	RegressionAUROC: 0.6210260391235352
	RegressionCompetitionScore: 0.18343558282208589

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6162337064743042
	RegressionCompetitionScore: 0.18742331288343558



Validation scores:
	RegressionAUROC: 0.6217321157455444
	RegressionCompetitionScore: 0.19539877300613498



Validation scores:
	RegressionAUROC: 0.6280840635299683
	RegressionCompetitionScore: 0.19233128834355828



Validation scores:
	RegressionAUROC: 0.632283091545105
	RegressionCompetitionScore: 0.19662576687116565

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6400808095932007
	RegressionCompetitionScore: 0.20306748466257668



Validation scores:
	RegressionAUROC: 0.6457226872444153
	RegressionCompetitionScore: 0.21625766871165644

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6467245817184448
	RegressionCompetitionScore: 0.2147239263803681

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6483657360076904
	RegressionCompetitionScore: 0.21717791411042944



Validation scores:
	RegressionAUROC: 0.6510111093521118
	RegressionCompetitionScore: 0.22484662576687117



Validation scores:
	RegressionAUROC: 0.652275800704956
	RegressionCompetitionScore: 0.2312883435582822

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6529619693756104
	RegressionCompetitionScore: 0.2352760736196319



Validation scores:
	RegressionAUROC: 0.654963493347168
	RegressionCompetitionScore: 0.2371165644171779



Validation scores:
	RegressionAUROC: 0.6552646160125732
	RegressionCompetitionScore: 0.23773006134969324

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6558887958526611
	RegressionCompetitionScore: 0.2371165644171779



Validation scores:
	RegressionAUROC: 0.6576695442199707
	RegressionCompetitionScore: 0.2371165644171779



Validation scores:
	RegressionAUROC: 0.6585357189178467
	RegressionCompetitionScore: 0.25061349693251533

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.6627870798110962
	RegressionCompetitionScore: 0.2469325153374233



Validation scores:
	RegressionAUROC: 0.6653430461883545
	RegressionCompetitionScore: 0.26226993865030673



Validation scores:
	RegressionAUROC: 0.6665849685668945
	RegressionCompetitionScore: 0.2846625766871166



Validation scores:
	RegressionAUROC: 0.6689416170120239
	RegressionCompetitionScore: 0.2907975460122699



Validation scores:
	RegressionAUROC: 0.6710290312767029
	RegressionCompetitionScore: 0.301840490797546



Validation scores:
	RegressionAUROC: 0.6769028902053833
	RegressionCompetitionScore: 0.30214723926380366



Validation scores:
	RegressionAUROC: 0.6761385202407837
	RegressionCompetitionScore: 0.2656441717791411

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6802942752838135
	RegressionCompetitionScore: 0.27116564417177913



Validation scores:
	RegressionAUROC: 0.6870248317718506
	RegressionCompetitionScore: 0.2969325153374233

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.6899867057800293
	RegressionCompetitionScore: 0.2812883435582822



Validation scores:
	RegressionAUROC: 0.6930086016654968
	RegressionCompetitionScore: 0.2822085889570552



Validation scores:
	RegressionAUROC: 0.6949868202209473
	RegressionCompetitionScore: 0.2757668711656442



Validation scores:
	RegressionAUROC: 0.6950423717498779
	RegressionCompetitionScore: 0.2822085889570552



Validation scores:
	RegressionAUROC: 0.6968050003051758
	RegressionCompetitionScore: 0.2782208588957055



Validation scores:
	RegressionAUROC: 0.6982575058937073
	RegressionCompetitionScore: 0.2898773006134969



Validation scores:
	RegressionAUROC: 0.701338529586792
	RegressionCompetitionScore: 0.2892638036809816

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.188. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2969325153374233
     Test RegressionAUROC            0.6870248317718506
Test RegressionCompetitionScore      0.2969325153374233
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 06:09:09,032][0m Trial 56 finished with value: 0.2969325153374233 and parameters: {'lr': 8.48345241301116e-05, 'dropout': 0.5880425301634777, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 4, 'dim_feedforward': 717, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 0.00012454151102211827, 'dropout': 0.6159301299706736, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 4, 'dim_feedforward': 712, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 450 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
450 K     Trainable params
0         Non-trainable params
450 K     Total params
1.804     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6086956262588501
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.6189212203025818
	RegressionCompetitionScore: 0.18558282208588958

Metric val_loss improved. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.608636736869812
	RegressionCompetitionScore: 0.21411042944785277



Validation scores:
	RegressionAUROC: 0.608677089214325
	RegressionCompetitionScore: 0.18926380368098158



Validation scores:
	RegressionAUROC: 0.6111213564872742
	RegressionCompetitionScore: 0.18865030674846625



Validation scores:
	RegressionAUROC: 0.6121903657913208
	RegressionCompetitionScore: 0.16165644171779142



Validation scores:
	RegressionAUROC: 0.6259245872497559
	RegressionCompetitionScore: 0.23190184049079754

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6230977773666382
	RegressionCompetitionScore: 0.24539877300613497



Validation scores:
	RegressionAUROC: 0.6264010667800903
	RegressionCompetitionScore: 0.248159509202454



Validation scores:
	RegressionAUROC: 0.6422336101531982
	RegressionCompetitionScore: 0.24723926380368097



Validation scores:
	RegressionAUROC: 0.6510730981826782
	RegressionCompetitionScore: 0.2371165644171779



Validation scores:
	RegressionAUROC: 0.6564490795135498
	RegressionCompetitionScore: 0.24631901840490797



Validation scores:
	RegressionAUROC: 0.6610085964202881
	RegressionCompetitionScore: 0.2441717791411043

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6648961901664734
	RegressionCompetitionScore: 0.25122699386503067



Validation scores:
	RegressionAUROC: 0.6687421798706055
	RegressionCompetitionScore: 0.2558282208588957

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6717406511306763
	RegressionCompetitionScore: 0.2558282208588957



Validation scores:
	RegressionAUROC: 0.6694701313972473
	RegressionCompetitionScore: 0.2450920245398773



Validation scores:
	RegressionAUROC: 0.674887478351593
	RegressionCompetitionScore: 0.2659509202453988



Validation scores:
	RegressionAUROC: 0.6812118291854858
	RegressionCompetitionScore: 0.2920245398773006



Validation scores:
	RegressionAUROC: 0.6817394495010376
	RegressionCompetitionScore: 0.297239263803681



Validation scores:
	RegressionAUROC: 0.6856169700622559
	RegressionCompetitionScore: 0.28282208588957053



Validation scores:
	RegressionAUROC: 0.6981782913208008
	RegressionCompetitionScore: 0.2892638036809816

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.194. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2558282208588957
     Test RegressionAUROC            0.6687421798706055
Test RegressionCompetitionScore      0.2558282208588957
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 06:17:51,789][0m Trial 57 finished with value: 0.2558282208588957 and parameters: {'lr': 0.00012454151102211827, 'dropout': 0.6159301299706736, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 4, 'dim_feedforward': 712, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 0.00013635803546376948, 'dropout': 0.5930122239922401, 'd_model_multiplier': 8, 'num_layers': 11, 'n_heads': 4, 'dim_feedforward': 596, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 520 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
520 K     Trainable params
0         Non-trainable params
520 K     Total params
2.080     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4917829632759094
	RegressionCompetitionScore: 0.06717791411042945

Metric val_loss improved. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5939767956733704
	RegressionCompetitionScore: 0.1628834355828221



Validation scores:
	RegressionAUROC: 0.6311824917793274
	RegressionCompetitionScore: 0.2401840490797546



Validation scores:
	RegressionAUROC: 0.6225849986076355
	RegressionCompetitionScore: 0.2748466257668712

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.624169111251831
	RegressionCompetitionScore: 0.2911042944785276



Validation scores:
	RegressionAUROC: 0.6294435858726501
	RegressionCompetitionScore: 0.2800613496932515

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6454514861106873
	RegressionCompetitionScore: 0.2785276073619632



Validation scores:
	RegressionAUROC: 0.6548366546630859
	RegressionCompetitionScore: 0.2822085889570552



Validation scores:
	RegressionAUROC: 0.6699268221855164
	RegressionCompetitionScore: 0.2874233128834356

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6880078315734863
	RegressionCompetitionScore: 0.298159509202454



Validation scores:
	RegressionAUROC: 0.6923811435699463
	RegressionCompetitionScore: 0.2714723926380368



Validation scores:
	RegressionAUROC: 0.692988395690918
	RegressionCompetitionScore: 0.26932515337423313



Validation scores:
	RegressionAUROC: 0.6953120827674866
	RegressionCompetitionScore: 0.2668711656441718



Validation scores:
	RegressionAUROC: 0.6963869333267212
	RegressionCompetitionScore: 0.2677914110429448



Validation scores:
	RegressionAUROC: 0.6976864337921143
	RegressionCompetitionScore: 0.27085889570552146

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6970173120498657
	RegressionCompetitionScore: 0.26993865030674846



Validation scores:
	RegressionAUROC: 0.7009575366973877
	RegressionCompetitionScore: 0.2677914110429448



Validation scores:
	RegressionAUROC: 0.700692892074585
	RegressionCompetitionScore: 0.26411042944785273



Validation scores:
	RegressionAUROC: 0.7033631205558777
	RegressionCompetitionScore: 0.2634969325153374



Validation scores:
	RegressionAUROC: 0.7092363834381104
	RegressionCompetitionScore: 0.297239263803681



Validation scores:
	RegressionAUROC: 0.7044061422348022
	RegressionCompetitionScore: 0.30828220858895705

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7045442461967468
	RegressionCompetitionScore: 0.3147239263803681



Validation scores:
	RegressionAUROC: 0.6997390985488892
	RegressionCompetitionScore: 0.3285276073619632

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7063001394271851
	RegressionCompetitionScore: 0.32975460122699385



Validation scores:
	RegressionAUROC: 0.7040656208992004
	RegressionCompetitionScore: 0.34355828220858897

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7147443294525146
	RegressionCompetitionScore: 0.3401840490797546



Validation scores:
	RegressionAUROC: 0.7254890203475952
	RegressionCompetitionScore: 0.3205521472392638

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7257775068283081
	RegressionCompetitionScore: 0.32085889570552145



Validation scores:
	RegressionAUROC: 0.7171038389205933
	RegressionCompetitionScore: 0.3521472392638037



Validation scores:
	RegressionAUROC: 0.709017276763916
	RegressionCompetitionScore: 0.3911042944785276



Validation scores:
	RegressionAUROC: 0.7089361548423767
	RegressionCompetitionScore: 0.3932515337423313



Validation scores:
	RegressionAUROC: 0.7263282537460327
	RegressionCompetitionScore: 0.3815950920245399

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7333436012268066
	RegressionCompetitionScore: 0.3411042944785276



Validation scores:
	RegressionAUROC: 0.7307754158973694
	RegressionCompetitionScore: 0.3374233128834356



Validation scores:
	RegressionAUROC: 0.7293544411659241
	RegressionCompetitionScore: 0.33404907975460124



Validation scores:
	RegressionAUROC: 0.7294020056724548
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7334117889404297
	RegressionCompetitionScore: 0.3411042944785276



Validation scores:
	RegressionAUROC: 0.736665666103363
	RegressionCompetitionScore: 0.3401840490797546



Validation scores:
	RegressionAUROC: 0.7384843230247498
	RegressionCompetitionScore: 0.347239263803681

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3815950920245399
     Test RegressionAUROC            0.7263282537460327
Test RegressionCompetitionScore      0.3815950920245399
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 06:33:36,527][0m Trial 58 finished with value: 0.3815950920245399 and parameters: {'lr': 0.00013635803546376948, 'dropout': 0.5930122239922401, 'd_model_multiplier': 8, 'num_layers': 11, 'n_heads': 4, 'dim_feedforward': 596, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 0.00012068080871092934, 'dropout': 0.5962262258511559, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 4, 'dim_feedforward': 596, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 390 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
390 K     Trainable params
0         Non-trainable params
390 K     Total params
1.563     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5013315677642822
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.736


Validation scores:
	RegressionAUROC: 0.5309902429580688
	RegressionCompetitionScore: 0.1

Metric val_loss improved by 0.516 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.5521149039268494
	RegressionCompetitionScore: 0.1196319018404908



Validation scores:
	RegressionAUROC: 0.580712080001831
	RegressionCompetitionScore: 0.1273006134969325

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.6076736450195312
	RegressionCompetitionScore: 0.13680981595092023



Validation scores:
	RegressionAUROC: 0.6307148933410645
	RegressionCompetitionScore: 0.1361963190184049

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6420700550079346
	RegressionCompetitionScore: 0.12883435582822086

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6466957330703735
	RegressionCompetitionScore: 0.12300613496932515



Validation scores:
	RegressionAUROC: 0.6558624505996704
	RegressionCompetitionScore: 0.1401840490797546



Validation scores:
	RegressionAUROC: 0.6496722102165222
	RegressionCompetitionScore: 0.12607361963190183



Validation scores:
	RegressionAUROC: 0.6381100416183472
	RegressionCompetitionScore: 0.12975460122699387



Validation scores:
	RegressionAUROC: 0.6473760604858398
	RegressionCompetitionScore: 0.1343558282208589



Validation scores:
	RegressionAUROC: 0.6686817407608032
	RegressionCompetitionScore: 0.15184049079754602



Validation scores:
	RegressionAUROC: 0.6826333999633789
	RegressionCompetitionScore: 0.2303680981595092

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.204. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.12883435582822086
     Test RegressionAUROC            0.6420700550079346
Test RegressionCompetitionScore      0.12883435582822086
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 06:39:34,245][0m Trial 59 finished with value: 0.12883435582822086 and parameters: {'lr': 0.00012068080871092934, 'dropout': 0.5962262258511559, 'd_model_multiplier': 8, 'num_layers': 8, 'n_heads': 4, 'dim_feedforward': 596, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 0.00020906385281729484, 'dropout': 0.641352490332422, 'd_model_multiplier': 8, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 645, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 462 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
462 K     Trainable params
0         Non-trainable params
462 K     Total params
1.850     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3285024166107178
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.42388975620269775
	RegressionCompetitionScore: 0.09417177914110429

Metric val_loss improved. New best score: 0.271


Validation scores:
	RegressionAUROC: 0.5957831740379333
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.572044849395752
	RegressionCompetitionScore: 0.08619631901840491

Metric val_loss improved by 0.062 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6236569881439209
	RegressionCompetitionScore: 0.08558282208588958



Validation scores:
	RegressionAUROC: 0.6393392086029053
	RegressionCompetitionScore: 0.25245398773006134



Validation scores:
	RegressionAUROC: 0.6381384134292603
	RegressionCompetitionScore: 0.2800613496932515

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6383666396141052
	RegressionCompetitionScore: 0.28067484662576686

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6445623636245728
	RegressionCompetitionScore: 0.28680981595092025



Validation scores:
	RegressionAUROC: 0.6528359651565552
	RegressionCompetitionScore: 0.3024539877300613



Validation scores:
	RegressionAUROC: 0.656795859336853
	RegressionCompetitionScore: 0.2852760736196319



Validation scores:
	RegressionAUROC: 0.6562905311584473
	RegressionCompetitionScore: 0.2696319018404908



Validation scores:
	RegressionAUROC: 0.6552156209945679
	RegressionCompetitionScore: 0.2588957055214724



Validation scores:
	RegressionAUROC: 0.6512699127197266
	RegressionCompetitionScore: 0.25030674846625767

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6444891691207886
	RegressionCompetitionScore: 0.24141104294478527



Validation scores:
	RegressionAUROC: 0.6402180790901184
	RegressionCompetitionScore: 0.21809815950920244

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6450749635696411
	RegressionCompetitionScore: 0.22914110429447854

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.646751880645752
	RegressionCompetitionScore: 0.23067484662576687



Validation scores:
	RegressionAUROC: 0.652640163898468
	RegressionCompetitionScore: 0.25061349693251533



Validation scores:
	RegressionAUROC: 0.6711183190345764
	RegressionCompetitionScore: 0.27208588957055213

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6783089637756348
	RegressionCompetitionScore: 0.2874233128834356

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.6850554943084717
	RegressionCompetitionScore: 0.3042944785276074

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6862494945526123
	RegressionCompetitionScore: 0.33496932515337424



Validation scores:
	RegressionAUROC: 0.6898976564407349
	RegressionCompetitionScore: 0.3085889570552147



Validation scores:
	RegressionAUROC: 0.690558910369873
	RegressionCompetitionScore: 0.3088957055214724

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6937017440795898
	RegressionCompetitionScore: 0.36073619631901843



Validation scores:
	RegressionAUROC: 0.7000865340232849
	RegressionCompetitionScore: 0.33496932515337424

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.703040361404419
	RegressionCompetitionScore: 0.36012269938650304



Validation scores:
	RegressionAUROC: 0.7076066136360168
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7065129280090332
	RegressionCompetitionScore: 0.32177914110429445



Validation scores:
	RegressionAUROC: 0.6994094848632812
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7069714069366455
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7083261013031006
	RegressionCompetitionScore: 0.32515337423312884



Validation scores:
	RegressionAUROC: 0.7088059186935425
	RegressionCompetitionScore: 0.3245398773006135

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.188. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.33496932515337424
     Test RegressionAUROC            0.7000865340232849
Test RegressionCompetitionScore      0.33496932515337424
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 06:52:57,420][0m Trial 60 finished with value: 0.33496932515337424 and parameters: {'lr': 0.00020906385281729484, 'dropout': 0.641352490332422, 'd_model_multiplier': 8, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 645, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 0.00023524555736404787, 'dropout': 0.6354602609963869, 'd_model_multiplier': 8, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 635, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 456 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
456 K     Trainable params
0         Non-trainable params
456 K     Total params
1.826     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.545893669128418
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.42340320348739624
	RegressionCompetitionScore: 0.08895705521472393

Metric val_loss improved. New best score: 0.518


Validation scores:
	RegressionAUROC: 0.5956454277038574
	RegressionCompetitionScore: 0.16717791411042945

Metric val_loss improved by 0.281 >= min_delta = 0.0. New best score: 0.236


Validation scores:
	RegressionAUROC: 0.5975251197814941
	RegressionCompetitionScore: 0.1638036809815951



Validation scores:
	RegressionAUROC: 0.6286999583244324
	RegressionCompetitionScore: 0.252760736196319



Validation scores:
	RegressionAUROC: 0.6420118808746338
	RegressionCompetitionScore: 0.26104294478527607

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.6493212580680847
	RegressionCompetitionScore: 0.22883435582822087



Validation scores:
	RegressionAUROC: 0.6597976088523865
	RegressionCompetitionScore: 0.21226993865030674



Validation scores:
	RegressionAUROC: 0.6700986623764038
	RegressionCompetitionScore: 0.20061349693251534



Validation scores:
	RegressionAUROC: 0.6759787797927856
	RegressionCompetitionScore: 0.20460122699386504

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.6816319227218628
	RegressionCompetitionScore: 0.201840490797546



Validation scores:
	RegressionAUROC: 0.6823197603225708
	RegressionCompetitionScore: 0.23374233128834357

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6834855079650879
	RegressionCompetitionScore: 0.24141104294478527

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6857331991195679
	RegressionCompetitionScore: 0.2420245398773006



Validation scores:
	RegressionAUROC: 0.6783066391944885
	RegressionCompetitionScore: 0.27699386503067486



Validation scores:
	RegressionAUROC: 0.6797820329666138
	RegressionCompetitionScore: 0.28159509202453986



Validation scores:
	RegressionAUROC: 0.6695742607116699
	RegressionCompetitionScore: 0.3061349693251534

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6701232194900513
	RegressionCompetitionScore: 0.31196319018404906



Validation scores:
	RegressionAUROC: 0.6695230007171631
	RegressionCompetitionScore: 0.3070552147239264

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6762809157371521
	RegressionCompetitionScore: 0.3107361963190184



Validation scores:
	RegressionAUROC: 0.6878446340560913
	RegressionCompetitionScore: 0.29386503067484665



Validation scores:
	RegressionAUROC: 0.7035945057868958
	RegressionCompetitionScore: 0.23282208588957054

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.702424168586731
	RegressionCompetitionScore: 0.2196319018404908



Validation scores:
	RegressionAUROC: 0.7017892599105835
	RegressionCompetitionScore: 0.21901840490797547

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6898986101150513
	RegressionCompetitionScore: 0.297239263803681



Validation scores:
	RegressionAUROC: 0.69947350025177
	RegressionCompetitionScore: 0.2312883435582822



Validation scores:
	RegressionAUROC: 0.6969467997550964
	RegressionCompetitionScore: 0.21380368098159508

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6933984756469727
	RegressionCompetitionScore: 0.19141104294478528



Validation scores:
	RegressionAUROC: 0.7031359672546387
	RegressionCompetitionScore: 0.27208588957055213

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7059996724128723
	RegressionCompetitionScore: 0.2754601226993865



Validation scores:
	RegressionAUROC: 0.7036912441253662
	RegressionCompetitionScore: 0.3095092024539877



Validation scores:
	RegressionAUROC: 0.7169927358627319
	RegressionCompetitionScore: 0.2782208588957055



Validation scores:
	RegressionAUROC: 0.7157013416290283
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7171833515167236
	RegressionCompetitionScore: 0.27791411042944786

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7203845977783203
	RegressionCompetitionScore: 0.2776073619631902



Validation scores:
	RegressionAUROC: 0.7219645977020264
	RegressionCompetitionScore: 0.2901840490797546



Validation scores:
	RegressionAUROC: 0.7181452512741089
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7171698808670044
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7133073806762695
	RegressionCompetitionScore: 0.28067484662576686



Validation scores:
	RegressionAUROC: 0.727502703666687
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7290997505187988
	RegressionCompetitionScore: 0.3113496932515337

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.186. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.27791411042944786
     Test RegressionAUROC            0.7171833515167236
Test RegressionCompetitionScore      0.27791411042944786
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 07:08:59,962][0m Trial 61 finished with value: 0.27791411042944786 and parameters: {'lr': 0.00023524555736404787, 'dropout': 0.6354602609963869, 'd_model_multiplier': 8, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 635, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 6.874447100649644e-05, 'dropout': 0.6487756879465846, 'd_model_multiplier': 8, 'num_layers': 11, 'n_heads': 4, 'dim_feedforward': 703, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 596 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
596 K     Trainable params
0         Non-trainable params
596 K     Total params
2.386     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6047475337982178
	RegressionCompetitionScore: 0.22484662576687117

Metric val_loss improved. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.6160564422607422
	RegressionCompetitionScore: 0.24447852760736197

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6135159730911255
	RegressionCompetitionScore: 0.2343558282208589

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.608784019947052
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6021155714988708
	RegressionCompetitionScore: 0.16840490797546012



Validation scores:
	RegressionAUROC: 0.6030906438827515
	RegressionCompetitionScore: 0.1659509202453988



Validation scores:
	RegressionAUROC: 0.6048241257667542
	RegressionCompetitionScore: 0.14693251533742333



Validation scores:
	RegressionAUROC: 0.6074044704437256
	RegressionCompetitionScore: 0.1196319018404908



Validation scores:
	RegressionAUROC: 0.6039950847625732
	RegressionCompetitionScore: 0.09386503067484663



Validation scores:
	RegressionAUROC: 0.5899006724357605
	RegressionCompetitionScore: 0.08251533742331288

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.202. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2343558282208589
     Test RegressionAUROC            0.6135159730911255
Test RegressionCompetitionScore      0.2343558282208589
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 07:13:25,430][0m Trial 62 finished with value: 0.2343558282208589 and parameters: {'lr': 6.874447100649644e-05, 'dropout': 0.6487756879465846, 'd_model_multiplier': 8, 'num_layers': 11, 'n_heads': 4, 'dim_feedforward': 703, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 0.0001887785033884619, 'dropout': 0.6711333020698264, 'd_model_multiplier': 8, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 756, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 527 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
527 K     Trainable params
0         Non-trainable params
527 K     Total params
2.109     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5652173757553101
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.4888507127761841
	RegressionCompetitionScore: 0.05705521472392638

Metric val_loss improved. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.5068460702896118
	RegressionCompetitionScore: 0.07699386503067485



Validation scores:
	RegressionAUROC: 0.6184468269348145
	RegressionCompetitionScore: 0.26809815950920246

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6033936738967896
	RegressionCompetitionScore: 0.26901840490797546

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6048926115036011
	RegressionCompetitionScore: 0.2668711656441718



Validation scores:
	RegressionAUROC: 0.6057477593421936
	RegressionCompetitionScore: 0.2665644171779141



Validation scores:
	RegressionAUROC: 0.6075189113616943
	RegressionCompetitionScore: 0.25245398773006134



Validation scores:
	RegressionAUROC: 0.6042354106903076
	RegressionCompetitionScore: 0.23404907975460124



Validation scores:
	RegressionAUROC: 0.6038333177566528
	RegressionCompetitionScore: 0.2174846625766871



Validation scores:
	RegressionAUROC: 0.6092851758003235
	RegressionCompetitionScore: 0.21196319018404908



Validation scores:
	RegressionAUROC: 0.6101468801498413
	RegressionCompetitionScore: 0.21012269938650308

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.197. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.26901840490797546
     Test RegressionAUROC            0.6033936738967896
Test RegressionCompetitionScore      0.26901840490797546
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 07:18:11,672][0m Trial 63 finished with value: 0.26901840490797546 and parameters: {'lr': 0.0001887785033884619, 'dropout': 0.6711333020698264, 'd_model_multiplier': 8, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 756, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 0.00047064207069946073, 'dropout': 0.6023685317465179, 'd_model_multiplier': 8, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 597, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 477 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
477 K     Trainable params
0         Non-trainable params
477 K     Total params
1.910     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4444444179534912
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 5.008


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 4.431 >= min_delta = 0.0. New best score: 0.577


Validation scores:
	RegressionAUROC: 0.34374916553497314
	RegressionCompetitionScore: 0.07116564417177915

Metric val_loss improved by 0.256 >= min_delta = 0.0. New best score: 0.321


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5018768310546875
	RegressionCompetitionScore: 0.04754601226993865

Metric val_loss improved by 0.109 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5042116045951843
	RegressionCompetitionScore: 0.056134969325153376



Validation scores:
	RegressionAUROC: 0.4850097596645355
	RegressionCompetitionScore: 0.06226993865030675



Validation scores:
	RegressionAUROC: 0.4822348654270172
	RegressionCompetitionScore: 0.056134969325153376



Validation scores:
	RegressionAUROC: 0.48916614055633545
	RegressionCompetitionScore: 0.05521472392638037

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5013341903686523
	RegressionCompetitionScore: 0.044171779141104296



Validation scores:
	RegressionAUROC: 0.5349088907241821
	RegressionCompetitionScore: 0.048466257668711654



Validation scores:
	RegressionAUROC: 0.5737314820289612
	RegressionCompetitionScore: 0.08220858895705521



Validation scores:
	RegressionAUROC: 0.5994136333465576
	RegressionCompetitionScore: 0.13588957055214723



Validation scores:
	RegressionAUROC: 0.619800329208374
	RegressionCompetitionScore: 0.19079754601226995



Validation scores:
	RegressionAUROC: 0.6262986660003662
	RegressionCompetitionScore: 0.19907975460122698



Validation scores:
	RegressionAUROC: 0.6322994232177734
	RegressionCompetitionScore: 0.2174846625766871

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.210. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.05521472392638037
     Test RegressionAUROC            0.48916614055633545
Test RegressionCompetitionScore      0.05521472392638037
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 07:25:05,232][0m Trial 64 finished with value: 0.05521472392638037 and parameters: {'lr': 0.00047064207069946073, 'dropout': 0.6023685317465179, 'd_model_multiplier': 8, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 597, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 5.817844609044443e-05, 'dropout': 0.5811206268587168, 'd_model_multiplier': 4, 'num_layers': 11, 'n_heads': 4, 'dim_feedforward': 545, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 241 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
241 K     Trainable params
0         Non-trainable params
241 K     Total params
0.966     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.404474675655365
	RegressionCompetitionScore: 0.0745398773006135

Metric val_loss improved. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.41583776473999023
	RegressionCompetitionScore: 0.08190184049079755



Validation scores:
	RegressionAUROC: 0.45298734307289124
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4361136555671692
	RegressionCompetitionScore: 0.0803680981595092



Validation scores:
	RegressionAUROC: 0.47341036796569824
	RegressionCompetitionScore: 0.08466257668711656

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.531103253364563
	RegressionCompetitionScore: 0.12147239263803682

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.573952317237854
	RegressionCompetitionScore: 0.17699386503067485

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5808687210083008
	RegressionCompetitionScore: 0.19969325153374234



Validation scores:
	RegressionAUROC: 0.5836304426193237
	RegressionCompetitionScore: 0.20644171779141104



Validation scores:
	RegressionAUROC: 0.5852217674255371
	RegressionCompetitionScore: 0.20828220858895705

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5867709517478943
	RegressionCompetitionScore: 0.21993865030674847



Validation scores:
	RegressionAUROC: 0.5896179676055908
	RegressionCompetitionScore: 0.2214723926380368



Validation scores:
	RegressionAUROC: 0.5931257009506226
	RegressionCompetitionScore: 0.2214723926380368



Validation scores:
	RegressionAUROC: 0.5966463088989258
	RegressionCompetitionScore: 0.21901840490797547



Validation scores:
	RegressionAUROC: 0.5999335646629333
	RegressionCompetitionScore: 0.22883435582822087



Validation scores:
	RegressionAUROC: 0.6021440625190735
	RegressionCompetitionScore: 0.23588957055214724

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6036232709884644
	RegressionCompetitionScore: 0.23957055214723927



Validation scores:
	RegressionAUROC: 0.6039275527000427
	RegressionCompetitionScore: 0.2273006134969325



Validation scores:
	RegressionAUROC: 0.6040945053100586
	RegressionCompetitionScore: 0.2254601226993865



Validation scores:
	RegressionAUROC: 0.6053355932235718
	RegressionCompetitionScore: 0.2273006134969325



Validation scores:
	RegressionAUROC: 0.6067774295806885
	RegressionCompetitionScore: 0.22576687116564417



Validation scores:
	RegressionAUROC: 0.6077256202697754
	RegressionCompetitionScore: 0.22269938650306748



Validation scores:
	RegressionAUROC: 0.6107261180877686
	RegressionCompetitionScore: 0.21319018404907975

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.208. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.23588957055214724
     Test RegressionAUROC            0.6021440625190735
Test RegressionCompetitionScore      0.23588957055214724
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 07:34:43,767][0m Trial 65 finished with value: 0.23588957055214724 and parameters: {'lr': 5.817844609044443e-05, 'dropout': 0.5811206268587168, 'd_model_multiplier': 4, 'num_layers': 11, 'n_heads': 4, 'dim_feedforward': 545, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 3.6756098382064294e-05, 'dropout': 0.5509507269138395, 'd_model_multiplier': 8, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 631, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 454 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
454 K     Trainable params
0         Non-trainable params
454 K     Total params
1.817     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6055948138237
	RegressionCompetitionScore: 0.2794478527607362

Metric val_loss improved. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.6188789010047913
	RegressionCompetitionScore: 0.12822085889570553

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.597253680229187
	RegressionCompetitionScore: 0.0598159509202454

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.6643334627151489
	RegressionCompetitionScore: 0.19846625766871165

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6833692193031311
	RegressionCompetitionScore: 0.21226993865030674



Validation scores:
	RegressionAUROC: 0.6901923418045044
	RegressionCompetitionScore: 0.2634969325153374

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7027277946472168
	RegressionCompetitionScore: 0.24631901840490797



Validation scores:
	RegressionAUROC: 0.7065476775169373
	RegressionCompetitionScore: 0.3067484662576687



Validation scores:
	RegressionAUROC: 0.7127256393432617
	RegressionCompetitionScore: 0.31717791411042945



Validation scores:
	RegressionAUROC: 0.7317266464233398
	RegressionCompetitionScore: 0.3361963190184049



Validation scores:
	RegressionAUROC: 0.7270711660385132
	RegressionCompetitionScore: 0.3273006134969325

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7307837009429932
	RegressionCompetitionScore: 0.3128834355828221



Validation scores:
	RegressionAUROC: 0.7203618884086609
	RegressionCompetitionScore: 0.31717791411042945



Validation scores:
	RegressionAUROC: 0.7225571870803833
	RegressionCompetitionScore: 0.30920245398773005



Validation scores:
	RegressionAUROC: 0.7328625321388245
	RegressionCompetitionScore: 0.3226993865030675

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.735535740852356
	RegressionCompetitionScore: 0.3337423312883436



Validation scores:
	RegressionAUROC: 0.7394858598709106
	RegressionCompetitionScore: 0.31012269938650305



Validation scores:
	RegressionAUROC: 0.7310697436332703
	RegressionCompetitionScore: 0.3248466257668712



Validation scores:
	RegressionAUROC: 0.7350918054580688
	RegressionCompetitionScore: 0.3423312883435583



Validation scores:
	RegressionAUROC: 0.7442771792411804
	RegressionCompetitionScore: 0.36073619631901843



Validation scores:
	RegressionAUROC: 0.7447572946548462
	RegressionCompetitionScore: 0.32423312883435584



Validation scores:
	RegressionAUROC: 0.7239614725112915
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3226993865030675
     Test RegressionAUROC            0.7328625321388245
Test RegressionCompetitionScore      0.3226993865030675
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 07:44:51,244][0m Trial 66 finished with value: 0.3226993865030675 and parameters: {'lr': 3.6756098382064294e-05, 'dropout': 0.5509507269138395, 'd_model_multiplier': 8, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 631, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 4.228623034515019e-05, 'dropout': 0.5477854681970941, 'd_model_multiplier': 2, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 652, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 137 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
137 K     Trainable params
0         Non-trainable params
137 K     Total params
0.551     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6458333134651184
	RegressionCompetitionScore: 0.5833333333333334



Validation scores:
	RegressionAUROC: 0.4698713421821594
	RegressionCompetitionScore: 0.06779141104294478

Metric val_loss improved. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.5113252401351929
	RegressionCompetitionScore: 0.07760736196319018

Metric val_loss improved by 0.041 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.4964076280593872
	RegressionCompetitionScore: 0.12822085889570553



Validation scores:
	RegressionAUROC: 0.5119125843048096
	RegressionCompetitionScore: 0.1312883435582822



Validation scores:
	RegressionAUROC: 0.5927928686141968
	RegressionCompetitionScore: 0.13404907975460123



Validation scores:
	RegressionAUROC: 0.6065490245819092
	RegressionCompetitionScore: 0.11134969325153374

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6212537288665771
	RegressionCompetitionScore: 0.11441717791411044



Validation scores:
	RegressionAUROC: 0.6163280606269836
	RegressionCompetitionScore: 0.11779141104294479



Validation scores:
	RegressionAUROC: 0.6032763719558716
	RegressionCompetitionScore: 0.19478527607361965



Validation scores:
	RegressionAUROC: 0.6408796310424805
	RegressionCompetitionScore: 0.1705521472392638



Validation scores:
	RegressionAUROC: 0.6189757585525513
	RegressionCompetitionScore: 0.18834355828220858



Validation scores:
	RegressionAUROC: 0.6251246929168701
	RegressionCompetitionScore: 0.2107361963190184

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6270081400871277
	RegressionCompetitionScore: 0.1726993865030675



Validation scores:
	RegressionAUROC: 0.6257933378219604
	RegressionCompetitionScore: 0.1325153374233129

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6427895426750183
	RegressionCompetitionScore: 0.18496932515337422



Validation scores:
	RegressionAUROC: 0.650640606880188
	RegressionCompetitionScore: 0.26901840490797546



Validation scores:
	RegressionAUROC: 0.6484662294387817
	RegressionCompetitionScore: 0.1677914110429448



Validation scores:
	RegressionAUROC: 0.6686784029006958
	RegressionCompetitionScore: 0.27423312883435585



Validation scores:
	RegressionAUROC: 0.6893925666809082
	RegressionCompetitionScore: 0.3193251533742331

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7051491141319275
	RegressionCompetitionScore: 0.34478527607361964

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7119574546813965
	RegressionCompetitionScore: 0.3236196319018405

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7187504768371582
	RegressionCompetitionScore: 0.3245398773006135



Validation scores:
	RegressionAUROC: 0.7280431389808655
	RegressionCompetitionScore: 0.2880368098159509

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7199066877365112
	RegressionCompetitionScore: 0.2668711656441718

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7352498769760132
	RegressionCompetitionScore: 0.3116564417177914

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7401597499847412
	RegressionCompetitionScore: 0.3165644171779141



Validation scores:
	RegressionAUROC: 0.7377504110336304
	RegressionCompetitionScore: 0.3122699386503067



Validation scores:
	RegressionAUROC: 0.7328290343284607
	RegressionCompetitionScore: 0.3276073619631902



Validation scores:
	RegressionAUROC: 0.7454497218132019
	RegressionCompetitionScore: 0.3309815950920245

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7342063784599304
	RegressionCompetitionScore: 0.344478527607362



Validation scores:
	RegressionAUROC: 0.749413013458252
	RegressionCompetitionScore: 0.3401840490797546

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7423824071884155
	RegressionCompetitionScore: 0.34294478527607364



Validation scores:
	RegressionAUROC: 0.7393126487731934
	RegressionCompetitionScore: 0.32699386503067485



Validation scores:
	RegressionAUROC: 0.741133451461792
	RegressionCompetitionScore: 0.33159509202453985



Validation scores:
	RegressionAUROC: 0.7450143098831177
	RegressionCompetitionScore: 0.36625766871165644

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7445075511932373
	RegressionCompetitionScore: 0.37055214723926383



Validation scores:
	RegressionAUROC: 0.7434230446815491
	RegressionCompetitionScore: 0.37116564417177916



Validation scores:
	RegressionAUROC: 0.7377604842185974
	RegressionCompetitionScore: 0.3352760736196319



Validation scores:
	RegressionAUROC: 0.7433828115463257
	RegressionCompetitionScore: 0.34570552147239264



Validation scores:
	RegressionAUROC: 0.7331104278564453
	RegressionCompetitionScore: 0.36226993865030677



Validation scores:
	RegressionAUROC: 0.7405382990837097
	RegressionCompetitionScore: 0.34938650306748464



Validation scores:
	RegressionAUROC: 0.7387304902076721
	RegressionCompetitionScore: 0.3595092024539877

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.173. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36625766871165644
     Test RegressionAUROC            0.7450143098831177
Test RegressionCompetitionScore      0.36625766871165644
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 08:04:19,415][0m Trial 67 finished with value: 0.36625766871165644 and parameters: {'lr': 4.228623034515019e-05, 'dropout': 0.5477854681970941, 'd_model_multiplier': 2, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 652, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 3.885802546669415e-05, 'dropout': 0.559751900807195, 'd_model_multiplier': 1, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 634, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 78.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
78.0 K    Trainable params
0         Non-trainable params
78.0 K    Total params
0.312     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5562493205070496
	RegressionCompetitionScore: 0.05521472392638037

Metric val_loss improved. New best score: 0.316


Validation scores:
	RegressionAUROC: 0.551079511642456
	RegressionCompetitionScore: 0.1067484662576687

Metric val_loss improved by 0.098 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5217702388763428
	RegressionCompetitionScore: 0.1098159509202454



Validation scores:
	RegressionAUROC: 0.6005902290344238
	RegressionCompetitionScore: 0.10613496932515337

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6391468048095703
	RegressionCompetitionScore: 0.10858895705521472

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6461714506149292
	RegressionCompetitionScore: 0.1147239263803681

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6522645950317383
	RegressionCompetitionScore: 0.13067484662576687



Validation scores:
	RegressionAUROC: 0.652764618396759
	RegressionCompetitionScore: 0.12914110429447853



Validation scores:
	RegressionAUROC: 0.6445737481117249
	RegressionCompetitionScore: 0.12361963190184048



Validation scores:
	RegressionAUROC: 0.6373157501220703
	RegressionCompetitionScore: 0.12269938650306748



Validation scores:
	RegressionAUROC: 0.61369788646698
	RegressionCompetitionScore: 0.13098159509202453



Validation scores:
	RegressionAUROC: 0.624055802822113
	RegressionCompetitionScore: 0.15122699386503066



Validation scores:
	RegressionAUROC: 0.6318542957305908
	RegressionCompetitionScore: 0.1245398773006135

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1147239263803681
     Test RegressionAUROC            0.6461714506149292
Test RegressionCompetitionScore      0.1147239263803681
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 08:10:36,917][0m Trial 68 finished with value: 0.1147239263803681 and parameters: {'lr': 3.885802546669415e-05, 'dropout': 0.559751900807195, 'd_model_multiplier': 1, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 634, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 1.5229466466753962e-05, 'dropout': 0.537750157046824, 'd_model_multiplier': 2, 'num_layers': 12, 'n_heads': 4, 'dim_feedforward': 593, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 148 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
148 K     Trainable params
0         Non-trainable params
148 K     Total params
0.594     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2291666567325592
	RegressionCompetitionScore: 0.08333333333333333



Validation scores:
	RegressionAUROC: 0.5300406813621521
	RegressionCompetitionScore: 0.05429447852760736

Metric val_loss improved. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.5699653029441833
	RegressionCompetitionScore: 0.0638036809815951

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6099228858947754
	RegressionCompetitionScore: 0.07914110429447853

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6247009634971619
	RegressionCompetitionScore: 0.12914110429447853

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6235493421554565
	RegressionCompetitionScore: 0.18220858895705522

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6321073770523071
	RegressionCompetitionScore: 0.1901840490797546



Validation scores:
	RegressionAUROC: 0.6373056769371033
	RegressionCompetitionScore: 0.19723926380368098



Validation scores:
	RegressionAUROC: 0.6502860188484192
	RegressionCompetitionScore: 0.1579754601226994



Validation scores:
	RegressionAUROC: 0.6654356122016907
	RegressionCompetitionScore: 0.22177914110429447



Validation scores:
	RegressionAUROC: 0.6667805910110474
	RegressionCompetitionScore: 0.20613496932515338



Validation scores:
	RegressionAUROC: 0.6743565201759338
	RegressionCompetitionScore: 0.21380368098159508



Validation scores:
	RegressionAUROC: 0.6816549897193909
	RegressionCompetitionScore: 0.2558282208588957

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6583545207977295
	RegressionCompetitionScore: 0.18282208588957055



Validation scores:
	RegressionAUROC: 0.6596043705940247
	RegressionCompetitionScore: 0.20153374233128835



Validation scores:
	RegressionAUROC: 0.6850963830947876
	RegressionCompetitionScore: 0.2763803680981595



Validation scores:
	RegressionAUROC: 0.673132598400116
	RegressionCompetitionScore: 0.2460122699386503



Validation scores:
	RegressionAUROC: 0.6802480220794678
	RegressionCompetitionScore: 0.25674846625766873



Validation scores:
	RegressionAUROC: 0.6785155534744263
	RegressionCompetitionScore: 0.24570552147239264



Validation scores:
	RegressionAUROC: 0.6826590299606323
	RegressionCompetitionScore: 0.25766871165644173

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.206. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2558282208588957
     Test RegressionAUROC            0.6816549897193909
Test RegressionCompetitionScore      0.2558282208588957
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 08:20:03,993][0m Trial 69 finished with value: 0.2558282208588957 and parameters: {'lr': 1.5229466466753962e-05, 'dropout': 0.537750157046824, 'd_model_multiplier': 2, 'num_layers': 12, 'n_heads': 4, 'dim_feedforward': 593, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 3.2984686418145815e-05, 'dropout': 0.6070820831567234, 'd_model_multiplier': 2, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 534, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 108 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
108 K     Trainable params
0         Non-trainable params
108 K     Total params
0.433     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.875
	RegressionCompetitionScore: 0.75



Validation scores:
	RegressionAUROC: 0.6015200018882751
	RegressionCompetitionScore: 0.23558282208588957

Metric val_loss improved. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.6294450759887695
	RegressionCompetitionScore: 0.05

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6305428743362427
	RegressionCompetitionScore: 0.06165644171779141



Validation scores:
	RegressionAUROC: 0.6353884935379028
	RegressionCompetitionScore: 0.0745398773006135



Validation scores:
	RegressionAUROC: 0.6210169792175293
	RegressionCompetitionScore: 0.07085889570552147



Validation scores:
	RegressionAUROC: 0.6420047283172607
	RegressionCompetitionScore: 0.09171779141104294



Validation scores:
	RegressionAUROC: 0.6477437615394592
	RegressionCompetitionScore: 0.19938650306748465



Validation scores:
	RegressionAUROC: 0.6709229946136475
	RegressionCompetitionScore: 0.22116564417177914



Validation scores:
	RegressionAUROC: 0.6414580941200256
	RegressionCompetitionScore: 0.2579754601226994

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.216. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                  0.05
     Test RegressionAUROC            0.6294450759887695
Test RegressionCompetitionScore             0.05
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 08:24:25,215][0m Trial 70 finished with value: 0.05 and parameters: {'lr': 3.2984686418145815e-05, 'dropout': 0.6070820831567234, 'd_model_multiplier': 2, 'num_layers': 9, 'n_heads': 4, 'dim_feedforward': 534, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 20 with value: 0.38588957055214723.[0m
Starting trial with params:
{'lr': 7.176307003561049e-05, 'dropout': 0.5532373658067695, 'd_model_multiplier': 2, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 650, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 137 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
137 K     Trainable params
0         Non-trainable params
137 K     Total params
0.549     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6077115535736084
	RegressionCompetitionScore: 0.12423312883435583

Metric val_loss improved. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.6468622088432312
	RegressionCompetitionScore: 0.25030674846625767

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.6616272330284119
	RegressionCompetitionScore: 0.22576687116564417

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6785129308700562
	RegressionCompetitionScore: 0.14969325153374233

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6898722052574158
	RegressionCompetitionScore: 0.27361963190184047

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.6835101246833801
	RegressionCompetitionScore: 0.27883435582822086



Validation scores:
	RegressionAUROC: 0.690284788608551
	RegressionCompetitionScore: 0.299079754601227



Validation scores:
	RegressionAUROC: 0.7153621912002563
	RegressionCompetitionScore: 0.3282208588957055



Validation scores:
	RegressionAUROC: 0.7133881449699402
	RegressionCompetitionScore: 0.3248466257668712



Validation scores:
	RegressionAUROC: 0.7305960059165955
	RegressionCompetitionScore: 0.38128834355828223



Validation scores:
	RegressionAUROC: 0.7299516201019287
	RegressionCompetitionScore: 0.38987730061349696

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7286747097969055
	RegressionCompetitionScore: 0.36503067484662577



Validation scores:
	RegressionAUROC: 0.7446504831314087
	RegressionCompetitionScore: 0.38834355828220857

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7171214818954468
	RegressionCompetitionScore: 0.37423312883435583



Validation scores:
	RegressionAUROC: 0.7089340090751648
	RegressionCompetitionScore: 0.34049079754601225



Validation scores:
	RegressionAUROC: 0.7497388124465942
	RegressionCompetitionScore: 0.3901840490797546



Validation scores:
	RegressionAUROC: 0.7508431673049927
	RegressionCompetitionScore: 0.39386503067484663



Validation scores:
	RegressionAUROC: 0.7194594740867615
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.7448296546936035
	RegressionCompetitionScore: 0.3736196319018405



Validation scores:
	RegressionAUROC: 0.7431126832962036
	RegressionCompetitionScore: 0.39754601226993863

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38834355828220857
     Test RegressionAUROC            0.7446504831314087
Test RegressionCompetitionScore      0.38834355828220857
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 08:33:53,211][0m Trial 71 finished with value: 0.38834355828220857 and parameters: {'lr': 7.176307003561049e-05, 'dropout': 0.5532373658067695, 'd_model_multiplier': 2, 'num_layers': 10, 'n_heads': 4, 'dim_feedforward': 650, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 71 with value: 0.38834355828220857.[0m
Starting trial with params:
{'lr': 8.58181209847607e-05, 'dropout': 0.5709254735415046, 'd_model_multiplier': 2, 'num_layers': 11, 'n_heads': 4, 'dim_feedforward': 155, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 56.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
56.2 K    Trainable params
0         Non-trainable params
56.2 K    Total params
0.225     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.526644766330719
	RegressionCompetitionScore: 0.06134969325153374

Metric val_loss improved. New best score: 0.240


Validation scores:
	RegressionAUROC: 0.6130411624908447
	RegressionCompetitionScore: 0.09294478527607362

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.6331337690353394
	RegressionCompetitionScore: 0.2371165644171779

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6472327709197998
	RegressionCompetitionScore: 0.23098159509202454

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.654821515083313
	RegressionCompetitionScore: 0.26042944785276073

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6815251708030701
	RegressionCompetitionScore: 0.23098159509202454

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.691047191619873
	RegressionCompetitionScore: 0.2647239263803681



Validation scores:
	RegressionAUROC: 0.6578490734100342
	RegressionCompetitionScore: 0.2450920245398773



Validation scores:
	RegressionAUROC: 0.7136532068252563
	RegressionCompetitionScore: 0.3202453987730061



Validation scores:
	RegressionAUROC: 0.7270742058753967
	RegressionCompetitionScore: 0.36257668711656443



Validation scores:
	RegressionAUROC: 0.729489803314209
	RegressionCompetitionScore: 0.3638036809815951

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7350863218307495
	RegressionCompetitionScore: 0.3619631901840491



Validation scores:
	RegressionAUROC: 0.7444882392883301
	RegressionCompetitionScore: 0.3558282208588957



Validation scores:
	RegressionAUROC: 0.7427546977996826
	RegressionCompetitionScore: 0.38190184049079756



Validation scores:
	RegressionAUROC: 0.7436347603797913
	RegressionCompetitionScore: 0.3684049079754601



Validation scores:
	RegressionAUROC: 0.7568217515945435
	RegressionCompetitionScore: 0.3861963190184049



Validation scores:
	RegressionAUROC: 0.748034656047821
	RegressionCompetitionScore: 0.36257668711656443



Validation scores:
	RegressionAUROC: 0.7517098188400269
	RegressionCompetitionScore: 0.347239263803681

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.191. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3638036809815951
     Test RegressionAUROC             0.729489803314209
Test RegressionCompetitionScore      0.3638036809815951
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 08:42:28,828][0m Trial 72 finished with value: 0.3638036809815951 and parameters: {'lr': 8.58181209847607e-05, 'dropout': 0.5709254735415046, 'd_model_multiplier': 2, 'num_layers': 11, 'n_heads': 4, 'dim_feedforward': 155, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 71 with value: 0.38834355828220857.[0m
Starting trial with params:
{'lr': 5.699415620588042e-05, 'dropout': 0.5766351758314221, 'd_model_multiplier': 2, 'num_layers': 11, 'n_heads': 4, 'dim_feedforward': 161, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 57.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
57.3 K    Trainable params
0         Non-trainable params
57.3 K    Total params
0.229     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6354166269302368
	RegressionCompetitionScore: 0.3333333333333333



Validation scores:
	RegressionAUROC: 0.5788397789001465
	RegressionCompetitionScore: 0.248159509202454

Metric val_loss improved. New best score: 0.247


Validation scores:
	RegressionAUROC: 0.5900877118110657
	RegressionCompetitionScore: 0.24478527607361963

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5914270877838135
	RegressionCompetitionScore: 0.249079754601227

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6158792972564697
	RegressionCompetitionScore: 0.2549079754601227



Validation scores:
	RegressionAUROC: 0.6408489942550659
	RegressionCompetitionScore: 0.26012269938650306



Validation scores:
	RegressionAUROC: 0.6359391212463379
	RegressionCompetitionScore: 0.2861963190184049



Validation scores:
	RegressionAUROC: 0.6639871597290039
	RegressionCompetitionScore: 0.2950920245398773



Validation scores:
	RegressionAUROC: 0.6577503085136414
	RegressionCompetitionScore: 0.2785276073619632



Validation scores:
	RegressionAUROC: 0.6578885316848755
	RegressionCompetitionScore: 0.20460122699386504



Validation scores:
	RegressionAUROC: 0.6284621953964233
	RegressionCompetitionScore: 0.1322085889570552

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.249079754601227
     Test RegressionAUROC            0.5914270877838135
Test RegressionCompetitionScore       0.249079754601227
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 08:47:22,519][0m Trial 73 finished with value: 0.249079754601227 and parameters: {'lr': 5.699415620588042e-05, 'dropout': 0.5766351758314221, 'd_model_multiplier': 2, 'num_layers': 11, 'n_heads': 4, 'dim_feedforward': 161, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0}. Best is trial 71 with value: 0.38834355828220857.[0m
Starting trial with params:
{'lr': 6.932619892576336e-05, 'dropout': 0.5510993516605562, 'd_model_multiplier': 2, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 239, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 600 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
600 K     Trainable params
0         Non-trainable params
600 K     Total params
2.403     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6012705564498901
	RegressionCompetitionScore: 0.17699386503067485

Metric val_loss improved. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.6540466547012329
	RegressionCompetitionScore: 0.2371165644171779



Validation scores:
	RegressionAUROC: 0.6320798397064209
	RegressionCompetitionScore: 0.21595092024539878

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.6858863830566406
	RegressionCompetitionScore: 0.22116564417177914

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6579352617263794
	RegressionCompetitionScore: 0.2665644171779141



Validation scores:
	RegressionAUROC: 0.6661338806152344
	RegressionCompetitionScore: 0.30460122699386505



Validation scores:
	RegressionAUROC: 0.7125222682952881
	RegressionCompetitionScore: 0.3674846625766871

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7011973857879639
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7269057631492615
	RegressionCompetitionScore: 0.3570552147239264



Validation scores:
	RegressionAUROC: 0.7361264228820801
	RegressionCompetitionScore: 0.37607361963190183

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7443541288375854
	RegressionCompetitionScore: 0.35920245398773004

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7443431615829468
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.742127537727356
	RegressionCompetitionScore: 0.3165644171779141



Validation scores:
	RegressionAUROC: 0.7449789643287659
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7566440105438232
	RegressionCompetitionScore: 0.36533742331288344



Validation scores:
	RegressionAUROC: 0.7496051788330078
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7448017597198486
	RegressionCompetitionScore: 0.37055214723926383



Validation scores:
	RegressionAUROC: 0.7505484223365784
	RegressionCompetitionScore: 0.3266871165644172

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.180. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.35920245398773004
     Test RegressionAUROC            0.7443541288375854
Test RegressionCompetitionScore      0.35920245398773004
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 09:02:35,069][0m Trial 74 finished with value: 0.35920245398773004 and parameters: {'lr': 6.932619892576336e-05, 'dropout': 0.5510993516605562, 'd_model_multiplier': 2, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 239, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 71 with value: 0.38834355828220857.[0m
Starting trial with params:
{'lr': 8.450201268977883e-05, 'dropout': 0.5640258811265082, 'd_model_multiplier': 2, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 183, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 561 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
561 K     Trainable params
0         Non-trainable params
561 K     Total params
2.247     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.1666666567325592
	RegressionCompetitionScore: 0.08333333333333333



Validation scores:
	RegressionAUROC: 0.67178875207901
	RegressionCompetitionScore: 0.2647239263803681

Metric val_loss improved. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.695574164390564
	RegressionCompetitionScore: 0.1312883435582822



Validation scores:
	RegressionAUROC: 0.708074688911438
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.704580545425415
	RegressionCompetitionScore: 0.200920245398773

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7335827350616455
	RegressionCompetitionScore: 0.30552147239263805



Validation scores:
	RegressionAUROC: 0.7361218929290771
	RegressionCompetitionScore: 0.3337423312883436



Validation scores:
	RegressionAUROC: 0.7201977968215942
	RegressionCompetitionScore: 0.36257668711656443



Validation scores:
	RegressionAUROC: 0.7199438810348511
	RegressionCompetitionScore: 0.36319018404907977



Validation scores:
	RegressionAUROC: 0.6934924125671387
	RegressionCompetitionScore: 0.3



Validation scores:
	RegressionAUROC: 0.7220569849014282
	RegressionCompetitionScore: 0.38404907975460123



Validation scores:
	RegressionAUROC: 0.7324568033218384
	RegressionCompetitionScore: 0.29233128834355826

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7381187677383423
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7469823360443115
	RegressionCompetitionScore: 0.35184049079754603

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7293350696563721
	RegressionCompetitionScore: 0.3184049079754601



Validation scores:
	RegressionAUROC: 0.7419083118438721
	RegressionCompetitionScore: 0.3567484662576687

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7296280860900879
	RegressionCompetitionScore: 0.28251533742331286



Validation scores:
	RegressionAUROC: 0.7247454524040222
	RegressionCompetitionScore: 0.3141104294478528



Validation scores:
	RegressionAUROC: 0.7254558801651001
	RegressionCompetitionScore: 0.27177914110429446



Validation scores:
	RegressionAUROC: 0.710310697555542
	RegressionCompetitionScore: 0.25766871165644173



Validation scores:
	RegressionAUROC: 0.7441918849945068
	RegressionCompetitionScore: 0.3095092024539877



Validation scores:
	RegressionAUROC: 0.7421414852142334
	RegressionCompetitionScore: 0.28588957055214725



Validation scores:
	RegressionAUROC: 0.7255620956420898
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.184. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3567484662576687
     Test RegressionAUROC            0.7419083118438721
Test RegressionCompetitionScore      0.3567484662576687
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 09:22:34,033][0m Trial 75 finished with value: 0.3567484662576687 and parameters: {'lr': 8.450201268977883e-05, 'dropout': 0.5640258811265082, 'd_model_multiplier': 2, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 183, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 71 with value: 0.38834355828220857.[0m
Starting trial with params:
{'lr': 8.784590600710834e-05, 'dropout': 0.5648472964173465, 'd_model_multiplier': 2, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 186, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 566 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
566 K     Trainable params
0         Non-trainable params
566 K     Total params
2.266     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3541666865348816
	RegressionCompetitionScore: 0.16666666666666666



Validation scores:
	RegressionAUROC: 0.5728641748428345
	RegressionCompetitionScore: 0.10214723926380367

Metric val_loss improved. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.6758795380592346
	RegressionCompetitionScore: 0.20398773006134968

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.7122554779052734
	RegressionCompetitionScore: 0.15674846625766872



Validation scores:
	RegressionAUROC: 0.7092559933662415
	RegressionCompetitionScore: 0.23957055214723927

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7220155000686646
	RegressionCompetitionScore: 0.29478527607361965

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7384731769561768
	RegressionCompetitionScore: 0.3549079754601227



Validation scores:
	RegressionAUROC: 0.733330488204956
	RegressionCompetitionScore: 0.3374233128834356



Validation scores:
	RegressionAUROC: 0.7233316898345947
	RegressionCompetitionScore: 0.3226993865030675



Validation scores:
	RegressionAUROC: 0.7382399439811707
	RegressionCompetitionScore: 0.37055214723926383



Validation scores:
	RegressionAUROC: 0.7354483604431152
	RegressionCompetitionScore: 0.37239263803680983



Validation scores:
	RegressionAUROC: 0.7525737285614014
	RegressionCompetitionScore: 0.37392638036809817

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7408450245857239
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7214392423629761
	RegressionCompetitionScore: 0.32177914110429445



Validation scores:
	RegressionAUROC: 0.7337585687637329
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7375434041023254
	RegressionCompetitionScore: 0.36901840490797544



Validation scores:
	RegressionAUROC: 0.7343987226486206
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.708899199962616
	RegressionCompetitionScore: 0.34938650306748464



Validation scores:
	RegressionAUROC: 0.7271592020988464
	RegressionCompetitionScore: 0.34294478527607364

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37392638036809817
     Test RegressionAUROC            0.7525737285614014
Test RegressionCompetitionScore      0.37392638036809817
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 09:38:59,715][0m Trial 76 finished with value: 0.37392638036809817 and parameters: {'lr': 8.784590600710834e-05, 'dropout': 0.5648472964173465, 'd_model_multiplier': 2, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 186, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 71 with value: 0.38834355828220857.[0m
Starting trial with params:
{'lr': 9.203023476887591e-05, 'dropout': 0.565631252348971, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 165, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 572 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
572 K     Trainable params
0         Non-trainable params
572 K     Total params
2.289     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7079182267189026
	RegressionCompetitionScore: 0.35429447852760737

Metric val_loss improved. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6983447074890137
	RegressionCompetitionScore: 0.248159509202454



Validation scores:
	RegressionAUROC: 0.6927868127822876
	RegressionCompetitionScore: 0.29478527607361965



Validation scores:
	RegressionAUROC: 0.704727828502655
	RegressionCompetitionScore: 0.2634969325153374

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7177440524101257
	RegressionCompetitionScore: 0.3177914110429448



Validation scores:
	RegressionAUROC: 0.7195320129394531
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7313578724861145
	RegressionCompetitionScore: 0.3226993865030675



Validation scores:
	RegressionAUROC: 0.7329952716827393
	RegressionCompetitionScore: 0.3236196319018405

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7412763833999634
	RegressionCompetitionScore: 0.37331288343558283

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7282999753952026
	RegressionCompetitionScore: 0.34662576687116564



Validation scores:
	RegressionAUROC: 0.7428154945373535
	RegressionCompetitionScore: 0.34263803680981597



Validation scores:
	RegressionAUROC: 0.7463453412055969
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7368899583816528
	RegressionCompetitionScore: 0.3039877300613497



Validation scores:
	RegressionAUROC: 0.7157270908355713
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7391947507858276
	RegressionCompetitionScore: 0.3401840490797546



Validation scores:
	RegressionAUROC: 0.7270734310150146
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37331288343558283
     Test RegressionAUROC            0.7412763833999634
Test RegressionCompetitionScore      0.37331288343558283
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 09:54:49,134][0m Trial 77 finished with value: 0.37331288343558283 and parameters: {'lr': 9.203023476887591e-05, 'dropout': 0.565631252348971, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 165, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 71 with value: 0.38834355828220857.[0m
Starting trial with params:
{'lr': 2.3968161103753935e-05, 'dropout': 0.5794282922782643, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 243, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 703 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
703 K     Trainable params
0         Non-trainable params
703 K     Total params
2.812     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6666666269302368
	RegressionCompetitionScore: 0.5833333333333334



Validation scores:
	RegressionAUROC: 0.6113191843032837
	RegressionCompetitionScore: 0.24171779141104294

Metric val_loss improved. New best score: 0.257


Validation scores:
	RegressionAUROC: 0.6454575657844543
	RegressionCompetitionScore: 0.23098159509202454

Metric val_loss improved by 0.061 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.679431676864624
	RegressionCompetitionScore: 0.2273006134969325

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7016613483428955
	RegressionCompetitionScore: 0.2254601226993865

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6890000104904175
	RegressionCompetitionScore: 0.28251533742331286



Validation scores:
	RegressionAUROC: 0.7200636267662048
	RegressionCompetitionScore: 0.27975460122699386



Validation scores:
	RegressionAUROC: 0.7243126630783081
	RegressionCompetitionScore: 0.2677914110429448

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7331314086914062
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7352776527404785
	RegressionCompetitionScore: 0.3015337423312883

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7378560304641724
	RegressionCompetitionScore: 0.3478527607361963



Validation scores:
	RegressionAUROC: 0.7340414524078369
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7236535549163818
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7313787341117859
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7233390808105469
	RegressionCompetitionScore: 0.27975460122699386



Validation scores:
	RegressionAUROC: 0.7346705198287964
	RegressionCompetitionScore: 0.32883435582822085



Validation scores:
	RegressionAUROC: 0.7402446269989014
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.176. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3015337423312883
     Test RegressionAUROC            0.7352776527404785
Test RegressionCompetitionScore      0.3015337423312883
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 10:10:41,320][0m Trial 78 finished with value: 0.3015337423312883 and parameters: {'lr': 2.3968161103753935e-05, 'dropout': 0.5794282922782643, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 243, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 71 with value: 0.38834355828220857.[0m
Starting trial with params:
{'lr': 9.716204722701627e-05, 'dropout': 0.5940954532599879, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 109, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 509 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
509 K     Trainable params
0         Non-trainable params
509 K     Total params
2.037     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6422784328460693
	RegressionCompetitionScore: 0.2245398773006135

Metric val_loss improved. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.6426698565483093
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6661202311515808
	RegressionCompetitionScore: 0.26134969325153373

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.6852385997772217
	RegressionCompetitionScore: 0.19141104294478528

Metric val_loss improved by 0.042 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7079037427902222
	RegressionCompetitionScore: 0.28251533742331286



Validation scores:
	RegressionAUROC: 0.708038330078125
	RegressionCompetitionScore: 0.31625766871165645

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7126901745796204
	RegressionCompetitionScore: 0.29938650306748466



Validation scores:
	RegressionAUROC: 0.7111121416091919
	RegressionCompetitionScore: 0.3193251533742331



Validation scores:
	RegressionAUROC: 0.7066149711608887
	RegressionCompetitionScore: 0.3187116564417178



Validation scores:
	RegressionAUROC: 0.7239577770233154
	RegressionCompetitionScore: 0.3478527607361963



Validation scores:
	RegressionAUROC: 0.7322194576263428
	RegressionCompetitionScore: 0.32423312883435584



Validation scores:
	RegressionAUROC: 0.7287929654121399
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6999366879463196
	RegressionCompetitionScore: 0.302760736196319

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.184. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.31625766871165645
     Test RegressionAUROC             0.708038330078125
Test RegressionCompetitionScore      0.31625766871165645
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 10:24:35,612][0m Trial 79 finished with value: 0.31625766871165645 and parameters: {'lr': 9.716204722701627e-05, 'dropout': 0.5940954532599879, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 109, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 71 with value: 0.38834355828220857.[0m
Starting trial with params:
{'lr': 0.00015152641133541004, 'dropout': 0.5568373778236256, 'd_model_multiplier': 2, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 261, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 682 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
682 K     Trainable params
0         Non-trainable params
682 K     Total params
2.730     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6543353796005249
	RegressionCompetitionScore: 0.3141104294478528

Metric val_loss improved. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.6979087591171265
	RegressionCompetitionScore: 0.24386503067484663

Metric val_loss improved by 0.040 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6908523440361023
	RegressionCompetitionScore: 0.18957055214723925

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7222467660903931
	RegressionCompetitionScore: 0.27024539877300613



Validation scores:
	RegressionAUROC: 0.7224041819572449
	RegressionCompetitionScore: 0.297239263803681

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.73394376039505
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6992916464805603
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.70809406042099
	RegressionCompetitionScore: 0.3352760736196319



Validation scores:
	RegressionAUROC: 0.7286229133605957
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7460065484046936
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7534288763999939
	RegressionCompetitionScore: 0.31809815950920245

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7516658306121826
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7321822047233582
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7191188335418701
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7328681945800781
	RegressionCompetitionScore: 0.35429447852760737



Validation scores:
	RegressionAUROC: 0.7341407537460327
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7269109487533569
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.742868185043335
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.31809815950920245
     Test RegressionAUROC            0.7534288763999939
Test RegressionCompetitionScore      0.31809815950920245
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 10:41:08,805][0m Trial 80 finished with value: 0.31809815950920245 and parameters: {'lr': 0.00015152641133541004, 'dropout': 0.5568373778236256, 'd_model_multiplier': 2, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 261, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 71 with value: 0.38834355828220857.[0m
Starting trial with params:
{'lr': 9.8903094355596e-05, 'dropout': 0.565978178549866, 'd_model_multiplier': 2, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 186, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 566 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
566 K     Trainable params
0         Non-trainable params
566 K     Total params
2.266     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3125000298023224
	RegressionCompetitionScore: 0.08333333333333333



Validation scores:
	RegressionAUROC: 0.6456936001777649
	RegressionCompetitionScore: 0.25736196319018406

Metric val_loss improved. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6870236396789551
	RegressionCompetitionScore: 0.27515337423312886

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7155088186264038
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7352942228317261
	RegressionCompetitionScore: 0.3300613496932515

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7407989501953125
	RegressionCompetitionScore: 0.3512269938650307

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.6731626987457275
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7422274947166443
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7426760196685791
	RegressionCompetitionScore: 0.38006134969325156



Validation scores:
	RegressionAUROC: 0.7480787038803101
	RegressionCompetitionScore: 0.36809815950920244



Validation scores:
	RegressionAUROC: 0.7543479800224304
	RegressionCompetitionScore: 0.38558282208588956



Validation scores:
	RegressionAUROC: 0.7481905221939087
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7226943969726562
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3512269938650307
     Test RegressionAUROC            0.7407989501953125
Test RegressionCompetitionScore      0.3512269938650307
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 10:52:18,908][0m Trial 81 finished with value: 0.3512269938650307 and parameters: {'lr': 9.8903094355596e-05, 'dropout': 0.565978178549866, 'd_model_multiplier': 2, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 186, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 71 with value: 0.38834355828220857.[0m
Starting trial with params:
{'lr': 6.641217820114178e-05, 'dropout': 0.5386083477231726, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 187, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 609 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
609 K     Trainable params
0         Non-trainable params
609 K     Total params
2.437     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7916666269302368
	RegressionCompetitionScore: 0.5833333333333334



Validation scores:
	RegressionAUROC: 0.6629217267036438
	RegressionCompetitionScore: 0.2343558282208589

Metric val_loss improved. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.6772701144218445
	RegressionCompetitionScore: 0.293558282208589

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.7023019790649414
	RegressionCompetitionScore: 0.29141104294478526

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6917945146560669
	RegressionCompetitionScore: 0.24447852760736197



Validation scores:
	RegressionAUROC: 0.7197388410568237
	RegressionCompetitionScore: 0.37208588957055216



Validation scores:
	RegressionAUROC: 0.7270063161849976
	RegressionCompetitionScore: 0.38496932515337423

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.730760931968689
	RegressionCompetitionScore: 0.3852760736196319



Validation scores:
	RegressionAUROC: 0.7268468141555786
	RegressionCompetitionScore: 0.36595092024539877



Validation scores:
	RegressionAUROC: 0.7220045924186707
	RegressionCompetitionScore: 0.34171779141104297



Validation scores:
	RegressionAUROC: 0.7354339361190796
	RegressionCompetitionScore: 0.3904907975460123



Validation scores:
	RegressionAUROC: 0.746990442276001
	RegressionCompetitionScore: 0.3726993865030675

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7412014007568359
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7494941353797913
	RegressionCompetitionScore: 0.349079754601227



Validation scores:
	RegressionAUROC: 0.7456827163696289
	RegressionCompetitionScore: 0.34202453987730064



Validation scores:
	RegressionAUROC: 0.7534484267234802
	RegressionCompetitionScore: 0.4012269938650307

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.749236524105072
	RegressionCompetitionScore: 0.37668711656441717



Validation scores:
	RegressionAUROC: 0.7432308197021484
	RegressionCompetitionScore: 0.39846625766871163



Validation scores:
	RegressionAUROC: 0.7384116649627686
	RegressionCompetitionScore: 0.39263803680981596



Validation scores:
	RegressionAUROC: 0.7473876476287842
	RegressionCompetitionScore: 0.42300613496932515



Validation scores:
	RegressionAUROC: 0.7415680885314941
	RegressionCompetitionScore: 0.4579754601226994



Validation scores:
	RegressionAUROC: 0.7501944303512573
	RegressionCompetitionScore: 0.41779141104294476



Validation scores:
	RegressionAUROC: 0.7399274110794067
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.168. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4012269938650307
     Test RegressionAUROC            0.7534484267234802
Test RegressionCompetitionScore      0.4012269938650307
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 11:13:50,109][0m Trial 82 finished with value: 0.4012269938650307 and parameters: {'lr': 6.641217820114178e-05, 'dropout': 0.5386083477231726, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 187, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 82 with value: 0.4012269938650307.[0m
Starting trial with params:
{'lr': 2.9078849845102946e-05, 'dropout': 0.5345978025832727, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 126, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 506 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
506 K     Trainable params
0         Non-trainable params
506 K     Total params
2.027     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5833333134651184
	RegressionCompetitionScore: 0.16666666666666666



Validation scores:
	RegressionAUROC: 0.6377361416816711
	RegressionCompetitionScore: 0.23742331288343557

Metric val_loss improved. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.6737083196640015
	RegressionCompetitionScore: 0.2245398773006135

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.678128719329834
	RegressionCompetitionScore: 0.1598159509202454



Validation scores:
	RegressionAUROC: 0.6963721513748169
	RegressionCompetitionScore: 0.25153374233128833



Validation scores:
	RegressionAUROC: 0.708728551864624
	RegressionCompetitionScore: 0.32515337423312884



Validation scores:
	RegressionAUROC: 0.712774395942688
	RegressionCompetitionScore: 0.2745398773006135

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7228189706802368
	RegressionCompetitionScore: 0.3088957055214724



Validation scores:
	RegressionAUROC: 0.7275373935699463
	RegressionCompetitionScore: 0.32699386503067485



Validation scores:
	RegressionAUROC: 0.7197087407112122
	RegressionCompetitionScore: 0.3276073619631902



Validation scores:
	RegressionAUROC: 0.7380455136299133
	RegressionCompetitionScore: 0.3871165644171779



Validation scores:
	RegressionAUROC: 0.739831268787384
	RegressionCompetitionScore: 0.37116564417177916



Validation scores:
	RegressionAUROC: 0.7368553876876831
	RegressionCompetitionScore: 0.38496932515337423



Validation scores:
	RegressionAUROC: 0.7312213182449341
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.186. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2745398773006135
     Test RegressionAUROC             0.712774395942688
Test RegressionCompetitionScore      0.2745398773006135
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 11:26:44,999][0m Trial 83 finished with value: 0.2745398773006135 and parameters: {'lr': 2.9078849845102946e-05, 'dropout': 0.5345978025832727, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 126, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 82 with value: 0.4012269938650307.[0m
Starting trial with params:
{'lr': 1.8362475736967684e-05, 'dropout': 0.5312139083077211, 'd_model_multiplier': 2, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 312, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 704 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
704 K     Trainable params
0         Non-trainable params
704 K     Total params
2.817     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7604166865348816
	RegressionCompetitionScore: 0.4166666666666667



Validation scores:
	RegressionAUROC: 0.6764354705810547
	RegressionCompetitionScore: 0.2745398773006135

Metric val_loss improved. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.6851234436035156
	RegressionCompetitionScore: 0.2978527607361963

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.6950646042823792
	RegressionCompetitionScore: 0.28404907975460125



Validation scores:
	RegressionAUROC: 0.707075297832489
	RegressionCompetitionScore: 0.26226993865030673



Validation scores:
	RegressionAUROC: 0.7116000056266785
	RegressionCompetitionScore: 0.2668711656441718



Validation scores:
	RegressionAUROC: 0.713207483291626
	RegressionCompetitionScore: 0.27361963190184047

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7222432494163513
	RegressionCompetitionScore: 0.2960122699386503



Validation scores:
	RegressionAUROC: 0.7148183584213257
	RegressionCompetitionScore: 0.29049079754601226



Validation scores:
	RegressionAUROC: 0.7324038147926331
	RegressionCompetitionScore: 0.3113496932515337



Validation scores:
	RegressionAUROC: 0.7345900535583496
	RegressionCompetitionScore: 0.3211656441717791



Validation scores:
	RegressionAUROC: 0.7412674427032471
	RegressionCompetitionScore: 0.3141104294478528

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7288385629653931
	RegressionCompetitionScore: 0.3248466257668712



Validation scores:
	RegressionAUROC: 0.7233686447143555
	RegressionCompetitionScore: 0.2920245398773006



Validation scores:
	RegressionAUROC: 0.7292908430099487
	RegressionCompetitionScore: 0.2960122699386503



Validation scores:
	RegressionAUROC: 0.7419498562812805
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7407928705215454
	RegressionCompetitionScore: 0.3273006134969325



Validation scores:
	RegressionAUROC: 0.7346478700637817
	RegressionCompetitionScore: 0.32883435582822085



Validation scores:
	RegressionAUROC: 0.7351263761520386
	RegressionCompetitionScore: 0.3214723926380368

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.180. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3141104294478528
     Test RegressionAUROC            0.7412674427032471
Test RegressionCompetitionScore      0.3141104294478528
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 11:42:02,106][0m Trial 84 finished with value: 0.3141104294478528 and parameters: {'lr': 1.8362475736967684e-05, 'dropout': 0.5312139083077211, 'd_model_multiplier': 2, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 312, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 82 with value: 0.4012269938650307.[0m
Starting trial with params:
{'lr': 6.662955746514475e-05, 'dropout': 0.5855859299574507, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 76, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 422 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
422 K     Trainable params
0         Non-trainable params
422 K     Total params
1.692     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.8125
	RegressionCompetitionScore: 0.4166666666666667



Validation scores:
	RegressionAUROC: 0.5855721831321716
	RegressionCompetitionScore: 0.24539877300613497

Metric val_loss improved. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.6049044132232666
	RegressionCompetitionScore: 0.2745398773006135

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.6795473694801331
	RegressionCompetitionScore: 0.08404907975460123

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6693723201751709
	RegressionCompetitionScore: 0.2659509202453988



Validation scores:
	RegressionAUROC: 0.6981510519981384
	RegressionCompetitionScore: 0.2917177914110429



Validation scores:
	RegressionAUROC: 0.7019131183624268
	RegressionCompetitionScore: 0.35613496932515337

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7155948281288147
	RegressionCompetitionScore: 0.3174846625766871



Validation scores:
	RegressionAUROC: 0.729915976524353
	RegressionCompetitionScore: 0.3309815950920245



Validation scores:
	RegressionAUROC: 0.7324238419532776
	RegressionCompetitionScore: 0.35429447852760737

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7213081121444702
	RegressionCompetitionScore: 0.35920245398773004



Validation scores:
	RegressionAUROC: 0.729468584060669
	RegressionCompetitionScore: 0.36165644171779143



Validation scores:
	RegressionAUROC: 0.7403736710548401
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7412738800048828
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7292885184288025
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7385501861572266
	RegressionCompetitionScore: 0.3245398773006135



Validation scores:
	RegressionAUROC: 0.704033374786377
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.178. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.35429447852760737
     Test RegressionAUROC            0.7324238419532776
Test RegressionCompetitionScore      0.35429447852760737
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 11:57:44,513][0m Trial 85 finished with value: 0.35429447852760737 and parameters: {'lr': 6.662955746514475e-05, 'dropout': 0.5855859299574507, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 76, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 82 with value: 0.4012269938650307.[0m
Starting trial with params:
{'lr': 0.0002880298642455624, 'dropout': 0.5702713271761802, 'd_model_multiplier': 2, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 212, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 562 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
562 K     Trainable params
0         Non-trainable params
562 K     Total params
2.250     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.625
	RegressionCompetitionScore: 0.4166666666666667



Validation scores:
	RegressionAUROC: 0.7081208229064941
	RegressionCompetitionScore: 0.2763803680981595

Metric val_loss improved. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.6974807381629944
	RegressionCompetitionScore: 0.19294478527607362



Validation scores:
	RegressionAUROC: 0.6137800216674805
	RegressionCompetitionScore: 0.10736196319018405

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6960746049880981
	RegressionCompetitionScore: 0.24079754601226994



Validation scores:
	RegressionAUROC: 0.6897802948951721
	RegressionCompetitionScore: 0.2696319018404908



Validation scores:
	RegressionAUROC: 0.6950960159301758
	RegressionCompetitionScore: 0.29325153374233126



Validation scores:
	RegressionAUROC: 0.6954630613327026
	RegressionCompetitionScore: 0.23773006134969324



Validation scores:
	RegressionAUROC: 0.6555269956588745
	RegressionCompetitionScore: 0.2926380368098159



Validation scores:
	RegressionAUROC: 0.6634875535964966
	RegressionCompetitionScore: 0.2837423312883436



Validation scores:
	RegressionAUROC: 0.6417865753173828
	RegressionCompetitionScore: 0.08282208588957055

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10736196319018405
     Test RegressionAUROC            0.6137800216674805
Test RegressionCompetitionScore      0.10736196319018405
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 12:06:24,327][0m Trial 86 finished with value: 0.10736196319018405 and parameters: {'lr': 0.0002880298642455624, 'dropout': 0.5702713271761802, 'd_model_multiplier': 2, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 212, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 82 with value: 0.4012269938650307.[0m
Starting trial with params:
{'lr': 4.0484588327999505e-05, 'dropout': 0.5461780684183016, 'd_model_multiplier': 2, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 151, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 512 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
512 K     Trainable params
0         Non-trainable params
512 K     Total params
2.049     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5265700221061707
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5996540784835815
	RegressionCompetitionScore: 0.21042944785276074

Metric val_loss improved. New best score: 0.278


Validation scores:
	RegressionAUROC: 0.6219748258590698
	RegressionCompetitionScore: 0.22116564417177914

Metric val_loss improved by 0.062 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6363517045974731
	RegressionCompetitionScore: 0.21380368098159508

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6459910869598389
	RegressionCompetitionScore: 0.2312883435582822



Validation scores:
	RegressionAUROC: 0.6573634147644043
	RegressionCompetitionScore: 0.24754601226993864

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6760090589523315
	RegressionCompetitionScore: 0.28282208588957053



Validation scores:
	RegressionAUROC: 0.6812933087348938
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6937585473060608
	RegressionCompetitionScore: 0.31533742331288345



Validation scores:
	RegressionAUROC: 0.6943519711494446
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7202668786048889
	RegressionCompetitionScore: 0.33067484662576685

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7084832787513733
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6820437908172607
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7033030390739441
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.697763204574585
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7222093343734741
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7078375816345215
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7136343121528625
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.189. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.33067484662576685
     Test RegressionAUROC            0.7202668786048889
Test RegressionCompetitionScore      0.33067484662576685
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 12:21:11,719][0m Trial 87 finished with value: 0.33067484662576685 and parameters: {'lr': 4.0484588327999505e-05, 'dropout': 0.5461780684183016, 'd_model_multiplier': 2, 'num_layers': 12, 'n_heads': 32, 'dim_feedforward': 151, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 82 with value: 0.4012269938650307.[0m
Starting trial with params:
{'lr': 0.00016419152965630785, 'dropout': 0.524289420820182, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 286, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 168 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
168 K     Trainable params
0         Non-trainable params
168 K     Total params
0.675     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7083333730697632
	RegressionCompetitionScore: 0.4166666666666667



Validation scores:
	RegressionAUROC: 0.6286409497261047
	RegressionCompetitionScore: 0.3067484662576687

Metric val_loss improved. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6734835505485535
	RegressionCompetitionScore: 0.22269938650306748



Validation scores:
	RegressionAUROC: 0.6648845672607422
	RegressionCompetitionScore: 0.24969325153374233

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6807816624641418
	RegressionCompetitionScore: 0.13404907975460123



Validation scores:
	RegressionAUROC: 0.7240512371063232
	RegressionCompetitionScore: 0.34846625766871164



Validation scores:
	RegressionAUROC: 0.7457762956619263
	RegressionCompetitionScore: 0.3773006134969325

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7285758256912231
	RegressionCompetitionScore: 0.37515337423312883



Validation scores:
	RegressionAUROC: 0.7249951362609863
	RegressionCompetitionScore: 0.3803680981595092

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7528836131095886
	RegressionCompetitionScore: 0.41595092024539876

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7472301721572876
	RegressionCompetitionScore: 0.37791411042944784



Validation scores:
	RegressionAUROC: 0.7455951571464539
	RegressionCompetitionScore: 0.37423312883435583



Validation scores:
	RegressionAUROC: 0.746193528175354
	RegressionCompetitionScore: 0.39662576687116563



Validation scores:
	RegressionAUROC: 0.7392688989639282
	RegressionCompetitionScore: 0.36687116564417177



Validation scores:
	RegressionAUROC: 0.7406885623931885
	RegressionCompetitionScore: 0.3880368098159509



Validation scores:
	RegressionAUROC: 0.7485558390617371
	RegressionCompetitionScore: 0.350920245398773

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7364529371261597
	RegressionCompetitionScore: 0.36717791411042944



Validation scores:
	RegressionAUROC: 0.741478681564331
	RegressionCompetitionScore: 0.4171779141104294



Validation scores:
	RegressionAUROC: 0.728172242641449
	RegressionCompetitionScore: 0.38128834355828223



Validation scores:
	RegressionAUROC: 0.7397530674934387
	RegressionCompetitionScore: 0.34478527607361964



Validation scores:
	RegressionAUROC: 0.7269154787063599
	RegressionCompetitionScore: 0.36411042944785277



Validation scores:
	RegressionAUROC: 0.7291112542152405
	RegressionCompetitionScore: 0.3570552147239264



Validation scores:
	RegressionAUROC: 0.7318726778030396
	RegressionCompetitionScore: 0.31993865030674845

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.171. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.350920245398773
     Test RegressionAUROC            0.7485558390617371
Test RegressionCompetitionScore       0.350920245398773
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 12:32:22,362][0m Trial 88 finished with value: 0.350920245398773 and parameters: {'lr': 0.00016419152965630785, 'dropout': 0.524289420820182, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 286, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 82 with value: 0.4012269938650307.[0m
Starting trial with params:
{'lr': 5.3060110288690924e-05, 'dropout': 0.6128265361334446, 'd_model_multiplier': 2, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 212, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 562 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
562 K     Trainable params
0         Non-trainable params
562 K     Total params
2.250     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3285024166107178
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6724317669868469
	RegressionCompetitionScore: 0.22975460122699387

Metric val_loss improved. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.6710589528083801
	RegressionCompetitionScore: 0.2245398773006135

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6866130828857422
	RegressionCompetitionScore: 0.17975460122699385

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6934545040130615
	RegressionCompetitionScore: 0.20920245398773007



Validation scores:
	RegressionAUROC: 0.6954721212387085
	RegressionCompetitionScore: 0.24785276073619633



Validation scores:
	RegressionAUROC: 0.6947557926177979
	RegressionCompetitionScore: 0.2205521472392638

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.69395911693573
	RegressionCompetitionScore: 0.2420245398773006



Validation scores:
	RegressionAUROC: 0.6845422983169556
	RegressionCompetitionScore: 0.23588957055214724



Validation scores:
	RegressionAUROC: 0.694974422454834
	RegressionCompetitionScore: 0.2898773006134969



Validation scores:
	RegressionAUROC: 0.7198729515075684
	RegressionCompetitionScore: 0.293558282208589



Validation scores:
	RegressionAUROC: 0.7187562584877014
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7175644636154175
	RegressionCompetitionScore: 0.2846625766871166



Validation scores:
	RegressionAUROC: 0.7057610154151917
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.192. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2205521472392638
     Test RegressionAUROC            0.6947557926177979
Test RegressionCompetitionScore      0.2205521472392638
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 12:43:03,284][0m Trial 89 finished with value: 0.2205521472392638 and parameters: {'lr': 5.3060110288690924e-05, 'dropout': 0.6128265361334446, 'd_model_multiplier': 2, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 212, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 82 with value: 0.4012269938650307.[0m
Starting trial with params:
{'lr': 2.765073297759647e-05, 'dropout': 0.5556187784266767, 'd_model_multiplier': 2, 'num_layers': 15, 'n_heads': 32, 'dim_feedforward': 95, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 513 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
513 K     Trainable params
0         Non-trainable params
513 K     Total params
2.053     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5416666865348816
	RegressionCompetitionScore: 0.08333333333333333



Validation scores:
	RegressionAUROC: 0.5545780658721924
	RegressionCompetitionScore: 0.09233128834355828

Metric val_loss improved. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5841478705406189
	RegressionCompetitionScore: 0.21411042944785277



Validation scores:
	RegressionAUROC: 0.6131486892700195
	RegressionCompetitionScore: 0.2245398773006135



Validation scores:
	RegressionAUROC: 0.6377643346786499
	RegressionCompetitionScore: 0.2294478527607362



Validation scores:
	RegressionAUROC: 0.6554461717605591
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.663044810295105
	RegressionCompetitionScore: 0.2794478527607362



Validation scores:
	RegressionAUROC: 0.6450756788253784
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6469310522079468
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.214. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.09233128834355828
     Test RegressionAUROC            0.5545780658721924
Test RegressionCompetitionScore      0.09233128834355828
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 12:52:23,636][0m Trial 90 finished with value: 0.09233128834355828 and parameters: {'lr': 2.765073297759647e-05, 'dropout': 0.5556187784266767, 'd_model_multiplier': 2, 'num_layers': 15, 'n_heads': 32, 'dim_feedforward': 95, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 82 with value: 0.4012269938650307.[0m
Starting trial with params:
{'lr': 9.706526990595564e-05, 'dropout': 0.5724810458636826, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 184, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 644 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
644 K     Trainable params
0         Non-trainable params
644 K     Total params
2.579     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4703064560890198
	RegressionCompetitionScore: 0.0598159509202454

Metric val_loss improved. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.6205952763557434
	RegressionCompetitionScore: 0.23680981595092024

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.535484790802002
	RegressionCompetitionScore: 0.08282208588957055

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.6661362648010254
	RegressionCompetitionScore: 0.10736196319018405

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6965489387512207
	RegressionCompetitionScore: 0.3352760736196319

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7256003022193909
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7172956466674805
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7251337766647339
	RegressionCompetitionScore: 0.3263803680981595

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7271577715873718
	RegressionCompetitionScore: 0.36165644171779143

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7215073704719543
	RegressionCompetitionScore: 0.3579754601226994



Validation scores:
	RegressionAUROC: 0.7354205846786499
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7151929140090942
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7343035340309143
	RegressionCompetitionScore: 0.3257668711656442



Validation scores:
	RegressionAUROC: 0.7164371013641357
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7366146445274353
	RegressionCompetitionScore: 0.3076687116564417



Validation scores:
	RegressionAUROC: 0.7308858633041382
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.176. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36165644171779143
     Test RegressionAUROC            0.7271577715873718
Test RegressionCompetitionScore      0.36165644171779143
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 13:09:25,927][0m Trial 91 finished with value: 0.36165644171779143 and parameters: {'lr': 9.706526990595564e-05, 'dropout': 0.5724810458636826, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 184, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 82 with value: 0.4012269938650307.[0m
Starting trial with params:
{'lr': 0.00011358047797562155, 'dropout': 0.5972627021840696, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 137, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 559 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
559 K     Trainable params
0         Non-trainable params
559 K     Total params
2.240     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6304929256439209
	RegressionCompetitionScore: 0.3254601226993865

Metric val_loss improved. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.5436574220657349
	RegressionCompetitionScore: 0.11533742331288344



Validation scores:
	RegressionAUROC: 0.6202866435050964
	RegressionCompetitionScore: 0.11441717791411044



Validation scores:
	RegressionAUROC: 0.6296828985214233
	RegressionCompetitionScore: 0.10736196319018405



Validation scores:
	RegressionAUROC: 0.6739089488983154
	RegressionCompetitionScore: 0.17699386503067485

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6602846384048462
	RegressionCompetitionScore: 0.19938650306748465



Validation scores:
	RegressionAUROC: 0.702315628528595
	RegressionCompetitionScore: 0.32975460122699385



Validation scores:
	RegressionAUROC: 0.6982549428939819
	RegressionCompetitionScore: 0.2846625766871166



Validation scores:
	RegressionAUROC: 0.7231736183166504
	RegressionCompetitionScore: 0.3880368098159509

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7333155870437622
	RegressionCompetitionScore: 0.38742331288343557



Validation scores:
	RegressionAUROC: 0.7330937385559082
	RegressionCompetitionScore: 0.30828220858895705



Validation scores:
	RegressionAUROC: 0.6592956781387329
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7341395616531372
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6907941699028015
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7510503530502319
	RegressionCompetitionScore: 0.39355828220858896

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7499532699584961
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.749611496925354
	RegressionCompetitionScore: 0.37576687116564417



Validation scores:
	RegressionAUROC: 0.7509803175926208
	RegressionCompetitionScore: 0.3736196319018405



Validation scores:
	RegressionAUROC: 0.7463080286979675
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7468946576118469
	RegressionCompetitionScore: 0.42760736196319016

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7300634980201721
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.741594672203064
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6997941732406616
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7087570428848267
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7391091585159302
	RegressionCompetitionScore: 0.3512269938650307



Validation scores:
	RegressionAUROC: 0.7241034507751465
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7187038064002991
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.181. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.42760736196319016
     Test RegressionAUROC            0.7468946576118469
Test RegressionCompetitionScore      0.42760736196319016
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 13:37:39,577][0m Trial 92 finished with value: 0.42760736196319016 and parameters: {'lr': 0.00011358047797562155, 'dropout': 0.5972627021840696, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 137, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00011242911437714766, 'dropout': 0.5963406963236169, 'd_model_multiplier': 64, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 138, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 244 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
244 M     Trainable params
0         Non-trainable params
244 M     Total params
979.811   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4791666865348816
	RegressionCompetitionScore: 0.08333333333333333



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.671


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.249 >= min_delta = 0.0. New best score: 0.422


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.536868691444397
	RegressionCompetitionScore: 0.07668711656441718



Validation scores:
	RegressionAUROC: 0.5800119042396545
	RegressionCompetitionScore: 0.1619631901840491

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.385


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49640318751335144
	RegressionCompetitionScore: 0.053067484662576686



Validation scores:
	RegressionAUROC: 0.4857226312160492
	RegressionCompetitionScore: 0.02822085889570552

Metric val_loss improved by 0.174 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.5047180652618408
	RegressionCompetitionScore: 0.041104294478527606



Validation scores:
	RegressionAUROC: 0.48351091146469116
	RegressionCompetitionScore: 0.0401840490797546



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49684232473373413
	RegressionCompetitionScore: 0.06411042944785277



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5094155073165894
	RegressionCompetitionScore: 0.05122699386503068

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.211. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.02822085889570552
     Test RegressionAUROC            0.4857226312160492
Test RegressionCompetitionScore      0.02822085889570552
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 14:59:35,351][0m Trial 93 finished with value: 0.02822085889570552 and parameters: {'lr': 0.00011242911437714766, 'dropout': 0.5963406963236169, 'd_model_multiplier': 64, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 138, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00037047625117828727, 'dropout': 0.5751366029349907, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 200, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 673 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
673 K     Trainable params
0         Non-trainable params
673 K     Total params
2.695     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4796063303947449
	RegressionCompetitionScore: 0.09171779141104294

Metric val_loss improved. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.4055512547492981
	RegressionCompetitionScore: 0.07914110429447853



Validation scores:
	RegressionAUROC: 0.6373683214187622
	RegressionCompetitionScore: 0.08067484662576688



Validation scores:
	RegressionAUROC: 0.6528939008712769
	RegressionCompetitionScore: 0.09202453987730061



Validation scores:
	RegressionAUROC: 0.6451821327209473
	RegressionCompetitionScore: 0.100920245398773

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.659107506275177
	RegressionCompetitionScore: 0.12331288343558282



Validation scores:
	RegressionAUROC: 0.6795281171798706
	RegressionCompetitionScore: 0.1312883435582822



Validation scores:
	RegressionAUROC: 0.5863221883773804
	RegressionCompetitionScore: 0.09141104294478528



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6536312699317932
	RegressionCompetitionScore: 0.24662576687116564



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.210. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.100920245398773
     Test RegressionAUROC            0.6451821327209473
Test RegressionCompetitionScore       0.100920245398773
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 15:12:32,492][0m Trial 94 finished with value: 0.100920245398773 and parameters: {'lr': 0.00037047625117828727, 'dropout': 0.5751366029349907, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 200, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0001578115544427036, 'dropout': 0.6240801964735829, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 155, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 592 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
592 K     Trainable params
0         Non-trainable params
592 K     Total params
2.370     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.64170902967453
	RegressionCompetitionScore: 0.2598159509202454

Metric val_loss improved. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.6619910001754761
	RegressionCompetitionScore: 0.08987730061349693

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6192247867584229
	RegressionCompetitionScore: 0.0687116564417178



Validation scores:
	RegressionAUROC: 0.6478642225265503
	RegressionCompetitionScore: 0.07239263803680981



Validation scores:
	RegressionAUROC: 0.6787539720535278
	RegressionCompetitionScore: 0.19417177914110428

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6513362526893616
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6961916089057922
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7028684616088867
	RegressionCompetitionScore: 0.3107361963190184



Validation scores:
	RegressionAUROC: 0.7010751962661743
	RegressionCompetitionScore: 0.34938650306748464

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.6878299713134766
	RegressionCompetitionScore: 0.3383435582822086



Validation scores:
	RegressionAUROC: 0.7130546569824219
	RegressionCompetitionScore: 0.24294478527607363



Validation scores:
	RegressionAUROC: 0.7029308080673218
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7328214049339294
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7149512767791748
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7314554452896118
	RegressionCompetitionScore: 0.24478527607361963



Validation scores:
	RegressionAUROC: 0.7392582893371582
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.183. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.34938650306748464
     Test RegressionAUROC            0.7010751962661743
Test RegressionCompetitionScore      0.34938650306748464
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 15:29:31,343][0m Trial 95 finished with value: 0.34938650306748464 and parameters: {'lr': 0.0001578115544427036, 'dropout': 0.6240801964735829, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 155, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 5.101739739021347e-05, 'dropout': 0.5865727113408582, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 179, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 122 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
122 K     Trainable params
0         Non-trainable params
122 K     Total params
0.492     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.45760443806648254
	RegressionCompetitionScore: 0.08834355828220859

Metric val_loss improved. New best score: 0.516


Validation scores:
	RegressionAUROC: 0.39082491397857666
	RegressionCompetitionScore: 0.05736196319018405

Metric val_loss improved by 0.238 >= min_delta = 0.0. New best score: 0.278


Validation scores:
	RegressionAUROC: 0.3988874554634094
	RegressionCompetitionScore: 0.057975460122699385

Metric val_loss improved by 0.046 >= min_delta = 0.0. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.4131960868835449
	RegressionCompetitionScore: 0.0705521472392638



Validation scores:
	RegressionAUROC: 0.4197135865688324
	RegressionCompetitionScore: 0.07300613496932515



Validation scores:
	RegressionAUROC: 0.4283573031425476
	RegressionCompetitionScore: 0.0754601226993865



Validation scores:
	RegressionAUROC: 0.4458639323711395
	RegressionCompetitionScore: 0.0843558282208589

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.44633761048316956
	RegressionCompetitionScore: 0.08650306748466258

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.44450077414512634
	RegressionCompetitionScore: 0.07914110429447853



Validation scores:
	RegressionAUROC: 0.44532811641693115
	RegressionCompetitionScore: 0.07760736196319018



Validation scores:
	RegressionAUROC: 0.45245814323425293
	RegressionCompetitionScore: 0.07791411042944785



Validation scores:
	RegressionAUROC: 0.45762404799461365
	RegressionCompetitionScore: 0.08251533742331288



Validation scores:
	RegressionAUROC: 0.4598570764064789
	RegressionCompetitionScore: 0.08558282208588958



Validation scores:
	RegressionAUROC: 0.4608396887779236
	RegressionCompetitionScore: 0.09294478527607362



Validation scores:
	RegressionAUROC: 0.4607951045036316
	RegressionCompetitionScore: 0.10276073619631902

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.213. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.08650306748466258
     Test RegressionAUROC            0.44633761048316956
Test RegressionCompetitionScore      0.08650306748466258
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 15:36:37,305][0m Trial 96 finished with value: 0.08650306748466258 and parameters: {'lr': 5.101739739021347e-05, 'dropout': 0.5865727113408582, 'd_model_multiplier': 2, 'num_layers': 13, 'n_heads': 8, 'dim_feedforward': 179, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 7.713483425998118e-05, 'dropout': 0.5378884076287096, 'd_model_multiplier': 2, 'num_layers': 15, 'n_heads': 32, 'dim_feedforward': 105, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 532 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
532 K     Trainable params
0         Non-trainable params
532 K     Total params
2.131     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6231393814086914
	RegressionCompetitionScore: 0.2733128834355828

Metric val_loss improved. New best score: 0.239


Validation scores:
	RegressionAUROC: 0.621954083442688
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6731187105178833
	RegressionCompetitionScore: 0.2420245398773006



Validation scores:
	RegressionAUROC: 0.6878642439842224
	RegressionCompetitionScore: 0.2469325153374233

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6874220371246338
	RegressionCompetitionScore: 0.31901840490797545

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6671839952468872
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6986477375030518
	RegressionCompetitionScore: 0.3506134969325153



Validation scores:
	RegressionAUROC: 0.7109671831130981
	RegressionCompetitionScore: 0.3469325153374233

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7142915725708008
	RegressionCompetitionScore: 0.35276073619631904



Validation scores:
	RegressionAUROC: 0.7154356241226196
	RegressionCompetitionScore: 0.36503067484662577



Validation scores:
	RegressionAUROC: 0.736693263053894
	RegressionCompetitionScore: 0.3693251533742331

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7418955564498901
	RegressionCompetitionScore: 0.3684049079754601



Validation scores:
	RegressionAUROC: 0.7395758628845215
	RegressionCompetitionScore: 0.346319018404908



Validation scores:
	RegressionAUROC: 0.7409190535545349
	RegressionCompetitionScore: 0.3647239263803681



Validation scores:
	RegressionAUROC: 0.7434862852096558
	RegressionCompetitionScore: 0.35337423312883437



Validation scores:
	RegressionAUROC: 0.7289489507675171
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7337990999221802
	RegressionCompetitionScore: 0.39478527607361963



Validation scores:
	RegressionAUROC: 0.7332866787910461
	RegressionCompetitionScore: 0.39723926380368096

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.184. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3693251533742331
     Test RegressionAUROC             0.736693263053894
Test RegressionCompetitionScore      0.3693251533742331
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 15:56:48,422][0m Trial 97 finished with value: 0.3693251533742331 and parameters: {'lr': 7.713483425998118e-05, 'dropout': 0.5378884076287096, 'd_model_multiplier': 2, 'num_layers': 15, 'n_heads': 32, 'dim_feedforward': 105, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 7.909794086970673e-05, 'dropout': 0.540849730980443, 'd_model_multiplier': 2, 'num_layers': 15, 'n_heads': 32, 'dim_feedforward': 66, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 457 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
457 K     Trainable params
0         Non-trainable params
457 K     Total params
1.829     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.375
	RegressionCompetitionScore: 0.25



Validation scores:
	RegressionAUROC: 0.6164014935493469
	RegressionCompetitionScore: 0.0794478527607362

Metric val_loss improved. New best score: 0.326


Validation scores:
	RegressionAUROC: 0.6516252756118774
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.065 >= min_delta = 0.0. New best score: 0.261


Validation scores:
	RegressionAUROC: 0.6809426546096802
	RegressionCompetitionScore: 0.20398773006134968

Metric val_loss improved by 0.072 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6797966957092285
	RegressionCompetitionScore: 0.16134969325153375



Validation scores:
	RegressionAUROC: 0.7177083492279053
	RegressionCompetitionScore: 0.35613496932515337

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7331036925315857
	RegressionCompetitionScore: 0.37484662576687117



Validation scores:
	RegressionAUROC: 0.7257071137428284
	RegressionCompetitionScore: 0.3619631901840491



Validation scores:
	RegressionAUROC: 0.7361890077590942
	RegressionCompetitionScore: 0.36687116564417177



Validation scores:
	RegressionAUROC: 0.7453255653381348
	RegressionCompetitionScore: 0.34938650306748464



Validation scores:
	RegressionAUROC: 0.708865761756897
	RegressionCompetitionScore: 0.3487730061349693



Validation scores:
	RegressionAUROC: 0.7382907867431641
	RegressionCompetitionScore: 0.33957055214723925



Validation scores:
	RegressionAUROC: 0.7421936392784119
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.184. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.35613496932515337
     Test RegressionAUROC            0.7177083492279053
Test RegressionCompetitionScore      0.35613496932515337
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 16:10:28,671][0m Trial 98 finished with value: 0.35613496932515337 and parameters: {'lr': 7.909794086970673e-05, 'dropout': 0.540849730980443, 'd_model_multiplier': 2, 'num_layers': 15, 'n_heads': 32, 'dim_feedforward': 66, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0002248560180336954, 'dropout': 0.5277831793423878, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 125, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 571 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
571 K     Trainable params
0         Non-trainable params
571 K     Total params
2.285     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.8125
	RegressionCompetitionScore: 0.75



Validation scores:
	RegressionAUROC: 0.6410733461380005
	RegressionCompetitionScore: 0.20429447852760735

Metric val_loss improved. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.6730989217758179
	RegressionCompetitionScore: 0.2156441717791411

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6768528819084167
	RegressionCompetitionScore: 0.3024539877300613



Validation scores:
	RegressionAUROC: 0.6960567235946655
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7340394854545593
	RegressionCompetitionScore: 0.38865030674846623

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7302103042602539
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7304027080535889
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7442519068717957
	RegressionCompetitionScore: 0.36226993865030677



Validation scores:
	RegressionAUROC: 0.7625486850738525
	RegressionCompetitionScore: 0.4242331288343558



Validation scores:
	RegressionAUROC: 0.7710253596305847
	RegressionCompetitionScore: 0.38588957055214723



Validation scores:
	RegressionAUROC: 0.7533296942710876
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.769188642501831
	RegressionCompetitionScore: 0.4187116564417178

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.187. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38865030674846623
     Test RegressionAUROC            0.7340394854545593
Test RegressionCompetitionScore      0.38865030674846623
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 16:18:43,069][0m Trial 99 finished with value: 0.38865030674846623 and parameters: {'lr': 0.0002248560180336954, 'dropout': 0.5277831793423878, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 125, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00022213654950418437, 'dropout': 0.5030398835029036, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 101, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 524 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
524 K     Trainable params
0         Non-trainable params
524 K     Total params
2.100     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.36231884360313416
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5810195207595825
	RegressionCompetitionScore: 0.23466257668711657

Metric val_loss improved. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.6267504692077637
	RegressionCompetitionScore: 0.25245398773006134

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6463922262191772
	RegressionCompetitionScore: 0.254601226993865



Validation scores:
	RegressionAUROC: 0.6776221394538879
	RegressionCompetitionScore: 0.2837423312883436

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.7057215571403503
	RegressionCompetitionScore: 0.3085889570552147



Validation scores:
	RegressionAUROC: 0.7159084677696228
	RegressionCompetitionScore: 0.34263803680981597



Validation scores:
	RegressionAUROC: 0.741297721862793
	RegressionCompetitionScore: 0.3570552147239264



Validation scores:
	RegressionAUROC: 0.7484374046325684
	RegressionCompetitionScore: 0.3604294478527607



Validation scores:
	RegressionAUROC: 0.7546535730361938
	RegressionCompetitionScore: 0.402760736196319

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7721987962722778
	RegressionCompetitionScore: 0.3969325153374233



Validation scores:
	RegressionAUROC: 0.7775123119354248
	RegressionCompetitionScore: 0.404601226993865



Validation scores:
	RegressionAUROC: 0.7831807136535645
	RegressionCompetitionScore: 0.404601226993865



Validation scores:
	RegressionAUROC: 0.7639443874359131
	RegressionCompetitionScore: 0.39815950920245397



Validation scores:
	RegressionAUROC: 0.7728922367095947
	RegressionCompetitionScore: 0.4493865030674847



Validation scores:
	RegressionAUROC: 0.7812691926956177
	RegressionCompetitionScore: 0.4285276073619632



Validation scores:
	RegressionAUROC: 0.7827823162078857
	RegressionCompetitionScore: 0.41687116564417176

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.172. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.402760736196319
     Test RegressionAUROC            0.7546535730361938
Test RegressionCompetitionScore       0.402760736196319
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 16:28:52,033][0m Trial 100 finished with value: 0.402760736196319 and parameters: {'lr': 0.00022213654950418437, 'dropout': 0.5030398835029036, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 101, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0002743933737842627, 'dropout': 0.5087643643168069, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 126, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 573 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
573 K     Trainable params
0         Non-trainable params
573 K     Total params
2.293     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5092448592185974
	RegressionCompetitionScore: 0.07760736196319018

Metric val_loss improved. New best score: 0.322


Validation scores:
	RegressionAUROC: 0.5985126495361328
	RegressionCompetitionScore: 0.24754601226993864

Metric val_loss improved by 0.062 >= min_delta = 0.0. New best score: 0.260


Validation scores:
	RegressionAUROC: 0.6221654415130615
	RegressionCompetitionScore: 0.29049079754601226

Metric val_loss improved by 0.051 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6221114993095398
	RegressionCompetitionScore: 0.2748466257668712

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6639864444732666
	RegressionCompetitionScore: 0.3042944785276074



Validation scores:
	RegressionAUROC: 0.6257517337799072
	RegressionCompetitionScore: 0.10797546012269939



Validation scores:
	RegressionAUROC: 0.6858236193656921
	RegressionCompetitionScore: 0.2800613496932515



Validation scores:
	RegressionAUROC: 0.6896679401397705
	RegressionCompetitionScore: 0.25736196319018406



Validation scores:
	RegressionAUROC: 0.6984635591506958
	RegressionCompetitionScore: 0.39754601226993863

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.7251307964324951
	RegressionCompetitionScore: 0.34049079754601225

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7122768759727478
	RegressionCompetitionScore: 0.37423312883435583



Validation scores:
	RegressionAUROC: 0.719554603099823
	RegressionCompetitionScore: 0.293558282208589

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6875638365745544
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7163906097412109
	RegressionCompetitionScore: 0.2677914110429448



Validation scores:
	RegressionAUROC: 0.7548744082450867
	RegressionCompetitionScore: 0.405521472392638

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7188155055046082
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7235487699508667
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7279097437858582
	RegressionCompetitionScore: 0.2558282208588957



Validation scores:
	RegressionAUROC: 0.7291768789291382
	RegressionCompetitionScore: 0.2450920245398773



Validation scores:
	RegressionAUROC: 0.7383275032043457
	RegressionCompetitionScore: 0.2871165644171779



Validation scores:
	RegressionAUROC: 0.7508053779602051
	RegressionCompetitionScore: 0.3006134969325153



Validation scores:
	RegressionAUROC: 0.7191939353942871
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.168. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.405521472392638
     Test RegressionAUROC            0.7548744082450867
Test RegressionCompetitionScore       0.405521472392638
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 16:42:36,009][0m Trial 101 finished with value: 0.405521472392638 and parameters: {'lr': 0.0002743933737842627, 'dropout': 0.5087643643168069, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 126, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0002465151218646395, 'dropout': 0.5065214302035438, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 112, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 546 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
546 K     Trainable params
0         Non-trainable params
546 K     Total params
2.185     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.25120770931243896
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.5918436646461487
	RegressionCompetitionScore: 0.24938650306748467

Metric val_loss improved. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6554783582687378
	RegressionCompetitionScore: 0.23865030674846627



Validation scores:
	RegressionAUROC: 0.6669101715087891
	RegressionCompetitionScore: 0.25030674846625767

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.7052120566368103
	RegressionCompetitionScore: 0.3042944785276074



Validation scores:
	RegressionAUROC: 0.7251216769218445
	RegressionCompetitionScore: 0.3604294478527607



Validation scores:
	RegressionAUROC: 0.7051955461502075
	RegressionCompetitionScore: 0.3978527607361963



Validation scores:
	RegressionAUROC: 0.7602816820144653
	RegressionCompetitionScore: 0.3920245398773006



Validation scores:
	RegressionAUROC: 0.7605876922607422
	RegressionCompetitionScore: 0.4049079754601227



Validation scores:
	RegressionAUROC: 0.7318657636642456
	RegressionCompetitionScore: 0.36319018404907977



Validation scores:
	RegressionAUROC: 0.7820737361907959
	RegressionCompetitionScore: 0.39846625766871163

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.197. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.25030674846625767
     Test RegressionAUROC            0.6669101715087891
Test RegressionCompetitionScore      0.25030674846625767
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 16:49:04,433][0m Trial 102 finished with value: 0.25030674846625767 and parameters: {'lr': 0.0002465151218646395, 'dropout': 0.5065214302035438, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 112, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0001897025090987873, 'dropout': 0.5106700065009941, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 90, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 503 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
503 K     Trainable params
0         Non-trainable params
503 K     Total params
2.014     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6348907947540283
	RegressionCompetitionScore: 0.1647239263803681

Metric val_loss improved. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.652989387512207
	RegressionCompetitionScore: 0.200920245398773



Validation scores:
	RegressionAUROC: 0.6201635003089905
	RegressionCompetitionScore: 0.13067484662576687

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6571950912475586
	RegressionCompetitionScore: 0.1401840490797546



Validation scores:
	RegressionAUROC: 0.6846538782119751
	RegressionCompetitionScore: 0.2469325153374233

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7132072448730469
	RegressionCompetitionScore: 0.2898773006134969



Validation scores:
	RegressionAUROC: 0.7117607593536377
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7174481153488159
	RegressionCompetitionScore: 0.3202453987730061



Validation scores:
	RegressionAUROC: 0.7195271849632263
	RegressionCompetitionScore: 0.34049079754601225



Validation scores:
	RegressionAUROC: 0.7360376119613647
	RegressionCompetitionScore: 0.3355828220858896

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7343040108680725
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.745480477809906
	RegressionCompetitionScore: 0.36901840490797544



Validation scores:
	RegressionAUROC: 0.7456717491149902
	RegressionCompetitionScore: 0.3352760736196319

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7537468671798706
	RegressionCompetitionScore: 0.3754601226993865



Validation scores:
	RegressionAUROC: 0.7512557506561279
	RegressionCompetitionScore: 0.3638036809815951



Validation scores:
	RegressionAUROC: 0.7496750354766846
	RegressionCompetitionScore: 0.34263803680981597



Validation scores:
	RegressionAUROC: 0.7632918953895569
	RegressionCompetitionScore: 0.35245398773006137



Validation scores:
	RegressionAUROC: 0.7299781441688538
	RegressionCompetitionScore: 0.32515337423312884



Validation scores:
	RegressionAUROC: 0.7344578504562378
	RegressionCompetitionScore: 0.35828220858895704



Validation scores:
	RegressionAUROC: 0.752272367477417
	RegressionCompetitionScore: 0.36411042944785277

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.176. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3352760736196319
     Test RegressionAUROC            0.7456717491149902
Test RegressionCompetitionScore      0.3352760736196319
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 17:01:34,011][0m Trial 103 finished with value: 0.3352760736196319 and parameters: {'lr': 0.0001897025090987873, 'dropout': 0.5106700065009941, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 90, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0005503505662389749, 'dropout': 0.4831774042964373, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 128, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 577 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
577 K     Trainable params
0         Non-trainable params
577 K     Total params
2.309     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.059


Validation scores:
	RegressionAUROC: 0.6113929748535156
	RegressionCompetitionScore: 0.12576687116564417

Metric val_loss improved by 0.711 >= min_delta = 0.0. New best score: 0.348


Validation scores:
	RegressionAUROC: 0.37697505950927734
	RegressionCompetitionScore: 0.08190184049079755

Metric val_loss improved by 0.129 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.39004409313201904
	RegressionCompetitionScore: 0.056134969325153376



Validation scores:
	RegressionAUROC: 0.43761157989501953
	RegressionCompetitionScore: 0.024846625766871164



Validation scores:
	RegressionAUROC: 0.3953936696052551
	RegressionCompetitionScore: 0.10153374233128834



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5516289472579956
	RegressionCompetitionScore: 0.1785276073619632



Validation scores:
	RegressionAUROC: 0.5714129209518433
	RegressionCompetitionScore: 0.2714723926380368

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5094923973083496
	RegressionCompetitionScore: 0.024846625766871164



Validation scores:
	RegressionAUROC: 0.608204185962677
	RegressionCompetitionScore: 0.27116564417177913



Validation scores:
	RegressionAUROC: 0.630126416683197
	RegressionCompetitionScore: 0.2901840490797546



Validation scores:
	RegressionAUROC: 0.54412841796875
	RegressionCompetitionScore: 0.06779141104294478



Validation scores:
	RegressionAUROC: 0.6226153373718262
	RegressionCompetitionScore: 0.27607361963190186

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6088495850563049
	RegressionCompetitionScore: 0.248159509202454



Validation scores:
	RegressionAUROC: 0.33996474742889404
	RegressionCompetitionScore: 0.022392638036809815



Validation scores:
	RegressionAUROC: 0.5142267942428589
	RegressionCompetitionScore: 0.07300613496932515



Validation scores:
	RegressionAUROC: 0.508352518081665
	RegressionCompetitionScore: 0.06625766871165645



Validation scores:
	RegressionAUROC: 0.3758040964603424
	RegressionCompetitionScore: 0.026993865030674847



Validation scores:
	RegressionAUROC: 0.5240408182144165
	RegressionCompetitionScore: 0.057975460122699385



Validation scores:
	RegressionAUROC: 0.543962836265564
	RegressionCompetitionScore: 0.16656441717791412

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.27607361963190186
     Test RegressionAUROC            0.6226153373718262
Test RegressionCompetitionScore      0.27607361963190186
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 17:14:39,822][0m Trial 104 finished with value: 0.27607361963190186 and parameters: {'lr': 0.0005503505662389749, 'dropout': 0.4831774042964373, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 128, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0001225571446984571, 'dropout': 0.5231954881072584, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 127, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 575 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
575 K     Trainable params
0         Non-trainable params
575 K     Total params
2.301     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5603864789009094
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.5499449968338013
	RegressionCompetitionScore: 0.07975460122699386

Metric val_loss improved. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6731839179992676
	RegressionCompetitionScore: 0.2205521472392638

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6800559759140015
	RegressionCompetitionScore: 0.26380368098159507

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.6991832852363586
	RegressionCompetitionScore: 0.2214723926380368

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7024250626564026
	RegressionCompetitionScore: 0.2996932515337423



Validation scores:
	RegressionAUROC: 0.7232964038848877
	RegressionCompetitionScore: 0.3095092024539877



Validation scores:
	RegressionAUROC: 0.727721631526947
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.710698664188385
	RegressionCompetitionScore: 0.302760736196319



Validation scores:
	RegressionAUROC: 0.7314040660858154
	RegressionCompetitionScore: 0.32085889570552145

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7442309856414795
	RegressionCompetitionScore: 0.3852760736196319



Validation scores:
	RegressionAUROC: 0.7364131212234497
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7364513874053955
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7364412546157837
	RegressionCompetitionScore: 0.3334355828220859



Validation scores:
	RegressionAUROC: 0.7275031805038452
	RegressionCompetitionScore: 0.29662576687116565



Validation scores:
	RegressionAUROC: 0.7497565150260925
	RegressionCompetitionScore: 0.3576687116564417



Validation scores:
	RegressionAUROC: 0.7464426755905151
	RegressionCompetitionScore: 0.349079754601227

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.185. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.32085889570552145
     Test RegressionAUROC            0.7314040660858154
Test RegressionCompetitionScore      0.32085889570552145
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 17:24:48,867][0m Trial 105 finished with value: 0.32085889570552145 and parameters: {'lr': 0.0001225571446984571, 'dropout': 0.5231954881072584, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 127, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0002797295605007668, 'dropout': 0.5328695585313672, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 85, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 466 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
466 K     Trainable params
0         Non-trainable params
466 K     Total params
1.864     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6038647294044495
	RegressionCompetitionScore: 0.43478260869565216



Validation scores:
	RegressionAUROC: 0.596930205821991
	RegressionCompetitionScore: 0.24877300613496933

Metric val_loss improved. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6280162334442139
	RegressionCompetitionScore: 0.2674846625766871



Validation scores:
	RegressionAUROC: 0.6919509172439575
	RegressionCompetitionScore: 0.2996932515337423

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6854726076126099
	RegressionCompetitionScore: 0.13957055214723926



Validation scores:
	RegressionAUROC: 0.6838639974594116
	RegressionCompetitionScore: 0.26319018404907973



Validation scores:
	RegressionAUROC: 0.7161312103271484
	RegressionCompetitionScore: 0.3371165644171779

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7262372970581055
	RegressionCompetitionScore: 0.3487730061349693



Validation scores:
	RegressionAUROC: 0.7116695046424866
	RegressionCompetitionScore: 0.3174846625766871



Validation scores:
	RegressionAUROC: 0.7422325611114502
	RegressionCompetitionScore: 0.36441717791411044

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7325915694236755
	RegressionCompetitionScore: 0.2794478527607362



Validation scores:
	RegressionAUROC: 0.7520222067832947
	RegressionCompetitionScore: 0.35828220858895704



Validation scores:
	RegressionAUROC: 0.7330661416053772
	RegressionCompetitionScore: 0.3693251533742331



Validation scores:
	RegressionAUROC: 0.7237737774848938
	RegressionCompetitionScore: 0.36226993865030677



Validation scores:
	RegressionAUROC: 0.7160861492156982
	RegressionCompetitionScore: 0.32239263803680984



Validation scores:
	RegressionAUROC: 0.7435817718505859
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7204944491386414
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.173. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36441717791411044
     Test RegressionAUROC            0.7422325611114502
Test RegressionCompetitionScore      0.36441717791411044
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 17:34:38,510][0m Trial 106 finished with value: 0.36441717791411044 and parameters: {'lr': 0.0002797295605007668, 'dropout': 0.5328695585313672, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 85, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0002050974413311564, 'dropout': 0.49839265221874496, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 107, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 505 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
505 K     Trainable params
0         Non-trainable params
505 K     Total params
2.023     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.62176114320755
	RegressionCompetitionScore: 0.295398773006135

Metric val_loss improved. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.6160273551940918
	RegressionCompetitionScore: 0.25429447852760734

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.6222134828567505
	RegressionCompetitionScore: 0.2723926380368098

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6583837270736694
	RegressionCompetitionScore: 0.13067484662576687



Validation scores:
	RegressionAUROC: 0.6802526116371155
	RegressionCompetitionScore: 0.31257668711656444

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.7206077575683594
	RegressionCompetitionScore: 0.35828220858895704



Validation scores:
	RegressionAUROC: 0.7179416418075562
	RegressionCompetitionScore: 0.36809815950920244



Validation scores:
	RegressionAUROC: 0.7160961031913757
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7192288637161255
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7344289422035217
	RegressionCompetitionScore: 0.404601226993865



Validation scores:
	RegressionAUROC: 0.7453701496124268
	RegressionCompetitionScore: 0.35736196319018404



Validation scores:
	RegressionAUROC: 0.7509006261825562
	RegressionCompetitionScore: 0.38834355828220857

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.200. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.31257668711656444
     Test RegressionAUROC            0.6802526116371155
Test RegressionCompetitionScore      0.31257668711656444
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 17:42:05,616][0m Trial 107 finished with value: 0.31257668711656444 and parameters: {'lr': 0.0002050974413311564, 'dropout': 0.49839265221874496, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 107, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00014829272919498438, 'dropout': 0.4785804671054189, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 218, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 751 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
751 K     Trainable params
0         Non-trainable params
751 K     Total params
3.005     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6183613538742065
	RegressionCompetitionScore: 0.15644171779141106

Metric val_loss improved. New best score: 0.391


Validation scores:
	RegressionAUROC: 0.5981371402740479
	RegressionCompetitionScore: 0.2696319018404908

Metric val_loss improved by 0.161 >= min_delta = 0.0. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.5995229482650757
	RegressionCompetitionScore: 0.27116564417177913

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6109423637390137
	RegressionCompetitionScore: 0.2852760736196319

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5987225770950317
	RegressionCompetitionScore: 0.2236196319018405

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6027272939682007
	RegressionCompetitionScore: 0.23803680981595093



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4069559574127197
	RegressionCompetitionScore: 0.0656441717791411



Validation scores:
	RegressionAUROC: 0.4194673001766205
	RegressionCompetitionScore: 0.05429447852760736



Validation scores:
	RegressionAUROC: 0.5914159417152405
	RegressionCompetitionScore: 0.24631901840490797



Validation scores:
	RegressionAUROC: 0.548527181148529
	RegressionCompetitionScore: 0.07730061349693251



Validation scores:
	RegressionAUROC: 0.5770577788352966
	RegressionCompetitionScore: 0.12392638036809817

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2236196319018405
     Test RegressionAUROC            0.5987225770950317
Test RegressionCompetitionScore      0.2236196319018405
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 17:51:33,059][0m Trial 108 finished with value: 0.2236196319018405 and parameters: {'lr': 0.00014829272919498438, 'dropout': 0.4785804671054189, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 218, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00035998832552430434, 'dropout': 0.5227387302016607, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 168, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 615 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
615 K     Trainable params
0         Non-trainable params
615 K     Total params
2.464     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.637466311454773
	RegressionCompetitionScore: 0.23374233128834357

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5204122066497803
	RegressionCompetitionScore: 0.13496932515337423



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.3690086603164673
	RegressionCompetitionScore: 0.0598159509202454



Validation scores:
	RegressionAUROC: 0.42040127515792847
	RegressionCompetitionScore: 0.06349693251533742



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.23374233128834357
     Test RegressionAUROC             0.637466311454773
Test RegressionCompetitionScore      0.23374233128834357
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 17:56:46,701][0m Trial 109 finished with value: 0.23374233128834357 and parameters: {'lr': 0.00035998832552430434, 'dropout': 0.5227387302016607, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 168, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00011832809939092386, 'dropout': 0.5157904076509501, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 140, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 600 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
600 K     Trainable params
0         Non-trainable params
600 K     Total params
2.401     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4396134912967682
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6445893049240112
	RegressionCompetitionScore: 0.2245398773006135

Metric val_loss improved. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.6636624336242676
	RegressionCompetitionScore: 0.253680981595092

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6699190139770508
	RegressionCompetitionScore: 0.25153374233128833

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6979411244392395
	RegressionCompetitionScore: 0.25030674846625767



Validation scores:
	RegressionAUROC: 0.7206926345825195
	RegressionCompetitionScore: 0.3383435582822086

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7253525257110596
	RegressionCompetitionScore: 0.34355828220858897



Validation scores:
	RegressionAUROC: 0.7228335738182068
	RegressionCompetitionScore: 0.36073619631901843



Validation scores:
	RegressionAUROC: 0.7045505046844482
	RegressionCompetitionScore: 0.3380368098159509



Validation scores:
	RegressionAUROC: 0.7332627773284912
	RegressionCompetitionScore: 0.34938650306748464



Validation scores:
	RegressionAUROC: 0.7365970611572266
	RegressionCompetitionScore: 0.38128834355828223



Validation scores:
	RegressionAUROC: 0.7425892949104309
	RegressionCompetitionScore: 0.38404907975460123

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7391701936721802
	RegressionCompetitionScore: 0.3791411042944785

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7359598875045776
	RegressionCompetitionScore: 0.3684049079754601



Validation scores:
	RegressionAUROC: 0.7302240133285522
	RegressionCompetitionScore: 0.33865030674846625



Validation scores:
	RegressionAUROC: 0.7354102730751038
	RegressionCompetitionScore: 0.3696319018404908



Validation scores:
	RegressionAUROC: 0.7077875137329102
	RegressionCompetitionScore: 0.3214723926380368



Validation scores:
	RegressionAUROC: 0.7405316829681396
	RegressionCompetitionScore: 0.3782208588957055



Validation scores:
	RegressionAUROC: 0.741012692451477
	RegressionCompetitionScore: 0.3834355828220859



Validation scores:
	RegressionAUROC: 0.7349729537963867
	RegressionCompetitionScore: 0.3656441717791411

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3791411042944785
     Test RegressionAUROC            0.7391701936721802
Test RegressionCompetitionScore      0.3791411042944785
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 18:08:38,160][0m Trial 110 finished with value: 0.3791411042944785 and parameters: {'lr': 0.00011832809939092386, 'dropout': 0.5157904076509501, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 140, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0001669509941234137, 'dropout': 0.5107903351058224, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 144, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 608 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
608 K     Trainable params
0         Non-trainable params
608 K     Total params
2.432     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2995169162750244
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6784409284591675
	RegressionCompetitionScore: 0.29846625766871165

Metric val_loss improved. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.6922398209571838
	RegressionCompetitionScore: 0.2874233128834356

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.7079126238822937
	RegressionCompetitionScore: 0.2776073619631902

Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7110740542411804
	RegressionCompetitionScore: 0.3220858895705521

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7032786011695862
	RegressionCompetitionScore: 0.3380368098159509



Validation scores:
	RegressionAUROC: 0.7143008708953857
	RegressionCompetitionScore: 0.2874233128834356



Validation scores:
	RegressionAUROC: 0.7074029445648193
	RegressionCompetitionScore: 0.30122699386503066



Validation scores:
	RegressionAUROC: 0.6679591536521912
	RegressionCompetitionScore: 0.26226993865030673



Validation scores:
	RegressionAUROC: 0.7203589677810669
	RegressionCompetitionScore: 0.3530674846625767



Validation scores:
	RegressionAUROC: 0.7305121421813965
	RegressionCompetitionScore: 0.3969325153374233



Validation scores:
	RegressionAUROC: 0.7244983911514282
	RegressionCompetitionScore: 0.2911042944785276

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.182. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3220858895705521
     Test RegressionAUROC            0.7110740542411804
Test RegressionCompetitionScore      0.3220858895705521
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 18:15:42,887][0m Trial 111 finished with value: 0.3220858895705521 and parameters: {'lr': 0.0001669509941234137, 'dropout': 0.5107903351058224, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 144, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0001263252099043725, 'dropout': 0.46586764507235984, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 130, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 581 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
581 K     Trainable params
0         Non-trainable params
581 K     Total params
2.324     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.5943575501441956
	RegressionCompetitionScore: 0.24294478527607363

Metric val_loss improved. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.6410398483276367
	RegressionCompetitionScore: 0.26380368098159507

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6408987045288086
	RegressionCompetitionScore: 0.2634969325153374



Validation scores:
	RegressionAUROC: 0.6507593989372253
	RegressionCompetitionScore: 0.26042944785276073



Validation scores:
	RegressionAUROC: 0.6215912103652954
	RegressionCompetitionScore: 0.2570552147239264



Validation scores:
	RegressionAUROC: 0.6846153736114502
	RegressionCompetitionScore: 0.2705521472392638

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.701890230178833
	RegressionCompetitionScore: 0.22914110429447854



Validation scores:
	RegressionAUROC: 0.7229151725769043
	RegressionCompetitionScore: 0.3220858895705521



Validation scores:
	RegressionAUROC: 0.7357633113861084
	RegressionCompetitionScore: 0.34662576687116564

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7321303486824036
	RegressionCompetitionScore: 0.37576687116564417



Validation scores:
	RegressionAUROC: 0.7379340529441833
	RegressionCompetitionScore: 0.3889570552147239

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7387185096740723
	RegressionCompetitionScore: 0.38773006134969323



Validation scores:
	RegressionAUROC: 0.7272505164146423
	RegressionCompetitionScore: 0.345398773006135



Validation scores:
	RegressionAUROC: 0.7426882982254028
	RegressionCompetitionScore: 0.3558282208588957



Validation scores:
	RegressionAUROC: 0.7463119029998779
	RegressionCompetitionScore: 0.3861963190184049

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7357435822486877
	RegressionCompetitionScore: 0.3638036809815951



Validation scores:
	RegressionAUROC: 0.7488574385643005
	RegressionCompetitionScore: 0.37392638036809817



Validation scores:
	RegressionAUROC: 0.7498521208763123
	RegressionCompetitionScore: 0.3717791411042945



Validation scores:
	RegressionAUROC: 0.7495490312576294
	RegressionCompetitionScore: 0.4067484662576687



Validation scores:
	RegressionAUROC: 0.751457154750824
	RegressionCompetitionScore: 0.39815950920245397



Validation scores:
	RegressionAUROC: 0.7477697134017944
	RegressionCompetitionScore: 0.3904907975460123



Validation scores:
	RegressionAUROC: 0.7470376491546631
	RegressionCompetitionScore: 0.36073619631901843

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3861963190184049
     Test RegressionAUROC            0.7463119029998779
Test RegressionCompetitionScore      0.3861963190184049
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 18:29:28,856][0m Trial 112 finished with value: 0.3861963190184049 and parameters: {'lr': 0.0001263252099043725, 'dropout': 0.46586764507235984, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 130, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00011336216711034172, 'dropout': 0.4689741396500178, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 64, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 428 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
428 K     Trainable params
0         Non-trainable params
428 K     Total params
1.712     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6304347515106201
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.6529341340065002
	RegressionCompetitionScore: 0.2165644171779141

Metric val_loss improved. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.6697150468826294
	RegressionCompetitionScore: 0.24723926380368097



Validation scores:
	RegressionAUROC: 0.6844268441200256
	RegressionCompetitionScore: 0.24294478527607363

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6994606256484985
	RegressionCompetitionScore: 0.2184049079754601

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6849933862686157
	RegressionCompetitionScore: 0.300920245398773



Validation scores:
	RegressionAUROC: 0.6995888352394104
	RegressionCompetitionScore: 0.2233128834355828



Validation scores:
	RegressionAUROC: 0.7014117240905762
	RegressionCompetitionScore: 0.29662576687116565



Validation scores:
	RegressionAUROC: 0.7049970626831055
	RegressionCompetitionScore: 0.24539877300613497



Validation scores:
	RegressionAUROC: 0.7096993923187256
	RegressionCompetitionScore: 0.28343558282208586

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.709868848323822
	RegressionCompetitionScore: 0.294478527607362



Validation scores:
	RegressionAUROC: 0.715430736541748
	RegressionCompetitionScore: 0.29049079754601226



Validation scores:
	RegressionAUROC: 0.714199423789978
	RegressionCompetitionScore: 0.2776073619631902



Validation scores:
	RegressionAUROC: 0.7162420749664307
	RegressionCompetitionScore: 0.2723926380368098

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7139840722084045
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7249035835266113
	RegressionCompetitionScore: 0.28282208588957053



Validation scores:
	RegressionAUROC: 0.7234967350959778
	RegressionCompetitionScore: 0.30460122699386505



Validation scores:
	RegressionAUROC: 0.7256895303726196
	RegressionCompetitionScore: 0.31717791411042945



Validation scores:
	RegressionAUROC: 0.7268905639648438
	RegressionCompetitionScore: 0.3159509202453988



Validation scores:
	RegressionAUROC: 0.7305940985679626
	RegressionCompetitionScore: 0.30736196319018405



Validation scores:
	RegressionAUROC: 0.7373098731040955
	RegressionCompetitionScore: 0.3300613496932515

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7337556481361389
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7350298166275024
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7362892627716064
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7392596006393433
	RegressionCompetitionScore: 0.3696319018404908



Validation scores:
	RegressionAUROC: 0.7411433458328247
	RegressionCompetitionScore: 0.3745398773006135



Validation scores:
	RegressionAUROC: 0.7334109544754028
	RegressionCompetitionScore: 0.34570552147239264



Validation scores:
	RegressionAUROC: 0.7360293865203857
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.180. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3300613496932515
     Test RegressionAUROC            0.7373098731040955
Test RegressionCompetitionScore      0.3300613496932515
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 18:45:31,934][0m Trial 113 finished with value: 0.3300613496932515 and parameters: {'lr': 0.00011336216711034172, 'dropout': 0.4689741396500178, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 64, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00025796190131738766, 'dropout': 0.4169810099060715, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 127, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 575 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
575 K     Trainable params
0         Non-trainable params
575 K     Total params
2.301     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5674363374710083
	RegressionCompetitionScore: 0.2098159509202454

Metric val_loss improved. New best score: 0.454


Validation scores:
	RegressionAUROC: 0.5061303377151489
	RegressionCompetitionScore: 0.09693251533742331

Metric val_loss improved by 0.239 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5329538583755493
	RegressionCompetitionScore: 0.10030674846625767

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6352909803390503
	RegressionCompetitionScore: 0.25153374233128833



Validation scores:
	RegressionAUROC: 0.4855019748210907
	RegressionCompetitionScore: 0.10398773006134969



Validation scores:
	RegressionAUROC: 0.5327719449996948
	RegressionCompetitionScore: 0.10828220858895705



Validation scores:
	RegressionAUROC: 0.4952363669872284
	RegressionCompetitionScore: 0.10950920245398774



Validation scores:
	RegressionAUROC: 0.5440777540206909
	RegressionCompetitionScore: 0.11441717791411044



Validation scores:
	RegressionAUROC: 0.5482908487319946
	RegressionCompetitionScore: 0.11687116564417178



Validation scores:
	RegressionAUROC: 0.6510033011436462
	RegressionCompetitionScore: 0.11840490797546012

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10030674846625767
     Test RegressionAUROC            0.5329538583755493
Test RegressionCompetitionScore      0.10030674846625767
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 18:52:01,101][0m Trial 114 finished with value: 0.10030674846625767 and parameters: {'lr': 0.00025796190131738766, 'dropout': 0.4169810099060715, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 127, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0005282067571878013, 'dropout': 0.4885967296325371, 'd_model_multiplier': 4, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 200, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 630 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
630 K     Trainable params
0         Non-trainable params
630 K     Total params
2.524     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7053139805793762
	RegressionCompetitionScore: 0.4782608695652174



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.663


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6110807061195374
	RegressionCompetitionScore: 0.2763803680981595

Metric val_loss improved by 0.330 >= min_delta = 0.0. New best score: 0.334


Validation scores:
	RegressionAUROC: 0.6184056401252747
	RegressionCompetitionScore: 0.2846625766871166

Metric val_loss improved by 0.101 >= min_delta = 0.0. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.6146519184112549
	RegressionCompetitionScore: 0.2659509202453988

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5952553153038025
	RegressionCompetitionScore: 0.2273006134969325



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6229921579360962
	RegressionCompetitionScore: 0.27300613496932513



Validation scores:
	RegressionAUROC: 0.38802871108055115
	RegressionCompetitionScore: 0.1067484662576687



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5989493727684021
	RegressionCompetitionScore: 0.22269938650306748



Validation scores:
	RegressionAUROC: 0.6127208471298218
	RegressionCompetitionScore: 0.26380368098159507

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.214. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2659509202453988
     Test RegressionAUROC            0.6146519184112549
Test RegressionCompetitionScore      0.2659509202453988
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 18:59:46,717][0m Trial 115 finished with value: 0.2659509202453988 and parameters: {'lr': 0.0005282067571878013, 'dropout': 0.4885967296325371, 'd_model_multiplier': 4, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 200, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00013201657742297152, 'dropout': 0.44797097191790053, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 173, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 624 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
596 K     Trainable params
28.8 K    Non-trainable params
624 K     Total params
2.500     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5945029854774475
	RegressionCompetitionScore: 0.24478527607361963

Metric val_loss improved. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.6269457340240479
	RegressionCompetitionScore: 0.25674846625766873



Validation scores:
	RegressionAUROC: 0.6444061994552612
	RegressionCompetitionScore: 0.24723926380368097

Metric val_loss improved by 0.049 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6651699542999268
	RegressionCompetitionScore: 0.18312883435582822



Validation scores:
	RegressionAUROC: 0.6836068034172058
	RegressionCompetitionScore: 0.2687116564417178



Validation scores:
	RegressionAUROC: 0.706476092338562
	RegressionCompetitionScore: 0.2668711656441718

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7255865335464478
	RegressionCompetitionScore: 0.2766871165644172

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7283008694648743
	RegressionCompetitionScore: 0.3211656441717791

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7195504307746887
	RegressionCompetitionScore: 0.3128834355828221



Validation scores:
	RegressionAUROC: 0.7277553081512451
	RegressionCompetitionScore: 0.3104294478527607



Validation scores:
	RegressionAUROC: 0.700705885887146
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7182738780975342
	RegressionCompetitionScore: 0.295398773006135



Validation scores:
	RegressionAUROC: 0.7274838089942932
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.719680666923523
	RegressionCompetitionScore: 0.29754601226993865



Validation scores:
	RegressionAUROC: 0.7307048439979553
	RegressionCompetitionScore: 0.3196319018404908

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3211656441717791
     Test RegressionAUROC            0.7283008694648743
Test RegressionCompetitionScore      0.3211656441717791
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 19:08:57,874][0m Trial 116 finished with value: 0.3211656441717791 and parameters: {'lr': 0.00013201657742297152, 'dropout': 0.44797097191790053, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 173, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00021814025088766546, 'dropout': 0.49282552490786985, 'd_model_multiplier': 4, 'num_layers': 1, 'n_heads': 16, 'dim_feedforward': 264, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 126 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
126 K     Trainable params
0         Non-trainable params
126 K     Total params
0.504     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6286977529525757
	RegressionCompetitionScore: 0.20521472392638038

Metric val_loss improved. New best score: 0.337


Validation scores:
	RegressionAUROC: 0.6618340015411377
	RegressionCompetitionScore: 0.16840490797546012



Validation scores:
	RegressionAUROC: 0.677053689956665
	RegressionCompetitionScore: 0.2754601226993865



Validation scores:
	RegressionAUROC: 0.6959401369094849
	RegressionCompetitionScore: 0.3294478527607362

Metric val_loss improved by 0.145 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7065072059631348
	RegressionCompetitionScore: 0.34386503067484664



Validation scores:
	RegressionAUROC: 0.7265826463699341
	RegressionCompetitionScore: 0.36165644171779143



Validation scores:
	RegressionAUROC: 0.7269799709320068
	RegressionCompetitionScore: 0.3407975460122699



Validation scores:
	RegressionAUROC: 0.7041414380073547
	RegressionCompetitionScore: 0.3294478527607362



Validation scores:
	RegressionAUROC: 0.6864839792251587
	RegressionCompetitionScore: 0.36012269938650304



Validation scores:
	RegressionAUROC: 0.7290184497833252
	RegressionCompetitionScore: 0.38926380368098157



Validation scores:
	RegressionAUROC: 0.7407841682434082
	RegressionCompetitionScore: 0.36533742331288344

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.191. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3294478527607362
     Test RegressionAUROC            0.6959401369094849
Test RegressionCompetitionScore      0.3294478527607362
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 19:13:36,233][0m Trial 117 finished with value: 0.3294478527607362 and parameters: {'lr': 0.00021814025088766546, 'dropout': 0.49282552490786985, 'd_model_multiplier': 4, 'num_layers': 1, 'n_heads': 16, 'dim_feedforward': 264, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 5.302163469069229e-05, 'dropout': 0.50376794304417, 'd_model_multiplier': 64, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 224, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 61.6 M
1 | loss_fn | MSELoss | 0     
------------------------------------
61.6 M    Trainable params
0         Non-trainable params
61.6 M    Total params
246.279   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3285024166107178
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.165


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.536 >= min_delta = 0.0. New best score: 0.630


Validation scores:
	RegressionAUROC: 0.5947431325912476
	RegressionCompetitionScore: 0.2233128834355828

Metric val_loss improved by 0.322 >= min_delta = 0.0. New best score: 0.307


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6384075880050659
	RegressionCompetitionScore: 0.22423312883435584

Metric val_loss improved by 0.099 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6100010871887207
	RegressionCompetitionScore: 0.1705521472392638



Validation scores:
	RegressionAUROC: 0.44125092029571533
	RegressionCompetitionScore: 0.11134969325153374



Validation scores:
	RegressionAUROC: 0.6199932098388672
	RegressionCompetitionScore: 0.2763803680981595



Validation scores:
	RegressionAUROC: 0.6229797601699829
	RegressionCompetitionScore: 0.27975460122699386



Validation scores:
	RegressionAUROC: 0.6270015239715576
	RegressionCompetitionScore: 0.28190184049079753



Validation scores:
	RegressionAUROC: 0.6296965479850769
	RegressionCompetitionScore: 0.2705521472392638



Validation scores:
	RegressionAUROC: 0.6346896886825562
	RegressionCompetitionScore: 0.2733128834355828

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.22423312883435584
     Test RegressionAUROC            0.6384075880050659
Test RegressionCompetitionScore      0.22423312883435584
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 19:35:33,574][0m Trial 118 finished with value: 0.22423312883435584 and parameters: {'lr': 5.302163469069229e-05, 'dropout': 0.50376794304417, 'd_model_multiplier': 64, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 224, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 9.804772556181818e-05, 'dropout': 0.4757531035781171, 'd_model_multiplier': 1, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 140, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 117 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
117 K     Trainable params
0         Non-trainable params
117 K     Total params
0.471     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.348


Validation scores:
	RegressionAUROC: 0.4465070962905884
	RegressionCompetitionScore: 0.08312883435582823

Metric val_loss improved by 0.946 >= min_delta = 0.0. New best score: 0.402


Validation scores:
	RegressionAUROC: 0.4871295094490051
	RegressionCompetitionScore: 0.11380368098159509

Metric val_loss improved by 0.168 >= min_delta = 0.0. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.4539910554885864
	RegressionCompetitionScore: 0.09355828220858896



Validation scores:
	RegressionAUROC: 0.3712714910507202
	RegressionCompetitionScore: 0.04539877300613497



Validation scores:
	RegressionAUROC: 0.38776659965515137
	RegressionCompetitionScore: 0.09355828220858896



Validation scores:
	RegressionAUROC: 0.3965914249420166
	RegressionCompetitionScore: 0.10061349693251534



Validation scores:
	RegressionAUROC: 0.3932812809944153
	RegressionCompetitionScore: 0.10153374233128834

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.3852497935295105
	RegressionCompetitionScore: 0.10184049079754601

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.38350021839141846
	RegressionCompetitionScore: 0.1049079754601227

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.530928373336792
	RegressionCompetitionScore: 0.10644171779141104



Validation scores:
	RegressionAUROC: 0.5593254566192627
	RegressionCompetitionScore: 0.15276073619631902



Validation scores:
	RegressionAUROC: 0.5542863607406616
	RegressionCompetitionScore: 0.14079754601226993



Validation scores:
	RegressionAUROC: 0.5463155508041382
	RegressionCompetitionScore: 0.11871165644171779



Validation scores:
	RegressionAUROC: 0.5434997081756592
	RegressionCompetitionScore: 0.11196319018404909

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5397063493728638
	RegressionCompetitionScore: 0.09386503067484663



Validation scores:
	RegressionAUROC: 0.5391018390655518
	RegressionCompetitionScore: 0.09815950920245399

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5395964980125427
	RegressionCompetitionScore: 0.10030674846625767



Validation scores:
	RegressionAUROC: 0.5436509847640991
	RegressionCompetitionScore: 0.09907975460122699

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.5493216514587402
	RegressionCompetitionScore: 0.10030674846625767



Validation scores:
	RegressionAUROC: 0.5600109100341797
	RegressionCompetitionScore: 0.100920245398773



Validation scores:
	RegressionAUROC: 0.571729302406311
	RegressionCompetitionScore: 0.10214723926380367

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.5782192945480347
	RegressionCompetitionScore: 0.10214723926380367



Validation scores:
	RegressionAUROC: 0.5903927087783813
	RegressionCompetitionScore: 0.1098159509202454



Validation scores:
	RegressionAUROC: 0.5954015254974365
	RegressionCompetitionScore: 0.11012269938650307



Validation scores:
	RegressionAUROC: 0.6037507057189941
	RegressionCompetitionScore: 0.11840490797546012



Validation scores:
	RegressionAUROC: 0.6133131384849548
	RegressionCompetitionScore: 0.12423312883435583



Validation scores:
	RegressionAUROC: 0.6186773777008057
	RegressionCompetitionScore: 0.12699386503067484



Validation scores:
	RegressionAUROC: 0.6293947696685791
	RegressionCompetitionScore: 0.13803680981595093

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.206. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10214723926380367
     Test RegressionAUROC             0.571729302406311
Test RegressionCompetitionScore      0.10214723926380367
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 19:52:07,096][0m Trial 119 finished with value: 0.10214723926380367 and parameters: {'lr': 9.804772556181818e-05, 'dropout': 0.4757531035781171, 'd_model_multiplier': 1, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 140, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00034790097234435456, 'dropout': 0.46319747098183073, 'd_model_multiplier': 4, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 118, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 461 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
461 K     Trainable params
0         Non-trainable params
461 K     Total params
1.845     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6086956262588501
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5010173916816711
	RegressionCompetitionScore: 0.008282208588957056

Metric val_loss improved. New best score: 1.695


Validation scores:
	RegressionAUROC: 0.601396918296814
	RegressionCompetitionScore: 0.09539877300613497

Metric val_loss improved by 1.427 >= min_delta = 0.0. New best score: 0.268


Validation scores:
	RegressionAUROC: 0.5665732026100159
	RegressionCompetitionScore: 0.16503067484662576



Validation scores:
	RegressionAUROC: 0.6445841789245605
	RegressionCompetitionScore: 0.25061349693251533

Metric val_loss improved by 0.040 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.6633251905441284
	RegressionCompetitionScore: 0.2322085889570552

Metric val_loss improved by 0.033 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6641738414764404
	RegressionCompetitionScore: 0.10184049079754601



Validation scores:
	RegressionAUROC: 0.7086922526359558
	RegressionCompetitionScore: 0.29662576687116565

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.6828358173370361
	RegressionCompetitionScore: 0.2911042944785276



Validation scores:
	RegressionAUROC: 0.6604267358779907
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6614241600036621
	RegressionCompetitionScore: 0.31809815950920245



Validation scores:
	RegressionAUROC: 0.6746730804443359
	RegressionCompetitionScore: 0.3389570552147239



Validation scores:
	RegressionAUROC: 0.7165553569793701
	RegressionCompetitionScore: 0.3423312883435583



Validation scores:
	RegressionAUROC: 0.7176464796066284
	RegressionCompetitionScore: 0.33773006134969324



Validation scores:
	RegressionAUROC: 0.7277836799621582
	RegressionCompetitionScore: 0.33496932515337424

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7194454073905945
	RegressionCompetitionScore: 0.34478527607361964



Validation scores:
	RegressionAUROC: 0.7212806940078735
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7397072315216064
	RegressionCompetitionScore: 0.3558282208588957



Validation scores:
	RegressionAUROC: 0.7337642312049866
	RegressionCompetitionScore: 0.3717791411042945



Validation scores:
	RegressionAUROC: 0.7370513677597046
	RegressionCompetitionScore: 0.3880368098159509



Validation scores:
	RegressionAUROC: 0.7406721115112305
	RegressionCompetitionScore: 0.38742331288343557



Validation scores:
	RegressionAUROC: 0.7400263547897339
	RegressionCompetitionScore: 0.403680981595092

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7504855394363403
	RegressionCompetitionScore: 0.39263803680981596



Validation scores:
	RegressionAUROC: 0.7430194616317749
	RegressionCompetitionScore: 0.38190184049079756



Validation scores:
	RegressionAUROC: 0.746502697467804
	RegressionCompetitionScore: 0.4021472392638037



Validation scores:
	RegressionAUROC: 0.7488189935684204
	RegressionCompetitionScore: 0.38773006134969323



Validation scores:
	RegressionAUROC: 0.7331563234329224
	RegressionCompetitionScore: 0.3257668711656442



Validation scores:
	RegressionAUROC: 0.7406483888626099
	RegressionCompetitionScore: 0.3834355828220859



Validation scores:
	RegressionAUROC: 0.7359834909439087
	RegressionCompetitionScore: 0.36319018404907977

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.172. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.403680981595092
     Test RegressionAUROC            0.7400263547897339
Test RegressionCompetitionScore       0.403680981595092
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 20:07:41,592][0m Trial 120 finished with value: 0.403680981595092 and parameters: {'lr': 0.00034790097234435456, 'dropout': 0.46319747098183073, 'd_model_multiplier': 4, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 118, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0006621919483463429, 'dropout': 0.4308809735548513, 'd_model_multiplier': 4, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 119, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 462 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
462 K     Trainable params
0         Non-trainable params
462 K     Total params
1.851     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7053139805793762
	RegressionCompetitionScore: 0.43478260869565216



Validation scores:
	RegressionAUROC: 0.4218883514404297
	RegressionCompetitionScore: 0.10797546012269939

Metric val_loss improved. New best score: 0.379


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.41533195972442627
	RegressionCompetitionScore: 0.04570552147239264

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.360


Validation scores:
	RegressionAUROC: 0.5076159238815308
	RegressionCompetitionScore: 0.04263803680981595

Metric val_loss improved by 0.065 >= min_delta = 0.0. New best score: 0.295


Validation scores:
	RegressionAUROC: 0.48887521028518677
	RegressionCompetitionScore: 0.04631901840490798



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4254437983036041
	RegressionCompetitionScore: 0.08895705521472393

Metric val_loss improved by 0.076 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.594078540802002
	RegressionCompetitionScore: 0.12147239263803682



Validation scores:
	RegressionAUROC: 0.5499145984649658
	RegressionCompetitionScore: 0.10736196319018405



Validation scores:
	RegressionAUROC: 0.6574336886405945
	RegressionCompetitionScore: 0.24355828220858897



Validation scores:
	RegressionAUROC: 0.6761764287948608
	RegressionCompetitionScore: 0.26533742331288346

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.219. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.08895705521472393
     Test RegressionAUROC            0.4254437983036041
Test RegressionCompetitionScore      0.08895705521472393
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 20:17:17,336][0m Trial 121 finished with value: 0.08895705521472393 and parameters: {'lr': 0.0006621919483463429, 'dropout': 0.4308809735548513, 'd_model_multiplier': 4, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 119, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0003549634748331364, 'dropout': 0.4572383726487009, 'd_model_multiplier': 4, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 95, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 454 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
454 K     Trainable params
0         Non-trainable params
454 K     Total params
1.819     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.487922728061676
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.4281495213508606
	RegressionCompetitionScore: 0.07760736196319018

Metric val_loss improved. New best score: 0.419


Validation scores:
	RegressionAUROC: 0.5335001945495605
	RegressionCompetitionScore: 0.09877300613496932

Metric val_loss improved by 0.210 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5892393589019775
	RegressionCompetitionScore: 0.248159509202454

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.584571361541748
	RegressionCompetitionScore: 0.18282208588957055



Validation scores:
	RegressionAUROC: 0.6656672954559326
	RegressionCompetitionScore: 0.22484662576687117



Validation scores:
	RegressionAUROC: 0.6635743975639343
	RegressionCompetitionScore: 0.3088957055214724



Validation scores:
	RegressionAUROC: 0.6964226961135864
	RegressionCompetitionScore: 0.3079754601226994



Validation scores:
	RegressionAUROC: 0.6967918276786804
	RegressionCompetitionScore: 0.3291411042944785



Validation scores:
	RegressionAUROC: 0.703402042388916
	RegressionCompetitionScore: 0.3266871165644172



Validation scores:
	RegressionAUROC: 0.6883406639099121
	RegressionCompetitionScore: 0.25674846625766873

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.248159509202454
     Test RegressionAUROC            0.5892393589019775
Test RegressionCompetitionScore       0.248159509202454
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 20:23:21,249][0m Trial 122 finished with value: 0.248159509202454 and parameters: {'lr': 0.0003549634748331364, 'dropout': 0.4572383726487009, 'd_model_multiplier': 4, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 95, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0008225327522602781, 'dropout': 0.4660070813451779, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 160, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 601 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
601 K     Trainable params
0         Non-trainable params
601 K     Total params
2.406     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.54347825050354
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.822


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.167 >= min_delta = 0.0. New best score: 0.655


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.630


Validation scores:
	RegressionAUROC: 0.5933334827423096
	RegressionCompetitionScore: 0.07269938650306748

Metric val_loss improved by 0.392 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4222071170806885
	RegressionCompetitionScore: 0.0696319018404908

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.223


Validation scores:
	RegressionAUROC: 0.41239452362060547
	RegressionCompetitionScore: 0.05644171779141104



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5869954824447632
	RegressionCompetitionScore: 0.2588957055214724



Validation scores:
	RegressionAUROC: 0.5581687688827515
	RegressionCompetitionScore: 0.11871165644171779



Validation scores:
	RegressionAUROC: 0.5522743463516235
	RegressionCompetitionScore: 0.08006134969325153



Validation scores:
	RegressionAUROC: 0.4412546157836914
	RegressionCompetitionScore: 0.09171779141104294

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.223. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.0696319018404908
     Test RegressionAUROC            0.4222071170806885
Test RegressionCompetitionScore      0.0696319018404908
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 20:33:38,821][0m Trial 123 finished with value: 0.0696319018404908 and parameters: {'lr': 0.0008225327522602781, 'dropout': 0.4660070813451779, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 160, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00018736155908716094, 'dropout': 0.5566973491211293, 'd_model_multiplier': 4, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 613, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.2 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.2 M     Trainable params
0         Non-trainable params
1.2 M     Total params
4.910     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5752936601638794
	RegressionCompetitionScore: 0.13558282208588956

Metric val_loss improved. New best score: 0.260


Validation scores:
	RegressionAUROC: 0.39229485392570496
	RegressionCompetitionScore: 0.0736196319018405

Metric val_loss improved by 0.047 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5235977172851562
	RegressionCompetitionScore: 0.1205521472392638



Validation scores:
	RegressionAUROC: 0.43852129578590393
	RegressionCompetitionScore: 0.05828220858895705



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.561323344707489
	RegressionCompetitionScore: 0.07607361963190185



Validation scores:
	RegressionAUROC: 0.5545040369033813
	RegressionCompetitionScore: 0.09969325153374232



Validation scores:
	RegressionAUROC: 0.5674933791160583
	RegressionCompetitionScore: 0.12576687116564417

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.213. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.0736196319018405
     Test RegressionAUROC            0.39229485392570496
Test RegressionCompetitionScore      0.0736196319018405
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 20:40:06,406][0m Trial 124 finished with value: 0.0736196319018405 and parameters: {'lr': 0.00018736155908716094, 'dropout': 0.5566973491211293, 'd_model_multiplier': 4, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 613, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0002957924037814329, 'dropout': 0.5261578536780993, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 88, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 499 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
470 K     Trainable params
28.8 K    Non-trainable params
499 K     Total params
1.999     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5846363306045532
	RegressionCompetitionScore: 0.08558282208588958

Metric val_loss improved. New best score: 0.253


Validation scores:
	RegressionAUROC: 0.6541818976402283
	RegressionCompetitionScore: 0.24785276073619633

Metric val_loss improved by 0.046 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.630152702331543
	RegressionCompetitionScore: 0.24233128834355827



Validation scores:
	RegressionAUROC: 0.6634432673454285
	RegressionCompetitionScore: 0.23558282208588957



Validation scores:
	RegressionAUROC: 0.6820998191833496
	RegressionCompetitionScore: 0.294478527607362



Validation scores:
	RegressionAUROC: 0.6652998328208923
	RegressionCompetitionScore: 0.2282208588957055



Validation scores:
	RegressionAUROC: 0.7077950835227966
	RegressionCompetitionScore: 0.24662576687116564



Validation scores:
	RegressionAUROC: 0.7137622833251953
	RegressionCompetitionScore: 0.29478527607361965



Validation scores:
	RegressionAUROC: 0.722931981086731
	RegressionCompetitionScore: 0.35644171779141104

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7300475239753723
	RegressionCompetitionScore: 0.35828220858895704



Validation scores:
	RegressionAUROC: 0.7474277019500732
	RegressionCompetitionScore: 0.3773006134969325



Validation scores:
	RegressionAUROC: 0.7374039888381958
	RegressionCompetitionScore: 0.35920245398773004

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7382358908653259
	RegressionCompetitionScore: 0.3549079754601227



Validation scores:
	RegressionAUROC: 0.7333794236183167
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7350197434425354
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.738381564617157
	RegressionCompetitionScore: 0.35153374233128837

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7213768362998962
	RegressionCompetitionScore: 0.3095092024539877



Validation scores:
	RegressionAUROC: 0.7340542078018188
	RegressionCompetitionScore: 0.35368098159509204



Validation scores:
	RegressionAUROC: 0.7422306537628174
	RegressionCompetitionScore: 0.37331288343558283



Validation scores:
	RegressionAUROC: 0.7326740026473999
	RegressionCompetitionScore: 0.3585889570552147



Validation scores:
	RegressionAUROC: 0.7381173372268677
	RegressionCompetitionScore: 0.3782208588957055

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7471033334732056
	RegressionCompetitionScore: 0.36319018404907977



Validation scores:
	RegressionAUROC: 0.7193537354469299
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7406477928161621
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7519723773002625
	RegressionCompetitionScore: 0.402760736196319



Validation scores:
	RegressionAUROC: 0.7461891174316406
	RegressionCompetitionScore: 0.34478527607361964



Validation scores:
	RegressionAUROC: 0.74216628074646
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7477788329124451
	RegressionCompetitionScore: 0.39263803680981596

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.744854748249054
	RegressionCompetitionScore: 0.39723926380368096



Validation scores:
	RegressionAUROC: 0.7486613392829895
	RegressionCompetitionScore: 0.39355828220858896



Validation scores:
	RegressionAUROC: 0.7504315972328186
	RegressionCompetitionScore: 0.37791411042944784



Validation scores:
	RegressionAUROC: 0.7486567497253418
	RegressionCompetitionScore: 0.37791411042944784



Validation scores:
	RegressionAUROC: 0.7265282869338989
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.750493586063385
	RegressionCompetitionScore: 0.3861963190184049



Validation scores:
	RegressionAUROC: 0.73687344789505
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.39263803680981596
     Test RegressionAUROC            0.7477788329124451
Test RegressionCompetitionScore      0.39263803680981596
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 21:01:24,792][0m Trial 125 finished with value: 0.39263803680981596 and parameters: {'lr': 0.0002957924037814329, 'dropout': 0.5261578536780993, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 88, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00032651057204371184, 'dropout': 0.5147193320690691, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 80, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 484 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
455 K     Trainable params
28.8 K    Non-trainable params
484 K     Total params
1.937     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.628


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 1.194 >= min_delta = 0.0. New best score: 0.434


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6094509363174438
	RegressionCompetitionScore: 0.10061349693251534

Metric val_loss improved by 0.122 >= min_delta = 0.0. New best score: 0.312


Validation scores:
	RegressionAUROC: 0.6399202346801758
	RegressionCompetitionScore: 0.09785276073619632



Validation scores:
	RegressionAUROC: 0.614213228225708
	RegressionCompetitionScore: 0.1067484662576687

Metric val_loss improved by 0.092 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.6876705884933472
	RegressionCompetitionScore: 0.1549079754601227



Validation scores:
	RegressionAUROC: 0.6871929168701172
	RegressionCompetitionScore: 0.149079754601227



Validation scores:
	RegressionAUROC: 0.6843985319137573
	RegressionCompetitionScore: 0.28343558282208586

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6759523153305054
	RegressionCompetitionScore: 0.3487730061349693



Validation scores:
	RegressionAUROC: 0.7229308485984802
	RegressionCompetitionScore: 0.34478527607361964



Validation scores:
	RegressionAUROC: 0.7310600280761719
	RegressionCompetitionScore: 0.34294478527607364



Validation scores:
	RegressionAUROC: 0.728904664516449
	RegressionCompetitionScore: 0.31993865030674845

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7333014011383057
	RegressionCompetitionScore: 0.3579754601226994

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7378418445587158
	RegressionCompetitionScore: 0.36134969325153377



Validation scores:
	RegressionAUROC: 0.7429227232933044
	RegressionCompetitionScore: 0.35429447852760737



Validation scores:
	RegressionAUROC: 0.7529764175415039
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7446083426475525
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7439067959785461
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7569786310195923
	RegressionCompetitionScore: 0.3993865030674847



Validation scores:
	RegressionAUROC: 0.7526336908340454
	RegressionCompetitionScore: 0.37607361963190183

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.172. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3579754601226994
     Test RegressionAUROC            0.7333014011383057
Test RegressionCompetitionScore      0.3579754601226994
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 21:14:26,675][0m Trial 126 finished with value: 0.3579754601226994 and parameters: {'lr': 0.00032651057204371184, 'dropout': 0.5147193320690691, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 80, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00044895710253657075, 'dropout': 0.5019274165965606, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 140, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 600 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
571 K     Trainable params
28.8 K    Non-trainable params
600 K     Total params
2.401     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6425120830535889
	RegressionCompetitionScore: 0.391304347826087



Validation scores:
	RegressionAUROC: 0.5828676223754883
	RegressionCompetitionScore: 0.25337423312883434

Metric val_loss improved. New best score: 0.290


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5942227840423584
	RegressionCompetitionScore: 0.21134969325153374



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6466524004936218
	RegressionCompetitionScore: 0.19631901840490798

Metric val_loss improved by 0.081 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6488128900527954
	RegressionCompetitionScore: 0.2236196319018405



Validation scores:
	RegressionAUROC: 0.6461501121520996
	RegressionCompetitionScore: 0.22760736196319017



Validation scores:
	RegressionAUROC: 0.6166665554046631
	RegressionCompetitionScore: 0.0785276073619632



Validation scores:
	RegressionAUROC: 0.6242949962615967
	RegressionCompetitionScore: 0.07085889570552147



Validation scores:
	RegressionAUROC: 0.6416621804237366
	RegressionCompetitionScore: 0.09478527607361963



Validation scores:
	RegressionAUROC: 0.6001364588737488
	RegressionCompetitionScore: 0.06901840490797546



Validation scores:
	RegressionAUROC: 0.5818838477134705
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.19631901840490798
     Test RegressionAUROC            0.6466524004936218
Test RegressionCompetitionScore      0.19631901840490798
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 21:22:04,476][0m Trial 127 finished with value: 0.19631901840490798 and parameters: {'lr': 0.00044895710253657075, 'dropout': 0.5019274165965606, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 140, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00025654879453791403, 'dropout': 0.5288071929265212, 'd_model_multiplier': 4, 'num_layers': 2, 'n_heads': 16, 'dim_feedforward': 110, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 137 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
108 K     Trainable params
28.8 K    Non-trainable params
137 K     Total params
0.549     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6271058320999146
	RegressionCompetitionScore: 0.09570552147239264

Metric val_loss improved. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.6824427843093872
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6456721425056458
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6334629654884338
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7051390409469604
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.5380377173423767
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6600087285041809
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7090615034103394
	RegressionCompetitionScore: 0.21595092024539878

Metric val_loss improved by 0.049 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.7188697457313538
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.730765163898468
	RegressionCompetitionScore: 0.36779141104294477



Validation scores:
	RegressionAUROC: 0.7208479642868042
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6286224126815796
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7342565059661865
	RegressionCompetitionScore: 0.37024539877300616

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7339888215065002
	RegressionCompetitionScore: 0.36533742331288344



Validation scores:
	RegressionAUROC: 0.7299765944480896
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7298458218574524
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6795218586921692
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7298125624656677
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7244733572006226
	RegressionCompetitionScore: 0.34386503067484664



Validation scores:
	RegressionAUROC: 0.7248756885528564
	RegressionCompetitionScore: 0.3773006134969325

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.5735482573509216
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6994423866271973
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6904817819595337
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7280285954475403
	RegressionCompetitionScore: 0.36871165644171777



Validation scores:
	RegressionAUROC: 0.725883960723877
	RegressionCompetitionScore: 0.35920245398773004



Validation scores:
	RegressionAUROC: 0.7404597401618958
	RegressionCompetitionScore: 0.36779141104294477

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7315840721130371
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7404283285140991
	RegressionCompetitionScore: 0.3708588957055215



Validation scores:
	RegressionAUROC: 0.7373284697532654
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7430571913719177
	RegressionCompetitionScore: 0.36993865030674844



Validation scores:
	RegressionAUROC: 0.7475234270095825
	RegressionCompetitionScore: 0.36226993865030677



Validation scores:
	RegressionAUROC: 0.7380344271659851
	RegressionCompetitionScore: 0.3334355828220859



Validation scores:
	RegressionAUROC: 0.752327024936676
	RegressionCompetitionScore: 0.3674846625766871

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.171. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36779141104294477
     Test RegressionAUROC            0.7404597401618958
Test RegressionCompetitionScore      0.36779141104294477
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 21:35:15,355][0m Trial 128 finished with value: 0.36779141104294477 and parameters: {'lr': 0.00025654879453791403, 'dropout': 0.5288071929265212, 'd_model_multiplier': 4, 'num_layers': 2, 'n_heads': 16, 'dim_feedforward': 110, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00041225371083705844, 'dropout': 0.5159316308048114, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 194, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 704 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
676 K     Trainable params
28.8 K    Non-trainable params
704 K     Total params
2.819     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3309178650379181
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.342


Validation scores:
	RegressionAUROC: 0.5847024917602539
	RegressionCompetitionScore: 0.10644171779141104

Metric val_loss improved by 1.134 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6380825042724609
	RegressionCompetitionScore: 0.2579754601226994



Validation scores:
	RegressionAUROC: 0.6402536034584045
	RegressionCompetitionScore: 0.25858895705521473



Validation scores:
	RegressionAUROC: 0.6341242790222168
	RegressionCompetitionScore: 0.25858895705521473

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6400445103645325
	RegressionCompetitionScore: 0.253680981595092



Validation scores:
	RegressionAUROC: 0.6400550007820129
	RegressionCompetitionScore: 0.24785276073619633



Validation scores:
	RegressionAUROC: 0.6312375068664551
	RegressionCompetitionScore: 0.2705521472392638



Validation scores:
	RegressionAUROC: 0.6441799998283386
	RegressionCompetitionScore: 0.254601226993865



Validation scores:
	RegressionAUROC: 0.6278552412986755
	RegressionCompetitionScore: 0.27269938650306746



Validation scores:
	RegressionAUROC: 0.6315730810165405
	RegressionCompetitionScore: 0.27883435582822086

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6812174320220947
	RegressionCompetitionScore: 0.2889570552147239



Validation scores:
	RegressionAUROC: 0.6911564469337463
	RegressionCompetitionScore: 0.3202453987730061

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6942020654678345
	RegressionCompetitionScore: 0.3107361963190184



Validation scores:
	RegressionAUROC: 0.7203367352485657
	RegressionCompetitionScore: 0.36226993865030677



Validation scores:
	RegressionAUROC: 0.719276487827301
	RegressionCompetitionScore: 0.35613496932515337



Validation scores:
	RegressionAUROC: 0.7138988375663757
	RegressionCompetitionScore: 0.3656441717791411



Validation scores:
	RegressionAUROC: 0.7122567296028137
	RegressionCompetitionScore: 0.33588957055214724



Validation scores:
	RegressionAUROC: 0.7335591316223145
	RegressionCompetitionScore: 0.3708588957055215



Validation scores:
	RegressionAUROC: 0.7388315200805664
	RegressionCompetitionScore: 0.3978527607361963

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.193. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3202453987730061
     Test RegressionAUROC            0.6911564469337463
Test RegressionCompetitionScore      0.3202453987730061
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 21:47:50,776][0m Trial 129 finished with value: 0.3202453987730061 and parameters: {'lr': 0.00041225371083705844, 'dropout': 0.5159316308048114, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 194, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00013977464857717326, 'dropout': 0.4882018374310711, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 77, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 478 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
449 K     Trainable params
28.8 K    Non-trainable params
478 K     Total params
1.914     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.579594075679779
	RegressionCompetitionScore: 0.27177914110429446

Metric val_loss improved. New best score: 0.248


Validation scores:
	RegressionAUROC: 0.5689485669136047
	RegressionCompetitionScore: 0.14938650306748466



Validation scores:
	RegressionAUROC: 0.5882748365402222
	RegressionCompetitionScore: 0.17883435582822085



Validation scores:
	RegressionAUROC: 0.6145793199539185
	RegressionCompetitionScore: 0.16809815950920245

Metric val_loss improved by 0.034 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.6489462852478027
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4390462338924408
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6443871259689331
	RegressionCompetitionScore: 0.249079754601227



Validation scores:
	RegressionAUROC: 0.6099271178245544
	RegressionCompetitionScore: 0.250920245398773



Validation scores:
	RegressionAUROC: 0.6676762104034424
	RegressionCompetitionScore: 0.24263803680981594



Validation scores:
	RegressionAUROC: 0.4305446743965149
	RegressionCompetitionScore: 0.11595092024539877



Validation scores:
	RegressionAUROC: 0.5011314153671265
	RegressionCompetitionScore: 0.008895705521472393

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.215. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.16809815950920245
     Test RegressionAUROC            0.6145793199539185
Test RegressionCompetitionScore      0.16809815950920245
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 21:55:13,643][0m Trial 130 finished with value: 0.16809815950920245 and parameters: {'lr': 0.00013977464857717326, 'dropout': 0.4882018374310711, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 77, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 7.244676392483628e-05, 'dropout': 0.5442053225620958, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 8, 'dim_feedforward': 156, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 248 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
248 K     Trainable params
0         Non-trainable params
248 K     Total params
0.996     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3478260934352875
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6075688600540161
	RegressionCompetitionScore: 0.2665644171779141

Metric val_loss improved. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6726670265197754
	RegressionCompetitionScore: 0.2245398773006135

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6716984510421753
	RegressionCompetitionScore: 0.2598159509202454



Validation scores:
	RegressionAUROC: 0.665300190448761
	RegressionCompetitionScore: 0.2058282208588957

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6740169525146484
	RegressionCompetitionScore: 0.27699386503067486

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6868818998336792
	RegressionCompetitionScore: 0.24662576687116564

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6910606622695923
	RegressionCompetitionScore: 0.2588957055214724



Validation scores:
	RegressionAUROC: 0.6945598125457764
	RegressionCompetitionScore: 0.25920245398773006

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7002657651901245
	RegressionCompetitionScore: 0.2880368098159509



Validation scores:
	RegressionAUROC: 0.6970850825309753
	RegressionCompetitionScore: 0.3159509202453988



Validation scores:
	RegressionAUROC: 0.7007650136947632
	RegressionCompetitionScore: 0.2650306748466258



Validation scores:
	RegressionAUROC: 0.6925097703933716
	RegressionCompetitionScore: 0.3122699386503067

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.6906411051750183
	RegressionCompetitionScore: 0.31809815950920245



Validation scores:
	RegressionAUROC: 0.7093871831893921
	RegressionCompetitionScore: 0.2969325153374233



Validation scores:
	RegressionAUROC: 0.7074345946311951
	RegressionCompetitionScore: 0.3168711656441718



Validation scores:
	RegressionAUROC: 0.7155513763427734
	RegressionCompetitionScore: 0.3067484662576687



Validation scores:
	RegressionAUROC: 0.714396595954895
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7167309522628784
	RegressionCompetitionScore: 0.3006134969325153



Validation scores:
	RegressionAUROC: 0.7163107395172119
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.184. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3122699386503067
     Test RegressionAUROC            0.6925097703933716
Test RegressionCompetitionScore      0.3122699386503067
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 22:04:17,567][0m Trial 131 finished with value: 0.3122699386503067 and parameters: {'lr': 7.244676392483628e-05, 'dropout': 0.5442053225620958, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 8, 'dim_feedforward': 156, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0001942320501740418, 'dropout': 0.5608515129674086, 'd_model_multiplier': 32, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 96, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 16.6 M
1 | loss_fn | MSELoss | 0     
------------------------------------
16.6 M    Trainable params
0         Non-trainable params
16.6 M    Total params
66.436    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.24637681245803833
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 22.998


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 13.247 >= min_delta = 0.0. New best score: 9.751


Validation scores:
	RegressionAUROC: 0.6753848195075989
	RegressionCompetitionScore: 0.28773006134969326

Metric val_loss improved by 9.384 >= min_delta = 0.0. New best score: 0.367


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6519256830215454
	RegressionCompetitionScore: 0.2785276073619632

Metric val_loss improved by 0.140 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.6545851826667786
	RegressionCompetitionScore: 0.254601226993865

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6053379774093628
	RegressionCompetitionScore: 0.10521472392638037

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5986428260803223
	RegressionCompetitionScore: 0.21779141104294478



Validation scores:
	RegressionAUROC: 0.6419947743415833
	RegressionCompetitionScore: 0.1392638036809816



Validation scores:
	RegressionAUROC: 0.6502560973167419
	RegressionCompetitionScore: 0.24969325153374233



Validation scores:
	RegressionAUROC: 0.6097904443740845
	RegressionCompetitionScore: 0.09754601226993866



Validation scores:
	RegressionAUROC: 0.5039989948272705
	RegressionCompetitionScore: 0.08282208588957055



Validation scores:
	RegressionAUROC: 0.4716375470161438
	RegressionCompetitionScore: 0.05245398773006135



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10521472392638037
     Test RegressionAUROC            0.6053379774093628
Test RegressionCompetitionScore      0.10521472392638037
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 22:18:35,068][0m Trial 132 finished with value: 0.10521472392638037 and parameters: {'lr': 0.0001942320501740418, 'dropout': 0.5608515129674086, 'd_model_multiplier': 32, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 96, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0002869674336546703, 'dropout': 0.4564651178359957, 'd_model_multiplier': 64, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 581, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 71.1 M
1 | loss_fn | MSELoss | 0     
------------------------------------
71.1 M    Trainable params
0         Non-trainable params
71.1 M    Total params
284.317   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.40000003576278687
	RegressionCompetitionScore: 0.2



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 3.657


Validation scores:
	RegressionAUROC: 0.5095337629318237
	RegressionCompetitionScore: 0.057975460122699385

Metric val_loss improved by 3.191 >= min_delta = 0.0. New best score: 0.466


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.50672447681427
	RegressionCompetitionScore: 0.05030674846625767

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.459


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49714750051498413
	RegressionCompetitionScore: 0.0352760736196319

Metric val_loss improved by 0.175 >= min_delta = 0.0. New best score: 0.284


Validation scores:
	RegressionAUROC: 0.4870767593383789
	RegressionCompetitionScore: 0.049079754601226995



Validation scores:
	RegressionAUROC: 0.5049769282341003
	RegressionCompetitionScore: 0.06932515337423313



Validation scores:
	RegressionAUROC: 0.49736008048057556
	RegressionCompetitionScore: 0.06165644171779141

Metric val_loss improved by 0.035 >= min_delta = 0.0. New best score: 0.249


Validation scores:
	RegressionAUROC: 0.4892253577709198
	RegressionCompetitionScore: 0.06687116564417178



Validation scores:
	RegressionAUROC: 0.4932921826839447
	RegressionCompetitionScore: 0.02607361963190184

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.233


Validation scores:
	RegressionAUROC: 0.5021494030952454
	RegressionCompetitionScore: 0.029447852760736196

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5100842714309692
	RegressionCompetitionScore: 0.0558282208588957



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5127952098846436
	RegressionCompetitionScore: 0.06288343558282208



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4993356466293335
	RegressionCompetitionScore: 0.03343558282208589



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.210. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore          0.029447852760736196
     Test RegressionAUROC            0.5021494030952454
Test RegressionCompetitionScore     0.029447852760736196
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 22:59:57,043][0m Trial 133 finished with value: 0.029447852760736196 and parameters: {'lr': 0.0002869674336546703, 'dropout': 0.4564651178359957, 'd_model_multiplier': 64, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 581, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0001072046396548483, 'dropout': 0.5237714454037501, 'd_model_multiplier': 1, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 131, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 96.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
89.6 K    Trainable params
7.2 K     Non-trainable params
96.8 K    Total params
0.387     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.0625
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5801206231117249
	RegressionCompetitionScore: 0.15153374233128836

Metric val_loss improved. New best score: 0.314


Validation scores:
	RegressionAUROC: 0.64176344871521
	RegressionCompetitionScore: 0.19570552147239265

Metric val_loss improved by 0.103 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6795475482940674
	RegressionCompetitionScore: 0.1960122699386503

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7169485688209534
	RegressionCompetitionScore: 0.2871165644171779

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7371134757995605
	RegressionCompetitionScore: 0.349079754601227



Validation scores:
	RegressionAUROC: 0.7473631501197815
	RegressionCompetitionScore: 0.3383435582822086



Validation scores:
	RegressionAUROC: 0.7475643157958984
	RegressionCompetitionScore: 0.35644171779141104



Validation scores:
	RegressionAUROC: 0.7440270185470581
	RegressionCompetitionScore: 0.35337423312883437



Validation scores:
	RegressionAUROC: 0.7452470660209656
	RegressionCompetitionScore: 0.401840490797546



Validation scores:
	RegressionAUROC: 0.7508754730224609
	RegressionCompetitionScore: 0.3852760736196319



Validation scores:
	RegressionAUROC: 0.7521682977676392
	RegressionCompetitionScore: 0.3745398773006135

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7531008124351501
	RegressionCompetitionScore: 0.3726993865030675



Validation scores:
	RegressionAUROC: 0.7555792927742004
	RegressionCompetitionScore: 0.3978527607361963



Validation scores:
	RegressionAUROC: 0.7423712611198425
	RegressionCompetitionScore: 0.35552147239263804



Validation scores:
	RegressionAUROC: 0.7544394731521606
	RegressionCompetitionScore: 0.3923312883435583

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7445838451385498
	RegressionCompetitionScore: 0.36257668711656443



Validation scores:
	RegressionAUROC: 0.743986964225769
	RegressionCompetitionScore: 0.3861963190184049



Validation scores:
	RegressionAUROC: 0.7482194900512695
	RegressionCompetitionScore: 0.36073619631901843



Validation scores:
	RegressionAUROC: 0.7403842210769653
	RegressionCompetitionScore: 0.3923312883435583



Validation scores:
	RegressionAUROC: 0.7426472902297974
	RegressionCompetitionScore: 0.39570552147239263



Validation scores:
	RegressionAUROC: 0.7433141469955444
	RegressionCompetitionScore: 0.3782208588957055



Validation scores:
	RegressionAUROC: 0.7497283220291138
	RegressionCompetitionScore: 0.38773006134969323

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.169. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3923312883435583
     Test RegressionAUROC            0.7544394731521606
Test RegressionCompetitionScore      0.3923312883435583
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 23:12:09,174][0m Trial 134 finished with value: 0.3923312883435583 and parameters: {'lr': 0.0001072046396548483, 'dropout': 0.5237714454037501, 'd_model_multiplier': 1, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 131, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.000116211874624483, 'dropout': 0.527274518408561, 'd_model_multiplier': 1, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 124, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 94.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
86.9 K    Trainable params
7.2 K     Non-trainable params
94.1 K    Total params
0.376     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.483091801404953
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5860259532928467
	RegressionCompetitionScore: 0.19785276073619631

Metric val_loss improved. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.4854811728000641
	RegressionCompetitionScore: 0.06993865030674846



Validation scores:
	RegressionAUROC: 0.5212813019752502
	RegressionCompetitionScore: 0.12085889570552147



Validation scores:
	RegressionAUROC: 0.5046988725662231
	RegressionCompetitionScore: 0.07791411042944785

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6118522882461548
	RegressionCompetitionScore: 0.3

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6844003200531006
	RegressionCompetitionScore: 0.2809815950920245

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6853474378585815
	RegressionCompetitionScore: 0.33312883435582824



Validation scores:
	RegressionAUROC: 0.708346962928772
	RegressionCompetitionScore: 0.2687116564417178



Validation scores:
	RegressionAUROC: 0.7201366424560547
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7467097640037537
	RegressionCompetitionScore: 0.3196319018404908

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7423394918441772
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.748264729976654
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7430566549301147
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7339097857475281
	RegressionCompetitionScore: 0.2960122699386503



Validation scores:
	RegressionAUROC: 0.7479870319366455
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7482986450195312
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7445588111877441
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3196319018404908
     Test RegressionAUROC            0.7467097640037537
Test RegressionCompetitionScore      0.3196319018404908
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 23:21:25,979][0m Trial 135 finished with value: 0.3196319018404908 and parameters: {'lr': 0.000116211874624483, 'dropout': 0.527274518408561, 'd_model_multiplier': 1, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 124, 'batch_size': 16, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00015873671699641762, 'dropout': 0.4806042631229897, 'd_model_multiplier': 1, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 141, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 100 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
93.6 K    Trainable params
7.2 K     Non-trainable params
100 K     Total params
0.403     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6892468929290771
	RegressionCompetitionScore: 0.18742331288343558

Metric val_loss improved. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.7045730352401733
	RegressionCompetitionScore: 0.32239263803680984

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7255655527114868
	RegressionCompetitionScore: 0.3469325153374233



Validation scores:
	RegressionAUROC: 0.7256385087966919
	RegressionCompetitionScore: 0.3276073619631902



Validation scores:
	RegressionAUROC: 0.7365660667419434
	RegressionCompetitionScore: 0.38926380368098157



Validation scores:
	RegressionAUROC: 0.7527034878730774
	RegressionCompetitionScore: 0.3791411042944785



Validation scores:
	RegressionAUROC: 0.7415602207183838
	RegressionCompetitionScore: 0.3674846625766871



Validation scores:
	RegressionAUROC: 0.7430530190467834
	RegressionCompetitionScore: 0.3834355828220859



Validation scores:
	RegressionAUROC: 0.7444223165512085
	RegressionCompetitionScore: 0.3745398773006135

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.193. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.32239263803680984
     Test RegressionAUROC            0.7045730352401733
Test RegressionCompetitionScore      0.32239263803680984
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 23:26:38,487][0m Trial 136 finished with value: 0.32239263803680984 and parameters: {'lr': 0.00015873671699641762, 'dropout': 0.4806042631229897, 'd_model_multiplier': 1, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 141, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 7.09545062220821e-05, 'dropout': 0.4981935718895747, 'd_model_multiplier': 1, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 661, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 375 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
368 K     Trainable params
7.2 K     Non-trainable params
375 K     Total params
1.503     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.40096616744995117
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.5753931403160095
	RegressionCompetitionScore: 0.13282208588957056

Metric val_loss improved. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5458434820175171
	RegressionCompetitionScore: 0.1343558282208589



Validation scores:
	RegressionAUROC: 0.5764369964599609
	RegressionCompetitionScore: 0.14693251533742333

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6359281539916992
	RegressionCompetitionScore: 0.1754601226993865

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6245489120483398
	RegressionCompetitionScore: 0.1392638036809816

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6464297771453857
	RegressionCompetitionScore: 0.15245398773006136

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6554601192474365
	RegressionCompetitionScore: 0.1423312883435583



Validation scores:
	RegressionAUROC: 0.6680612564086914
	RegressionCompetitionScore: 0.147239263803681



Validation scores:
	RegressionAUROC: 0.6806974411010742
	RegressionCompetitionScore: 0.2558282208588957

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6674075126647949
	RegressionCompetitionScore: 0.27085889570552146



Validation scores:
	RegressionAUROC: 0.6883323192596436
	RegressionCompetitionScore: 0.28067484662576686

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6910101175308228
	RegressionCompetitionScore: 0.2929447852760736

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.707741379737854
	RegressionCompetitionScore: 0.29325153374233126



Validation scores:
	RegressionAUROC: 0.7050987482070923
	RegressionCompetitionScore: 0.297239263803681



Validation scores:
	RegressionAUROC: 0.7226430177688599
	RegressionCompetitionScore: 0.3061349693251534

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6978566646575928
	RegressionCompetitionScore: 0.26533742331288346



Validation scores:
	RegressionAUROC: 0.7243392467498779
	RegressionCompetitionScore: 0.31441717791411045



Validation scores:
	RegressionAUROC: 0.7119764089584351
	RegressionCompetitionScore: 0.3067484662576687



Validation scores:
	RegressionAUROC: 0.7166480422019958
	RegressionCompetitionScore: 0.32423312883435584



Validation scores:
	RegressionAUROC: 0.736716091632843
	RegressionCompetitionScore: 0.3521472392638037



Validation scores:
	RegressionAUROC: 0.7307645082473755
	RegressionCompetitionScore: 0.295398773006135

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7336043119430542
	RegressionCompetitionScore: 0.3174846625766871



Validation scores:
	RegressionAUROC: 0.7088914513587952
	RegressionCompetitionScore: 0.2785276073619632



Validation scores:
	RegressionAUROC: 0.7272887229919434
	RegressionCompetitionScore: 0.3214723926380368



Validation scores:
	RegressionAUROC: 0.7350289821624756
	RegressionCompetitionScore: 0.31809815950920245



Validation scores:
	RegressionAUROC: 0.7185367345809937
	RegressionCompetitionScore: 0.2926380368098159



Validation scores:
	RegressionAUROC: 0.7281773686408997
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7346339225769043
	RegressionCompetitionScore: 0.3147239263803681

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.189. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.295398773006135
     Test RegressionAUROC            0.7307645082473755
Test RegressionCompetitionScore       0.295398773006135
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 23:43:20,436][0m Trial 137 finished with value: 0.295398773006135 and parameters: {'lr': 7.09545062220821e-05, 'dropout': 0.4981935718895747, 'd_model_multiplier': 1, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 661, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 3.339933574417393e-05, 'dropout': 0.5354577215346857, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 99, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 93.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
85.8 K    Trainable params
7.2 K     Non-trainable params
93.0 K    Total params
0.372     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3124999701976776
	RegressionCompetitionScore: 0.08333333333333333



Validation scores:
	RegressionAUROC: 0.45776912569999695
	RegressionCompetitionScore: 0.12239263803680982

Metric val_loss improved. New best score: 0.253


Validation scores:
	RegressionAUROC: 0.5714466571807861
	RegressionCompetitionScore: 0.11748466257668712

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.242


Validation scores:
	RegressionAUROC: 0.6186872720718384
	RegressionCompetitionScore: 0.1098159509202454

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.6756227612495422
	RegressionCompetitionScore: 0.25828220858895706

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6926499009132385
	RegressionCompetitionScore: 0.25552147239263806



Validation scores:
	RegressionAUROC: 0.7028310298919678
	RegressionCompetitionScore: 0.2996932515337423



Validation scores:
	RegressionAUROC: 0.699958860874176
	RegressionCompetitionScore: 0.3030674846625767

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.7106752395629883
	RegressionCompetitionScore: 0.2865030674846626

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.6928057670593262
	RegressionCompetitionScore: 0.28496932515337425



Validation scores:
	RegressionAUROC: 0.7215596437454224
	RegressionCompetitionScore: 0.2874233128834356

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7239187359809875
	RegressionCompetitionScore: 0.28404907975460125



Validation scores:
	RegressionAUROC: 0.7136269807815552
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7176187634468079
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7103036642074585
	RegressionCompetitionScore: 0.29141104294478526



Validation scores:
	RegressionAUROC: 0.7320743203163147
	RegressionCompetitionScore: 0.30030674846625766



Validation scores:
	RegressionAUROC: 0.7314924001693726
	RegressionCompetitionScore: 0.3085889570552147



Validation scores:
	RegressionAUROC: 0.733274519443512
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.180. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2874233128834356
     Test RegressionAUROC            0.7215596437454224
Test RegressionCompetitionScore      0.2874233128834356
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-04 23:53:30,686][0m Trial 138 finished with value: 0.2874233128834356 and parameters: {'lr': 3.339933574417393e-05, 'dropout': 0.5354577215346857, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 99, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00023834678479618015, 'dropout': 0.5204845602150187, 'd_model_multiplier': 4, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 687, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.3 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.3 M     Trainable params
28.8 K    Non-trainable params
1.3 M     Total params
5.368     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4905833899974823
	RegressionCompetitionScore: 0.09570552147239264

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5426116585731506
	RegressionCompetitionScore: 0.0736196319018405



Validation scores:
	RegressionAUROC: 0.5465893745422363
	RegressionCompetitionScore: 0.0834355828220859

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.4988440275192261
	RegressionCompetitionScore: 0.07760736196319018



Validation scores:
	RegressionAUROC: 0.552254855632782
	RegressionCompetitionScore: 0.07116564417177915



Validation scores:
	RegressionAUROC: 0.6078245639801025
	RegressionCompetitionScore: 0.08619631901840491



Validation scores:
	RegressionAUROC: 0.6260905861854553
	RegressionCompetitionScore: 0.0852760736196319



Validation scores:
	RegressionAUROC: 0.6328442692756653
	RegressionCompetitionScore: 0.07300613496932515



Validation scores:
	RegressionAUROC: 0.6424409747123718
	RegressionCompetitionScore: 0.11012269938650307



Validation scores:
	RegressionAUROC: 0.626650333404541
	RegressionCompetitionScore: 0.22177914110429447

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.0834355828220859
     Test RegressionAUROC            0.5465893745422363
Test RegressionCompetitionScore      0.0834355828220859
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 00:00:11,158][0m Trial 139 finished with value: 0.0834355828220859 and parameters: {'lr': 0.00023834678479618015, 'dropout': 0.5204845602150187, 'd_model_multiplier': 4, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 687, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0001193165603904159, 'dropout': 0.4723345650226767, 'd_model_multiplier': 16, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 175, 'batch_size': 1024, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 5.6 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
5.4 M     Trainable params
115 K     Non-trainable params
5.6 M     Total params
22.259    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3816424608230591
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 15.430


Validation scores:
	RegressionAUROC: 0.5047417879104614
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 14.847 >= min_delta = 0.0. New best score: 0.583


Validation scores:
	RegressionAUROC: 0.5800459384918213
	RegressionCompetitionScore: 0.19478527607361965



Validation scores:
	RegressionAUROC: 0.6222236752510071
	RegressionCompetitionScore: 0.23282208588957054

Metric val_loss improved by 0.176 >= min_delta = 0.0. New best score: 0.407


Validation scores:
	RegressionAUROC: 0.6153249740600586
	RegressionCompetitionScore: 0.24355828220858897

Metric val_loss improved by 0.169 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.6138695478439331
	RegressionCompetitionScore: 0.2549079754601227

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6179243922233582
	RegressionCompetitionScore: 0.26104294478527607



Validation scores:
	RegressionAUROC: 0.5816009044647217
	RegressionCompetitionScore: 0.21042944785276074



Validation scores:
	RegressionAUROC: 0.5039176344871521
	RegressionCompetitionScore: 0.008282208588957056



Validation scores:
	RegressionAUROC: 0.6449506878852844
	RegressionCompetitionScore: 0.25337423312883434



Validation scores:
	RegressionAUROC: 0.6429120302200317
	RegressionCompetitionScore: 0.2561349693251534



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.202. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2549079754601227
     Test RegressionAUROC            0.6138695478439331
Test RegressionCompetitionScore      0.2549079754601227
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 00:09:50,690][0m Trial 140 finished with value: 0.2549079754601227 and parameters: {'lr': 0.0001193165603904159, 'dropout': 0.4723345650226767, 'd_model_multiplier': 16, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 175, 'batch_size': 1024, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 8.736097891684445e-05, 'dropout': 0.5524699948985401, 'd_model_multiplier': 4, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 167, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.6 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.6 M     Trainable params
0         Non-trainable params
1.6 M     Total params
6.235     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4166666865348816
	RegressionCompetitionScore: 0.3333333333333333



Validation scores:
	RegressionAUROC: 0.6527708768844604
	RegressionCompetitionScore: 0.13006134969325153

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.643760621547699
	RegressionCompetitionScore: 0.3015337423312883

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6625869274139404
	RegressionCompetitionScore: 0.1343558282208589



Validation scores:
	RegressionAUROC: 0.6970663070678711
	RegressionCompetitionScore: 0.23865030674846627



Validation scores:
	RegressionAUROC: 0.7148183584213257
	RegressionCompetitionScore: 0.35153374233128837



Validation scores:
	RegressionAUROC: 0.7239123582839966
	RegressionCompetitionScore: 0.3095092024539877

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7236599922180176
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7258775234222412
	RegressionCompetitionScore: 0.3693251533742331



Validation scores:
	RegressionAUROC: 0.7412060499191284
	RegressionCompetitionScore: 0.3638036809815951

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7131026983261108
	RegressionCompetitionScore: 0.3598159509202454



Validation scores:
	RegressionAUROC: 0.7447203993797302
	RegressionCompetitionScore: 0.4030674846625767



Validation scores:
	RegressionAUROC: 0.7541425228118896
	RegressionCompetitionScore: 0.4128834355828221



Validation scores:
	RegressionAUROC: 0.7573449015617371
	RegressionCompetitionScore: 0.4205521472392638



Validation scores:
	RegressionAUROC: 0.732149600982666
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7584421634674072
	RegressionCompetitionScore: 0.41042944785276075



Validation scores:
	RegressionAUROC: 0.7423333525657654
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.176. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3638036809815951
     Test RegressionAUROC            0.7412060499191284
Test RegressionCompetitionScore      0.3638036809815951
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 00:26:13,966][0m Trial 141 finished with value: 0.3638036809815951 and parameters: {'lr': 8.736097891684445e-05, 'dropout': 0.5524699948985401, 'd_model_multiplier': 4, 'num_layers': 13, 'n_heads': 32, 'dim_feedforward': 167, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 5.5134377209321e-05, 'dropout': 0.5405820188278262, 'd_model_multiplier': 4, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 118, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.2 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.2 M     Trainable params
0         Non-trainable params
1.2 M     Total params
4.804     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6064654588699341
	RegressionCompetitionScore: 0.18466257668711655

Metric val_loss improved. New best score: 0.289


Validation scores:
	RegressionAUROC: 0.638961672782898
	RegressionCompetitionScore: 0.17883435582822085

Metric val_loss improved by 0.071 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.6600483059883118
	RegressionCompetitionScore: 0.22392638036809817

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.652131199836731
	RegressionCompetitionScore: 0.15



Validation scores:
	RegressionAUROC: 0.6872711181640625
	RegressionCompetitionScore: 0.2696319018404908



Validation scores:
	RegressionAUROC: 0.7094993591308594
	RegressionCompetitionScore: 0.2616564417177914



Validation scores:
	RegressionAUROC: 0.6948786377906799
	RegressionCompetitionScore: 0.2803680981595092



Validation scores:
	RegressionAUROC: 0.7144139409065247
	RegressionCompetitionScore: 0.29478527607361965



Validation scores:
	RegressionAUROC: 0.7279821038246155
	RegressionCompetitionScore: 0.3211656441717791

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.724933922290802
	RegressionCompetitionScore: 0.32239263803680984



Validation scores:
	RegressionAUROC: 0.7350393533706665
	RegressionCompetitionScore: 0.3309815950920245

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.7163688540458679
	RegressionCompetitionScore: 0.30214723926380366



Validation scores:
	RegressionAUROC: 0.7218675017356873
	RegressionCompetitionScore: 0.2874233128834356



Validation scores:
	RegressionAUROC: 0.7331516146659851
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7435516119003296
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7390447854995728
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7221782803535461
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.723379373550415
	RegressionCompetitionScore: 0.32239263803680984

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.195. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3309815950920245
     Test RegressionAUROC            0.7350393533706665
Test RegressionCompetitionScore      0.3309815950920245
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 00:41:49,080][0m Trial 142 finished with value: 0.3309815950920245 and parameters: {'lr': 5.5134377209321e-05, 'dropout': 0.5405820188278262, 'd_model_multiplier': 4, 'num_layers': 11, 'n_heads': 32, 'dim_feedforward': 118, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 9.80219812353556e-05, 'dropout': 0.5115313327604729, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 64, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 428 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
428 K     Trainable params
0         Non-trainable params
428 K     Total params
1.712     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6555883288383484
	RegressionCompetitionScore: 0.3294478527607362

Metric val_loss improved. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6939113140106201
	RegressionCompetitionScore: 0.28404907975460125



Validation scores:
	RegressionAUROC: 0.7106170654296875
	RegressionCompetitionScore: 0.24233128834355827



Validation scores:
	RegressionAUROC: 0.7194098234176636
	RegressionCompetitionScore: 0.31809815950920245



Validation scores:
	RegressionAUROC: 0.733967661857605
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7405380010604858
	RegressionCompetitionScore: 0.3325153374233129



Validation scores:
	RegressionAUROC: 0.7464178800582886
	RegressionCompetitionScore: 0.36349693251533743



Validation scores:
	RegressionAUROC: 0.739112138748169
	RegressionCompetitionScore: 0.38773006134969323

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.196. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3294478527607362
     Test RegressionAUROC            0.6555883288383484
Test RegressionCompetitionScore      0.3294478527607362
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 00:50:37,332][0m Trial 143 finished with value: 0.3294478527607362 and parameters: {'lr': 9.80219812353556e-05, 'dropout': 0.5115313327604729, 'd_model_multiplier': 2, 'num_layers': 14, 'n_heads': 32, 'dim_feedforward': 64, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00018489389305279192, 'dropout': 0.5632803302801357, 'd_model_multiplier': 4, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 331, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 850 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
850 K     Trainable params
0         Non-trainable params
850 K     Total params
3.402     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.875
	RegressionCompetitionScore: 0.5



Validation scores:
	RegressionAUROC: 0.6407272815704346
	RegressionCompetitionScore: 0.2371165644171779

Metric val_loss improved. New best score: 0.243


Validation scores:
	RegressionAUROC: 0.6839065551757812
	RegressionCompetitionScore: 0.21595092024539878

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.6753690242767334
	RegressionCompetitionScore: 0.1303680981595092

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6829832792282104
	RegressionCompetitionScore: 0.19785276073619631



Validation scores:
	RegressionAUROC: 0.7039967179298401
	RegressionCompetitionScore: 0.3383435582822086



Validation scores:
	RegressionAUROC: 0.6836302876472473
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.652907133102417
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7143580913543701
	RegressionCompetitionScore: 0.347239263803681

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7093278765678406
	RegressionCompetitionScore: 0.36226993865030677



Validation scores:
	RegressionAUROC: 0.7234134674072266
	RegressionCompetitionScore: 0.3904907975460123

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7077657580375671
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6897804141044617
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7299090623855591
	RegressionCompetitionScore: 0.2791411042944785



Validation scores:
	RegressionAUROC: 0.7134313583374023
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7352169752120972
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7068732976913452
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.724807620048523
	RegressionCompetitionScore: 0.35828220858895704

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.176. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3904907975460123
     Test RegressionAUROC            0.7234134674072266
Test RegressionCompetitionScore      0.3904907975460123
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 01:02:00,604][0m Trial 144 finished with value: 0.3904907975460123 and parameters: {'lr': 0.00018489389305279192, 'dropout': 0.5632803302801357, 'd_model_multiplier': 4, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 331, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00019213534248791614, 'dropout': 0.4350086076420873, 'd_model_multiplier': 4, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 379, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 865 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
865 K     Trainable params
0         Non-trainable params
865 K     Total params
3.461     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6591732501983643
	RegressionCompetitionScore: 0.201840490797546

Metric val_loss improved. New best score: 0.241


Validation scores:
	RegressionAUROC: 0.6866580247879028
	RegressionCompetitionScore: 0.23466257668711657

Metric val_loss improved by 0.033 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.7000917196273804
	RegressionCompetitionScore: 0.2343558282208589

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6844826340675354
	RegressionCompetitionScore: 0.16226993865030676



Validation scores:
	RegressionAUROC: 0.7277884483337402
	RegressionCompetitionScore: 0.3211656441717791



Validation scores:
	RegressionAUROC: 0.7126006484031677
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7266724109649658
	RegressionCompetitionScore: 0.3558282208588957



Validation scores:
	RegressionAUROC: 0.7373780012130737
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5900042653083801
	RegressionCompetitionScore: 0.2668711656441718



Validation scores:
	RegressionAUROC: 0.7494187355041504
	RegressionCompetitionScore: 0.38558282208588956

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7409095764160156
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7324746251106262
	RegressionCompetitionScore: 0.3656441717791411



Validation scores:
	RegressionAUROC: 0.7388019561767578
	RegressionCompetitionScore: 0.3263803680981595



Validation scores:
	RegressionAUROC: 0.7306824326515198
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7275327444076538
	RegressionCompetitionScore: 0.2791411042944785

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.6906616687774658
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7157860398292542
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7172677516937256
	RegressionCompetitionScore: 0.25030674846625767



Validation scores:
	RegressionAUROC: 0.7223648428916931
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7351230978965759
	RegressionCompetitionScore: 0.3920245398773006



Validation scores:
	RegressionAUROC: 0.7383406758308411
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7229438424110413
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2791411042944785
     Test RegressionAUROC            0.7275327444076538
Test RegressionCompetitionScore      0.2791411042944785
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 01:15:46,775][0m Trial 145 finished with value: 0.2791411042944785 and parameters: {'lr': 0.00019213534248791614, 'dropout': 0.4350086076420873, 'd_model_multiplier': 4, 'num_layers': 12, 'n_heads': 16, 'dim_feedforward': 379, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00015606322102440701, 'dropout': 0.5268586432824074, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 565, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.4 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.4 M     Trainable params
0         Non-trainable params
1.4 M     Total params
5.691     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3333333432674408
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.46259111166000366
	RegressionCompetitionScore: 0.10705521472392639

Metric val_loss improved. New best score: 0.369


Validation scores:
	RegressionAUROC: 0.6080117225646973
	RegressionCompetitionScore: 0.14785276073619633



Validation scores:
	RegressionAUROC: 0.49939796328544617
	RegressionCompetitionScore: 0.1058282208588957



Validation scores:
	RegressionAUROC: 0.6232753992080688
	RegressionCompetitionScore: 0.2273006134969325

Metric val_loss improved by 0.085 >= min_delta = 0.0. New best score: 0.284


Validation scores:
	RegressionAUROC: 0.5759012699127197
	RegressionCompetitionScore: 0.2156441717791411



Validation scores:
	RegressionAUROC: 0.587162435054779
	RegressionCompetitionScore: 0.20398773006134968

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.270


Validation scores:
	RegressionAUROC: 0.6037204265594482
	RegressionCompetitionScore: 0.13987730061349693

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.244


Validation scores:
	RegressionAUROC: 0.6182438135147095
	RegressionCompetitionScore: 0.18128834355828222



Validation scores:
	RegressionAUROC: 0.5462644696235657
	RegressionCompetitionScore: 0.11042944785276074



Validation scores:
	RegressionAUROC: 0.5115211606025696
	RegressionCompetitionScore: 0.10398773006134969



Validation scores:
	RegressionAUROC: 0.5469563603401184
	RegressionCompetitionScore: 0.11134969325153374



Validation scores:
	RegressionAUROC: 0.42112451791763306
	RegressionCompetitionScore: 0.08006134969325153

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5443683862686157
	RegressionCompetitionScore: 0.1263803680981595

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6224530935287476
	RegressionCompetitionScore: 0.1303680981595092



Validation scores:
	RegressionAUROC: 0.4286755323410034
	RegressionCompetitionScore: 0.08865030674846626



Validation scores:
	RegressionAUROC: 0.4621955156326294
	RegressionCompetitionScore: 0.10245398773006135



Validation scores:
	RegressionAUROC: 0.3995804786682129
	RegressionCompetitionScore: 0.06503067484662577



Validation scores:
	RegressionAUROC: 0.6034523248672485
	RegressionCompetitionScore: 0.09846625766871166



Validation scores:
	RegressionAUROC: 0.5841653347015381
	RegressionCompetitionScore: 0.09570552147239264



Validation scores:
	RegressionAUROC: 0.4831180274486542
	RegressionCompetitionScore: 0.09785276073619632

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.207. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1263803680981595
     Test RegressionAUROC            0.5443683862686157
Test RegressionCompetitionScore      0.1263803680981595
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 01:31:16,462][0m Trial 146 finished with value: 0.1263803680981595 and parameters: {'lr': 0.00015606322102440701, 'dropout': 0.5268586432824074, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 565, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0003847221311348304, 'dropout': 0.43954937816897555, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 140, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 425 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
425 K     Trainable params
0         Non-trainable params
425 K     Total params
1.701     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6351029872894287
	RegressionCompetitionScore: 0.2570552147239264

Metric val_loss improved. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6786155700683594
	RegressionCompetitionScore: 0.27515337423312886



Validation scores:
	RegressionAUROC: 0.7055107951164246
	RegressionCompetitionScore: 0.27300613496932513



Validation scores:
	RegressionAUROC: 0.7049240469932556
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7312232851982117
	RegressionCompetitionScore: 0.33496932515337424

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.7497321963310242
	RegressionCompetitionScore: 0.3904907975460123

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7407017350196838
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7391158938407898
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7411490082740784
	RegressionCompetitionScore: 0.33957055214723925



Validation scores:
	RegressionAUROC: 0.7325730323791504
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.680239737033844
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7002456188201904
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7054862976074219
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3904907975460123
     Test RegressionAUROC            0.7497321963310242
Test RegressionCompetitionScore      0.3904907975460123
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 01:38:46,194][0m Trial 147 finished with value: 0.3904907975460123 and parameters: {'lr': 0.0003847221311348304, 'dropout': 0.43954937816897555, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 140, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00032543264736352803, 'dropout': 0.4124131273479666, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 91, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 362 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
333 K     Trainable params
28.8 K    Non-trainable params
362 K     Total params
1.448     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6497465372085571
	RegressionCompetitionScore: 0.2294478527607362

Metric val_loss improved. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.6543405055999756
	RegressionCompetitionScore: 0.08680981595092024

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.5921481847763062
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7029705047607422
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7375763654708862
	RegressionCompetitionScore: 0.3806748466257669

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7412735819816589
	RegressionCompetitionScore: 0.3254601226993865



Validation scores:
	RegressionAUROC: 0.710852861404419
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7330801486968994
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7448362112045288
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7668598294258118
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7738868594169617
	RegressionCompetitionScore: 0.3512269938650307

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7699105143547058
	RegressionCompetitionScore: 0.37515337423312883

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7344889640808105
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7494364976882935
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7334762811660767
	RegressionCompetitionScore: 0.3085889570552147



Validation scores:
	RegressionAUROC: 0.7212661504745483
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7649145126342773
	RegressionCompetitionScore: 0.3696319018404908



Validation scores:
	RegressionAUROC: 0.7515032291412354
	RegressionCompetitionScore: 0.3328220858895706



Validation scores:
	RegressionAUROC: 0.7871413230895996
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37515337423312883
     Test RegressionAUROC            0.7699105143547058
Test RegressionCompetitionScore      0.37515337423312883
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 01:51:06,337][0m Trial 148 finished with value: 0.37515337423312883 and parameters: {'lr': 0.00032543264736352803, 'dropout': 0.4124131273479666, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 91, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0006408830639919824, 'dropout': 0.46377930990221555, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 131, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 413 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
413 K     Trainable params
0         Non-trainable params
413 K     Total params
1.655     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.41118037700653076
	RegressionCompetitionScore: 0.0794478527607362

Metric val_loss improved. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.6271328926086426
	RegressionCompetitionScore: 0.1659509202453988

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.6358762979507446
	RegressionCompetitionScore: 0.07822085889570553

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6987333297729492
	RegressionCompetitionScore: 0.17239263803680982

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6965410113334656
	RegressionCompetitionScore: 0.31717791411042945

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.7009573578834534
	RegressionCompetitionScore: 0.19815950920245398

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7251123189926147
	RegressionCompetitionScore: 0.2898773006134969

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.721021294593811
	RegressionCompetitionScore: 0.2782208588957055



Validation scores:
	RegressionAUROC: 0.7261446118354797
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7436319589614868
	RegressionCompetitionScore: 0.298159509202454



Validation scores:
	RegressionAUROC: 0.7333273887634277
	RegressionCompetitionScore: 0.2892638036809816

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7427868843078613
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7407008409500122
	RegressionCompetitionScore: 0.28588957055214725

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7242875099182129
	RegressionCompetitionScore: 0.25736196319018406



Validation scores:
	RegressionAUROC: 0.7390576601028442
	RegressionCompetitionScore: 0.2987730061349693



Validation scores:
	RegressionAUROC: 0.7314866781234741
	RegressionCompetitionScore: 0.27208588957055213



Validation scores:
	RegressionAUROC: 0.7274125218391418
	RegressionCompetitionScore: 0.3042944785276074



Validation scores:
	RegressionAUROC: 0.7435214519500732
	RegressionCompetitionScore: 0.3095092024539877



Validation scores:
	RegressionAUROC: 0.7186367511749268
	RegressionCompetitionScore: 0.30828220858895705



Validation scores:
	RegressionAUROC: 0.7542011737823486
	RegressionCompetitionScore: 0.32177914110429445

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.28588957055214725
     Test RegressionAUROC            0.7407008409500122
Test RegressionCompetitionScore      0.28588957055214725
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 02:01:40,518][0m Trial 149 finished with value: 0.28588957055214725 and parameters: {'lr': 0.0006408830639919824, 'dropout': 0.46377930990221555, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 131, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0004310247001386822, 'dropout': 0.44443885371379627, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 113, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 548 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
548 K     Trainable params
0         Non-trainable params
548 K     Total params
2.192     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.21256038546562195
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6221634149551392
	RegressionCompetitionScore: 0.2656441717791411

Metric val_loss improved. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6891315579414368
	RegressionCompetitionScore: 0.2205521472392638



Validation scores:
	RegressionAUROC: 0.6961840987205505
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6526013612747192
	RegressionCompetitionScore: 0.11595092024539877



Validation scores:
	RegressionAUROC: 0.6840897798538208
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7238951921463013
	RegressionCompetitionScore: 0.2846625766871166

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7039597034454346
	RegressionCompetitionScore: 0.2205521472392638



Validation scores:
	RegressionAUROC: 0.725853443145752
	RegressionCompetitionScore: 0.3282208588957055

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7387858629226685
	RegressionCompetitionScore: 0.36687116564417177



Validation scores:
	RegressionAUROC: 0.7382689714431763
	RegressionCompetitionScore: 0.346319018404908



Validation scores:
	RegressionAUROC: 0.7318580150604248
	RegressionCompetitionScore: 0.346319018404908

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7389583587646484
	RegressionCompetitionScore: 0.3248466257668712



Validation scores:
	RegressionAUROC: 0.7287964820861816
	RegressionCompetitionScore: 0.3052147239263804



Validation scores:
	RegressionAUROC: 0.7349904775619507
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7435513734817505
	RegressionCompetitionScore: 0.36779141104294477

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7417429685592651
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.741873025894165
	RegressionCompetitionScore: 0.3763803680981595



Validation scores:
	RegressionAUROC: 0.7193251848220825
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7293907403945923
	RegressionCompetitionScore: 0.3576687116564417



Validation scores:
	RegressionAUROC: 0.726993203163147
	RegressionCompetitionScore: 0.4039877300613497



Validation scores:
	RegressionAUROC: 0.7336047291755676
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7156371474266052
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36779141104294477
     Test RegressionAUROC            0.7435513734817505
Test RegressionCompetitionScore      0.36779141104294477
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 02:15:41,126][0m Trial 150 finished with value: 0.36779141104294477 and parameters: {'lr': 0.0004310247001386822, 'dropout': 0.44443885371379627, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 113, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0011994933679738765, 'dropout': 0.4234355974691986, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 80, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 347 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
319 K     Trainable params
28.8 K    Non-trainable params
347 K     Total params
1.391     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6649652719497681
	RegressionCompetitionScore: 0.25828220858895706

Metric val_loss improved. New best score: 0.484


Validation scores:
	RegressionAUROC: 0.6795915961265564
	RegressionCompetitionScore: 0.12208588957055215

Metric val_loss improved by 0.263 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5818568468093872
	RegressionCompetitionScore: 0.1107361963190184

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.508226752281189
	RegressionCompetitionScore: 0.04785276073619632



Validation scores:
	RegressionAUROC: 0.3925321698188782
	RegressionCompetitionScore: 0.1049079754601227

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.40497273206710815
	RegressionCompetitionScore: 0.12576687116564417



Validation scores:
	RegressionAUROC: 0.40359431505203247
	RegressionCompetitionScore: 0.11901840490797547



Validation scores:
	RegressionAUROC: 0.4081685245037079
	RegressionCompetitionScore: 0.11380368098159509



Validation scores:
	RegressionAUROC: 0.6155204176902771
	RegressionCompetitionScore: 0.03343558282208589



Validation scores:
	RegressionAUROC: 0.5972575545310974
	RegressionCompetitionScore: 0.18404907975460122



Validation scores:
	RegressionAUROC: 0.47280335426330566
	RegressionCompetitionScore: 0.0803680981595092



Validation scores:
	RegressionAUROC: 0.5503641366958618
	RegressionCompetitionScore: 0.010429447852760737

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1049079754601227
     Test RegressionAUROC            0.3925321698188782
Test RegressionCompetitionScore      0.1049079754601227
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 02:24:31,421][0m Trial 151 finished with value: 0.1049079754601227 and parameters: {'lr': 0.0011994933679738765, 'dropout': 0.4234355974691986, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 80, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00023272909164035968, 'dropout': 0.41106832403507754, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 613, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.0 M     Trainable params
28.8 K    Non-trainable params
1.0 M     Total params
4.142     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6000000238418579
	RegressionCompetitionScore: 0.2



Validation scores:
	RegressionAUROC: 0.6156332492828369
	RegressionCompetitionScore: 0.2846625766871166

Metric val_loss improved. New best score: 0.352


Validation scores:
	RegressionAUROC: 0.6997931003570557
	RegressionCompetitionScore: 0.301840490797546



Validation scores:
	RegressionAUROC: 0.7194408178329468
	RegressionCompetitionScore: 0.3549079754601227

Metric val_loss improved by 0.170 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7343155145645142
	RegressionCompetitionScore: 0.3665644171779141



Validation scores:
	RegressionAUROC: 0.7275686264038086
	RegressionCompetitionScore: 0.36441717791411044

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.6879043579101562
	RegressionCompetitionScore: 0.3070552147239264



Validation scores:
	RegressionAUROC: 0.7473517060279846
	RegressionCompetitionScore: 0.38128834355828223



Validation scores:
	RegressionAUROC: 0.721677839756012
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7032670974731445
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7504439353942871
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7302151918411255
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6679308414459229
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36441717791411044
     Test RegressionAUROC            0.7275686264038086
Test RegressionCompetitionScore      0.36441717791411044
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 02:32:24,844][0m Trial 152 finished with value: 0.36441717791411044 and parameters: {'lr': 0.00023272909164035968, 'dropout': 0.41106832403507754, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 613, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00035075089632913764, 'dropout': 0.4455955680239166, 'd_model_multiplier': 4, 'num_layers': 11, 'n_heads': 16, 'dim_feedforward': 343, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 748 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
719 K     Trainable params
28.8 K    Non-trainable params
748 K     Total params
2.993     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6000000238418579
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.6632585525512695
	RegressionCompetitionScore: 0.26226993865030673

Metric val_loss improved. New best score: 0.436


Validation scores:
	RegressionAUROC: 0.6429833173751831
	RegressionCompetitionScore: 0.27085889570552146

Metric val_loss improved by 0.202 >= min_delta = 0.0. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.6595785617828369
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.649308979511261
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6815809011459351
	RegressionCompetitionScore: 0.2656441717791411

Metric val_loss improved by 0.042 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.6767445206642151
	RegressionCompetitionScore: 0.24846625766871167



Validation scores:
	RegressionAUROC: 0.5164957046508789
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4999833106994629
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6140876412391663
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.192. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2656441717791411
     Test RegressionAUROC            0.6815809011459351
Test RegressionCompetitionScore      0.2656441717791411
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 02:40:48,595][0m Trial 153 finished with value: 0.2656441717791411 and parameters: {'lr': 0.00035075089632913764, 'dropout': 0.4455955680239166, 'd_model_multiplier': 4, 'num_layers': 11, 'n_heads': 16, 'dim_feedforward': 343, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0002908591904646141, 'dropout': 0.40112081446080705, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 90, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 360 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
331 K     Trainable params
28.8 K    Non-trainable params
360 K     Total params
1.443     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.669214129447937
	RegressionCompetitionScore: 0.2785276073619632

Metric val_loss improved. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.7128409743309021
	RegressionCompetitionScore: 0.3220858895705521

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.7168287038803101
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7193047404289246
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6825560331344604
	RegressionCompetitionScore: 0.26993865030674846

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7335938215255737
	RegressionCompetitionScore: 0.35521472392638037



Validation scores:
	RegressionAUROC: 0.7146538496017456
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6748781204223633
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7029021382331848
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7181708812713623
	RegressionCompetitionScore: 0.348159509202454



Validation scores:
	RegressionAUROC: 0.6741780042648315
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.696158230304718
	RegressionCompetitionScore: 0.3015337423312883

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.194. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.26993865030674846
     Test RegressionAUROC            0.6825560331344604
Test RegressionCompetitionScore      0.26993865030674846
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 02:48:58,652][0m Trial 154 finished with value: 0.26993865030674846 and parameters: {'lr': 0.0002908591904646141, 'dropout': 0.40112081446080705, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 90, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.000492002437886305, 'dropout': 0.4391266216603505, 'd_model_multiplier': 4, 'num_layers': 11, 'n_heads': 16, 'dim_feedforward': 145, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 467 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
438 K     Trainable params
28.8 K    Non-trainable params
467 K     Total params
1.869     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.1458333432674408
	RegressionCompetitionScore: 0.08333333333333333



Validation scores:
	RegressionAUROC: 0.6365160942077637
	RegressionCompetitionScore: 0.3177914110429448

Metric val_loss improved. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.7003759741783142
	RegressionCompetitionScore: 0.2570552147239264

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.7068426609039307
	RegressionCompetitionScore: 0.25030674846625767



Validation scores:
	RegressionAUROC: 0.6722730398178101
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6950486898422241
	RegressionCompetitionScore: 0.33680981595092024

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7171717286109924
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7254490852355957
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6756290793418884
	RegressionCompetitionScore: 0.2067484662576687



Validation scores:
	RegressionAUROC: 0.6952450275421143
	RegressionCompetitionScore: 0.2855828220858896



Validation scores:
	RegressionAUROC: 0.7072224020957947
	RegressionCompetitionScore: 0.30030674846625766

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.5031275153160095
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5703127980232239
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6650519371032715
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6826505661010742
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6738741397857666
	RegressionCompetitionScore: 0.19631901840490798



Validation scores:
	RegressionAUROC: 0.6780650615692139
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4936283230781555
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.186. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.30030674846625766
     Test RegressionAUROC            0.7072224020957947
Test RegressionCompetitionScore      0.30030674846625766
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 02:59:08,792][0m Trial 155 finished with value: 0.30030674846625766 and parameters: {'lr': 0.000492002437886305, 'dropout': 0.4391266216603505, 'd_model_multiplier': 4, 'num_layers': 11, 'n_heads': 16, 'dim_feedforward': 145, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0003068346386688341, 'dropout': 0.4251123217864896, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 111, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 387 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
387 K     Trainable params
0         Non-trainable params
387 K     Total params
1.551     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6875
	RegressionCompetitionScore: 0.3333333333333333



Validation scores:
	RegressionAUROC: 0.6130461096763611
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.384


Validation scores:
	RegressionAUROC: 0.688014030456543
	RegressionCompetitionScore: 0.28404907975460125

Metric val_loss improved by 0.100 >= min_delta = 0.0. New best score: 0.284


Validation scores:
	RegressionAUROC: 0.692508339881897
	RegressionCompetitionScore: 0.2570552147239264

Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: 0.255


Validation scores:
	RegressionAUROC: 0.7107940912246704
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7098654508590698
	RegressionCompetitionScore: 0.3088957055214724

Metric val_loss improved by 0.064 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7346009016036987
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7258622646331787
	RegressionCompetitionScore: 0.34662576687116564



Validation scores:
	RegressionAUROC: 0.7383004426956177
	RegressionCompetitionScore: 0.3570552147239264



Validation scores:
	RegressionAUROC: 0.7334047555923462
	RegressionCompetitionScore: 0.3929447852760736



Validation scores:
	RegressionAUROC: 0.7396945953369141
	RegressionCompetitionScore: 0.34202453987730064



Validation scores:
	RegressionAUROC: 0.7481271624565125
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7342358827590942
	RegressionCompetitionScore: 0.3576687116564417



Validation scores:
	RegressionAUROC: 0.7493146061897278
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.7068492770195007
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7247294783592224
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7551948428153992
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7444748282432556
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7459360361099243
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.184. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC            0.7481271624565125
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 03:09:21,158][0m Trial 156 finished with value: 0.0 and parameters: {'lr': 0.0003068346386688341, 'dropout': 0.4251123217864896, 'd_model_multiplier': 4, 'num_layers': 10, 'n_heads': 16, 'dim_feedforward': 111, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00013951991642532623, 'dropout': 0.453383481893366, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 149, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 581 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
552 K     Trainable params
28.8 K    Non-trainable params
581 K     Total params
2.326     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.8999999761581421
	RegressionCompetitionScore: 0.8



Validation scores:
	RegressionAUROC: 0.659130871295929
	RegressionCompetitionScore: 0.2233128834355828

Metric val_loss improved. New best score: 0.304


Validation scores:
	RegressionAUROC: 0.6887506246566772
	RegressionCompetitionScore: 0.13282208588957056

Metric val_loss improved by 0.050 >= min_delta = 0.0. New best score: 0.254


Validation scores:
	RegressionAUROC: 0.6953465938568115
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.035 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.7030479907989502
	RegressionCompetitionScore: 0.18926380368098158

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.7341737747192383
	RegressionCompetitionScore: 0.38865030674846623

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7260184288024902
	RegressionCompetitionScore: 0.3254601226993865



Validation scores:
	RegressionAUROC: 0.725125789642334
	RegressionCompetitionScore: 0.2766871165644172



Validation scores:
	RegressionAUROC: 0.7364381551742554
	RegressionCompetitionScore: 0.31196319018404906



Validation scores:
	RegressionAUROC: 0.7340028285980225
	RegressionCompetitionScore: 0.3901840490797546



Validation scores:
	RegressionAUROC: 0.7564831376075745
	RegressionCompetitionScore: 0.4088957055214724

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7297259569168091
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7377002239227295
	RegressionCompetitionScore: 0.3512269938650307



Validation scores:
	RegressionAUROC: 0.7393524646759033
	RegressionCompetitionScore: 0.2920245398773006



Validation scores:
	RegressionAUROC: 0.7232953906059265
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6951425075531006
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7391438484191895
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7169481515884399
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4088957055214724
     Test RegressionAUROC            0.7564831376075745
Test RegressionCompetitionScore      0.4088957055214724
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 03:22:39,052][0m Trial 157 finished with value: 0.4088957055214724 and parameters: {'lr': 0.00013951991642532623, 'dropout': 0.453383481893366, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 149, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0001578238910896822, 'dropout': 0.4532713733216343, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 8, 'dim_feedforward': 134, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 228 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
228 K     Trainable params
0         Non-trainable params
228 K     Total params
0.916     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.54347825050354
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.501243531703949
	RegressionCompetitionScore: 0.003374233128834356

Metric val_loss improved. New best score: 0.627


Validation scores:
	RegressionAUROC: 0.52482008934021
	RegressionCompetitionScore: 0.1294478527607362

Metric val_loss improved by 0.058 >= min_delta = 0.0. New best score: 0.568


Validation scores:
	RegressionAUROC: 0.4851990342140198
	RegressionCompetitionScore: 0.15184049079754602

Metric val_loss improved by 0.036 >= min_delta = 0.0. New best score: 0.533


Validation scores:
	RegressionAUROC: 0.47939062118530273
	RegressionCompetitionScore: 0.1668711656441718



Validation scores:
	RegressionAUROC: 0.5005310773849487
	RegressionCompetitionScore: 0.1588957055214724

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.517


Validation scores:
	RegressionAUROC: 0.5186697244644165
	RegressionCompetitionScore: 0.15122699386503066

Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.488


Validation scores:
	RegressionAUROC: 0.523179292678833
	RegressionCompetitionScore: 0.18036809815950922

Metric val_loss improved by 0.096 >= min_delta = 0.0. New best score: 0.391


Validation scores:
	RegressionAUROC: 0.5143687129020691
	RegressionCompetitionScore: 0.1579754601226994

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.367


Validation scores:
	RegressionAUROC: 0.5418230891227722
	RegressionCompetitionScore: 0.17883435582822085



Validation scores:
	RegressionAUROC: 0.46426939964294434
	RegressionCompetitionScore: 0.16042944785276073



Validation scores:
	RegressionAUROC: 0.460177481174469
	RegressionCompetitionScore: 0.14294478527607363

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.351


Validation scores:
	RegressionAUROC: 0.595979630947113
	RegressionCompetitionScore: 0.19447852760736195

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.340


Validation scores:
	RegressionAUROC: 0.5798267126083374
	RegressionCompetitionScore: 0.201840490797546

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.314


Validation scores:
	RegressionAUROC: 0.5763245820999146
	RegressionCompetitionScore: 0.19233128834355828



Validation scores:
	RegressionAUROC: 0.5727453231811523
	RegressionCompetitionScore: 0.18282208588957055

Metric val_loss improved by 0.027 >= min_delta = 0.0. New best score: 0.287


Validation scores:
	RegressionAUROC: 0.598750114440918
	RegressionCompetitionScore: 0.19417177914110428



Validation scores:
	RegressionAUROC: 0.5772594213485718
	RegressionCompetitionScore: 0.20644171779141104



Validation scores:
	RegressionAUROC: 0.5912139415740967
	RegressionCompetitionScore: 0.16809815950920245

Metric val_loss improved by 0.034 >= min_delta = 0.0. New best score: 0.253


Validation scores:
	RegressionAUROC: 0.6020389795303345
	RegressionCompetitionScore: 0.19877300613496932

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.248


Validation scores:
	RegressionAUROC: 0.5054843425750732
	RegressionCompetitionScore: 0.09171779141104294



Validation scores:
	RegressionAUROC: 0.5163613557815552
	RegressionCompetitionScore: 0.09785276073619632



Validation scores:
	RegressionAUROC: 0.5638937950134277
	RegressionCompetitionScore: 0.1294478527607362

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.245


Validation scores:
	RegressionAUROC: 0.5523861050605774
	RegressionCompetitionScore: 0.13650306748466257

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.240


Validation scores:
	RegressionAUROC: 0.6093181371688843
	RegressionCompetitionScore: 0.22668711656441717



Validation scores:
	RegressionAUROC: 0.5537687540054321
	RegressionCompetitionScore: 0.17239263803680982



Validation scores:
	RegressionAUROC: 0.5262607336044312
	RegressionCompetitionScore: 0.14662576687116563



Validation scores:
	RegressionAUROC: 0.5620065927505493
	RegressionCompetitionScore: 0.15674846625766872



Validation scores:
	RegressionAUROC: 0.5689283609390259
	RegressionCompetitionScore: 0.14171779141104293



Validation scores:
	RegressionAUROC: 0.5414544343948364
	RegressionCompetitionScore: 0.10920245398773006



Validation scores:
	RegressionAUROC: 0.43602225184440613
	RegressionCompetitionScore: 0.05736196319018405

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.240. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.13650306748466257
     Test RegressionAUROC            0.5523861050605774
Test RegressionCompetitionScore      0.13650306748466257
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 03:37:00,221][0m Trial 158 finished with value: 0.13650306748466257 and parameters: {'lr': 0.0001578238910896822, 'dropout': 0.4532713733216343, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 8, 'dim_feedforward': 134, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.000122344559758383, 'dropout': 0.5035206474259394, 'd_model_multiplier': 1, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 159, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 127 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
127 K     Trainable params
0         Non-trainable params
127 K     Total params
0.509     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6404140591621399
	RegressionCompetitionScore: 0.13803680981595093

Metric val_loss improved. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.6328162550926208
	RegressionCompetitionScore: 0.13067484662576687

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6584010124206543
	RegressionCompetitionScore: 0.1401840490797546

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6832833290100098
	RegressionCompetitionScore: 0.250920245398773



Validation scores:
	RegressionAUROC: 0.6761597990989685
	RegressionCompetitionScore: 0.25920245398773006



Validation scores:
	RegressionAUROC: 0.6830782890319824
	RegressionCompetitionScore: 0.2684049079754601



Validation scores:
	RegressionAUROC: 0.6650584936141968
	RegressionCompetitionScore: 0.2776073619631902



Validation scores:
	RegressionAUROC: 0.6577495336532593
	RegressionCompetitionScore: 0.2861963190184049



Validation scores:
	RegressionAUROC: 0.6653269529342651
	RegressionCompetitionScore: 0.2920245398773006



Validation scores:
	RegressionAUROC: 0.7129523754119873
	RegressionCompetitionScore: 0.34386503067484664

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.211. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1401840490797546
     Test RegressionAUROC            0.6584010124206543
Test RegressionCompetitionScore      0.1401840490797546
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 03:43:06,318][0m Trial 159 finished with value: 0.1401840490797546 and parameters: {'lr': 0.000122344559758383, 'dropout': 0.5035206474259394, 'd_model_multiplier': 1, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 159, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00020618599847799557, 'dropout': 0.4606845196728395, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 495, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.2 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.2 M     Trainable params
0         Non-trainable params
1.2 M     Total params
4.826     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3125000298023224
	RegressionCompetitionScore: 0.08333333333333333



Validation scores:
	RegressionAUROC: 0.6409971117973328
	RegressionCompetitionScore: 0.2420245398773006

Metric val_loss improved. New best score: 0.236


Validation scores:
	RegressionAUROC: 0.6540038585662842
	RegressionCompetitionScore: 0.26319018404907973

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.6612744331359863
	RegressionCompetitionScore: 0.08742331288343558



Validation scores:
	RegressionAUROC: 0.6986808180809021
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7124067544937134
	RegressionCompetitionScore: 0.3334355828220859



Validation scores:
	RegressionAUROC: 0.7170449495315552
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7089088559150696
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6870489120483398
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7214804291725159
	RegressionCompetitionScore: 0.36073619631901843

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.213. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.26319018404907973
     Test RegressionAUROC            0.6540038585662842
Test RegressionCompetitionScore      0.26319018404907973
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 03:49:33,251][0m Trial 160 finished with value: 0.26319018404907973 and parameters: {'lr': 0.00020618599847799557, 'dropout': 0.4606845196728395, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 495, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00024246140192076582, 'dropout': 0.4345512190824277, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 93, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 509 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
480 K     Trainable params
28.8 K    Non-trainable params
509 K     Total params
2.038     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.06666666269302368
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6519840955734253
	RegressionCompetitionScore: 0.15337423312883436

Metric val_loss improved. New best score: 0.262


Validation scores:
	RegressionAUROC: 0.656183123588562
	RegressionCompetitionScore: 0.3070552147239264

Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: 0.233


Validation scores:
	RegressionAUROC: 0.710125744342804
	RegressionCompetitionScore: 0.3414110429447853

Metric val_loss improved by 0.052 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.6832441091537476
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6652871370315552
	RegressionCompetitionScore: 0.3512269938650307



Validation scores:
	RegressionAUROC: 0.489257276058197
	RegressionCompetitionScore: 0.08006134969325153



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6514793634414673
	RegressionCompetitionScore: 0.08466257668711656



Validation scores:
	RegressionAUROC: 0.646769642829895
	RegressionCompetitionScore: 0.1273006134969325



Validation scores:
	RegressionAUROC: 0.6650604009628296
	RegressionCompetitionScore: 0.11349693251533742

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.181. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3414110429447853
     Test RegressionAUROC             0.710125744342804
Test RegressionCompetitionScore      0.3414110429447853
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 03:58:29,742][0m Trial 161 finished with value: 0.3414110429447853 and parameters: {'lr': 0.00024246140192076582, 'dropout': 0.4345512190824277, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 93, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00036843485750291265, 'dropout': 0.4076499806354261, 'd_model_multiplier': 4, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 146, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 540 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
511 K     Trainable params
28.8 K    Non-trainable params
540 K     Total params
2.161     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6116153001785278
	RegressionCompetitionScore: 0.27975460122699386

Metric val_loss improved. New best score: 0.355


Validation scores:
	RegressionAUROC: 0.6990870237350464
	RegressionCompetitionScore: 0.27423312883435585

Metric val_loss improved by 0.122 >= min_delta = 0.0. New best score: 0.233


Validation scores:
	RegressionAUROC: 0.6881446838378906
	RegressionCompetitionScore: 0.11625766871165644

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.6895445585250854
	RegressionCompetitionScore: 0.16901840490797546

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6695587635040283
	RegressionCompetitionScore: 0.19325153374233128



Validation scores:
	RegressionAUROC: 0.6579736471176147
	RegressionCompetitionScore: 0.16226993865030676



Validation scores:
	RegressionAUROC: 0.6708723902702332
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.675426721572876
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6681606769561768
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6964672207832336
	RegressionCompetitionScore: 0.34171779141104297



Validation scores:
	RegressionAUROC: 0.5648727416992188
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.197. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.16901840490797546
     Test RegressionAUROC            0.6895445585250854
Test RegressionCompetitionScore      0.16901840490797546
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 04:06:59,803][0m Trial 162 finished with value: 0.16901840490797546 and parameters: {'lr': 0.00036843485750291265, 'dropout': 0.4076499806354261, 'd_model_multiplier': 4, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 146, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00013852303256811776, 'dropout': 0.41880805902037427, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 122, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 565 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
536 K     Trainable params
28.8 K    Non-trainable params
565 K     Total params
2.262     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6552668809890747
	RegressionCompetitionScore: 0.2776073619631902

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6884958148002625
	RegressionCompetitionScore: 0.2898773006134969

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6771268844604492
	RegressionCompetitionScore: 0.16165644171779142



Validation scores:
	RegressionAUROC: 0.7097809314727783
	RegressionCompetitionScore: 0.2880368098159509



Validation scores:
	RegressionAUROC: 0.7275189161300659
	RegressionCompetitionScore: 0.3628834355828221

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7289714217185974
	RegressionCompetitionScore: 0.3647239263803681



Validation scores:
	RegressionAUROC: 0.7447189092636108
	RegressionCompetitionScore: 0.3941717791411043

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7283070087432861
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7456783652305603
	RegressionCompetitionScore: 0.4174846625766871



Validation scores:
	RegressionAUROC: 0.7425627708435059
	RegressionCompetitionScore: 0.39662576687116563



Validation scores:
	RegressionAUROC: 0.7623825669288635
	RegressionCompetitionScore: 0.3929447852760736



Validation scores:
	RegressionAUROC: 0.7133684158325195
	RegressionCompetitionScore: 0.29570552147239265



Validation scores:
	RegressionAUROC: 0.7521668672561646
	RegressionCompetitionScore: 0.35429447852760737



Validation scores:
	RegressionAUROC: 0.7533091902732849
	RegressionCompetitionScore: 0.38374233128834356

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.173. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3941717791411043
     Test RegressionAUROC            0.7447189092636108
Test RegressionCompetitionScore      0.3941717791411043
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 04:19:15,208][0m Trial 163 finished with value: 0.3941717791411043 and parameters: {'lr': 0.00013852303256811776, 'dropout': 0.41880805902037427, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 122, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0001389014962955837, 'dropout': 0.423641918806269, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 123, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 567 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
538 K     Trainable params
28.8 K    Non-trainable params
567 K     Total params
2.270     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6666666269302368
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.6459070444107056
	RegressionCompetitionScore: 0.29386503067484665

Metric val_loss improved. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6961096525192261
	RegressionCompetitionScore: 0.249079754601227



Validation scores:
	RegressionAUROC: 0.7172504663467407
	RegressionCompetitionScore: 0.2901840490797546

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7022011876106262
	RegressionCompetitionScore: 0.302760736196319



Validation scores:
	RegressionAUROC: 0.721247673034668
	RegressionCompetitionScore: 0.36073619631901843



Validation scores:
	RegressionAUROC: 0.7129921317100525
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7232725024223328
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7156068682670593
	RegressionCompetitionScore: 0.35245398773006137



Validation scores:
	RegressionAUROC: 0.7249395847320557
	RegressionCompetitionScore: 0.34754601226993864



Validation scores:
	RegressionAUROC: 0.732646107673645
	RegressionCompetitionScore: 0.3576687116564417

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7403558492660522
	RegressionCompetitionScore: 0.3693251533742331

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7048754692077637
	RegressionCompetitionScore: 0.27208588957055213



Validation scores:
	RegressionAUROC: 0.6966970562934875
	RegressionCompetitionScore: 0.3211656441717791



Validation scores:
	RegressionAUROC: 0.7174330949783325
	RegressionCompetitionScore: 0.2865030674846626



Validation scores:
	RegressionAUROC: 0.7309035062789917
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7389429211616516
	RegressionCompetitionScore: 0.31104294478527605



Validation scores:
	RegressionAUROC: 0.7155483961105347
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7044544219970703
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.178. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3693251533742331
     Test RegressionAUROC            0.7403558492660522
Test RegressionCompetitionScore      0.3693251533742331
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 04:34:53,630][0m Trial 164 finished with value: 0.3693251533742331 and parameters: {'lr': 0.0001389014962955837, 'dropout': 0.423641918806269, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 123, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00010910025558411344, 'dropout': 0.44344424390798337, 'd_model_multiplier': 8, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 201, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.9 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.9 M     Trainable params
57.6 K    Non-trainable params
1.9 M     Total params
7.636     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3719806671142578
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.628250241279602
	RegressionCompetitionScore: 0.17300613496932515

Metric val_loss improved. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.639531672000885
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6500467658042908
	RegressionCompetitionScore: 0.254601226993865



Validation scores:
	RegressionAUROC: 0.6869980096817017
	RegressionCompetitionScore: 0.24785276073619633

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.6976181268692017
	RegressionCompetitionScore: 0.31196319018404906

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7078572511672974
	RegressionCompetitionScore: 0.30122699386503066



Validation scores:
	RegressionAUROC: 0.6769660711288452
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7170015573501587
	RegressionCompetitionScore: 0.3079754601226994



Validation scores:
	RegressionAUROC: 0.7176632881164551
	RegressionCompetitionScore: 0.33220858895705524



Validation scores:
	RegressionAUROC: 0.7275202870368958
	RegressionCompetitionScore: 0.3374233128834356



Validation scores:
	RegressionAUROC: 0.7277799248695374
	RegressionCompetitionScore: 0.34202453987730064



Validation scores:
	RegressionAUROC: 0.7220101356506348
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.186. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.31196319018404906
     Test RegressionAUROC            0.6976181268692017
Test RegressionCompetitionScore      0.31196319018404906
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 04:43:05,074][0m Trial 165 finished with value: 0.31196319018404906 and parameters: {'lr': 0.00010910025558411344, 'dropout': 0.44344424390798337, 'd_model_multiplier': 8, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 201, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 5.6336726031462e-05, 'dropout': 0.4771254275104807, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 161, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 603 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
574 K     Trainable params
28.8 K    Non-trainable params
603 K     Total params
2.413     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5708845853805542
	RegressionCompetitionScore: 0.08987730061349693

Metric val_loss improved. New best score: 0.334


Validation scores:
	RegressionAUROC: 0.6222277283668518
	RegressionCompetitionScore: 0.24785276073619633

Metric val_loss improved by 0.130 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6414960622787476
	RegressionCompetitionScore: 0.20828220858895705



Validation scores:
	RegressionAUROC: 0.6501868963241577
	RegressionCompetitionScore: 0.23190184049079754

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6604369878768921
	RegressionCompetitionScore: 0.25398773006134967



Validation scores:
	RegressionAUROC: 0.6706154942512512
	RegressionCompetitionScore: 0.2552147239263804

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.6762720346450806
	RegressionCompetitionScore: 0.21687116564417178



Validation scores:
	RegressionAUROC: 0.6867395639419556
	RegressionCompetitionScore: 0.2450920245398773



Validation scores:
	RegressionAUROC: 0.6949905157089233
	RegressionCompetitionScore: 0.2898773006134969



Validation scores:
	RegressionAUROC: 0.7046190500259399
	RegressionCompetitionScore: 0.26196319018404907



Validation scores:
	RegressionAUROC: 0.7055175304412842
	RegressionCompetitionScore: 0.2898773006134969



Validation scores:
	RegressionAUROC: 0.6886041760444641
	RegressionCompetitionScore: 0.3076687116564417

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.710927426815033
	RegressionCompetitionScore: 0.2684049079754601



Validation scores:
	RegressionAUROC: 0.7035679817199707
	RegressionCompetitionScore: 0.33067484662576685



Validation scores:
	RegressionAUROC: 0.6958966255187988
	RegressionCompetitionScore: 0.35613496932515337



Validation scores:
	RegressionAUROC: 0.7186318635940552
	RegressionCompetitionScore: 0.29570552147239265

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7232131958007812
	RegressionCompetitionScore: 0.3450920245398773

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7187844514846802
	RegressionCompetitionScore: 0.30828220858895705

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7261483073234558
	RegressionCompetitionScore: 0.3441717791411043



Validation scores:
	RegressionAUROC: 0.7303536534309387
	RegressionCompetitionScore: 0.34263803680981597



Validation scores:
	RegressionAUROC: 0.7276896238327026
	RegressionCompetitionScore: 0.34386503067484664



Validation scores:
	RegressionAUROC: 0.7281345129013062
	RegressionCompetitionScore: 0.3312883435582822

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.72601717710495
	RegressionCompetitionScore: 0.3095092024539877

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.71860671043396
	RegressionCompetitionScore: 0.3521472392638037



Validation scores:
	RegressionAUROC: 0.7306751012802124
	RegressionCompetitionScore: 0.3291411042944785



Validation scores:
	RegressionAUROC: 0.7369676232337952
	RegressionCompetitionScore: 0.3285276073619632

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7388564348220825
	RegressionCompetitionScore: 0.3665644171779141



Validation scores:
	RegressionAUROC: 0.7254437804222107
	RegressionCompetitionScore: 0.3193251533742331



Validation scores:
	RegressionAUROC: 0.7378944158554077
	RegressionCompetitionScore: 0.35030674846625764



Validation scores:
	RegressionAUROC: 0.7439872026443481
	RegressionCompetitionScore: 0.3588957055214724



Validation scores:
	RegressionAUROC: 0.7475835084915161
	RegressionCompetitionScore: 0.33773006134969324

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7414200305938721
	RegressionCompetitionScore: 0.3294478527607362



Validation scores:
	RegressionAUROC: 0.7419924736022949
	RegressionCompetitionScore: 0.3365030674846626



Validation scores:
	RegressionAUROC: 0.7383460998535156
	RegressionCompetitionScore: 0.3441717791411043

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7389298677444458
	RegressionCompetitionScore: 0.35245398773006137



Validation scores:
	RegressionAUROC: 0.73829585313797
	RegressionCompetitionScore: 0.32699386503067485



Validation scores:
	RegressionAUROC: 0.7435262203216553
	RegressionCompetitionScore: 0.34202453987730064



Validation scores:
	RegressionAUROC: 0.7431576251983643
	RegressionCompetitionScore: 0.34355828220858897



Validation scores:
	RegressionAUROC: 0.7384602427482605
	RegressionCompetitionScore: 0.344478527607362



Validation scores:
	RegressionAUROC: 0.7399348616600037
	RegressionCompetitionScore: 0.37055214723926383



Validation scores:
	RegressionAUROC: 0.748622715473175
	RegressionCompetitionScore: 0.3401840490797546

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.171. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3441717791411043
     Test RegressionAUROC            0.7383460998535156
Test RegressionCompetitionScore      0.3441717791411043
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 05:07:23,683][0m Trial 166 finished with value: 0.3441717791411043 and parameters: {'lr': 5.6336726031462e-05, 'dropout': 0.4771254275104807, 'd_model_multiplier': 4, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 161, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00018790859809693025, 'dropout': 0.5195228799755898, 'd_model_multiplier': 32, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 109, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 16.8 M
1 | loss_fn | MSELoss | 0     
------------------------------------
16.8 M    Trainable params
0         Non-trainable params
16.8 M    Total params
67.182    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.46666669845581055
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.612


Validation scores:
	RegressionAUROC: 0.6162468194961548
	RegressionCompetitionScore: 0.293558282208589

Metric val_loss improved by 0.398 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5815114378929138
	RegressionCompetitionScore: 0.26134969325153373



Validation scores:
	RegressionAUROC: 0.6315231919288635
	RegressionCompetitionScore: 0.14202453987730063



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.41301077604293823
	RegressionCompetitionScore: 0.10368098159509202

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.214. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.293558282208589
     Test RegressionAUROC            0.6162468194961548
Test RegressionCompetitionScore       0.293558282208589
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 05:17:24,425][0m Trial 167 finished with value: 0.293558282208589 and parameters: {'lr': 0.00018790859809693025, 'dropout': 0.5195228799755898, 'd_model_multiplier': 32, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 109, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 4.185697597880725e-05, 'dropout': 0.48926155876400257, 'd_model_multiplier': 64, 'num_layers': 15, 'n_heads': 64, 'dim_feedforward': 179, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.0 B 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.0 B     Trainable params
0         Non-trainable params
1.0 B     Total params
4,131.858 Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

[WARNING] OOM for trial with params {'lr': 4.185697597880725e-05, 'dropout': 0.48926155876400257, 'd_model_multiplier': 64, 'num_layers': 15, 'n_heads': 64, 'dim_feedforward': 179, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}
[32m[I 2023-04-05 05:17:39,550][0m Trial 168 finished with value: 0.0 and parameters: {'lr': 4.185697597880725e-05, 'dropout': 0.48926155876400257, 'd_model_multiplier': 64, 'num_layers': 15, 'n_heads': 64, 'dim_feedforward': 179, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 6.978612878532295e-05, 'dropout': 0.546052227445317, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 128, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 577 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
577 K     Trainable params
0         Non-trainable params
577 K     Total params
2.309     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4791666865348816
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.41192519664764404
	RegressionCompetitionScore: 0.09325153374233129

Metric val_loss improved. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5920239686965942
	RegressionCompetitionScore: 0.23865030674846627



Validation scores:
	RegressionAUROC: 0.6081002354621887
	RegressionCompetitionScore: 0.2665644171779141

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6227083802223206
	RegressionCompetitionScore: 0.27607361963190186



Validation scores:
	RegressionAUROC: 0.6450779438018799
	RegressionCompetitionScore: 0.17822085889570552



Validation scores:
	RegressionAUROC: 0.6937032341957092
	RegressionCompetitionScore: 0.2941717791411043



Validation scores:
	RegressionAUROC: 0.7050275802612305
	RegressionCompetitionScore: 0.3122699386503067



Validation scores:
	RegressionAUROC: 0.6892372369766235
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.7172224521636963
	RegressionCompetitionScore: 0.32975460122699385

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7160481214523315
	RegressionCompetitionScore: 0.3300613496932515



Validation scores:
	RegressionAUROC: 0.733385443687439
	RegressionCompetitionScore: 0.36073619631901843



Validation scores:
	RegressionAUROC: 0.7041671872138977
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7321531772613525
	RegressionCompetitionScore: 0.34386503067484664



Validation scores:
	RegressionAUROC: 0.7422894239425659
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7389082312583923
	RegressionCompetitionScore: 0.3595092024539877



Validation scores:
	RegressionAUROC: 0.7195254564285278
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.187. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.32975460122699385
     Test RegressionAUROC            0.7172224521636963
Test RegressionCompetitionScore      0.32975460122699385
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 05:28:55,656][0m Trial 169 finished with value: 0.32975460122699385 and parameters: {'lr': 6.978612878532295e-05, 'dropout': 0.546052227445317, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 128, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00015578498153850709, 'dropout': 0.45378802294756937, 'd_model_multiplier': 16, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 149, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 5.0 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
4.9 M     Trainable params
115 K     Non-trainable params
5.0 M     Total params
20.096    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.9166666865348816
	RegressionCompetitionScore: 0.9166666666666666



Validation scores:
	RegressionAUROC: 0.41137415170669556
	RegressionCompetitionScore: 0.0843558282208589

Metric val_loss improved. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.43685704469680786
	RegressionCompetitionScore: 0.07699386503067485



Validation scores:
	RegressionAUROC: 0.4108993709087372
	RegressionCompetitionScore: 0.10398773006134969

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.4220603108406067
	RegressionCompetitionScore: 0.07883435582822086

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5904656648635864
	RegressionCompetitionScore: 0.21012269938650308



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4340038001537323
	RegressionCompetitionScore: 0.09447852760736196



Validation scores:
	RegressionAUROC: 0.5467191338539124
	RegressionCompetitionScore: 0.13803680981595093



Validation scores:
	RegressionAUROC: 0.5841460227966309
	RegressionCompetitionScore: 0.22607361963190184



Validation scores:
	RegressionAUROC: 0.6081094741821289
	RegressionCompetitionScore: 0.28251533742331286



Validation scores:
	RegressionAUROC: 0.5436807870864868
	RegressionCompetitionScore: 0.17147239263803682

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.07883435582822086
     Test RegressionAUROC            0.4220603108406067
Test RegressionCompetitionScore      0.07883435582822086
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 05:37:12,190][0m Trial 170 finished with value: 0.07883435582822086 and parameters: {'lr': 0.00015578498153850709, 'dropout': 0.45378802294756937, 'd_model_multiplier': 16, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 149, 'batch_size': 8, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.000271254141912278, 'dropout': 0.41654829094518736, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 84, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 491 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
463 K     Trainable params
28.8 K    Non-trainable params
491 K     Total params
1.968     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3999999761581421
	RegressionCompetitionScore: 0.2



Validation scores:
	RegressionAUROC: 0.686798095703125
	RegressionCompetitionScore: 0.25030674846625767

Metric val_loss improved. New best score: 0.427


Validation scores:
	RegressionAUROC: 0.6954407691955566
	RegressionCompetitionScore: 0.26533742331288346

Metric val_loss improved by 0.104 >= min_delta = 0.0. New best score: 0.323


Validation scores:
	RegressionAUROC: 0.679790735244751
	RegressionCompetitionScore: 0.2950920245398773

Metric val_loss improved by 0.130 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6936873197555542
	RegressionCompetitionScore: 0.28773006134969326



Validation scores:
	RegressionAUROC: 0.6608796119689941
	RegressionCompetitionScore: 0.3116564417177914



Validation scores:
	RegressionAUROC: 0.6731553077697754
	RegressionCompetitionScore: 0.3628834355828221



Validation scores:
	RegressionAUROC: 0.6599636673927307
	RegressionCompetitionScore: 0.2263803680981595



Validation scores:
	RegressionAUROC: 0.6113366484642029
	RegressionCompetitionScore: 0.18803680981595092



Validation scores:
	RegressionAUROC: 0.6046155691146851
	RegressionCompetitionScore: 0.17791411042944785



Validation scores:
	RegressionAUROC: 0.4165838062763214
	RegressionCompetitionScore: 0.04570552147239264

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.193. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2950920245398773
     Test RegressionAUROC             0.679790735244751
Test RegressionCompetitionScore      0.2950920245398773
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 05:46:11,787][0m Trial 171 finished with value: 0.2950920245398773 and parameters: {'lr': 0.000271254141912278, 'dropout': 0.41654829094518736, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 84, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00021987268210119882, 'dropout': 0.41336487774539094, 'd_model_multiplier': 4, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 101, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 464 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
436 K     Trainable params
28.8 K    Non-trainable params
464 K     Total params
1.860     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6666666269302368
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.5973999500274658
	RegressionCompetitionScore: 0.2469325153374233

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6837517023086548
	RegressionCompetitionScore: 0.3058282208588957



Validation scores:
	RegressionAUROC: 0.6996738910675049
	RegressionCompetitionScore: 0.348159509202454



Validation scores:
	RegressionAUROC: 0.7034400701522827
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7033852338790894
	RegressionCompetitionScore: 0.293558282208589

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.7072627544403076
	RegressionCompetitionScore: 0.33404907975460124



Validation scores:
	RegressionAUROC: 0.629602313041687
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6453633308410645
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.658382773399353
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7171131372451782
	RegressionCompetitionScore: 0.25736196319018406

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.6962032318115234
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7108215093612671
	RegressionCompetitionScore: 0.29478527607361965



Validation scores:
	RegressionAUROC: 0.662918210029602
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.693344235420227
	RegressionCompetitionScore: 0.2898773006134969



Validation scores:
	RegressionAUROC: 0.6999010443687439
	RegressionCompetitionScore: 0.2303680981595092



Validation scores:
	RegressionAUROC: 0.6186023950576782
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5984519124031067
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.187. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.25736196319018406
     Test RegressionAUROC            0.7171131372451782
Test RegressionCompetitionScore      0.25736196319018406
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 05:58:56,225][0m Trial 172 finished with value: 0.25736196319018406 and parameters: {'lr': 0.00021987268210119882, 'dropout': 0.41336487774539094, 'd_model_multiplier': 4, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 101, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00011283297843623823, 'dropout': 0.43939191305514347, 'd_model_multiplier': 4, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 70, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 308 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
280 K     Trainable params
28.8 K    Non-trainable params
308 K     Total params
1.236     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.46666666865348816
	RegressionCompetitionScore: 0.2



Validation scores:
	RegressionAUROC: 0.6858376264572144
	RegressionCompetitionScore: 0.21288343558282208

Metric val_loss improved. New best score: 0.266


Validation scores:
	RegressionAUROC: 0.6723104119300842
	RegressionCompetitionScore: 0.16257668711656442

Metric val_loss improved by 0.045 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.7029005289077759
	RegressionCompetitionScore: 0.16901840490797546

Metric val_loss improved by 0.036 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7056189179420471
	RegressionCompetitionScore: 0.2996932515337423



Validation scores:
	RegressionAUROC: 0.7327389717102051
	RegressionCompetitionScore: 0.3312883435582822



Validation scores:
	RegressionAUROC: 0.7533554434776306
	RegressionCompetitionScore: 0.36503067484662577



Validation scores:
	RegressionAUROC: 0.7493130564689636
	RegressionCompetitionScore: 0.37116564417177916

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7552075386047363
	RegressionCompetitionScore: 0.4021472392638037

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7491593956947327
	RegressionCompetitionScore: 0.37791411042944784



Validation scores:
	RegressionAUROC: 0.7581775188446045
	RegressionCompetitionScore: 0.40613496932515336



Validation scores:
	RegressionAUROC: 0.7621404528617859
	RegressionCompetitionScore: 0.40736196319018403

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7397587895393372
	RegressionCompetitionScore: 0.38098159509202456



Validation scores:
	RegressionAUROC: 0.7618603706359863
	RegressionCompetitionScore: 0.4088957055214724



Validation scores:
	RegressionAUROC: 0.7640562057495117
	RegressionCompetitionScore: 0.4187116564417178



Validation scores:
	RegressionAUROC: 0.7728968858718872
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7773183584213257
	RegressionCompetitionScore: 0.4119631901840491

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7685613632202148
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7734977602958679
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7430728673934937
	RegressionCompetitionScore: 0.4058282208588957



Validation scores:
	RegressionAUROC: 0.7718764543533325
	RegressionCompetitionScore: 0.4251533742331288



Validation scores:
	RegressionAUROC: 0.7677457928657532
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7723977565765381
	RegressionCompetitionScore: 0.4144171779141104



Validation scores:
	RegressionAUROC: 0.7848386764526367
	RegressionCompetitionScore: 0.450920245398773

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.167. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4119631901840491
     Test RegressionAUROC            0.7773183584213257
Test RegressionCompetitionScore      0.4119631901840491
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 06:13:28,001][0m Trial 173 finished with value: 0.4119631901840491 and parameters: {'lr': 0.00011283297843623823, 'dropout': 0.43939191305514347, 'd_model_multiplier': 4, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 70, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 9.40355096863723e-05, 'dropout': 0.44004376849774457, 'd_model_multiplier': 4, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 73, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 312 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
283 K     Trainable params
28.8 K    Non-trainable params
312 K     Total params
1.250     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7333333492279053
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.6484723091125488
	RegressionCompetitionScore: 0.21779141104294478

Metric val_loss improved. New best score: 0.245


Validation scores:
	RegressionAUROC: 0.6731285452842712
	RegressionCompetitionScore: 0.2598159509202454

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.7107517719268799
	RegressionCompetitionScore: 0.298159509202454

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.7132087349891663
	RegressionCompetitionScore: 0.32791411042944785



Validation scores:
	RegressionAUROC: 0.7293870449066162
	RegressionCompetitionScore: 0.35828220858895704

Metric val_loss improved by 0.034 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.742181658744812
	RegressionCompetitionScore: 0.3745398773006135

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7396296262741089
	RegressionCompetitionScore: 0.3610429447852761



Validation scores:
	RegressionAUROC: 0.7431743741035461
	RegressionCompetitionScore: 0.3960122699386503



Validation scores:
	RegressionAUROC: 0.7359488606452942
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7447530627250671
	RegressionCompetitionScore: 0.3911042944785276



Validation scores:
	RegressionAUROC: 0.7415147423744202
	RegressionCompetitionScore: 0.35460122699386504



Validation scores:
	RegressionAUROC: 0.7343752384185791
	RegressionCompetitionScore: 0.35153374233128837



Validation scores:
	RegressionAUROC: 0.7418522834777832
	RegressionCompetitionScore: 0.3460122699386503

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3745398773006135
     Test RegressionAUROC             0.742181658744812
Test RegressionCompetitionScore      0.3745398773006135
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 06:21:52,000][0m Trial 174 finished with value: 0.3745398773006135 and parameters: {'lr': 9.40355096863723e-05, 'dropout': 0.44004376849774457, 'd_model_multiplier': 4, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 73, 'batch_size': 4, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0001244616097784352, 'dropout': 0.4329013840572014, 'd_model_multiplier': 4, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 117, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 363 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
334 K     Trainable params
28.8 K    Non-trainable params
363 K     Total params
1.454     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5748792290687561
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5695635080337524
	RegressionCompetitionScore: 0.16656441717791412

Metric val_loss improved. New best score: 0.248


Validation scores:
	RegressionAUROC: 0.58497154712677
	RegressionCompetitionScore: 0.20429447852760735

Metric val_loss improved by 0.033 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.6053179502487183
	RegressionCompetitionScore: 0.2558282208588957

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.6236871480941772
	RegressionCompetitionScore: 0.27116564417177913

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6408421993255615
	RegressionCompetitionScore: 0.26319018404907973



Validation scores:
	RegressionAUROC: 0.6460656523704529
	RegressionCompetitionScore: 0.1901840490797546

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.623522162437439
	RegressionCompetitionScore: 0.11748466257668712

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6528019905090332
	RegressionCompetitionScore: 0.14263803680981596



Validation scores:
	RegressionAUROC: 0.6671817302703857
	RegressionCompetitionScore: 0.2058282208588957



Validation scores:
	RegressionAUROC: 0.6728428602218628
	RegressionCompetitionScore: 0.2174846625766871



Validation scores:
	RegressionAUROC: 0.6764825582504272
	RegressionCompetitionScore: 0.1794478527607362

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6819909811019897
	RegressionCompetitionScore: 0.19969325153374234

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6863299012184143
	RegressionCompetitionScore: 0.1785276073619632



Validation scores:
	RegressionAUROC: 0.6960728764533997
	RegressionCompetitionScore: 0.22392638036809817

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7080134749412537
	RegressionCompetitionScore: 0.2312883435582822

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7039720416069031
	RegressionCompetitionScore: 0.23496932515337424



Validation scores:
	RegressionAUROC: 0.7177255153656006
	RegressionCompetitionScore: 0.3113496932515337

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7036647796630859
	RegressionCompetitionScore: 0.21809815950920244



Validation scores:
	RegressionAUROC: 0.7278276681900024
	RegressionCompetitionScore: 0.3325153374233129



Validation scores:
	RegressionAUROC: 0.731707751750946
	RegressionCompetitionScore: 0.4067484662576687



Validation scores:
	RegressionAUROC: 0.7256193161010742
	RegressionCompetitionScore: 0.3803680981595092



Validation scores:
	RegressionAUROC: 0.7306091785430908
	RegressionCompetitionScore: 0.37607361963190183

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7179341316223145
	RegressionCompetitionScore: 0.2696319018404908



Validation scores:
	RegressionAUROC: 0.7262450456619263
	RegressionCompetitionScore: 0.32699386503067485

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7354699969291687
	RegressionCompetitionScore: 0.39478527607361963

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.691159725189209
	RegressionCompetitionScore: 0.20705521472392638



Validation scores:
	RegressionAUROC: 0.7405967116355896
	RegressionCompetitionScore: 0.39447852760736196



Validation scores:
	RegressionAUROC: 0.7253904342651367
	RegressionCompetitionScore: 0.33159509202453985



Validation scores:
	RegressionAUROC: 0.7356690764427185
	RegressionCompetitionScore: 0.3567484662576687



Validation scores:
	RegressionAUROC: 0.745356023311615
	RegressionCompetitionScore: 0.40061349693251536



Validation scores:
	RegressionAUROC: 0.7473702430725098
	RegressionCompetitionScore: 0.37760736196319017



Validation scores:
	RegressionAUROC: 0.746504545211792
	RegressionCompetitionScore: 0.37331288343558283

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7381432056427002
	RegressionCompetitionScore: 0.3441717791411043



Validation scores:
	RegressionAUROC: 0.7422041893005371
	RegressionCompetitionScore: 0.3570552147239264



Validation scores:
	RegressionAUROC: 0.7473112344741821
	RegressionCompetitionScore: 0.3803680981595092



Validation scores:
	RegressionAUROC: 0.7199394702911377
	RegressionCompetitionScore: 0.32515337423312884



Validation scores:
	RegressionAUROC: 0.7462436556816101
	RegressionCompetitionScore: 0.38312883435582823



Validation scores:
	RegressionAUROC: 0.7471828460693359
	RegressionCompetitionScore: 0.37576687116564417



Validation scores:
	RegressionAUROC: 0.7427512407302856
	RegressionCompetitionScore: 0.3843558282208589

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37331288343558283
     Test RegressionAUROC             0.746504545211792
Test RegressionCompetitionScore      0.37331288343558283
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 06:41:08,360][0m Trial 175 finished with value: 0.37331288343558283 and parameters: {'lr': 0.0001244616097784352, 'dropout': 0.4329013840572014, 'd_model_multiplier': 4, 'num_layers': 9, 'n_heads': 16, 'dim_feedforward': 117, 'batch_size': 128, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 7.817788714271611e-05, 'dropout': 0.5327188104161927, 'd_model_multiplier': 8, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 65, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.4 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.4 M     Trainable params
0         Non-trainable params
1.4 M     Total params
5.539     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.41555923223495483
	RegressionCompetitionScore: 0.08128834355828221

Metric val_loss improved. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.5982693433761597
	RegressionCompetitionScore: 0.2794478527607362



Validation scores:
	RegressionAUROC: 0.6410204172134399
	RegressionCompetitionScore: 0.26717791411042946



Validation scores:
	RegressionAUROC: 0.5950894355773926
	RegressionCompetitionScore: 0.2432515337423313



Validation scores:
	RegressionAUROC: 0.5906662940979004
	RegressionCompetitionScore: 0.24263803680981594



Validation scores:
	RegressionAUROC: 0.4959205985069275
	RegressionCompetitionScore: 0.10552147239263804



Validation scores:
	RegressionAUROC: 0.5871477127075195
	RegressionCompetitionScore: 0.2303680981595092



Validation scores:
	RegressionAUROC: 0.6721152663230896
	RegressionCompetitionScore: 0.2196319018404908

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.5996575355529785
	RegressionCompetitionScore: 0.249079754601227



Validation scores:
	RegressionAUROC: 0.5915600657463074
	RegressionCompetitionScore: 0.19079754601226995



Validation scores:
	RegressionAUROC: 0.4130876660346985
	RegressionCompetitionScore: 0.09417177914110429



Validation scores:
	RegressionAUROC: 0.5462808609008789
	RegressionCompetitionScore: 0.09631901840490797



Validation scores:
	RegressionAUROC: 0.5321681499481201
	RegressionCompetitionScore: 0.05828220858895705



Validation scores:
	RegressionAUROC: 0.4349249303340912
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5151630640029907
	RegressionCompetitionScore: 0.11319018404907975

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.205. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2196319018404908
     Test RegressionAUROC            0.6721152663230896
Test RegressionCompetitionScore      0.2196319018404908
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 06:54:51,211][0m Trial 176 finished with value: 0.2196319018404908 and parameters: {'lr': 7.817788714271611e-05, 'dropout': 0.5327188104161927, 'd_model_multiplier': 8, 'num_layers': 15, 'n_heads': 16, 'dim_feedforward': 65, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 2.2425631401673444e-05, 'dropout': 0.42947869605159145, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 4, 'dim_feedforward': 141, 'batch_size': 1024, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 118 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
111 K     Trainable params
7.2 K     Non-trainable params
118 K     Total params
0.473     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3913043141365051
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.4042190611362457
	RegressionCompetitionScore: 0.06134969325153374

Metric val_loss improved. New best score: 0.472


Validation scores:
	RegressionAUROC: 0.4039210081100464
	RegressionCompetitionScore: 0.06319018404907975

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.463


Validation scores:
	RegressionAUROC: 0.4037783145904541
	RegressionCompetitionScore: 0.06196319018404908

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.459


Validation scores:
	RegressionAUROC: 0.40365201234817505
	RegressionCompetitionScore: 0.060429447852760734

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.453


Validation scores:
	RegressionAUROC: 0.4035027027130127
	RegressionCompetitionScore: 0.06073619631901841

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.451


Validation scores:
	RegressionAUROC: 0.4032145142555237
	RegressionCompetitionScore: 0.06134969325153374

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.446


Validation scores:
	RegressionAUROC: 0.4027915298938751
	RegressionCompetitionScore: 0.06165644171779141

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.439


Validation scores:
	RegressionAUROC: 0.40255439281463623
	RegressionCompetitionScore: 0.06165644171779141

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.435


Validation scores:
	RegressionAUROC: 0.4021376371383667
	RegressionCompetitionScore: 0.06165644171779141

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.427


Validation scores:
	RegressionAUROC: 0.40194737911224365
	RegressionCompetitionScore: 0.06134969325153374

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.423


Validation scores:
	RegressionAUROC: 0.40134191513061523
	RegressionCompetitionScore: 0.06073619631901841

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.415


Validation scores:
	RegressionAUROC: 0.40096211433410645
	RegressionCompetitionScore: 0.06073619631901841

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.405


Validation scores:
	RegressionAUROC: 0.4007337689399719
	RegressionCompetitionScore: 0.061042944785276075

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.401


Validation scores:
	RegressionAUROC: 0.4003351926803589
	RegressionCompetitionScore: 0.06134969325153374

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.391


Validation scores:
	RegressionAUROC: 0.4001403748989105
	RegressionCompetitionScore: 0.06134969325153374

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.386


Validation scores:
	RegressionAUROC: 0.3997703790664673
	RegressionCompetitionScore: 0.06196319018404908

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.375


Validation scores:
	RegressionAUROC: 0.39941877126693726
	RegressionCompetitionScore: 0.06165644171779141

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.364


Validation scores:
	RegressionAUROC: 0.3992338180541992
	RegressionCompetitionScore: 0.06226993865030675

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.359


Validation scores:
	RegressionAUROC: 0.3986629247665405
	RegressionCompetitionScore: 0.06257668711656442

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.348


Validation scores:
	RegressionAUROC: 0.39821988344192505
	RegressionCompetitionScore: 0.06257668711656442

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.343


Validation scores:
	RegressionAUROC: 0.39743244647979736
	RegressionCompetitionScore: 0.06319018404907975

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.332


Validation scores:
	RegressionAUROC: 0.3966718316078186
	RegressionCompetitionScore: 0.06257668711656442

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.321


Validation scores:
	RegressionAUROC: 0.39634767174720764
	RegressionCompetitionScore: 0.06257668711656442

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.316


Validation scores:
	RegressionAUROC: 0.3958515524864197
	RegressionCompetitionScore: 0.05889570552147239

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.306


Validation scores:
	RegressionAUROC: 0.39558175206184387
	RegressionCompetitionScore: 0.0598159509202454

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.301


Validation scores:
	RegressionAUROC: 0.39494866132736206
	RegressionCompetitionScore: 0.06012269938650307

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.291


Validation scores:
	RegressionAUROC: 0.39420056343078613
	RegressionCompetitionScore: 0.06073619631901841

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.281


Validation scores:
	RegressionAUROC: 0.39382773637771606
	RegressionCompetitionScore: 0.061042944785276075

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.276


Validation scores:
	RegressionAUROC: 0.39332661032676697
	RegressionCompetitionScore: 0.06134969325153374

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.268


Validation scores:
	RegressionAUROC: 0.39320722222328186
	RegressionCompetitionScore: 0.06196319018404908

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.263


Validation scores:
	RegressionAUROC: 0.39305806159973145
	RegressionCompetitionScore: 0.06165644171779141

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.256


Validation scores:
	RegressionAUROC: 0.3928714096546173
	RegressionCompetitionScore: 0.06257668711656442

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.249


Validation scores:
	RegressionAUROC: 0.3928283452987671
	RegressionCompetitionScore: 0.06288343558282208

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.246


Validation scores:
	RegressionAUROC: 0.3926628828048706
	RegressionCompetitionScore: 0.06226993865030675

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.239


Validation scores:
	RegressionAUROC: 0.3926210105419159
	RegressionCompetitionScore: 0.06257668711656442

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.236


Validation scores:
	RegressionAUROC: 0.3926986753940582
	RegressionCompetitionScore: 0.06134969325153374

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.231


Validation scores:
	RegressionAUROC: 0.3929747939109802
	RegressionCompetitionScore: 0.06319018404907975

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.39331090450286865
	RegressionCompetitionScore: 0.06226993865030675

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.39376282691955566
	RegressionCompetitionScore: 0.06226993865030675

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.3940209150314331
	RegressionCompetitionScore: 0.0638036809815951

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.3944542407989502
	RegressionCompetitionScore: 0.0638036809815951

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.39505547285079956
	RegressionCompetitionScore: 0.06441717791411043

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.39528071880340576
	RegressionCompetitionScore: 0.06533742331288343

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.3957790732383728
	RegressionCompetitionScore: 0.06503067484662577



Validation scores:
	RegressionAUROC: 0.39615577459335327
	RegressionCompetitionScore: 0.06503067484662577



Validation scores:
	RegressionAUROC: 0.3965909779071808
	RegressionCompetitionScore: 0.06779141104294478



Validation scores:
	RegressionAUROC: 0.3978741765022278
	RegressionCompetitionScore: 0.06717791411042945



Validation scores:
	RegressionAUROC: 0.39875829219818115
	RegressionCompetitionScore: 0.06840490797546012



Validation scores:
	RegressionAUROC: 0.40122970938682556
	RegressionCompetitionScore: 0.06533742331288343



Validation scores:
	RegressionAUROC: 0.40250858664512634
	RegressionCompetitionScore: 0.06073619631901841

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.217. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.06533742331288343
     Test RegressionAUROC            0.39528071880340576
Test RegressionCompetitionScore      0.06533742331288343
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 07:15:28,365][0m Trial 177 finished with value: 0.06533742331288343 and parameters: {'lr': 2.2425631401673444e-05, 'dropout': 0.42947869605159145, 'd_model_multiplier': 4, 'num_layers': 15, 'n_heads': 4, 'dim_feedforward': 141, 'batch_size': 1024, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00015295935162579395, 'dropout': 0.4621901248302888, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 642, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 343 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
343 K     Trainable params
0         Non-trainable params
343 K     Total params
1.376     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6306458711624146
	RegressionCompetitionScore: 0.28343558282208586

Metric val_loss improved. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.6906499862670898
	RegressionCompetitionScore: 0.3070552147239264

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.687185525894165
	RegressionCompetitionScore: 0.28957055214723926

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.7004994750022888
	RegressionCompetitionScore: 0.22300613496932514

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7235903739929199
	RegressionCompetitionScore: 0.33067484662576685

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7322977185249329
	RegressionCompetitionScore: 0.3487730061349693



Validation scores:
	RegressionAUROC: 0.7293909788131714
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7411319613456726
	RegressionCompetitionScore: 0.33220858895705524



Validation scores:
	RegressionAUROC: 0.7443479299545288
	RegressionCompetitionScore: 0.37760736196319017



Validation scores:
	RegressionAUROC: 0.7354844212532043
	RegressionCompetitionScore: 0.36134969325153377

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7427425384521484
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7403556108474731
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7368698716163635
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7478715777397156
	RegressionCompetitionScore: 0.3861963190184049



Validation scores:
	RegressionAUROC: 0.7554569244384766
	RegressionCompetitionScore: 0.39263803680981596

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.737831711769104
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7468144297599792
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7463319301605225
	RegressionCompetitionScore: 0.402760736196319



Validation scores:
	RegressionAUROC: 0.7377356886863708
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7409876585006714
	RegressionCompetitionScore: 0.403680981595092



Validation scores:
	RegressionAUROC: 0.7224017381668091
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7200912237167358
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.178. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.39263803680981596
     Test RegressionAUROC            0.7554569244384766
Test RegressionCompetitionScore      0.39263803680981596
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 07:28:23,747][0m Trial 178 finished with value: 0.39263803680981596 and parameters: {'lr': 0.00015295935162579395, 'dropout': 0.4621901248302888, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 642, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00016861661336209656, 'dropout': 0.4657804004776753, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 584, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 317 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
317 K     Trainable params
0         Non-trainable params
317 K     Total params
1.268     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4788554310798645
	RegressionCompetitionScore: 0.04754601226993865

Metric val_loss improved. New best score: 0.256


Validation scores:
	RegressionAUROC: 0.5885925889015198
	RegressionCompetitionScore: 0.15061349693251533

Metric val_loss improved by 0.044 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.6153872013092041
	RegressionCompetitionScore: 0.24355828220858897

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6499887108802795
	RegressionCompetitionScore: 0.0950920245398773

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6597516536712646
	RegressionCompetitionScore: 0.10705521472392639



Validation scores:
	RegressionAUROC: 0.6702819466590881
	RegressionCompetitionScore: 0.12208588957055215



Validation scores:
	RegressionAUROC: 0.6677536964416504
	RegressionCompetitionScore: 0.21411042944785277

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6946988701820374
	RegressionCompetitionScore: 0.27392638036809813



Validation scores:
	RegressionAUROC: 0.7059799432754517
	RegressionCompetitionScore: 0.33220858895705524

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7105364799499512
	RegressionCompetitionScore: 0.3414110429447853



Validation scores:
	RegressionAUROC: 0.7151966094970703
	RegressionCompetitionScore: 0.35030674846625764



Validation scores:
	RegressionAUROC: 0.715425968170166
	RegressionCompetitionScore: 0.35644171779141104



Validation scores:
	RegressionAUROC: 0.7363396286964417
	RegressionCompetitionScore: 0.36012269938650304



Validation scores:
	RegressionAUROC: 0.7327905893325806
	RegressionCompetitionScore: 0.3392638036809816

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7397326231002808
	RegressionCompetitionScore: 0.3773006134969325

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7498350143432617
	RegressionCompetitionScore: 0.37668711656441717



Validation scores:
	RegressionAUROC: 0.7411631345748901
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7298147678375244
	RegressionCompetitionScore: 0.35030674846625764



Validation scores:
	RegressionAUROC: 0.7417080402374268
	RegressionCompetitionScore: 0.34938650306748464



Validation scores:
	RegressionAUROC: 0.7444673776626587
	RegressionCompetitionScore: 0.35276073619631904

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7450388669967651
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7416373491287231
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7340002059936523
	RegressionCompetitionScore: 0.3352760736196319



Validation scores:
	RegressionAUROC: 0.7333276271820068
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7561048269271851
	RegressionCompetitionScore: 0.3904907975460123

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7492926120758057
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7457388043403625
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7414827346801758
	RegressionCompetitionScore: 0.3441717791411043



Validation scores:
	RegressionAUROC: 0.7480786442756653
	RegressionCompetitionScore: 0.3585889570552147



Validation scores:
	RegressionAUROC: 0.7267451286315918
	RegressionCompetitionScore: 0.26196319018404907



Validation scores:
	RegressionAUROC: 0.7446305751800537
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7373596429824829
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.173. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3904907975460123
     Test RegressionAUROC            0.7561048269271851
Test RegressionCompetitionScore      0.3904907975460123
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 07:46:51,595][0m Trial 179 finished with value: 0.3904907975460123 and parameters: {'lr': 0.00016861661336209656, 'dropout': 0.4657804004776753, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 584, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00017368883665365117, 'dropout': 0.45151706144784076, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 649, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 347 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
347 K     Trainable params
0         Non-trainable params
347 K     Total params
1.389     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6811594367027283
	RegressionCompetitionScore: 0.5217391304347826



Validation scores:
	RegressionAUROC: 0.5714681148529053
	RegressionCompetitionScore: 0.16441717791411042

Metric val_loss improved. New best score: 0.239


Validation scores:
	RegressionAUROC: 0.5781322717666626
	RegressionCompetitionScore: 0.1619631901840491

Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5774798393249512
	RegressionCompetitionScore: 0.15613496932515336



Validation scores:
	RegressionAUROC: 0.5711690187454224
	RegressionCompetitionScore: 0.12975460122699387



Validation scores:
	RegressionAUROC: 0.5415987372398376
	RegressionCompetitionScore: 0.06993865030674846



Validation scores:
	RegressionAUROC: 0.5257304906845093
	RegressionCompetitionScore: 0.0549079754601227



Validation scores:
	RegressionAUROC: 0.5396762490272522
	RegressionCompetitionScore: 0.057975460122699385



Validation scores:
	RegressionAUROC: 0.5534449815750122
	RegressionCompetitionScore: 0.056134969325153376



Validation scores:
	RegressionAUROC: 0.569216787815094
	RegressionCompetitionScore: 0.05766871165644172

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1619631901840491
     Test RegressionAUROC            0.5781322717666626
Test RegressionCompetitionScore      0.1619631901840491
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 07:52:26,061][0m Trial 180 finished with value: 0.1619631901840491 and parameters: {'lr': 0.00017368883665365117, 'dropout': 0.45151706144784076, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 649, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0001397085384791283, 'dropout': 0.4693156386188853, 'd_model_multiplier': 1, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 597, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 302 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
302 K     Trainable params
0         Non-trainable params
302 K     Total params
1.209     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.47342991828918457
	RegressionCompetitionScore: 0.30434782608695654



Validation scores:
	RegressionAUROC: 0.5792242288589478
	RegressionCompetitionScore: 0.24355828220858897

Metric val_loss improved. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.5844148993492126
	RegressionCompetitionScore: 0.25736196319018406

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6051174402236938
	RegressionCompetitionScore: 0.27392638036809813

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6739767789840698
	RegressionCompetitionScore: 0.26196319018404907



Validation scores:
	RegressionAUROC: 0.6991773247718811
	RegressionCompetitionScore: 0.28865030674846626



Validation scores:
	RegressionAUROC: 0.7160292863845825
	RegressionCompetitionScore: 0.3285276073619632



Validation scores:
	RegressionAUROC: 0.7320204973220825
	RegressionCompetitionScore: 0.3506134969325153

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7283704280853271
	RegressionCompetitionScore: 0.36257668711656443

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7368370294570923
	RegressionCompetitionScore: 0.3496932515337423



Validation scores:
	RegressionAUROC: 0.7344227433204651
	RegressionCompetitionScore: 0.3773006134969325



Validation scores:
	RegressionAUROC: 0.7381079196929932
	RegressionCompetitionScore: 0.3871165644171779



Validation scores:
	RegressionAUROC: 0.7376635074615479
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.735846221446991
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7481341361999512
	RegressionCompetitionScore: 0.36595092024539877



Validation scores:
	RegressionAUROC: 0.7449239492416382
	RegressionCompetitionScore: 0.35920245398773004

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.176. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36257668711656443
     Test RegressionAUROC            0.7283704280853271
Test RegressionCompetitionScore      0.36257668711656443
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 08:01:03,356][0m Trial 181 finished with value: 0.36257668711656443 and parameters: {'lr': 0.0001397085384791283, 'dropout': 0.4693156386188853, 'd_model_multiplier': 1, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 597, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0002193681578648532, 'dropout': 0.46358487051865965, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 635, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 340 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
340 K     Trainable params
0         Non-trainable params
340 K     Total params
1.363     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6434040069580078
	RegressionCompetitionScore: 0.2644171779141104

Metric val_loss improved. New best score: 0.237


Validation scores:
	RegressionAUROC: 0.6305726766586304
	RegressionCompetitionScore: 0.294478527607362



Validation scores:
	RegressionAUROC: 0.6466814279556274
	RegressionCompetitionScore: 0.30736196319018405

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.6149345636367798
	RegressionCompetitionScore: 0.27699386503067486

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.6361911296844482
	RegressionCompetitionScore: 0.3300613496932515

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.6259799003601074
	RegressionCompetitionScore: 0.2978527607361963

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.627403199672699
	RegressionCompetitionScore: 0.2901840490797546

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5307000875473022
	RegressionCompetitionScore: 0.03987730061349693



Validation scores:
	RegressionAUROC: 0.48051324486732483
	RegressionCompetitionScore: 0.06687116564417178



Validation scores:
	RegressionAUROC: 0.5227628946304321
	RegressionCompetitionScore: 0.057975460122699385



Validation scores:
	RegressionAUROC: 0.6231718063354492
	RegressionCompetitionScore: 0.10061349693251534



Validation scores:
	RegressionAUROC: 0.6380294561386108
	RegressionCompetitionScore: 0.09079754601226994



Validation scores:
	RegressionAUROC: 0.5294376611709595
	RegressionCompetitionScore: 0.07423312883435583



Validation scores:
	RegressionAUROC: 0.41830673813819885
	RegressionCompetitionScore: 0.11319018404907975

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2901840490797546
     Test RegressionAUROC             0.627403199672699
Test RegressionCompetitionScore      0.2901840490797546
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 08:09:24,898][0m Trial 182 finished with value: 0.2901840490797546 and parameters: {'lr': 0.0002193681578648532, 'dropout': 0.46358487051865965, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 635, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00010238599530581268, 'dropout': 0.4447029251378274, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 558, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 305 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
305 K     Trainable params
0         Non-trainable params
305 K     Total params
1.220     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5975387096405029
	RegressionCompetitionScore: 0.07300613496932515

Metric val_loss improved. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6249434947967529
	RegressionCompetitionScore: 0.07760736196319018

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.5879180431365967
	RegressionCompetitionScore: 0.04969325153374233



Validation scores:
	RegressionAUROC: 0.6653084754943848
	RegressionCompetitionScore: 0.1

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.707598090171814
	RegressionCompetitionScore: 0.25950920245398773

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.7262462973594666
	RegressionCompetitionScore: 0.3380368098159509

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7312384843826294
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7319920063018799
	RegressionCompetitionScore: 0.3273006134969325



Validation scores:
	RegressionAUROC: 0.730230987071991
	RegressionCompetitionScore: 0.3239263803680982



Validation scores:
	RegressionAUROC: 0.7269041538238525
	RegressionCompetitionScore: 0.3460122699386503



Validation scores:
	RegressionAUROC: 0.7320156097412109
	RegressionCompetitionScore: 0.293558282208589



Validation scores:
	RegressionAUROC: 0.7179737091064453
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7244828343391418
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3380368098159509
     Test RegressionAUROC            0.7262462973594666
Test RegressionCompetitionScore      0.3380368098159509
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 08:17:11,046][0m Trial 183 finished with value: 0.3380368098159509 and parameters: {'lr': 0.00010238599530581268, 'dropout': 0.4447029251378274, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 558, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 6.35150676479251e-05, 'dropout': 0.4772485054829092, 'd_model_multiplier': 1, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 615, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 309 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
309 K     Trainable params
0         Non-trainable params
309 K     Total params
1.240     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5375946760177612
	RegressionCompetitionScore: 0.12668711656441717

Metric val_loss improved. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.5991048812866211
	RegressionCompetitionScore: 0.1156441717791411



Validation scores:
	RegressionAUROC: 0.6347377300262451
	RegressionCompetitionScore: 0.2558282208588957



Validation scores:
	RegressionAUROC: 0.6862248182296753
	RegressionCompetitionScore: 0.15122699386503066



Validation scores:
	RegressionAUROC: 0.7224113941192627
	RegressionCompetitionScore: 0.29478527607361965



Validation scores:
	RegressionAUROC: 0.7346301674842834
	RegressionCompetitionScore: 0.3337423312883436



Validation scores:
	RegressionAUROC: 0.7317298650741577
	RegressionCompetitionScore: 0.33067484662576685



Validation scores:
	RegressionAUROC: 0.741058349609375
	RegressionCompetitionScore: 0.34294478527607364

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.206. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.12668711656441717
     Test RegressionAUROC            0.5375946760177612
Test RegressionCompetitionScore      0.12668711656441717
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 08:22:01,614][0m Trial 184 finished with value: 0.12668711656441717 and parameters: {'lr': 6.35150676479251e-05, 'dropout': 0.4772485054829092, 'd_model_multiplier': 1, 'num_layers': 13, 'n_heads': 16, 'dim_feedforward': 615, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00015294025343664535, 'dropout': 0.4542180820627907, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 528, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 291 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
291 K     Trainable params
0         Non-trainable params
291 K     Total params
1.165     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6304347515106201
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.41970670223236084
	RegressionCompetitionScore: 0.09417177914110429

Metric val_loss improved. New best score: 0.284


Validation scores:
	RegressionAUROC: 0.45505815744400024
	RegressionCompetitionScore: 0.1058282208588957

Metric val_loss improved by 0.075 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.4915367364883423
	RegressionCompetitionScore: 0.11042944785276074



Validation scores:
	RegressionAUROC: 0.4875912070274353
	RegressionCompetitionScore: 0.10797546012269939

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5753874778747559
	RegressionCompetitionScore: 0.11871165644171779



Validation scores:
	RegressionAUROC: 0.6961690187454224
	RegressionCompetitionScore: 0.3187116564417178



Validation scores:
	RegressionAUROC: 0.7242965698242188
	RegressionCompetitionScore: 0.3128834355828221

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7206315994262695
	RegressionCompetitionScore: 0.33067484662576685



Validation scores:
	RegressionAUROC: 0.7319049835205078
	RegressionCompetitionScore: 0.31901840490797545



Validation scores:
	RegressionAUROC: 0.7368000149726868
	RegressionCompetitionScore: 0.32791411042944785



Validation scores:
	RegressionAUROC: 0.7488420605659485
	RegressionCompetitionScore: 0.37944785276073617

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7494025230407715
	RegressionCompetitionScore: 0.37791411042944784



Validation scores:
	RegressionAUROC: 0.7226487398147583
	RegressionCompetitionScore: 0.32239263803680984



Validation scores:
	RegressionAUROC: 0.7440625429153442
	RegressionCompetitionScore: 0.3588957055214724



Validation scores:
	RegressionAUROC: 0.7430391311645508
	RegressionCompetitionScore: 0.3558282208588957



Validation scores:
	RegressionAUROC: 0.745880126953125
	RegressionCompetitionScore: 0.35184049079754603



Validation scores:
	RegressionAUROC: 0.7543946504592896
	RegressionCompetitionScore: 0.36073619631901843



Validation scores:
	RegressionAUROC: 0.753026008605957
	RegressionCompetitionScore: 0.36533742331288344

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.169. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37944785276073617
     Test RegressionAUROC            0.7488420605659485
Test RegressionCompetitionScore      0.37944785276073617
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 08:32:41,897][0m Trial 185 finished with value: 0.37944785276073617 and parameters: {'lr': 0.00015294025343664535, 'dropout': 0.4542180820627907, 'd_model_multiplier': 1, 'num_layers': 14, 'n_heads': 16, 'dim_feedforward': 528, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.000273557678551476, 'dropout': 0.46219642567126096, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 16, 'dim_feedforward': 626, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 96.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
96.4 K    Trainable params
0         Non-trainable params
96.4 K    Total params
0.386     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.512077271938324
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.71175616979599
	RegressionCompetitionScore: 0.2579754601226994

Metric val_loss improved. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7273597121238708
	RegressionCompetitionScore: 0.34662576687116564

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7272155284881592
	RegressionCompetitionScore: 0.3674846625766871



Validation scores:
	RegressionAUROC: 0.7267374396324158
	RegressionCompetitionScore: 0.38404907975460123



Validation scores:
	RegressionAUROC: 0.7470403909683228
	RegressionCompetitionScore: 0.3889570552147239



Validation scores:
	RegressionAUROC: 0.7488478422164917
	RegressionCompetitionScore: 0.4371165644171779

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7519199252128601
	RegressionCompetitionScore: 0.3911042944785276



Validation scores:
	RegressionAUROC: 0.7518285512924194
	RegressionCompetitionScore: 0.37055214723926383



Validation scores:
	RegressionAUROC: 0.7323194742202759
	RegressionCompetitionScore: 0.30122699386503066



Validation scores:
	RegressionAUROC: 0.7536306381225586
	RegressionCompetitionScore: 0.34355828220858897



Validation scores:
	RegressionAUROC: 0.7551674842834473
	RegressionCompetitionScore: 0.36134969325153377



Validation scores:
	RegressionAUROC: 0.7630771398544312
	RegressionCompetitionScore: 0.3871165644171779

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7529088258743286
	RegressionCompetitionScore: 0.3843558282208589



Validation scores:
	RegressionAUROC: 0.7592062950134277
	RegressionCompetitionScore: 0.39570552147239263

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.771310567855835
	RegressionCompetitionScore: 0.4058282208588957



Validation scores:
	RegressionAUROC: 0.7779422998428345
	RegressionCompetitionScore: 0.3969325153374233



Validation scores:
	RegressionAUROC: 0.7657583355903625
	RegressionCompetitionScore: 0.36871165644171777



Validation scores:
	RegressionAUROC: 0.7571498155593872
	RegressionCompetitionScore: 0.3407975460122699



Validation scores:
	RegressionAUROC: 0.7675927877426147
	RegressionCompetitionScore: 0.37791411042944784



Validation scores:
	RegressionAUROC: 0.7688575983047485
	RegressionCompetitionScore: 0.41042944785276075



Validation scores:
	RegressionAUROC: 0.7731853127479553
	RegressionCompetitionScore: 0.40736196319018403

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.166. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.39570552147239263
     Test RegressionAUROC            0.7592062950134277
Test RegressionCompetitionScore      0.39570552147239263
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 08:41:23,477][0m Trial 186 finished with value: 0.39570552147239263 and parameters: {'lr': 0.000273557678551476, 'dropout': 0.46219642567126096, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 16, 'dim_feedforward': 626, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 1.4594014141990447e-05, 'dropout': 0.4638616465697683, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 16, 'dim_feedforward': 639, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 97.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
90.5 K    Trainable params
7.2 K     Non-trainable params
97.7 K    Total params
0.391     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.5837955474853516
	RegressionCompetitionScore: 0.15920245398773006

Metric val_loss improved. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.6279011964797974
	RegressionCompetitionScore: 0.24141104294478527

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6569592952728271
	RegressionCompetitionScore: 0.26901840490797546

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.6790759563446045
	RegressionCompetitionScore: 0.29478527607361965

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.6897413730621338
	RegressionCompetitionScore: 0.2822085889570552



Validation scores:
	RegressionAUROC: 0.6942510604858398
	RegressionCompetitionScore: 0.2794478527607362



Validation scores:
	RegressionAUROC: 0.6960262656211853
	RegressionCompetitionScore: 0.2871165644171779



Validation scores:
	RegressionAUROC: 0.7045387029647827
	RegressionCompetitionScore: 0.2865030674846626



Validation scores:
	RegressionAUROC: 0.7072849273681641
	RegressionCompetitionScore: 0.2874233128834356



Validation scores:
	RegressionAUROC: 0.7088973522186279
	RegressionCompetitionScore: 0.2674846625766871



Validation scores:
	RegressionAUROC: 0.7076675295829773
	RegressionCompetitionScore: 0.2687116564417178

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7042884826660156
	RegressionCompetitionScore: 0.26993865030674846



Validation scores:
	RegressionAUROC: 0.7055548429489136
	RegressionCompetitionScore: 0.27515337423312886

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7102828025817871
	RegressionCompetitionScore: 0.2745398773006135



Validation scores:
	RegressionAUROC: 0.7095311880111694
	RegressionCompetitionScore: 0.2745398773006135



Validation scores:
	RegressionAUROC: 0.7142633199691772
	RegressionCompetitionScore: 0.27607361963190186



Validation scores:
	RegressionAUROC: 0.7150514125823975
	RegressionCompetitionScore: 0.28957055214723926



Validation scores:
	RegressionAUROC: 0.7168364524841309
	RegressionCompetitionScore: 0.2917177914110429



Validation scores:
	RegressionAUROC: 0.7191460132598877
	RegressionCompetitionScore: 0.2883435582822086



Validation scores:
	RegressionAUROC: 0.7193892002105713
	RegressionCompetitionScore: 0.2889570552147239

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.183. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.27515337423312886
     Test RegressionAUROC            0.7055548429489136
Test RegressionCompetitionScore      0.27515337423312886
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 08:49:35,673][0m Trial 187 finished with value: 0.27515337423312886 and parameters: {'lr': 1.4594014141990447e-05, 'dropout': 0.4638616465697683, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 16, 'dim_feedforward': 639, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00042890246242731887, 'dropout': 0.47083737520156105, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 16, 'dim_feedforward': 583, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 112 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
112 K     Trainable params
0         Non-trainable params
112 K     Total params
0.450     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.46859899163246155
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.6707847714424133
	RegressionCompetitionScore: 0.2570552147239264

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.643478512763977
	RegressionCompetitionScore: 0.28282208588957053

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7062633037567139
	RegressionCompetitionScore: 0.31257668711656444

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6889260411262512
	RegressionCompetitionScore: 0.20920245398773007



Validation scores:
	RegressionAUROC: 0.7171242237091064
	RegressionCompetitionScore: 0.31257668711656444

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7418416142463684
	RegressionCompetitionScore: 0.37852760736196317

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7245050668716431
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7325038909912109
	RegressionCompetitionScore: 0.344478527607362



Validation scores:
	RegressionAUROC: 0.7253432273864746
	RegressionCompetitionScore: 0.35184049079754603



Validation scores:
	RegressionAUROC: 0.7355571985244751
	RegressionCompetitionScore: 0.347239263803681



Validation scores:
	RegressionAUROC: 0.7542462944984436
	RegressionCompetitionScore: 0.3628834355828221



Validation scores:
	RegressionAUROC: 0.7550545930862427
	RegressionCompetitionScore: 0.38865030674846623



Validation scores:
	RegressionAUROC: 0.7622640132904053
	RegressionCompetitionScore: 0.38926380368098157

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.172. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37852760736196317
     Test RegressionAUROC            0.7418416142463684
Test RegressionCompetitionScore      0.37852760736196317
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 08:55:10,213][0m Trial 188 finished with value: 0.37852760736196317 and parameters: {'lr': 0.00042890246242731887, 'dropout': 0.47083737520156105, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 16, 'dim_feedforward': 583, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00028471501319953104, 'dropout': 0.4949059899752667, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 16, 'dim_feedforward': 664, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 77.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
77.1 K    Trainable params
0         Non-trainable params
77.1 K    Total params
0.308     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4637681245803833
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6739674806594849
	RegressionCompetitionScore: 0.18803680981595092

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.7141873836517334
	RegressionCompetitionScore: 0.2926380368098159

Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7152261137962341
	RegressionCompetitionScore: 0.31441717791411045



Validation scores:
	RegressionAUROC: 0.7157193422317505
	RegressionCompetitionScore: 0.29233128834355826



Validation scores:
	RegressionAUROC: 0.7323669195175171
	RegressionCompetitionScore: 0.34294478527607364

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7364360094070435
	RegressionCompetitionScore: 0.3604294478527607



Validation scores:
	RegressionAUROC: 0.7437452077865601
	RegressionCompetitionScore: 0.32515337423312884



Validation scores:
	RegressionAUROC: 0.7451932430267334
	RegressionCompetitionScore: 0.36687116564417177

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.729475200176239
	RegressionCompetitionScore: 0.34294478527607364



Validation scores:
	RegressionAUROC: 0.740260124206543
	RegressionCompetitionScore: 0.38098159509202456



Validation scores:
	RegressionAUROC: 0.7456632852554321
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7411928176879883
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7455864548683167
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.734942615032196
	RegressionCompetitionScore: 0.34662576687116564



Validation scores:
	RegressionAUROC: 0.745928943157196
	RegressionCompetitionScore: 0.35460122699386504

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.173. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36687116564417177
     Test RegressionAUROC            0.7451932430267334
Test RegressionCompetitionScore      0.36687116564417177
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 09:01:23,362][0m Trial 189 finished with value: 0.36687116564417177 and parameters: {'lr': 0.00028471501319953104, 'dropout': 0.4949059899752667, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 16, 'dim_feedforward': 664, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0001853377716023244, 'dropout': 0.4833997666595295, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 16, 'dim_feedforward': 626, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 183 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
176 K     Trainable params
7.2 K     Non-trainable params
183 K     Total params
0.735     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6666666269302368
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5075201988220215
	RegressionCompetitionScore: 0.13006134969325153

Metric val_loss improved. New best score: 0.314


Validation scores:
	RegressionAUROC: 0.5522096157073975
	RegressionCompetitionScore: 0.08957055214723926

Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.271


Validation scores:
	RegressionAUROC: 0.5842604637145996
	RegressionCompetitionScore: 0.10521472392638037

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.257


Validation scores:
	RegressionAUROC: 0.5800530910491943
	RegressionCompetitionScore: 0.11257668711656442

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.6298157572746277
	RegressionCompetitionScore: 0.13865030674846626

Metric val_loss improved by 0.051 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6608037948608398
	RegressionCompetitionScore: 0.18957055214723925



Validation scores:
	RegressionAUROC: 0.7094104290008545
	RegressionCompetitionScore: 0.32791411042944785

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7094703316688538
	RegressionCompetitionScore: 0.33220858895705524

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.6458624601364136
	RegressionCompetitionScore: 0.2883435582822086



Validation scores:
	RegressionAUROC: 0.6589840650558472
	RegressionCompetitionScore: 0.2929447852760736



Validation scores:
	RegressionAUROC: 0.7154362797737122
	RegressionCompetitionScore: 0.33067484662576685



Validation scores:
	RegressionAUROC: 0.7099463939666748
	RegressionCompetitionScore: 0.3294478527607362

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7240648865699768
	RegressionCompetitionScore: 0.3656441717791411

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7213045358657837
	RegressionCompetitionScore: 0.3334355828220859



Validation scores:
	RegressionAUROC: 0.7111233472824097
	RegressionCompetitionScore: 0.3006134969325153

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7129632234573364
	RegressionCompetitionScore: 0.3076687116564417

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7293261885643005
	RegressionCompetitionScore: 0.3708588957055215

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7274285554885864
	RegressionCompetitionScore: 0.3610429447852761



Validation scores:
	RegressionAUROC: 0.6670689582824707
	RegressionCompetitionScore: 0.22791411042944784



Validation scores:
	RegressionAUROC: 0.7130082845687866
	RegressionCompetitionScore: 0.3088957055214724



Validation scores:
	RegressionAUROC: 0.7287884950637817
	RegressionCompetitionScore: 0.3576687116564417



Validation scores:
	RegressionAUROC: 0.7284701466560364
	RegressionCompetitionScore: 0.33957055214723925



Validation scores:
	RegressionAUROC: 0.7338829040527344
	RegressionCompetitionScore: 0.3745398773006135



Validation scores:
	RegressionAUROC: 0.7221288681030273
	RegressionCompetitionScore: 0.35521472392638037

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3708588957055215
     Test RegressionAUROC            0.7293261885643005
Test RegressionCompetitionScore      0.3708588957055215
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 09:12:38,764][0m Trial 190 finished with value: 0.3708588957055215 and parameters: {'lr': 0.0001853377716023244, 'dropout': 0.4833997666595295, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 16, 'dim_feedforward': 626, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.00022048373040230182, 'dropout': 0.45087649857345147, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 601, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 55.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
55.2 K    Trainable params
0         Non-trainable params
55.2 K    Total params
0.221     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.31884056329727173
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6263063549995422
	RegressionCompetitionScore: 0.12515337423312883

Metric val_loss improved. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6667084693908691
	RegressionCompetitionScore: 0.27392638036809813

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.704382598400116
	RegressionCompetitionScore: 0.34355828220858897

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.711755633354187
	RegressionCompetitionScore: 0.35828220858895704



Validation scores:
	RegressionAUROC: 0.714221715927124
	RegressionCompetitionScore: 0.35460122699386504



Validation scores:
	RegressionAUROC: 0.7266064882278442
	RegressionCompetitionScore: 0.3708588957055215

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7288214564323425
	RegressionCompetitionScore: 0.3576687116564417



Validation scores:
	RegressionAUROC: 0.7141658067703247
	RegressionCompetitionScore: 0.3104294478527607



Validation scores:
	RegressionAUROC: 0.730147659778595
	RegressionCompetitionScore: 0.35276073619631904

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7539420127868652
	RegressionCompetitionScore: 0.3441717791411043



Validation scores:
	RegressionAUROC: 0.7492311000823975
	RegressionCompetitionScore: 0.3460122699386503



Validation scores:
	RegressionAUROC: 0.7515301704406738
	RegressionCompetitionScore: 0.36809815950920244

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.748131513595581
	RegressionCompetitionScore: 0.3628834355828221

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7417047023773193
	RegressionCompetitionScore: 0.38190184049079756



Validation scores:
	RegressionAUROC: 0.7628626823425293
	RegressionCompetitionScore: 0.38680981595092023

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7596419453620911
	RegressionCompetitionScore: 0.35030674846625764



Validation scores:
	RegressionAUROC: 0.759888768196106
	RegressionCompetitionScore: 0.3825153374233129



Validation scores:
	RegressionAUROC: 0.7567014694213867
	RegressionCompetitionScore: 0.37668711656441717



Validation scores:
	RegressionAUROC: 0.7544349431991577
	RegressionCompetitionScore: 0.4012269938650307



Validation scores:
	RegressionAUROC: 0.7702252268791199
	RegressionCompetitionScore: 0.3604294478527607



Validation scores:
	RegressionAUROC: 0.7707812190055847
	RegressionCompetitionScore: 0.4236196319018405



Validation scores:
	RegressionAUROC: 0.7683890461921692
	RegressionCompetitionScore: 0.4144171779141104

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.166. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38680981595092023
     Test RegressionAUROC            0.7628626823425293
Test RegressionCompetitionScore      0.38680981595092023
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 09:21:58,425][0m Trial 191 finished with value: 0.38680981595092023 and parameters: {'lr': 0.00022048373040230182, 'dropout': 0.45087649857345147, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 601, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0002546382286414211, 'dropout': 0.4465155082821805, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 681, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 71.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
71.2 K    Trainable params
0         Non-trainable params
71.2 K    Total params
0.285     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3550724387168884
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6506868600845337
	RegressionCompetitionScore: 0.13067484662576687

Metric val_loss improved. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.6732323169708252
	RegressionCompetitionScore: 0.2411042944785276

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6948843002319336
	RegressionCompetitionScore: 0.252760736196319

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7166869640350342
	RegressionCompetitionScore: 0.27607361963190186

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7305973768234253
	RegressionCompetitionScore: 0.3604294478527607

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7326754331588745
	RegressionCompetitionScore: 0.38987730061349696



Validation scores:
	RegressionAUROC: 0.7355986833572388
	RegressionCompetitionScore: 0.37331288343558283



Validation scores:
	RegressionAUROC: 0.733069896697998
	RegressionCompetitionScore: 0.3496932515337423



Validation scores:
	RegressionAUROC: 0.7330583333969116
	RegressionCompetitionScore: 0.3585889570552147



Validation scores:
	RegressionAUROC: 0.7167739868164062
	RegressionCompetitionScore: 0.3407975460122699



Validation scores:
	RegressionAUROC: 0.7376717925071716
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7205114364624023
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.172. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3604294478527607
     Test RegressionAUROC            0.7305973768234253
Test RegressionCompetitionScore      0.3604294478527607
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 09:27:15,996][0m Trial 192 finished with value: 0.3604294478527607 and parameters: {'lr': 0.0002546382286414211, 'dropout': 0.4465155082821805, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 681, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 92 with value: 0.42760736196319016.[0m
Starting trial with params:
{'lr': 0.0005839760231696869, 'dropout': 0.45957225154269477, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 611, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 55.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
55.7 K    Trainable params
0         Non-trainable params
55.7 K    Total params
0.223     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7342995405197144
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.6630270481109619
	RegressionCompetitionScore: 0.11932515337423313

Metric val_loss improved. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6771535277366638
	RegressionCompetitionScore: 0.2969325153374233

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6885789036750793
	RegressionCompetitionScore: 0.27515337423312886



Validation scores:
	RegressionAUROC: 0.7110273838043213
	RegressionCompetitionScore: 0.36257668711656443

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7280468940734863
	RegressionCompetitionScore: 0.38680981595092023



Validation scores:
	RegressionAUROC: 0.7206327319145203
	RegressionCompetitionScore: 0.34662576687116564



Validation scores:
	RegressionAUROC: 0.7289450764656067
	RegressionCompetitionScore: 0.38128834355828223

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7316498160362244
	RegressionCompetitionScore: 0.40736196319018403



Validation scores:
	RegressionAUROC: 0.730441153049469
	RegressionCompetitionScore: 0.35644171779141104



Validation scores:
	RegressionAUROC: 0.7461159229278564
	RegressionCompetitionScore: 0.4223926380368098



Validation scores:
	RegressionAUROC: 0.7570070028305054
	RegressionCompetitionScore: 0.39355828220858896

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7532497644424438
	RegressionCompetitionScore: 0.38987730061349696



Validation scores:
	RegressionAUROC: 0.746745228767395
	RegressionCompetitionScore: 0.346319018404908



Validation scores:
	RegressionAUROC: 0.7708162069320679
	RegressionCompetitionScore: 0.45

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.774246335029602
	RegressionCompetitionScore: 0.39386503067484663



Validation scores:
	RegressionAUROC: 0.7816101312637329
	RegressionCompetitionScore: 0.4570552147239264

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7842756509780884
	RegressionCompetitionScore: 0.4420245398773006

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.158


Validation scores:
	RegressionAUROC: 0.7815313339233398
	RegressionCompetitionScore: 0.4696319018404908



Validation scores:
	RegressionAUROC: 0.7754629850387573
	RegressionCompetitionScore: 0.447239263803681



Validation scores:
	RegressionAUROC: 0.7896400094032288
	RegressionCompetitionScore: 0.42822085889570555



Validation scores:
	RegressionAUROC: 0.79505455493927
	RegressionCompetitionScore: 0.4484662576687117



Validation scores:
	RegressionAUROC: 0.7912362813949585
	RegressionCompetitionScore: 0.4423312883435583



Validation scores:
	RegressionAUROC: 0.7663204669952393
	RegressionCompetitionScore: 0.3334355828220859



Validation scores:
	RegressionAUROC: 0.7970248460769653
	RegressionCompetitionScore: 0.46717791411042947

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.158. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4420245398773006
     Test RegressionAUROC            0.7842756509780884
Test RegressionCompetitionScore      0.4420245398773006
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 09:37:15,855][0m Trial 193 finished with value: 0.4420245398773006 and parameters: {'lr': 0.0005839760231696869, 'dropout': 0.45957225154269477, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 611, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 193 with value: 0.4420245398773006.[0m
Starting trial with params:
{'lr': 0.0005197011289908794, 'dropout': 0.45977676620738517, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 600, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 55.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
55.2 K    Trainable params
0         Non-trainable params
55.2 K    Total params
0.221     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6369485855102539
	RegressionCompetitionScore: 0.27423312883435585

Metric val_loss improved. New best score: 0.296


Validation scores:
	RegressionAUROC: 0.6510637998580933
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.266


Validation scores:
	RegressionAUROC: 0.7287572622299194
	RegressionCompetitionScore: 0.3061349693251534

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.7382820248603821
	RegressionCompetitionScore: 0.3579754601226994

Metric val_loss improved by 0.062 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.766454815864563
	RegressionCompetitionScore: 0.37392638036809817

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7662171721458435
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7613115310668945
	RegressionCompetitionScore: 0.38404907975460123



Validation scores:
	RegressionAUROC: 0.7560060024261475
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7756481766700745
	RegressionCompetitionScore: 0.4273006134969325



Validation scores:
	RegressionAUROC: 0.7863056063652039
	RegressionCompetitionScore: 0.41595092024539876



Validation scores:
	RegressionAUROC: 0.7950305938720703
	RegressionCompetitionScore: 0.42116564417177915

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7628771662712097
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7758943438529968
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7730695605278015
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7940174341201782
	RegressionCompetitionScore: 0.4349693251533742

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.7888479828834534
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7845580577850342
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7830090522766113
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7825195789337158
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7798938751220703
	RegressionCompetitionScore: 0.3825153374233129



Validation scores:
	RegressionAUROC: 0.783576250076294
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7441021800041199
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.161. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4349693251533742
     Test RegressionAUROC            0.7940174341201782
Test RegressionCompetitionScore      0.4349693251533742
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 09:46:30,136][0m Trial 194 finished with value: 0.4349693251533742 and parameters: {'lr': 0.0005197011289908794, 'dropout': 0.45977676620738517, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 600, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 193 with value: 0.4420245398773006.[0m
Starting trial with params:
{'lr': 0.0006050403932569147, 'dropout': 0.457857693418305, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 602, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 55.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
55.3 K    Trainable params
0         Non-trainable params
55.3 K    Total params
0.221     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5314009785652161
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.6881639957427979
	RegressionCompetitionScore: 0.2263803680981595

Metric val_loss improved. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.7007699608802795
	RegressionCompetitionScore: 0.300920245398773

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7023618221282959
	RegressionCompetitionScore: 0.3782208588957055



Validation scores:
	RegressionAUROC: 0.7265864610671997
	RegressionCompetitionScore: 0.36165644171779143



Validation scores:
	RegressionAUROC: 0.7366694211959839
	RegressionCompetitionScore: 0.3825153374233129

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.76203852891922
	RegressionCompetitionScore: 0.38466257668711656

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7565968036651611
	RegressionCompetitionScore: 0.37239263803680983



Validation scores:
	RegressionAUROC: 0.7437776923179626
	RegressionCompetitionScore: 0.39079754601226996



Validation scores:
	RegressionAUROC: 0.758341372013092
	RegressionCompetitionScore: 0.3414110429447853



Validation scores:
	RegressionAUROC: 0.7738271951675415
	RegressionCompetitionScore: 0.39079754601226996

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7815340161323547
	RegressionCompetitionScore: 0.3920245398773006

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7637960910797119
	RegressionCompetitionScore: 0.4088957055214724



Validation scores:
	RegressionAUROC: 0.7714264392852783
	RegressionCompetitionScore: 0.4242331288343558



Validation scores:
	RegressionAUROC: 0.7789486646652222
	RegressionCompetitionScore: 0.4098159509202454



Validation scores:
	RegressionAUROC: 0.7700120210647583
	RegressionCompetitionScore: 0.4165644171779141



Validation scores:
	RegressionAUROC: 0.8115811347961426
	RegressionCompetitionScore: 0.4386503067484663

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.156


Validation scores:
	RegressionAUROC: 0.780420184135437
	RegressionCompetitionScore: 0.38128834355828223



Validation scores:
	RegressionAUROC: 0.8009794354438782
	RegressionCompetitionScore: 0.43466257668711655



Validation scores:
	RegressionAUROC: 0.7861941456794739
	RegressionCompetitionScore: 0.44877300613496934



Validation scores:
	RegressionAUROC: 0.7978740334510803
	RegressionCompetitionScore: 0.4174846625766871



Validation scores:
	RegressionAUROC: 0.7904321551322937
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7722904682159424
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.8008474111557007
	RegressionCompetitionScore: 0.42668711656441716

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.156. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4386503067484663
     Test RegressionAUROC            0.8115811347961426
Test RegressionCompetitionScore      0.4386503067484663
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 09:56:12,387][0m Trial 195 finished with value: 0.4386503067484663 and parameters: {'lr': 0.0006050403932569147, 'dropout': 0.457857693418305, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 602, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 193 with value: 0.4420245398773006.[0m
Starting trial with params:
{'lr': 0.0008225566842853196, 'dropout': 0.4587042928756004, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 575, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 53.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
53.9 K    Trainable params
0         Non-trainable params
53.9 K    Total params
0.216     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6525984406471252
	RegressionCompetitionScore: 0.2803680981595092

Metric val_loss improved. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.696209728717804
	RegressionCompetitionScore: 0.2684049079754601

Metric val_loss improved by 0.038 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7086048722267151
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7044360637664795
	RegressionCompetitionScore: 0.3138036809815951



Validation scores:
	RegressionAUROC: 0.7105560302734375
	RegressionCompetitionScore: 0.3131901840490798



Validation scores:
	RegressionAUROC: 0.71366286277771
	RegressionCompetitionScore: 0.3303680981595092



Validation scores:
	RegressionAUROC: 0.7148953676223755
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.717327356338501
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7304370999336243
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.186. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2684049079754601
     Test RegressionAUROC             0.696209728717804
Test RegressionCompetitionScore      0.2684049079754601
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 10:00:15,474][0m Trial 196 finished with value: 0.2684049079754601 and parameters: {'lr': 0.0008225566842853196, 'dropout': 0.4587042928756004, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 575, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 193 with value: 0.4420245398773006.[0m
Starting trial with params:
{'lr': 0.0006331946836117903, 'dropout': 0.47443003022974384, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 546, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 42.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
42.8 K    Trainable params
0         Non-trainable params
42.8 K    Total params
0.171     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6425120234489441
	RegressionCompetitionScore: 0.391304347826087



Validation scores:
	RegressionAUROC: 0.7321584224700928
	RegressionCompetitionScore: 0.3895705521472393

Metric val_loss improved. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7158767580986023
	RegressionCompetitionScore: 0.35368098159509204



Validation scores:
	RegressionAUROC: 0.7317649126052856
	RegressionCompetitionScore: 0.37024539877300616

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7386046648025513
	RegressionCompetitionScore: 0.3684049079754601



Validation scores:
	RegressionAUROC: 0.7244778871536255
	RegressionCompetitionScore: 0.3619631901840491



Validation scores:
	RegressionAUROC: 0.7567751407623291
	RegressionCompetitionScore: 0.35920245398773004



Validation scores:
	RegressionAUROC: 0.7531806230545044
	RegressionCompetitionScore: 0.348159509202454

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7381165623664856
	RegressionCompetitionScore: 0.3128834355828221



Validation scores:
	RegressionAUROC: 0.7587816715240479
	RegressionCompetitionScore: 0.3726993865030675



Validation scores:
	RegressionAUROC: 0.7623170614242554
	RegressionCompetitionScore: 0.4245398773006135



Validation scores:
	RegressionAUROC: 0.7556077837944031
	RegressionCompetitionScore: 0.31012269938650305



Validation scores:
	RegressionAUROC: 0.7494924068450928
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7259971499443054
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.763117790222168
	RegressionCompetitionScore: 0.3914110429447853

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.167. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.348159509202454
     Test RegressionAUROC            0.7531806230545044
Test RegressionCompetitionScore       0.348159509202454
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 10:06:19,085][0m Trial 197 finished with value: 0.348159509202454 and parameters: {'lr': 0.0006331946836117903, 'dropout': 0.47443003022974384, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 546, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 193 with value: 0.4420245398773006.[0m
Starting trial with params:
{'lr': 0.0005005115833677953, 'dropout': 0.4367360590284169, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 611, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 55.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
55.7 K    Trainable params
0         Non-trainable params
55.7 K    Total params
0.223     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5169082283973694
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6675707697868347
	RegressionCompetitionScore: 0.22760736196319017

Metric val_loss improved. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.6569412350654602
	RegressionCompetitionScore: 0.30122699386503066

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.223


Validation scores:
	RegressionAUROC: 0.7160569429397583
	RegressionCompetitionScore: 0.3398773006134969



Validation scores:
	RegressionAUROC: 0.6637735366821289
	RegressionCompetitionScore: 0.21196319018404908

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7416266202926636
	RegressionCompetitionScore: 0.3736196319018405

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7487910985946655
	RegressionCompetitionScore: 0.38865030674846623



Validation scores:
	RegressionAUROC: 0.7499566674232483
	RegressionCompetitionScore: 0.3782208588957055



Validation scores:
	RegressionAUROC: 0.7491845488548279
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.7400639057159424
	RegressionCompetitionScore: 0.3319018404907976



Validation scores:
	RegressionAUROC: 0.7821900844573975
	RegressionCompetitionScore: 0.3911042944785276

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7634890675544739
	RegressionCompetitionScore: 0.36441717791411044



Validation scores:
	RegressionAUROC: 0.775958776473999
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7813204526901245
	RegressionCompetitionScore: 0.4352760736196319



Validation scores:
	RegressionAUROC: 0.7856573462486267
	RegressionCompetitionScore: 0.41226993865030676



Validation scores:
	RegressionAUROC: 0.7908387184143066
	RegressionCompetitionScore: 0.42576687116564416

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.786561131477356
	RegressionCompetitionScore: 0.4138036809815951



Validation scores:
	RegressionAUROC: 0.7872937321662903
	RegressionCompetitionScore: 0.4128834355828221



Validation scores:
	RegressionAUROC: 0.7958335876464844
	RegressionCompetitionScore: 0.45858895705521474

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7759090662002563
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7939445972442627
	RegressionCompetitionScore: 0.41687116564417176



Validation scores:
	RegressionAUROC: 0.7872042655944824
	RegressionCompetitionScore: 0.40153374233128836



Validation scores:
	RegressionAUROC: 0.7758203744888306
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7668362259864807
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7620978355407715
	RegressionCompetitionScore: 0.3871165644171779



Validation scores:
	RegressionAUROC: 0.7904963493347168
	RegressionCompetitionScore: 0.4331288343558282

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.162. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.45858895705521474
     Test RegressionAUROC            0.7958335876464844
Test RegressionCompetitionScore      0.45858895705521474
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 10:16:47,301][0m Trial 198 finished with value: 0.45858895705521474 and parameters: {'lr': 0.0005005115833677953, 'dropout': 0.4367360590284169, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 611, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00047317227387242393, 'dropout': 0.4320950556681704, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 599, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 55.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
55.1 K    Trainable params
0         Non-trainable params
55.1 K    Total params
0.220     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4927535951137543
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6765661239624023
	RegressionCompetitionScore: 0.1647239263803681

Metric val_loss improved. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6928606033325195
	RegressionCompetitionScore: 0.28588957055214725

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.7205448746681213
	RegressionCompetitionScore: 0.33496932515337424

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.739726722240448
	RegressionCompetitionScore: 0.38987730061349696

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7503794431686401
	RegressionCompetitionScore: 0.4012269938650307

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7570003271102905
	RegressionCompetitionScore: 0.40245398773006136



Validation scores:
	RegressionAUROC: 0.7515787482261658
	RegressionCompetitionScore: 0.39355828220858896

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7511165142059326
	RegressionCompetitionScore: 0.38404907975460123



Validation scores:
	RegressionAUROC: 0.745244026184082
	RegressionCompetitionScore: 0.34294478527607364



Validation scores:
	RegressionAUROC: 0.7587690353393555
	RegressionCompetitionScore: 0.32423312883435584



Validation scores:
	RegressionAUROC: 0.7722168564796448
	RegressionCompetitionScore: 0.36595092024539877



Validation scores:
	RegressionAUROC: 0.7608987092971802
	RegressionCompetitionScore: 0.3598159509202454



Validation scores:
	RegressionAUROC: 0.7589746713638306
	RegressionCompetitionScore: 0.3604294478527607

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7762410044670105
	RegressionCompetitionScore: 0.40061349693251536



Validation scores:
	RegressionAUROC: 0.7865777611732483
	RegressionCompetitionScore: 0.39662576687116563



Validation scores:
	RegressionAUROC: 0.7954082489013672
	RegressionCompetitionScore: 0.39969325153374236

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.159


Validation scores:
	RegressionAUROC: 0.7783907651901245
	RegressionCompetitionScore: 0.36779141104294477



Validation scores:
	RegressionAUROC: 0.7812692523002625
	RegressionCompetitionScore: 0.3914110429447853



Validation scores:
	RegressionAUROC: 0.774486780166626
	RegressionCompetitionScore: 0.3978527607361963



Validation scores:
	RegressionAUROC: 0.7885078191757202
	RegressionCompetitionScore: 0.36717791411042944



Validation scores:
	RegressionAUROC: 0.7839722037315369
	RegressionCompetitionScore: 0.38742331288343557



Validation scores:
	RegressionAUROC: 0.7732361555099487
	RegressionCompetitionScore: 0.35429447852760737



Validation scores:
	RegressionAUROC: 0.7800076603889465
	RegressionCompetitionScore: 0.3736196319018405

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.159. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.39969325153374236
     Test RegressionAUROC            0.7954082489013672
Test RegressionCompetitionScore      0.39969325153374236
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 10:26:28,041][0m Trial 199 finished with value: 0.39969325153374236 and parameters: {'lr': 0.00047317227387242393, 'dropout': 0.4320950556681704, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 599, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0011321844605191047, 'dropout': 0.4282963383024122, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 610, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 55.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
55.7 K    Trainable params
0         Non-trainable params
55.7 K    Total params
0.223     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7681158781051636
	RegressionCompetitionScore: 0.6086956521739131



Validation scores:
	RegressionAUROC: 0.703954815864563
	RegressionCompetitionScore: 0.26993865030674846

Metric val_loss improved. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.710511326789856
	RegressionCompetitionScore: 0.3052147239263804



Validation scores:
	RegressionAUROC: 0.7190138101577759
	RegressionCompetitionScore: 0.32883435582822085



Validation scores:
	RegressionAUROC: 0.7223029136657715
	RegressionCompetitionScore: 0.350920245398773



Validation scores:
	RegressionAUROC: 0.7060238122940063
	RegressionCompetitionScore: 0.3196319018404908

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7242594957351685
	RegressionCompetitionScore: 0.37975460122699384



Validation scores:
	RegressionAUROC: 0.7249799966812134
	RegressionCompetitionScore: 0.34049079754601225



Validation scores:
	RegressionAUROC: 0.7311596274375916
	RegressionCompetitionScore: 0.34570552147239264

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.732852578163147
	RegressionCompetitionScore: 0.32239263803680984



Validation scores:
	RegressionAUROC: 0.7346979379653931
	RegressionCompetitionScore: 0.3131901840490798



Validation scores:
	RegressionAUROC: 0.7403262853622437
	RegressionCompetitionScore: 0.3521472392638037



Validation scores:
	RegressionAUROC: 0.7423415184020996
	RegressionCompetitionScore: 0.35460122699386504



Validation scores:
	RegressionAUROC: 0.7370015382766724
	RegressionCompetitionScore: 0.32177914110429445



Validation scores:
	RegressionAUROC: 0.7394838333129883
	RegressionCompetitionScore: 0.32791411042944785



Validation scores:
	RegressionAUROC: 0.7472336292266846
	RegressionCompetitionScore: 0.34263803680981597

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.34570552147239264
     Test RegressionAUROC            0.7311596274375916
Test RegressionCompetitionScore      0.34570552147239264
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 10:32:56,792][0m Trial 200 finished with value: 0.34570552147239264 and parameters: {'lr': 0.0011321844605191047, 'dropout': 0.4282963383024122, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 610, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00048718494524619007, 'dropout': 0.4360922239929152, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 583, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 54.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
54.3 K    Trainable params
0         Non-trainable params
54.3 K    Total params
0.217     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5845410823822021
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.701400876045227
	RegressionCompetitionScore: 0.2917177914110429

Metric val_loss improved. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7046736478805542
	RegressionCompetitionScore: 0.2687116564417178



Validation scores:
	RegressionAUROC: 0.7285929918289185
	RegressionCompetitionScore: 0.35521472392638037

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7073997259140015
	RegressionCompetitionScore: 0.27208588957055213



Validation scores:
	RegressionAUROC: 0.7359091639518738
	RegressionCompetitionScore: 0.35030674846625764

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7529137134552002
	RegressionCompetitionScore: 0.36533742331288344

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.755652666091919
	RegressionCompetitionScore: 0.35429447852760737

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7428097724914551
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7313904762268066
	RegressionCompetitionScore: 0.2733128834355828



Validation scores:
	RegressionAUROC: 0.7545130252838135
	RegressionCompetitionScore: 0.38834355828220857



Validation scores:
	RegressionAUROC: 0.745657742023468
	RegressionCompetitionScore: 0.3478527607361963

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7492827773094177
	RegressionCompetitionScore: 0.3346625766871166

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7313346862792969
	RegressionCompetitionScore: 0.2705521472392638



Validation scores:
	RegressionAUROC: 0.7389330863952637
	RegressionCompetitionScore: 0.3441717791411043



Validation scores:
	RegressionAUROC: 0.7520267367362976
	RegressionCompetitionScore: 0.36411042944785277



Validation scores:
	RegressionAUROC: 0.7537972927093506
	RegressionCompetitionScore: 0.37392638036809817



Validation scores:
	RegressionAUROC: 0.7413498163223267
	RegressionCompetitionScore: 0.3407975460122699



Validation scores:
	RegressionAUROC: 0.739553689956665
	RegressionCompetitionScore: 0.38006134969325156



Validation scores:
	RegressionAUROC: 0.7285711765289307
	RegressionCompetitionScore: 0.25122699386503067

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.169. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3346625766871166
     Test RegressionAUROC            0.7492827773094177
Test RegressionCompetitionScore      0.3346625766871166
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 10:41:01,567][0m Trial 201 finished with value: 0.3346625766871166 and parameters: {'lr': 0.00048718494524619007, 'dropout': 0.4360922239929152, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 583, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.000621143163294205, 'dropout': 0.44193513478897245, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 621, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 56.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
56.2 K    Trainable params
0         Non-trainable params
56.2 K    Total params
0.225     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6785235404968262
	RegressionCompetitionScore: 0.30030674846625766

Metric val_loss improved. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7133141756057739
	RegressionCompetitionScore: 0.34478527607361964

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7198607325553894
	RegressionCompetitionScore: 0.32883435582822085



Validation scores:
	RegressionAUROC: 0.7119299173355103
	RegressionCompetitionScore: 0.3015337423312883



Validation scores:
	RegressionAUROC: 0.7291406989097595
	RegressionCompetitionScore: 0.2861963190184049



Validation scores:
	RegressionAUROC: 0.7348121404647827
	RegressionCompetitionScore: 0.3312883435582822



Validation scores:
	RegressionAUROC: 0.7406775951385498
	RegressionCompetitionScore: 0.3334355828220859



Validation scores:
	RegressionAUROC: 0.7496706247329712
	RegressionCompetitionScore: 0.3282208588957055



Validation scores:
	RegressionAUROC: 0.7601027488708496
	RegressionCompetitionScore: 0.36411042944785277

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.757952868938446
	RegressionCompetitionScore: 0.37607361963190183



Validation scores:
	RegressionAUROC: 0.7732905149459839
	RegressionCompetitionScore: 0.3914110429447853

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7603437900543213
	RegressionCompetitionScore: 0.3049079754601227



Validation scores:
	RegressionAUROC: 0.7547698616981506
	RegressionCompetitionScore: 0.2837423312883436



Validation scores:
	RegressionAUROC: 0.7695276737213135
	RegressionCompetitionScore: 0.34386503067484664



Validation scores:
	RegressionAUROC: 0.7716884613037109
	RegressionCompetitionScore: 0.3263803680981595



Validation scores:
	RegressionAUROC: 0.7615212202072144
	RegressionCompetitionScore: 0.23496932515337424



Validation scores:
	RegressionAUROC: 0.7842750549316406
	RegressionCompetitionScore: 0.4030674846625767

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7697281241416931
	RegressionCompetitionScore: 0.38650306748466257



Validation scores:
	RegressionAUROC: 0.7806092500686646
	RegressionCompetitionScore: 0.39815950920245397



Validation scores:
	RegressionAUROC: 0.7828885316848755
	RegressionCompetitionScore: 0.41779141104294476



Validation scores:
	RegressionAUROC: 0.7906454801559448
	RegressionCompetitionScore: 0.3978527607361963



Validation scores:
	RegressionAUROC: 0.7798181772232056
	RegressionCompetitionScore: 0.35337423312883437



Validation scores:
	RegressionAUROC: 0.7768893241882324
	RegressionCompetitionScore: 0.36441717791411044



Validation scores:
	RegressionAUROC: 0.7815527319908142
	RegressionCompetitionScore: 0.4012269938650307

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.162. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4030674846625767
     Test RegressionAUROC            0.7842750549316406
Test RegressionCompetitionScore      0.4030674846625767
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 10:51:04,635][0m Trial 202 finished with value: 0.4030674846625767 and parameters: {'lr': 0.000621143163294205, 'dropout': 0.44193513478897245, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 621, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0006321550257285002, 'dropout': 0.43507451247591616, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 630, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 56.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
56.7 K    Trainable params
0         Non-trainable params
56.7 K    Total params
0.227     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6763284802436829
	RegressionCompetitionScore: 0.4782608695652174



Validation scores:
	RegressionAUROC: 0.6488502025604248
	RegressionCompetitionScore: 0.09907975460122699

Metric val_loss improved. New best score: 0.241


Validation scores:
	RegressionAUROC: 0.6991877555847168
	RegressionCompetitionScore: 0.31441717791411045

Metric val_loss improved by 0.047 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7325845956802368
	RegressionCompetitionScore: 0.3579754601226994

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7264660596847534
	RegressionCompetitionScore: 0.35



Validation scores:
	RegressionAUROC: 0.7514241337776184
	RegressionCompetitionScore: 0.39478527607361963

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7560007572174072
	RegressionCompetitionScore: 0.39263803680981596



Validation scores:
	RegressionAUROC: 0.7582012414932251
	RegressionCompetitionScore: 0.4325153374233129

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7784656882286072
	RegressionCompetitionScore: 0.3993865030674847

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7539392709732056
	RegressionCompetitionScore: 0.3398773006134969



Validation scores:
	RegressionAUROC: 0.7836765646934509
	RegressionCompetitionScore: 0.3993865030674847

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7754138708114624
	RegressionCompetitionScore: 0.38282208588957056



Validation scores:
	RegressionAUROC: 0.7868659496307373
	RegressionCompetitionScore: 0.4049079754601227

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.159


Validation scores:
	RegressionAUROC: 0.7880336046218872
	RegressionCompetitionScore: 0.39815950920245397



Validation scores:
	RegressionAUROC: 0.7933516502380371
	RegressionCompetitionScore: 0.4208588957055215

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.156


Validation scores:
	RegressionAUROC: 0.7928774356842041
	RegressionCompetitionScore: 0.3880368098159509



Validation scores:
	RegressionAUROC: 0.8039185404777527
	RegressionCompetitionScore: 0.43098159509202455



Validation scores:
	RegressionAUROC: 0.7931994199752808
	RegressionCompetitionScore: 0.36625766871165644

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.154


Validation scores:
	RegressionAUROC: 0.8066399693489075
	RegressionCompetitionScore: 0.4466257668711656



Validation scores:
	RegressionAUROC: 0.8017033934593201
	RegressionCompetitionScore: 0.4236196319018405



Validation scores:
	RegressionAUROC: 0.7951360940933228
	RegressionCompetitionScore: 0.40061349693251536



Validation scores:
	RegressionAUROC: 0.7763533592224121
	RegressionCompetitionScore: 0.4049079754601227



Validation scores:
	RegressionAUROC: 0.786774218082428
	RegressionCompetitionScore: 0.4058282208588957



Validation scores:
	RegressionAUROC: 0.7949422597885132
	RegressionCompetitionScore: 0.4226993865030675



Validation scores:
	RegressionAUROC: 0.7897028923034668
	RegressionCompetitionScore: 0.4021472392638037

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.154. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36625766871165644
     Test RegressionAUROC            0.7931994199752808
Test RegressionCompetitionScore      0.36625766871165644
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 11:01:04,992][0m Trial 203 finished with value: 0.36625766871165644 and parameters: {'lr': 0.0006321550257285002, 'dropout': 0.43507451247591616, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 630, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0005362064293962017, 'dropout': 0.44522113456545026, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 599, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 65.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
65.6 K    Trainable params
0         Non-trainable params
65.6 K    Total params
0.263     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3333333134651184
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6925370693206787
	RegressionCompetitionScore: 0.27085889570552146

Metric val_loss improved. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7168412208557129
	RegressionCompetitionScore: 0.32883435582822085

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7180740833282471
	RegressionCompetitionScore: 0.34662576687116564

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7234518527984619
	RegressionCompetitionScore: 0.33588957055214724



Validation scores:
	RegressionAUROC: 0.7434370517730713
	RegressionCompetitionScore: 0.36717791411042944



Validation scores:
	RegressionAUROC: 0.7440797686576843
	RegressionCompetitionScore: 0.36319018404907977



Validation scores:
	RegressionAUROC: 0.7362802624702454
	RegressionCompetitionScore: 0.34171779141104297



Validation scores:
	RegressionAUROC: 0.7270413637161255
	RegressionCompetitionScore: 0.3411042944785276



Validation scores:
	RegressionAUROC: 0.7403291463851929
	RegressionCompetitionScore: 0.37883435582822084



Validation scores:
	RegressionAUROC: 0.756526529788971
	RegressionCompetitionScore: 0.37607361963190183

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7448835372924805
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7261789441108704
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7509806156158447
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.745458722114563
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7425432205200195
	RegressionCompetitionScore: 0.35153374233128837



Validation scores:
	RegressionAUROC: 0.7444994449615479
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7108520865440369
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.180. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37607361963190183
     Test RegressionAUROC             0.756526529788971
Test RegressionCompetitionScore      0.37607361963190183
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 11:08:23,779][0m Trial 204 finished with value: 0.37607361963190183 and parameters: {'lr': 0.0005362064293962017, 'dropout': 0.44522113456545026, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 599, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0008823808284261147, 'dropout': 0.4534987611928654, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 566, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 53.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
53.4 K    Trainable params
0         Non-trainable params
53.4 K    Total params
0.214     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.36231884360313416
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6750849485397339
	RegressionCompetitionScore: 0.2846625766871166

Metric val_loss improved. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6951654553413391
	RegressionCompetitionScore: 0.29570552147239265

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7063461542129517
	RegressionCompetitionScore: 0.3365030674846626

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7217943668365479
	RegressionCompetitionScore: 0.36717791411042944

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.6942935585975647
	RegressionCompetitionScore: 0.1745398773006135

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7362302541732788
	RegressionCompetitionScore: 0.3736196319018405



Validation scores:
	RegressionAUROC: 0.7469127774238586
	RegressionCompetitionScore: 0.3861963190184049

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7315200567245483
	RegressionCompetitionScore: 0.2987730061349693

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7533366680145264
	RegressionCompetitionScore: 0.3598159509202454

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7516177892684937
	RegressionCompetitionScore: 0.28957055214723926



Validation scores:
	RegressionAUROC: 0.7619519233703613
	RegressionCompetitionScore: 0.39723926380368096



Validation scores:
	RegressionAUROC: 0.7814805507659912
	RegressionCompetitionScore: 0.41687116564417176



Validation scores:
	RegressionAUROC: 0.773216724395752
	RegressionCompetitionScore: 0.3665644171779141

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7730307579040527
	RegressionCompetitionScore: 0.3941717791411043

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.785732090473175
	RegressionCompetitionScore: 0.4214723926380368

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.158


Validation scores:
	RegressionAUROC: 0.7637472152709961
	RegressionCompetitionScore: 0.32699386503067485



Validation scores:
	RegressionAUROC: 0.8010159730911255
	RegressionCompetitionScore: 0.43803680981595094



Validation scores:
	RegressionAUROC: 0.7910244464874268
	RegressionCompetitionScore: 0.4214723926380368

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.155


Validation scores:
	RegressionAUROC: 0.7651373147964478
	RegressionCompetitionScore: 0.3530674846625767



Validation scores:
	RegressionAUROC: 0.7610890865325928
	RegressionCompetitionScore: 0.34355828220858897



Validation scores:
	RegressionAUROC: 0.7927204370498657
	RegressionCompetitionScore: 0.4138036809815951



Validation scores:
	RegressionAUROC: 0.7754166722297668
	RegressionCompetitionScore: 0.3978527607361963



Validation scores:
	RegressionAUROC: 0.7741293907165527
	RegressionCompetitionScore: 0.2634969325153374



Validation scores:
	RegressionAUROC: 0.7896156907081604
	RegressionCompetitionScore: 0.42024539877300615



Validation scores:
	RegressionAUROC: 0.7894910573959351
	RegressionCompetitionScore: 0.44355828220858895

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.155. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4214723926380368
     Test RegressionAUROC            0.7910244464874268
Test RegressionCompetitionScore      0.4214723926380368
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 11:18:49,809][0m Trial 205 finished with value: 0.4214723926380368 and parameters: {'lr': 0.0008823808284261147, 'dropout': 0.4534987611928654, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 566, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0008575815153695883, 'dropout': 0.42254990884001953, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 563, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 53.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
53.3 K    Trainable params
0         Non-trainable params
53.3 K    Total params
0.213     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6749274730682373
	RegressionCompetitionScore: 0.2996932515337423

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6848463416099548
	RegressionCompetitionScore: 0.3058282208588957

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.701869547367096
	RegressionCompetitionScore: 0.3411042944785276

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7127262949943542
	RegressionCompetitionScore: 0.34171779141104297



Validation scores:
	RegressionAUROC: 0.7348194122314453
	RegressionCompetitionScore: 0.36319018404907977



Validation scores:
	RegressionAUROC: 0.7416062355041504
	RegressionCompetitionScore: 0.3815950920245399



Validation scores:
	RegressionAUROC: 0.7382510900497437
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7260850667953491
	RegressionCompetitionScore: 0.3371165644171779



Validation scores:
	RegressionAUROC: 0.7531048655509949
	RegressionCompetitionScore: 0.3904907975460123



Validation scores:
	RegressionAUROC: 0.7591813802719116
	RegressionCompetitionScore: 0.3825153374233129

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.773859977722168
	RegressionCompetitionScore: 0.4153374233128834

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7739096879959106
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7795529961585999
	RegressionCompetitionScore: 0.4165644171779141



Validation scores:
	RegressionAUROC: 0.7705630660057068
	RegressionCompetitionScore: 0.38926380368098157



Validation scores:
	RegressionAUROC: 0.7855781316757202
	RegressionCompetitionScore: 0.4144171779141104

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7888361215591431
	RegressionCompetitionScore: 0.40153374233128836



Validation scores:
	RegressionAUROC: 0.7627924680709839
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.773162305355072
	RegressionCompetitionScore: 0.3598159509202454



Validation scores:
	RegressionAUROC: 0.7689048051834106
	RegressionCompetitionScore: 0.3923312883435583



Validation scores:
	RegressionAUROC: 0.7596321702003479
	RegressionCompetitionScore: 0.37975460122699384



Validation scores:
	RegressionAUROC: 0.7819340229034424
	RegressionCompetitionScore: 0.3895705521472393



Validation scores:
	RegressionAUROC: 0.7807122468948364
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.165. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4144171779141104
     Test RegressionAUROC            0.7855781316757202
Test RegressionCompetitionScore      0.4144171779141104
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 11:27:51,619][0m Trial 206 finished with value: 0.4144171779141104 and parameters: {'lr': 0.0008575815153695883, 'dropout': 0.42254990884001953, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 563, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0013047349706951338, 'dropout': 0.42089291941844276, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 562, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 53.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
53.2 K    Trainable params
0         Non-trainable params
53.2 K    Total params
0.213     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6538926362991333
	RegressionCompetitionScore: 0.20644171779141104

Metric val_loss improved. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6815941333770752
	RegressionCompetitionScore: 0.2941717791411043

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7097617387771606
	RegressionCompetitionScore: 0.3024539877300613



Validation scores:
	RegressionAUROC: 0.7157744765281677
	RegressionCompetitionScore: 0.3401840490797546



Validation scores:
	RegressionAUROC: 0.676567554473877
	RegressionCompetitionScore: 0.249079754601227



Validation scores:
	RegressionAUROC: 0.611457109451294
	RegressionCompetitionScore: 0.15276073619631902



Validation scores:
	RegressionAUROC: 0.6178640127182007
	RegressionCompetitionScore: 0.17760736196319019



Validation scores:
	RegressionAUROC: 0.6808443069458008
	RegressionCompetitionScore: 0.2634969325153374

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.694715142250061
	RegressionCompetitionScore: 0.2846625766871166

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6843551993370056
	RegressionCompetitionScore: 0.18834355828220858



Validation scores:
	RegressionAUROC: 0.6860473155975342
	RegressionCompetitionScore: 0.25337423312883434



Validation scores:
	RegressionAUROC: 0.6995887756347656
	RegressionCompetitionScore: 0.3567484662576687



Validation scores:
	RegressionAUROC: 0.702075183391571
	RegressionCompetitionScore: 0.3411042944785276



Validation scores:
	RegressionAUROC: 0.7094873189926147
	RegressionCompetitionScore: 0.3549079754601227

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7049134969711304
	RegressionCompetitionScore: 0.3604294478527607



Validation scores:
	RegressionAUROC: 0.7011321783065796
	RegressionCompetitionScore: 0.34662576687116564



Validation scores:
	RegressionAUROC: 0.6940746307373047
	RegressionCompetitionScore: 0.30552147239263805



Validation scores:
	RegressionAUROC: 0.6749564409255981
	RegressionCompetitionScore: 0.21380368098159508



Validation scores:
	RegressionAUROC: 0.6981983184814453
	RegressionCompetitionScore: 0.3116564417177914



Validation scores:
	RegressionAUROC: 0.7077313661575317
	RegressionCompetitionScore: 0.3104294478527607



Validation scores:
	RegressionAUROC: 0.7137928009033203
	RegressionCompetitionScore: 0.32699386503067485

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.183. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3549079754601227
     Test RegressionAUROC            0.7094873189926147
Test RegressionCompetitionScore      0.3549079754601227
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 11:36:30,868][0m Trial 207 finished with value: 0.3549079754601227 and parameters: {'lr': 0.0013047349706951338, 'dropout': 0.42089291941844276, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 562, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0008723862624665996, 'dropout': 0.4236981525999037, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 614, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 55.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
55.9 K    Trainable params
0         Non-trainable params
55.9 K    Total params
0.224     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6995060443878174
	RegressionCompetitionScore: 0.2907975460122699

Metric val_loss improved. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.6989203691482544
	RegressionCompetitionScore: 0.2733128834355828



Validation scores:
	RegressionAUROC: 0.7153153419494629
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7089698910713196
	RegressionCompetitionScore: 0.3432515337423313



Validation scores:
	RegressionAUROC: 0.7325051426887512
	RegressionCompetitionScore: 0.3880368098159509



Validation scores:
	RegressionAUROC: 0.7190965414047241
	RegressionCompetitionScore: 0.36165644171779143

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7239195108413696
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7218952178955078
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7115465402603149
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7238197326660156
	RegressionCompetitionScore: 0.2898773006134969



Validation scores:
	RegressionAUROC: 0.7295535206794739
	RegressionCompetitionScore: 0.3116564417177914



Validation scores:
	RegressionAUROC: 0.7260162830352783
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7210716009140015
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.178. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36165644171779143
     Test RegressionAUROC            0.7190965414047241
Test RegressionCompetitionScore      0.36165644171779143
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 11:42:02,002][0m Trial 208 finished with value: 0.36165644171779143 and parameters: {'lr': 0.0008723862624665996, 'dropout': 0.4236981525999037, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 614, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0007714127480891594, 'dropout': 0.4585359086778116, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 547, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 42.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
42.8 K    Trainable params
0         Non-trainable params
42.8 K    Total params
0.171     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3719806671142578
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6411805152893066
	RegressionCompetitionScore: 0.15030674846625766

Metric val_loss improved. New best score: 0.275


Validation scores:
	RegressionAUROC: 0.6957180500030518
	RegressionCompetitionScore: 0.28190184049079753

Metric val_loss improved by 0.092 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7277641296386719
	RegressionCompetitionScore: 0.35920245398773004



Validation scores:
	RegressionAUROC: 0.7282629013061523
	RegressionCompetitionScore: 0.39754601226993863



Validation scores:
	RegressionAUROC: 0.742784857749939
	RegressionCompetitionScore: 0.38404907975460123

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7555666565895081
	RegressionCompetitionScore: 0.40950920245398775



Validation scores:
	RegressionAUROC: 0.7507257461547852
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7544553279876709
	RegressionCompetitionScore: 0.38588957055214723



Validation scores:
	RegressionAUROC: 0.7576779127120972
	RegressionCompetitionScore: 0.3576687116564417



Validation scores:
	RegressionAUROC: 0.7633670568466187
	RegressionCompetitionScore: 0.39447852760736196



Validation scores:
	RegressionAUROC: 0.7470576167106628
	RegressionCompetitionScore: 0.36871165644171777



Validation scores:
	RegressionAUROC: 0.7460005283355713
	RegressionCompetitionScore: 0.36779141104294477

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.171. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38404907975460123
     Test RegressionAUROC             0.742784857749939
Test RegressionCompetitionScore      0.38404907975460123
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 11:47:07,653][0m Trial 209 finished with value: 0.38404907975460123 and parameters: {'lr': 0.0007714127480891594, 'dropout': 0.4585359086778116, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 547, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0011167999843601762, 'dropout': 0.43217669949215975, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 564, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 53.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
53.3 K    Trainable params
0         Non-trainable params
53.3 K    Total params
0.213     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6335521936416626
	RegressionCompetitionScore: 0.27085889570552146

Metric val_loss improved. New best score: 0.245


Validation scores:
	RegressionAUROC: 0.6294947862625122
	RegressionCompetitionScore: 0.20030674846625768



Validation scores:
	RegressionAUROC: 0.6550275087356567
	RegressionCompetitionScore: 0.2371165644171779



Validation scores:
	RegressionAUROC: 0.6878957748413086
	RegressionCompetitionScore: 0.24662576687116564

Metric val_loss improved by 0.034 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6950377225875854
	RegressionCompetitionScore: 0.301840490797546



Validation scores:
	RegressionAUROC: 0.6462713479995728
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6862121820449829
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6832267045974731
	RegressionCompetitionScore: 0.3276073619631902



Validation scores:
	RegressionAUROC: 0.6881531476974487
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6894984245300293
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6266717314720154
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.211. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.24662576687116564
     Test RegressionAUROC            0.6878957748413086
Test RegressionCompetitionScore      0.24662576687116564
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 11:51:54,981][0m Trial 210 finished with value: 0.24662576687116564 and parameters: {'lr': 0.0011167999843601762, 'dropout': 0.43217669949215975, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 564, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0005670067240821195, 'dropout': 0.45128679985282416, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 626, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 56.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
56.5 K    Trainable params
0         Non-trainable params
56.5 K    Total params
0.226     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.54347825050354
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6723073720932007
	RegressionCompetitionScore: 0.11625766871165644

Metric val_loss improved. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.713215172290802
	RegressionCompetitionScore: 0.32975460122699385

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7258734703063965
	RegressionCompetitionScore: 0.38926380368098157



Validation scores:
	RegressionAUROC: 0.7303823232650757
	RegressionCompetitionScore: 0.39386503067484663

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7402132749557495
	RegressionCompetitionScore: 0.4107361963190184



Validation scores:
	RegressionAUROC: 0.7443318367004395
	RegressionCompetitionScore: 0.399079754601227



Validation scores:
	RegressionAUROC: 0.7415522933006287
	RegressionCompetitionScore: 0.39631901840490796



Validation scores:
	RegressionAUROC: 0.7371143102645874
	RegressionCompetitionScore: 0.36073619631901843

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7167534232139587
	RegressionCompetitionScore: 0.26717791411042946



Validation scores:
	RegressionAUROC: 0.7376933693885803
	RegressionCompetitionScore: 0.35429447852760737



Validation scores:
	RegressionAUROC: 0.7487649917602539
	RegressionCompetitionScore: 0.37576687116564417



Validation scores:
	RegressionAUROC: 0.7434788942337036
	RegressionCompetitionScore: 0.37392638036809817



Validation scores:
	RegressionAUROC: 0.7218937873840332
	RegressionCompetitionScore: 0.2950920245398773



Validation scores:
	RegressionAUROC: 0.7354979515075684
	RegressionCompetitionScore: 0.34202453987730064



Validation scores:
	RegressionAUROC: 0.743130087852478
	RegressionCompetitionScore: 0.3880368098159509

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36073619631901843
     Test RegressionAUROC            0.7371143102645874
Test RegressionCompetitionScore      0.36073619631901843
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 11:58:14,207][0m Trial 211 finished with value: 0.36073619631901843 and parameters: {'lr': 0.0005670067240821195, 'dropout': 0.45128679985282416, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 626, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00046886315066406827, 'dropout': 0.44693702885397635, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 520, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 51.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
51.1 K    Trainable params
0         Non-trainable params
51.1 K    Total params
0.204     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6476541757583618
	RegressionCompetitionScore: 0.23742331288343557

Metric val_loss improved. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6745050549507141
	RegressionCompetitionScore: 0.294478527607362



Validation scores:
	RegressionAUROC: 0.6824555397033691
	RegressionCompetitionScore: 0.28865030674846626

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.7145216464996338
	RegressionCompetitionScore: 0.3165644171779141

Metric val_loss improved by 0.027 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7129961848258972
	RegressionCompetitionScore: 0.3389570552147239

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7494367957115173
	RegressionCompetitionScore: 0.38190184049079756

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7173824310302734
	RegressionCompetitionScore: 0.35337423312883437



Validation scores:
	RegressionAUROC: 0.7500510215759277
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.737970769405365
	RegressionCompetitionScore: 0.293558282208589



Validation scores:
	RegressionAUROC: 0.7645116448402405
	RegressionCompetitionScore: 0.35920245398773004

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7602699995040894
	RegressionCompetitionScore: 0.3389570552147239



Validation scores:
	RegressionAUROC: 0.7576573491096497
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7485700249671936
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7691788673400879
	RegressionCompetitionScore: 0.4138036809815951



Validation scores:
	RegressionAUROC: 0.7647072076797485
	RegressionCompetitionScore: 0.4208588957055215



Validation scores:
	RegressionAUROC: 0.7744932770729065
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7716082334518433
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.169. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.35920245398773004
     Test RegressionAUROC            0.7645116448402405
Test RegressionCompetitionScore      0.35920245398773004
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 12:05:19,530][0m Trial 212 finished with value: 0.35920245398773004 and parameters: {'lr': 0.00046886315066406827, 'dropout': 0.44693702885397635, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 520, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0007491773309779397, 'dropout': 0.43690602518221994, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 650, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 69.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
69.1 K    Trainable params
0         Non-trainable params
69.1 K    Total params
0.276     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7125604152679443
	RegressionCompetitionScore: 0.6086956521739131



Validation scores:
	RegressionAUROC: 0.6908315420150757
	RegressionCompetitionScore: 0.19662576687116565

Metric val_loss improved. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.6909523010253906
	RegressionCompetitionScore: 0.3030674846625767



Validation scores:
	RegressionAUROC: 0.6964056491851807
	RegressionCompetitionScore: 0.2871165644171779



Validation scores:
	RegressionAUROC: 0.7238089442253113
	RegressionCompetitionScore: 0.3300613496932515

Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7297700643539429
	RegressionCompetitionScore: 0.36871165644171777



Validation scores:
	RegressionAUROC: 0.7412320375442505
	RegressionCompetitionScore: 0.36503067484662577



Validation scores:
	RegressionAUROC: 0.6871302127838135
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.72486811876297
	RegressionCompetitionScore: 0.3156441717791411



Validation scores:
	RegressionAUROC: 0.723676860332489
	RegressionCompetitionScore: 0.3131901840490798



Validation scores:
	RegressionAUROC: 0.7415899038314819
	RegressionCompetitionScore: 0.344478527607362



Validation scores:
	RegressionAUROC: 0.7237608432769775
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.176. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3300613496932515
     Test RegressionAUROC            0.7238089442253113
Test RegressionCompetitionScore      0.3300613496932515
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 12:10:05,545][0m Trial 213 finished with value: 0.3300613496932515 and parameters: {'lr': 0.0007491773309779397, 'dropout': 0.43690602518221994, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 650, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00039148101096869075, 'dropout': 0.4586892869349875, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 594, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 54.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
54.9 K    Trainable params
0         Non-trainable params
54.9 K    Total params
0.219     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6292904615402222
	RegressionCompetitionScore: 0.1116564417177914

Metric val_loss improved. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.7352795600891113
	RegressionCompetitionScore: 0.3825153374233129

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7386034727096558
	RegressionCompetitionScore: 0.4107361963190184

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7221981883049011
	RegressionCompetitionScore: 0.3061349693251534



Validation scores:
	RegressionAUROC: 0.751171350479126
	RegressionCompetitionScore: 0.4153374233128834



Validation scores:
	RegressionAUROC: 0.7416651844978333
	RegressionCompetitionScore: 0.38404907975460123

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7504996657371521
	RegressionCompetitionScore: 0.39079754601226996



Validation scores:
	RegressionAUROC: 0.7459348440170288
	RegressionCompetitionScore: 0.33680981595092024



Validation scores:
	RegressionAUROC: 0.7320162653923035
	RegressionCompetitionScore: 0.26288343558282207



Validation scores:
	RegressionAUROC: 0.7380191087722778
	RegressionCompetitionScore: 0.3361963190184049



Validation scores:
	RegressionAUROC: 0.7589609622955322
	RegressionCompetitionScore: 0.36073619631901843

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7579182386398315
	RegressionCompetitionScore: 0.3585889570552147



Validation scores:
	RegressionAUROC: 0.7559499144554138
	RegressionCompetitionScore: 0.38312883435582823



Validation scores:
	RegressionAUROC: 0.7294467687606812
	RegressionCompetitionScore: 0.3058282208588957



Validation scores:
	RegressionAUROC: 0.7565253973007202
	RegressionCompetitionScore: 0.39754601226993863



Validation scores:
	RegressionAUROC: 0.7573760747909546
	RegressionCompetitionScore: 0.35552147239263804

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7645543217658997
	RegressionCompetitionScore: 0.3674846625766871



Validation scores:
	RegressionAUROC: 0.7588058710098267
	RegressionCompetitionScore: 0.31104294478527605



Validation scores:
	RegressionAUROC: 0.759793758392334
	RegressionCompetitionScore: 0.3628834355828221



Validation scores:
	RegressionAUROC: 0.7528504133224487
	RegressionCompetitionScore: 0.39815950920245397



Validation scores:
	RegressionAUROC: 0.7677029967308044
	RegressionCompetitionScore: 0.3941717791411043

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7580718398094177
	RegressionCompetitionScore: 0.35153374233128837



Validation scores:
	RegressionAUROC: 0.7516448497772217
	RegressionCompetitionScore: 0.2263803680981595



Validation scores:
	RegressionAUROC: 0.7677873969078064
	RegressionCompetitionScore: 0.25674846625766873



Validation scores:
	RegressionAUROC: 0.7580692172050476
	RegressionCompetitionScore: 0.37484662576687117



Validation scores:
	RegressionAUROC: 0.7605803608894348
	RegressionCompetitionScore: 0.30552147239263805



Validation scores:
	RegressionAUROC: 0.7638246417045593
	RegressionCompetitionScore: 0.37055214723926383



Validation scores:
	RegressionAUROC: 0.7597039937973022
	RegressionCompetitionScore: 0.2892638036809816

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.166. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3941717791411043
     Test RegressionAUROC            0.7677029967308044
Test RegressionCompetitionScore      0.3941717791411043
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 12:21:29,066][0m Trial 214 finished with value: 0.3941717791411043 and parameters: {'lr': 0.00039148101096869075, 'dropout': 0.4586892869349875, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 594, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0006074302736877351, 'dropout': 0.4579385689855931, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 584, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 44.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
44.1 K    Trainable params
0         Non-trainable params
44.1 K    Total params
0.176     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7198067307472229
	RegressionCompetitionScore: 0.6086956521739131



Validation scores:
	RegressionAUROC: 0.6942884922027588
	RegressionCompetitionScore: 0.25552147239263806

Metric val_loss improved. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6862292289733887
	RegressionCompetitionScore: 0.33865030674846625

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7295319437980652
	RegressionCompetitionScore: 0.35

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7379464507102966
	RegressionCompetitionScore: 0.37055214723926383

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.728014349937439
	RegressionCompetitionScore: 0.3383435582822086



Validation scores:
	RegressionAUROC: 0.7496193051338196
	RegressionCompetitionScore: 0.38680981595092023



Validation scores:
	RegressionAUROC: 0.7446255683898926
	RegressionCompetitionScore: 0.34171779141104297

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7540088295936584
	RegressionCompetitionScore: 0.35337423312883437

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7750422954559326
	RegressionCompetitionScore: 0.3202453987730061



Validation scores:
	RegressionAUROC: 0.783483624458313
	RegressionCompetitionScore: 0.4411042944785276



Validation scores:
	RegressionAUROC: 0.7743074893951416
	RegressionCompetitionScore: 0.38588957055214723

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7937289476394653
	RegressionCompetitionScore: 0.3904907975460123

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.159


Validation scores:
	RegressionAUROC: 0.7889881134033203
	RegressionCompetitionScore: 0.39478527607361963



Validation scores:
	RegressionAUROC: 0.7941575050354004
	RegressionCompetitionScore: 0.4110429447852761



Validation scores:
	RegressionAUROC: 0.781735897064209
	RegressionCompetitionScore: 0.35828220858895704



Validation scores:
	RegressionAUROC: 0.7945163249969482
	RegressionCompetitionScore: 0.3911042944785276



Validation scores:
	RegressionAUROC: 0.7936488389968872
	RegressionCompetitionScore: 0.3521472392638037



Validation scores:
	RegressionAUROC: 0.8012182712554932
	RegressionCompetitionScore: 0.4199386503067485



Validation scores:
	RegressionAUROC: 0.8015822768211365
	RegressionCompetitionScore: 0.39539877300613496

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.159. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3904907975460123
     Test RegressionAUROC            0.7937289476394653
Test RegressionCompetitionScore      0.3904907975460123
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 12:29:17,399][0m Trial 215 finished with value: 0.3904907975460123 and parameters: {'lr': 0.0006074302736877351, 'dropout': 0.4579385689855931, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 584, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.000995467261074694, 'dropout': 0.48327533043554277, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 598, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 55.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
55.1 K    Trainable params
0         Non-trainable params
55.1 K    Total params
0.220     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3285024166107178
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6475490927696228
	RegressionCompetitionScore: 0.1638036809815951

Metric val_loss improved. New best score: 0.347


Validation scores:
	RegressionAUROC: 0.6937685012817383
	RegressionCompetitionScore: 0.20460122699386504

Metric val_loss improved by 0.152 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7100025415420532
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7409884333610535
	RegressionCompetitionScore: 0.2588957055214724



Validation scores:
	RegressionAUROC: 0.748958945274353
	RegressionCompetitionScore: 0.3598159509202454

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7536421418190002
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7561632990837097
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7939629554748535
	RegressionCompetitionScore: 0.34938650306748464

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7870761156082153
	RegressionCompetitionScore: 0.39754601226993863



Validation scores:
	RegressionAUROC: 0.7919543981552124
	RegressionCompetitionScore: 0.4119631901840491

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7047639489173889
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7416159510612488
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7268280386924744
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7656379342079163
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7898791432380676
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7558430433273315
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7483621835708618
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4119631901840491
     Test RegressionAUROC            0.7919543981552124
Test RegressionCompetitionScore      0.4119631901840491
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 12:36:18,797][0m Trial 216 finished with value: 0.4119631901840491 and parameters: {'lr': 0.000995467261074694, 'dropout': 0.48327533043554277, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 598, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.000982779486827163, 'dropout': 0.48171770919296486, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 606, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 55.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
55.5 K    Trainable params
0         Non-trainable params
55.5 K    Total params
0.222     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6805400848388672
	RegressionCompetitionScore: 0.2714723926380368

Metric val_loss improved. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.6700589656829834
	RegressionCompetitionScore: 0.2920245398773006



Validation scores:
	RegressionAUROC: 0.727015495300293
	RegressionCompetitionScore: 0.3469325153374233

Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6764824986457825
	RegressionCompetitionScore: 0.25429447852760734



Validation scores:
	RegressionAUROC: 0.7318218350410461
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.7513889074325562
	RegressionCompetitionScore: 0.36257668711656443

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.6770907044410706
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7400500774383545
	RegressionCompetitionScore: 0.3346625766871166



Validation scores:
	RegressionAUROC: 0.7387725114822388
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7376018762588501
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6651154160499573
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6523871421813965
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6901571750640869
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36257668711656443
     Test RegressionAUROC            0.7513889074325562
Test RegressionCompetitionScore      0.36257668711656443
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 12:41:50,395][0m Trial 217 finished with value: 0.36257668711656443 and parameters: {'lr': 0.000982779486827163, 'dropout': 0.48171770919296486, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 606, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0007918279235446139, 'dropout': 0.46804647711384595, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 571, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 53.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
53.7 K    Trainable params
0         Non-trainable params
53.7 K    Total params
0.215     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3526570200920105
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6965258121490479
	RegressionCompetitionScore: 0.3174846625766871

Metric val_loss improved. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7063853144645691
	RegressionCompetitionScore: 0.35276073619631904

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7294676303863525
	RegressionCompetitionScore: 0.3825153374233129

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7298533916473389
	RegressionCompetitionScore: 0.36411042944785277



Validation scores:
	RegressionAUROC: 0.7504397630691528
	RegressionCompetitionScore: 0.41779141104294476

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7325968742370605
	RegressionCompetitionScore: 0.3230061349693252



Validation scores:
	RegressionAUROC: 0.7415783405303955
	RegressionCompetitionScore: 0.3407975460122699



Validation scores:
	RegressionAUROC: 0.731915295124054
	RegressionCompetitionScore: 0.33067484662576685



Validation scores:
	RegressionAUROC: 0.7141847014427185
	RegressionCompetitionScore: 0.22668711656441717



Validation scores:
	RegressionAUROC: 0.7472186088562012
	RegressionCompetitionScore: 0.34294478527607364



Validation scores:
	RegressionAUROC: 0.7497464418411255
	RegressionCompetitionScore: 0.3889570552147239

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7446814775466919
	RegressionCompetitionScore: 0.349079754601227



Validation scores:
	RegressionAUROC: 0.7381917238235474
	RegressionCompetitionScore: 0.27791411042944786

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7549116015434265
	RegressionCompetitionScore: 0.39079754601226996



Validation scores:
	RegressionAUROC: 0.7446705102920532
	RegressionCompetitionScore: 0.4134969325153374



Validation scores:
	RegressionAUROC: 0.755036473274231
	RegressionCompetitionScore: 0.37944785276073617



Validation scores:
	RegressionAUROC: 0.7610145211219788
	RegressionCompetitionScore: 0.34171779141104297



Validation scores:
	RegressionAUROC: 0.7685616612434387
	RegressionCompetitionScore: 0.34171779141104297

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.728668212890625
	RegressionCompetitionScore: 0.26134969325153373



Validation scores:
	RegressionAUROC: 0.7407767176628113
	RegressionCompetitionScore: 0.33220858895705524



Validation scores:
	RegressionAUROC: 0.7625123262405396
	RegressionCompetitionScore: 0.33220858895705524



Validation scores:
	RegressionAUROC: 0.7504553198814392
	RegressionCompetitionScore: 0.3328220858895706



Validation scores:
	RegressionAUROC: 0.7501382231712341
	RegressionCompetitionScore: 0.36411042944785277



Validation scores:
	RegressionAUROC: 0.7534613609313965
	RegressionCompetitionScore: 0.40828220858895703



Validation scores:
	RegressionAUROC: 0.7574312686920166
	RegressionCompetitionScore: 0.3352760736196319

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.165. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.34171779141104297
     Test RegressionAUROC            0.7685616612434387
Test RegressionCompetitionScore      0.34171779141104297
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 12:52:00,539][0m Trial 218 finished with value: 0.34171779141104297 and parameters: {'lr': 0.0007918279235446139, 'dropout': 0.46804647711384595, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 571, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0013375831297449882, 'dropout': 0.4888885128468, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 625, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 67.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
67.4 K    Trainable params
0         Non-trainable params
67.4 K    Total params
0.270     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6538074016571045
	RegressionCompetitionScore: 0.19877300613496932

Metric val_loss improved. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.6959853172302246
	RegressionCompetitionScore: 0.2285276073619632



Validation scores:
	RegressionAUROC: 0.6786558032035828
	RegressionCompetitionScore: 0.253680981595092



Validation scores:
	RegressionAUROC: 0.6550602912902832
	RegressionCompetitionScore: 0.2371165644171779

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6480287313461304
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6883074045181274
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6836152076721191
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6702048778533936
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6312636733055115
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.659527599811554
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6518133878707886
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.206. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2371165644171779
     Test RegressionAUROC            0.6550602912902832
Test RegressionCompetitionScore      0.2371165644171779
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 12:56:47,106][0m Trial 219 finished with value: 0.2371165644171779 and parameters: {'lr': 0.0013375831297449882, 'dropout': 0.4888885128468, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 625, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0018625609607955938, 'dropout': 0.46034545348968225, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 599, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 44.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
44.6 K    Trainable params
0         Non-trainable params
44.6 K    Total params
0.178     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6908212304115295
	RegressionCompetitionScore: 0.4782608695652174



Validation scores:
	RegressionAUROC: 0.6906020641326904
	RegressionCompetitionScore: 0.1628834355828221

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6871083974838257
	RegressionCompetitionScore: 0.22699386503067484

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6830735206604004
	RegressionCompetitionScore: 0.26993865030674846



Validation scores:
	RegressionAUROC: 0.689526379108429
	RegressionCompetitionScore: 0.2855828220858896

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6641937494277954
	RegressionCompetitionScore: 0.27607361963190186



Validation scores:
	RegressionAUROC: 0.7075213193893433
	RegressionCompetitionScore: 0.33773006134969324



Validation scores:
	RegressionAUROC: 0.704574465751648
	RegressionCompetitionScore: 0.3558282208588957



Validation scores:
	RegressionAUROC: 0.7164067029953003
	RegressionCompetitionScore: 0.3380368098159509



Validation scores:
	RegressionAUROC: 0.7040021419525146
	RegressionCompetitionScore: 0.3174846625766871

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7100648283958435
	RegressionCompetitionScore: 0.35245398773006137



Validation scores:
	RegressionAUROC: 0.6252027750015259
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6028494834899902
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.632605791091919
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.635404109954834
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7129753232002258
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.6822038888931274
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.186. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3174846625766871
     Test RegressionAUROC            0.7040021419525146
Test RegressionCompetitionScore      0.3174846625766871
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 13:03:25,223][0m Trial 220 finished with value: 0.3174846625766871 and parameters: {'lr': 0.0018625609607955938, 'dropout': 0.46034545348968225, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 599, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.000381154473138875, 'dropout': 0.4517714588849909, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 594, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 54.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
54.9 K    Trainable params
0         Non-trainable params
54.9 K    Total params
0.219     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6524491310119629
	RegressionCompetitionScore: 0.08680981595092024

Metric val_loss improved. New best score: 0.247


Validation scores:
	RegressionAUROC: 0.6909385919570923
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7046427726745605
	RegressionCompetitionScore: 0.2236196319018405



Validation scores:
	RegressionAUROC: 0.7275698781013489
	RegressionCompetitionScore: 0.38926380368098157

Metric val_loss improved by 0.065 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7375655770301819
	RegressionCompetitionScore: 0.33220858895705524

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7546569108963013
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7484490871429443
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7935394048690796
	RegressionCompetitionScore: 0.38865030674846623

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7731814384460449
	RegressionCompetitionScore: 0.34846625766871164



Validation scores:
	RegressionAUROC: 0.7909586429595947
	RegressionCompetitionScore: 0.4138036809815951



Validation scores:
	RegressionAUROC: 0.7888326644897461
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7714622616767883
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7663500308990479
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.8004598617553711
	RegressionCompetitionScore: 0.45674846625766874



Validation scores:
	RegressionAUROC: 0.7781792879104614
	RegressionCompetitionScore: 0.399079754601227

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.167. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38865030674846623
     Test RegressionAUROC            0.7935394048690796
Test RegressionCompetitionScore      0.38865030674846623
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 13:09:43,877][0m Trial 221 finished with value: 0.38865030674846623 and parameters: {'lr': 0.000381154473138875, 'dropout': 0.4517714588849909, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 594, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0004949590472599356, 'dropout': 0.47274200991615795, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 540, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 52.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
52.1 K    Trainable params
0         Non-trainable params
52.1 K    Total params
0.208     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6859903335571289
	RegressionCompetitionScore: 0.43478260869565216



Validation scores:
	RegressionAUROC: 0.687904953956604
	RegressionCompetitionScore: 0.22024539877300614

Metric val_loss improved. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.7062878608703613
	RegressionCompetitionScore: 0.3030674846625767

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.72296142578125
	RegressionCompetitionScore: 0.344478527607362



Validation scores:
	RegressionAUROC: 0.7171131372451782
	RegressionCompetitionScore: 0.3187116564417178



Validation scores:
	RegressionAUROC: 0.7416850328445435
	RegressionCompetitionScore: 0.35552147239263804



Validation scores:
	RegressionAUROC: 0.7486944198608398
	RegressionCompetitionScore: 0.35736196319018404

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7494019269943237
	RegressionCompetitionScore: 0.3549079754601227

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7542775273323059
	RegressionCompetitionScore: 0.39263803680981596



Validation scores:
	RegressionAUROC: 0.7515928149223328
	RegressionCompetitionScore: 0.3754601226993865



Validation scores:
	RegressionAUROC: 0.745550274848938
	RegressionCompetitionScore: 0.38190184049079756



Validation scores:
	RegressionAUROC: 0.7590750455856323
	RegressionCompetitionScore: 0.36901840490797544



Validation scores:
	RegressionAUROC: 0.7621797323226929
	RegressionCompetitionScore: 0.38190184049079756

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7581382393836975
	RegressionCompetitionScore: 0.35828220858895704



Validation scores:
	RegressionAUROC: 0.7739770412445068
	RegressionCompetitionScore: 0.38773006134969323

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7612638473510742
	RegressionCompetitionScore: 0.38312883435582823



Validation scores:
	RegressionAUROC: 0.7832164764404297
	RegressionCompetitionScore: 0.3960122699386503

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7558027505874634
	RegressionCompetitionScore: 0.37300613496932516



Validation scores:
	RegressionAUROC: 0.7614927291870117
	RegressionCompetitionScore: 0.38865030674846623



Validation scores:
	RegressionAUROC: 0.7697182297706604
	RegressionCompetitionScore: 0.38773006134969323



Validation scores:
	RegressionAUROC: 0.7498027086257935
	RegressionCompetitionScore: 0.33680981595092024



Validation scores:
	RegressionAUROC: 0.7803484201431274
	RegressionCompetitionScore: 0.36411042944785277

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7572692632675171
	RegressionCompetitionScore: 0.3147239263803681



Validation scores:
	RegressionAUROC: 0.7767977118492126
	RegressionCompetitionScore: 0.37024539877300616

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7796012759208679
	RegressionCompetitionScore: 0.39631901840490796



Validation scores:
	RegressionAUROC: 0.787727952003479
	RegressionCompetitionScore: 0.43803680981595094



Validation scores:
	RegressionAUROC: 0.7707469463348389
	RegressionCompetitionScore: 0.37147239263803683



Validation scores:
	RegressionAUROC: 0.7663314342498779
	RegressionCompetitionScore: 0.37392638036809817



Validation scores:
	RegressionAUROC: 0.782866358757019
	RegressionCompetitionScore: 0.36993865030674844

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.7719908952713013
	RegressionCompetitionScore: 0.3193251533742331



Validation scores:
	RegressionAUROC: 0.7535659074783325
	RegressionCompetitionScore: 0.36349693251533743



Validation scores:
	RegressionAUROC: 0.7679727077484131
	RegressionCompetitionScore: 0.3423312883435583



Validation scores:
	RegressionAUROC: 0.765643835067749
	RegressionCompetitionScore: 0.25245398773006134



Validation scores:
	RegressionAUROC: 0.7726562023162842
	RegressionCompetitionScore: 0.2852760736196319



Validation scores:
	RegressionAUROC: 0.7712644338607788
	RegressionCompetitionScore: 0.3726993865030675



Validation scores:
	RegressionAUROC: 0.7798344492912292
	RegressionCompetitionScore: 0.4312883435582822

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.161. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36993865030674844
     Test RegressionAUROC             0.782866358757019
Test RegressionCompetitionScore      0.36993865030674844
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 13:23:49,990][0m Trial 222 finished with value: 0.36993865030674844 and parameters: {'lr': 0.0004949590472599356, 'dropout': 0.47274200991615795, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 540, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0003587742304135339, 'dropout': 0.4425999032985222, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 434, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 46.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
46.7 K    Trainable params
0         Non-trainable params
46.7 K    Total params
0.187     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.36231884360313416
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6700719594955444
	RegressionCompetitionScore: 0.14785276073619633

Metric val_loss improved. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.7017310261726379
	RegressionCompetitionScore: 0.26319018404907973

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.7170523405075073
	RegressionCompetitionScore: 0.2684049079754601

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7150158286094666
	RegressionCompetitionScore: 0.26042944785276073

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7463325262069702
	RegressionCompetitionScore: 0.33957055214723925

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7598361968994141
	RegressionCompetitionScore: 0.35644171779141104



Validation scores:
	RegressionAUROC: 0.7508741021156311
	RegressionCompetitionScore: 0.3414110429447853



Validation scores:
	RegressionAUROC: 0.7459639310836792
	RegressionCompetitionScore: 0.32975460122699385



Validation scores:
	RegressionAUROC: 0.7558953762054443
	RegressionCompetitionScore: 0.3717791411042945



Validation scores:
	RegressionAUROC: 0.766504168510437
	RegressionCompetitionScore: 0.38220858895705523

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7714711427688599
	RegressionCompetitionScore: 0.36503067484662577



Validation scores:
	RegressionAUROC: 0.7673224210739136
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7551363706588745
	RegressionCompetitionScore: 0.34202453987730064



Validation scores:
	RegressionAUROC: 0.7659561634063721
	RegressionCompetitionScore: 0.36901840490797544



Validation scores:
	RegressionAUROC: 0.7757314443588257
	RegressionCompetitionScore: 0.3736196319018405

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.159


Validation scores:
	RegressionAUROC: 0.782132089138031
	RegressionCompetitionScore: 0.39969325153374236



Validation scores:
	RegressionAUROC: 0.7856206893920898
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7838079929351807
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7920835018157959
	RegressionCompetitionScore: 0.45674846625766874



Validation scores:
	RegressionAUROC: 0.773346483707428
	RegressionCompetitionScore: 0.32791411042944785



Validation scores:
	RegressionAUROC: 0.7834402322769165
	RegressionCompetitionScore: 0.4447852760736196



Validation scores:
	RegressionAUROC: 0.7688223123550415
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.159. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3736196319018405
     Test RegressionAUROC            0.7757314443588257
Test RegressionCompetitionScore      0.3736196319018405
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 13:32:53,424][0m Trial 223 finished with value: 0.3736196319018405 and parameters: {'lr': 0.0003587742304135339, 'dropout': 0.4425999032985222, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 434, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0006485776790582444, 'dropout': 0.4229740783074523, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 644, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 57.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
57.4 K    Trainable params
0         Non-trainable params
57.4 K    Total params
0.230     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3526570200920105
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6909862756729126
	RegressionCompetitionScore: 0.22116564417177914

Metric val_loss improved. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.7165996432304382
	RegressionCompetitionScore: 0.3058282208588957

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7341020107269287
	RegressionCompetitionScore: 0.36012269938650304



Validation scores:
	RegressionAUROC: 0.7238526344299316
	RegressionCompetitionScore: 0.3248466257668712

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.743515133857727
	RegressionCompetitionScore: 0.3693251533742331

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7396910190582275
	RegressionCompetitionScore: 0.3825153374233129



Validation scores:
	RegressionAUROC: 0.7391911745071411
	RegressionCompetitionScore: 0.35644171779141104



Validation scores:
	RegressionAUROC: 0.7301534414291382
	RegressionCompetitionScore: 0.3309815950920245



Validation scores:
	RegressionAUROC: 0.736931562423706
	RegressionCompetitionScore: 0.3303680981595092



Validation scores:
	RegressionAUROC: 0.74781334400177
	RegressionCompetitionScore: 0.3469325153374233



Validation scores:
	RegressionAUROC: 0.7473101019859314
	RegressionCompetitionScore: 0.37484662576687117



Validation scores:
	RegressionAUROC: 0.7700477242469788
	RegressionCompetitionScore: 0.36871165644171777

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3693251533742331
     Test RegressionAUROC             0.743515133857727
Test RegressionCompetitionScore      0.3693251533742331
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 13:38:02,781][0m Trial 224 finished with value: 0.3693251533742331 and parameters: {'lr': 0.0006485776790582444, 'dropout': 0.4229740783074523, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 644, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0004258362103706428, 'dropout': 0.50316128573747, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 619, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 67.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
67.0 K    Trainable params
0         Non-trainable params
67.0 K    Total params
0.268     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5120773315429688
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5969946384429932
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.262


Validation scores:
	RegressionAUROC: 0.6732023358345032
	RegressionCompetitionScore: 0.23588957055214724

Metric val_loss improved by 0.063 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6856807470321655
	RegressionCompetitionScore: 0.23466257668711657

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6891692876815796
	RegressionCompetitionScore: 0.2647239263803681

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7137383222579956
	RegressionCompetitionScore: 0.2950920245398773



Validation scores:
	RegressionAUROC: 0.7359734773635864
	RegressionCompetitionScore: 0.3791411042944785



Validation scores:
	RegressionAUROC: 0.742556095123291
	RegressionCompetitionScore: 0.3693251533742331



Validation scores:
	RegressionAUROC: 0.7538353800773621
	RegressionCompetitionScore: 0.39171779141104296

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7539339661598206
	RegressionCompetitionScore: 0.34938650306748464

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7595662474632263
	RegressionCompetitionScore: 0.38987730061349696

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7640680074691772
	RegressionCompetitionScore: 0.35153374233128837

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7720764875411987
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7154275178909302
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7628031969070435
	RegressionCompetitionScore: 0.39846625766871163



Validation scores:
	RegressionAUROC: 0.7633768320083618
	RegressionCompetitionScore: 0.3763803680981595

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7665880918502808
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7661567330360413
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7664704322814941
	RegressionCompetitionScore: 0.4260736196319018



Validation scores:
	RegressionAUROC: 0.7631887197494507
	RegressionCompetitionScore: 0.39171779141104296



Validation scores:
	RegressionAUROC: 0.7698302268981934
	RegressionCompetitionScore: 0.43190184049079755



Validation scores:
	RegressionAUROC: 0.7676801085472107
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7701367735862732
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.166. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3763803680981595
     Test RegressionAUROC            0.7633768320083618
Test RegressionCompetitionScore      0.3763803680981595
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 13:47:08,272][0m Trial 225 finished with value: 0.3763803680981595 and parameters: {'lr': 0.0004258362103706428, 'dropout': 0.50316128573747, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 619, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0009829424380815416, 'dropout': 0.45703093933677447, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 670, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 47.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
47.0 K    Trainable params
0         Non-trainable params
47.0 K    Total params
0.188     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.652429461479187
	RegressionCompetitionScore: 0.08190184049079755

Metric val_loss improved. New best score: 0.259


Validation scores:
	RegressionAUROC: 0.6958985924720764
	RegressionCompetitionScore: 0.2371165644171779

Metric val_loss improved by 0.065 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7028145790100098
	RegressionCompetitionScore: 0.2674846625766871



Validation scores:
	RegressionAUROC: 0.7052922248840332
	RegressionCompetitionScore: 0.29325153374233126

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7195718288421631
	RegressionCompetitionScore: 0.36901840490797544



Validation scores:
	RegressionAUROC: 0.7437906861305237
	RegressionCompetitionScore: 0.3901840490797546

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.704606294631958
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7249691486358643
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7252812385559082
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7315242886543274
	RegressionCompetitionScore: 0.2754601226993865



Validation scores:
	RegressionAUROC: 0.7176944017410278
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6873229146003723
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6338573098182678
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.190. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3901840490797546
     Test RegressionAUROC            0.7437906861305237
Test RegressionCompetitionScore      0.3901840490797546
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 13:52:37,617][0m Trial 226 finished with value: 0.3901840490797546 and parameters: {'lr': 0.0009829424380815416, 'dropout': 0.45703093933677447, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 670, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00030893510169157176, 'dropout': 0.40487783762498386, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 497, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 49.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
49.9 K    Trainable params
0         Non-trainable params
49.9 K    Total params
0.200     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6822625398635864
	RegressionCompetitionScore: 0.1530674846625767

Metric val_loss improved. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.7028770446777344
	RegressionCompetitionScore: 0.2607361963190184

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7017500996589661
	RegressionCompetitionScore: 0.26901840490797546



Validation scores:
	RegressionAUROC: 0.7139862775802612
	RegressionCompetitionScore: 0.347239263803681



Validation scores:
	RegressionAUROC: 0.7340360879898071
	RegressionCompetitionScore: 0.36134969325153377

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7443681359291077
	RegressionCompetitionScore: 0.38006134969325156



Validation scores:
	RegressionAUROC: 0.7707983255386353
	RegressionCompetitionScore: 0.3889570552147239

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7725015878677368
	RegressionCompetitionScore: 0.38834355828220857

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7745072841644287
	RegressionCompetitionScore: 0.41932515337423315

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7908390760421753
	RegressionCompetitionScore: 0.44631901840490795



Validation scores:
	RegressionAUROC: 0.7920107841491699
	RegressionCompetitionScore: 0.4368098159509202

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7959098219871521
	RegressionCompetitionScore: 0.4493865030674847



Validation scores:
	RegressionAUROC: 0.7931501865386963
	RegressionCompetitionScore: 0.4371165644171779

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.155


Validation scores:
	RegressionAUROC: 0.784740149974823
	RegressionCompetitionScore: 0.42822085889570555



Validation scores:
	RegressionAUROC: 0.8034114837646484
	RegressionCompetitionScore: 0.41411042944785276



Validation scores:
	RegressionAUROC: 0.7978379726409912
	RegressionCompetitionScore: 0.4420245398773006



Validation scores:
	RegressionAUROC: 0.8053745031356812
	RegressionCompetitionScore: 0.455521472392638



Validation scores:
	RegressionAUROC: 0.7957754135131836
	RegressionCompetitionScore: 0.453680981595092



Validation scores:
	RegressionAUROC: 0.779165506362915
	RegressionCompetitionScore: 0.4076687116564417



Validation scores:
	RegressionAUROC: 0.7926989793777466
	RegressionCompetitionScore: 0.42822085889570555

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.155. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4371165644171779
     Test RegressionAUROC            0.7931501865386963
Test RegressionCompetitionScore      0.4371165644171779
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 14:00:51,850][0m Trial 227 finished with value: 0.4371165644171779 and parameters: {'lr': 0.00030893510169157176, 'dropout': 0.40487783762498386, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 497, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0003354926361742862, 'dropout': 0.4065481576901256, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 572, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 53.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
53.7 K    Trainable params
0         Non-trainable params
53.7 K    Total params
0.215     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.46859902143478394
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.705856204032898
	RegressionCompetitionScore: 0.298159509202454

Metric val_loss improved. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6845533847808838
	RegressionCompetitionScore: 0.3184049079754601



Validation scores:
	RegressionAUROC: 0.7070921659469604
	RegressionCompetitionScore: 0.3052147239263804



Validation scores:
	RegressionAUROC: 0.7193024754524231
	RegressionCompetitionScore: 0.34754601226993864

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7326660752296448
	RegressionCompetitionScore: 0.38650306748466257

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7433792948722839
	RegressionCompetitionScore: 0.38650306748466257



Validation scores:
	RegressionAUROC: 0.7371079921722412
	RegressionCompetitionScore: 0.36257668711656443



Validation scores:
	RegressionAUROC: 0.7340878248214722
	RegressionCompetitionScore: 0.36165644171779143



Validation scores:
	RegressionAUROC: 0.7015219926834106
	RegressionCompetitionScore: 0.3049079754601227



Validation scores:
	RegressionAUROC: 0.7438198328018188
	RegressionCompetitionScore: 0.3932515337423313



Validation scores:
	RegressionAUROC: 0.7380804419517517
	RegressionCompetitionScore: 0.3806748466257669



Validation scores:
	RegressionAUROC: 0.7516360282897949
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38650306748466257
     Test RegressionAUROC            0.7326660752296448
Test RegressionCompetitionScore      0.38650306748466257
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 14:06:01,726][0m Trial 228 finished with value: 0.38650306748466257 and parameters: {'lr': 0.0003354926361742862, 'dropout': 0.4065481576901256, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 572, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.000537999734553491, 'dropout': 0.41147772862343934, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 505, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 41.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
41.4 K    Trainable params
0         Non-trainable params
41.4 K    Total params
0.166     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.32367148995399475
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.7252274751663208
	RegressionCompetitionScore: 0.3389570552147239

Metric val_loss improved. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.6888943910598755
	RegressionCompetitionScore: 0.27791411042944786



Validation scores:
	RegressionAUROC: 0.7272355556488037
	RegressionCompetitionScore: 0.37300613496932516

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7283087968826294
	RegressionCompetitionScore: 0.36073619631901843



Validation scores:
	RegressionAUROC: 0.7252818942070007
	RegressionCompetitionScore: 0.3184049079754601



Validation scores:
	RegressionAUROC: 0.7436591386795044
	RegressionCompetitionScore: 0.36349693251533743



Validation scores:
	RegressionAUROC: 0.7529214024543762
	RegressionCompetitionScore: 0.36901840490797544



Validation scores:
	RegressionAUROC: 0.7421854734420776
	RegressionCompetitionScore: 0.35736196319018404



Validation scores:
	RegressionAUROC: 0.724301815032959
	RegressionCompetitionScore: 0.25030674846625767



Validation scores:
	RegressionAUROC: 0.7368428111076355
	RegressionCompetitionScore: 0.3116564417177914

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37300613496932516
     Test RegressionAUROC            0.7272355556488037
Test RegressionCompetitionScore      0.37300613496932516
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 14:10:19,995][0m Trial 229 finished with value: 0.37300613496932516 and parameters: {'lr': 0.000537999734553491, 'dropout': 0.41147772862343934, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 505, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0015956519038347774, 'dropout': 0.42084680455404655, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 607, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 55.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
55.5 K    Trainable params
0         Non-trainable params
55.5 K    Total params
0.222     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6159420013427734
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.6977198123931885
	RegressionCompetitionScore: 0.27269938650306746

Metric val_loss improved. New best score: 0.297


Validation scores:
	RegressionAUROC: 0.698620080947876
	RegressionCompetitionScore: 0.27791411042944786

Metric val_loss improved by 0.087 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.716507077217102
	RegressionCompetitionScore: 0.3058282208588957

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7082891464233398
	RegressionCompetitionScore: 0.2960122699386503



Validation scores:
	RegressionAUROC: 0.6600737571716309
	RegressionCompetitionScore: 0.24846625766871167



Validation scores:
	RegressionAUROC: 0.6860615015029907
	RegressionCompetitionScore: 0.21503067484662577



Validation scores:
	RegressionAUROC: 0.6985728740692139
	RegressionCompetitionScore: 0.2846625766871166



Validation scores:
	RegressionAUROC: 0.7151053547859192
	RegressionCompetitionScore: 0.2911042944785276



Validation scores:
	RegressionAUROC: 0.6839755773544312
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7030878067016602
	RegressionCompetitionScore: 0.29938650306748466

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.178. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3058282208588957
     Test RegressionAUROC             0.716507077217102
Test RegressionCompetitionScore      0.3058282208588957
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 14:14:42,763][0m Trial 230 finished with value: 0.3058282208588957 and parameters: {'lr': 0.0015956519038347774, 'dropout': 0.42084680455404655, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 607, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00030874926789335277, 'dropout': 0.46696698497211986, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 473, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 48.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
48.7 K    Trainable params
0         Non-trainable params
48.7 K    Total params
0.195     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4782608449459076
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.6999419331550598
	RegressionCompetitionScore: 0.31993865030674845

Metric val_loss improved. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.7267469167709351
	RegressionCompetitionScore: 0.3585889570552147

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7234395742416382
	RegressionCompetitionScore: 0.37147239263803683



Validation scores:
	RegressionAUROC: 0.7214713096618652
	RegressionCompetitionScore: 0.36595092024539877

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7387738227844238
	RegressionCompetitionScore: 0.36625766871165644

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7496171593666077
	RegressionCompetitionScore: 0.38834355828220857

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7449181079864502
	RegressionCompetitionScore: 0.36073619631901843



Validation scores:
	RegressionAUROC: 0.7320094108581543
	RegressionCompetitionScore: 0.3401840490797546



Validation scores:
	RegressionAUROC: 0.7450804710388184
	RegressionCompetitionScore: 0.37852760736196317



Validation scores:
	RegressionAUROC: 0.7443927526473999
	RegressionCompetitionScore: 0.37208588957055216



Validation scores:
	RegressionAUROC: 0.7474199533462524
	RegressionCompetitionScore: 0.37024539877300616



Validation scores:
	RegressionAUROC: 0.7283902764320374
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7417246699333191
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38834355828220857
     Test RegressionAUROC            0.7496171593666077
Test RegressionCompetitionScore      0.38834355828220857
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 14:20:12,497][0m Trial 231 finished with value: 0.38834355828220857 and parameters: {'lr': 0.00030874926789335277, 'dropout': 0.46696698497211986, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 473, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0007457208031025115, 'dropout': 0.40111892745438305, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 342, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 42.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
42.0 K    Trainable params
0         Non-trainable params
42.0 K    Total params
0.168     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6962008476257324
	RegressionCompetitionScore: 0.2650306748466258

Metric val_loss improved. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.7102996110916138
	RegressionCompetitionScore: 0.31349693251533745

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7260820269584656
	RegressionCompetitionScore: 0.38128834355828223



Validation scores:
	RegressionAUROC: 0.7279003858566284
	RegressionCompetitionScore: 0.3717791411042945

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7362968325614929
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.733007550239563
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7390187382698059
	RegressionCompetitionScore: 0.37607361963190183



Validation scores:
	RegressionAUROC: 0.7374857664108276
	RegressionCompetitionScore: 0.34355828220858897

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7320332527160645
	RegressionCompetitionScore: 0.35184049079754603



Validation scores:
	RegressionAUROC: 0.7359560132026672
	RegressionCompetitionScore: 0.29478527607361965

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7440195679664612
	RegressionCompetitionScore: 0.3665644171779141

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7389600276947021
	RegressionCompetitionScore: 0.25153374233128833



Validation scores:
	RegressionAUROC: 0.7235236167907715
	RegressionCompetitionScore: 0.250920245398773



Validation scores:
	RegressionAUROC: 0.753508448600769
	RegressionCompetitionScore: 0.3993865030674847



Validation scores:
	RegressionAUROC: 0.7627794742584229
	RegressionCompetitionScore: 0.39263803680981596



Validation scores:
	RegressionAUROC: 0.7745219469070435
	RegressionCompetitionScore: 0.3263803680981595

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.7627313137054443
	RegressionCompetitionScore: 0.38098159509202456



Validation scores:
	RegressionAUROC: 0.7746162414550781
	RegressionCompetitionScore: 0.4116564417177914



Validation scores:
	RegressionAUROC: 0.7736091613769531
	RegressionCompetitionScore: 0.3717791411042945



Validation scores:
	RegressionAUROC: 0.7627648115158081
	RegressionCompetitionScore: 0.3745398773006135



Validation scores:
	RegressionAUROC: 0.7678972482681274
	RegressionCompetitionScore: 0.4125766871165644



Validation scores:
	RegressionAUROC: 0.7493435144424438
	RegressionCompetitionScore: 0.27024539877300613



Validation scores:
	RegressionAUROC: 0.7331589460372925
	RegressionCompetitionScore: 0.23895705521472393

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.161. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3263803680981595
     Test RegressionAUROC            0.7745219469070435
Test RegressionCompetitionScore      0.3263803680981595
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 14:29:31,807][0m Trial 232 finished with value: 0.3263803680981595 and parameters: {'lr': 0.0007457208031025115, 'dropout': 0.40111892745438305, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 342, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00043956211935397555, 'dropout': 0.43213667298858227, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 393, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 51.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
51.6 K    Trainable params
0         Non-trainable params
51.6 K    Total params
0.206     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.43719804286956787
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.66321861743927
	RegressionCompetitionScore: 0.18435582822085889

Metric val_loss improved. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6964409947395325
	RegressionCompetitionScore: 0.24723926380368097

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7112942934036255
	RegressionCompetitionScore: 0.28496932515337425

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.72933429479599
	RegressionCompetitionScore: 0.3389570552147239



Validation scores:
	RegressionAUROC: 0.738573431968689
	RegressionCompetitionScore: 0.3389570552147239

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7423011064529419
	RegressionCompetitionScore: 0.35613496932515337



Validation scores:
	RegressionAUROC: 0.7516427040100098
	RegressionCompetitionScore: 0.34478527607361964



Validation scores:
	RegressionAUROC: 0.7573878765106201
	RegressionCompetitionScore: 0.347239263803681



Validation scores:
	RegressionAUROC: 0.7776470184326172
	RegressionCompetitionScore: 0.4076687116564417

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7390956282615662
	RegressionCompetitionScore: 0.35552147239263804



Validation scores:
	RegressionAUROC: 0.7571254968643188
	RegressionCompetitionScore: 0.37484662576687117



Validation scores:
	RegressionAUROC: 0.7657891511917114
	RegressionCompetitionScore: 0.4214723926380368



Validation scores:
	RegressionAUROC: 0.7811580896377563
	RegressionCompetitionScore: 0.37944785276073617



Validation scores:
	RegressionAUROC: 0.7585552930831909
	RegressionCompetitionScore: 0.4107361963190184



Validation scores:
	RegressionAUROC: 0.7642148733139038
	RegressionCompetitionScore: 0.4098159509202454



Validation scores:
	RegressionAUROC: 0.7700750827789307
	RegressionCompetitionScore: 0.40705521472392636

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.166. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4076687116564417
     Test RegressionAUROC            0.7776470184326172
Test RegressionCompetitionScore      0.4076687116564417
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 14:36:12,054][0m Trial 233 finished with value: 0.4076687116564417 and parameters: {'lr': 0.00043956211935397555, 'dropout': 0.43213667298858227, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 393, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0004300353208545246, 'dropout': 0.4283360038950573, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 392, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 51.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
51.6 K    Trainable params
0         Non-trainable params
51.6 K    Total params
0.206     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6859903931617737
	RegressionCompetitionScore: 0.4782608695652174



Validation scores:
	RegressionAUROC: 0.6595430374145508
	RegressionCompetitionScore: 0.2843558282208589

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6913546323776245
	RegressionCompetitionScore: 0.2831288343558282



Validation scores:
	RegressionAUROC: 0.7151026129722595
	RegressionCompetitionScore: 0.3285276073619632

Metric val_loss improved by 0.027 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7333847284317017
	RegressionCompetitionScore: 0.401840490797546



Validation scores:
	RegressionAUROC: 0.7465088367462158
	RegressionCompetitionScore: 0.3736196319018405

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7586376667022705
	RegressionCompetitionScore: 0.4162576687116564



Validation scores:
	RegressionAUROC: 0.7403366565704346
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7602359056472778
	RegressionCompetitionScore: 0.38987730061349696



Validation scores:
	RegressionAUROC: 0.7709745168685913
	RegressionCompetitionScore: 0.4269938650306748



Validation scores:
	RegressionAUROC: 0.7895059585571289
	RegressionCompetitionScore: 0.42668711656441716



Validation scores:
	RegressionAUROC: 0.7711151242256165
	RegressionCompetitionScore: 0.38128834355828223



Validation scores:
	RegressionAUROC: 0.7776956558227539
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3736196319018405
     Test RegressionAUROC            0.7465088367462158
Test RegressionCompetitionScore      0.3736196319018405
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 14:41:17,364][0m Trial 234 finished with value: 0.3736196319018405 and parameters: {'lr': 0.0004300353208545246, 'dropout': 0.4283360038950573, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 392, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0006159504679401379, 'dropout': 0.6616118320900443, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 553, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 52.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
52.8 K    Trainable params
0         Non-trainable params
52.8 K    Total params
0.211     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6650114059448242
	RegressionCompetitionScore: 0.20398773006134968

Metric val_loss improved. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.6854655146598816
	RegressionCompetitionScore: 0.11993865030674847

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6811386942863464
	RegressionCompetitionScore: 0.10122699386503067



Validation scores:
	RegressionAUROC: 0.5996918678283691
	RegressionCompetitionScore: 0.10214723926380367



Validation scores:
	RegressionAUROC: 0.4863172471523285
	RegressionCompetitionScore: 0.10368098159509202



Validation scores:
	RegressionAUROC: 0.5240312218666077
	RegressionCompetitionScore: 0.11533742331288344



Validation scores:
	RegressionAUROC: 0.4989241361618042
	RegressionCompetitionScore: 0.10705521472392639



Validation scores:
	RegressionAUROC: 0.46355003118515015
	RegressionCompetitionScore: 0.08957055214723926



Validation scores:
	RegressionAUROC: 0.6485658884048462
	RegressionCompetitionScore: 0.10889570552147239

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.201. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.11993865030674847
     Test RegressionAUROC            0.6854655146598816
Test RegressionCompetitionScore      0.11993865030674847
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 14:45:12,819][0m Trial 235 finished with value: 0.11993865030674847 and parameters: {'lr': 0.0006159504679401379, 'dropout': 0.6616118320900443, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 553, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0008517482504794483, 'dropout': 0.4367483585228659, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 635, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 68.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
68.1 K    Trainable params
0         Non-trainable params
68.1 K    Total params
0.272     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5772947072982788
	RegressionCompetitionScore: 0.30434782608695654



Validation scores:
	RegressionAUROC: 0.6478778123855591
	RegressionCompetitionScore: 0.20889570552147238

Metric val_loss improved. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.6924149394035339
	RegressionCompetitionScore: 0.22760736196319017



Validation scores:
	RegressionAUROC: 0.670945405960083
	RegressionCompetitionScore: 0.2659509202453988

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.6852823495864868
	RegressionCompetitionScore: 0.2757668711656442

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6945630311965942
	RegressionCompetitionScore: 0.300920245398773

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7039737701416016
	RegressionCompetitionScore: 0.31441717791411045



Validation scores:
	RegressionAUROC: 0.7128360867500305
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7249252796173096
	RegressionCompetitionScore: 0.35429447852760737



Validation scores:
	RegressionAUROC: 0.7139897346496582
	RegressionCompetitionScore: 0.35153374233128837



Validation scores:
	RegressionAUROC: 0.7020646929740906
	RegressionCompetitionScore: 0.3294478527607362



Validation scores:
	RegressionAUROC: 0.6008728742599487
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6222176551818848
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.189. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.300920245398773
     Test RegressionAUROC            0.6945630311965942
Test RegressionCompetitionScore       0.300920245398773
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 14:50:18,250][0m Trial 236 finished with value: 0.300920245398773 and parameters: {'lr': 0.0008517482504794483, 'dropout': 0.4367483585228659, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 635, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00047354803251893943, 'dropout': 0.4159981296968126, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 585, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 44.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
44.1 K    Trainable params
0         Non-trainable params
44.1 K    Total params
0.177     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4106280207633972
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.7143244743347168
	RegressionCompetitionScore: 0.27024539877300613

Metric val_loss improved. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7257286906242371
	RegressionCompetitionScore: 0.3441717791411043



Validation scores:
	RegressionAUROC: 0.7061636447906494
	RegressionCompetitionScore: 0.3061349693251534

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7042809724807739
	RegressionCompetitionScore: 0.2165644171779141



Validation scores:
	RegressionAUROC: 0.7470305562019348
	RegressionCompetitionScore: 0.37300613496932516

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7600457668304443
	RegressionCompetitionScore: 0.38926380368098157

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7707211971282959
	RegressionCompetitionScore: 0.4128834355828221



Validation scores:
	RegressionAUROC: 0.7767633199691772
	RegressionCompetitionScore: 0.40644171779141103

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.754004716873169
	RegressionCompetitionScore: 0.3901840490797546



Validation scores:
	RegressionAUROC: 0.7833898067474365
	RegressionCompetitionScore: 0.4147239263803681



Validation scores:
	RegressionAUROC: 0.796143651008606
	RegressionCompetitionScore: 0.42822085889570555

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.154


Validation scores:
	RegressionAUROC: 0.7952126860618591
	RegressionCompetitionScore: 0.4371165644171779



Validation scores:
	RegressionAUROC: 0.7885364890098572
	RegressionCompetitionScore: 0.43282208588957055



Validation scores:
	RegressionAUROC: 0.7876428961753845
	RegressionCompetitionScore: 0.4187116564417178



Validation scores:
	RegressionAUROC: 0.8008114099502563
	RegressionCompetitionScore: 0.44785276073619634



Validation scores:
	RegressionAUROC: 0.8023660182952881
	RegressionCompetitionScore: 0.48957055214723927



Validation scores:
	RegressionAUROC: 0.7789351940155029
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.7801269292831421
	RegressionCompetitionScore: 0.4386503067484663

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.154. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.42822085889570555
     Test RegressionAUROC             0.796143651008606
Test RegressionCompetitionScore      0.42822085889570555
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 14:57:41,353][0m Trial 237 finished with value: 0.42822085889570555 and parameters: {'lr': 0.00047354803251893943, 'dropout': 0.4159981296968126, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 585, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0004237151289086323, 'dropout': 0.41139456077062675, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 583, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 74.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
74.8 K    Trainable params
0         Non-trainable params
74.8 K    Total params
0.299     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4057970941066742
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6874957084655762
	RegressionCompetitionScore: 0.23680981595092024

Metric val_loss improved. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.6817927360534668
	RegressionCompetitionScore: 0.22423312883435584

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.7014041543006897
	RegressionCompetitionScore: 0.2650306748466258

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7081324458122253
	RegressionCompetitionScore: 0.3015337423312883

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7293791770935059
	RegressionCompetitionScore: 0.3619631901840491



Validation scores:
	RegressionAUROC: 0.7560079097747803
	RegressionCompetitionScore: 0.4279141104294479

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.747651219367981
	RegressionCompetitionScore: 0.39171779141104296

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7566489577293396
	RegressionCompetitionScore: 0.4138036809815951

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7355031967163086
	RegressionCompetitionScore: 0.35030674846625764

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7708879709243774
	RegressionCompetitionScore: 0.43190184049079755



Validation scores:
	RegressionAUROC: 0.7647466659545898
	RegressionCompetitionScore: 0.37944785276073617

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.766564130783081
	RegressionCompetitionScore: 0.4245398773006135



Validation scores:
	RegressionAUROC: 0.7573492527008057
	RegressionCompetitionScore: 0.38496932515337423

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.754868745803833
	RegressionCompetitionScore: 0.40061349693251536

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7548699378967285
	RegressionCompetitionScore: 0.3843558282208589



Validation scores:
	RegressionAUROC: 0.7820245027542114
	RegressionCompetitionScore: 0.37975460122699384

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7782750129699707
	RegressionCompetitionScore: 0.40797546012269936



Validation scores:
	RegressionAUROC: 0.7697113752365112
	RegressionCompetitionScore: 0.400920245398773



Validation scores:
	RegressionAUROC: 0.7752002477645874
	RegressionCompetitionScore: 0.42024539877300615



Validation scores:
	RegressionAUROC: 0.7891196608543396
	RegressionCompetitionScore: 0.4288343558282209



Validation scores:
	RegressionAUROC: 0.781183123588562
	RegressionCompetitionScore: 0.38190184049079756



Validation scores:
	RegressionAUROC: 0.7813516855239868
	RegressionCompetitionScore: 0.4128834355828221



Validation scores:
	RegressionAUROC: 0.7785922884941101
	RegressionCompetitionScore: 0.39355828220858896

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.162. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37975460122699384
     Test RegressionAUROC            0.7820245027542114
Test RegressionCompetitionScore      0.37975460122699384
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 15:07:16,520][0m Trial 238 finished with value: 0.37975460122699384 and parameters: {'lr': 0.0004237151289086323, 'dropout': 0.41139456077062675, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 583, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0006501752934228309, 'dropout': 0.4298546469422824, 'd_model_multiplier': 32, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 595, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 821 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
821 K     Trainable params
0         Non-trainable params
821 K     Total params
3.285     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5265700221061707
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.673


Validation scores:
	RegressionAUROC: 0.5353066325187683
	RegressionCompetitionScore: 0.08619631901840491

Metric val_loss improved by 0.669 >= min_delta = 0.0. New best score: 1.003


Validation scores:
	RegressionAUROC: 0.6432527303695679
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.563 >= min_delta = 0.0. New best score: 0.440


Validation scores:
	RegressionAUROC: 0.689629852771759
	RegressionCompetitionScore: 0.21134969325153374

Metric val_loss improved by 0.203 >= min_delta = 0.0. New best score: 0.237


Validation scores:
	RegressionAUROC: 0.7095857858657837
	RegressionCompetitionScore: 0.2987730061349693



Validation scores:
	RegressionAUROC: 0.6356302499771118
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7092535495758057
	RegressionCompetitionScore: 0.25674846625766873

Metric val_loss improved by 0.055 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6480865478515625
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6817477941513062
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.506213903427124
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5129923820495605
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6096470952033997
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.182. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.25674846625766873
     Test RegressionAUROC            0.7092535495758057
Test RegressionCompetitionScore      0.25674846625766873
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 15:13:10,346][0m Trial 239 finished with value: 0.25674846625766873 and parameters: {'lr': 0.0006501752934228309, 'dropout': 0.4298546469422824, 'd_model_multiplier': 32, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 595, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0003302872745930019, 'dropout': 0.4151575831381519, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 563, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 43.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
43.4 K    Trainable params
0         Non-trainable params
43.4 K    Total params
0.174     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6834654808044434
	RegressionCompetitionScore: 0.3030674846625767

Metric val_loss improved. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.6924806833267212
	RegressionCompetitionScore: 0.3088957055214724

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7233788371086121
	RegressionCompetitionScore: 0.3674846625766871

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7385159730911255
	RegressionCompetitionScore: 0.35460122699386504



Validation scores:
	RegressionAUROC: 0.7405771017074585
	RegressionCompetitionScore: 0.35



Validation scores:
	RegressionAUROC: 0.741778552532196
	RegressionCompetitionScore: 0.3598159509202454

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7429449558258057
	RegressionCompetitionScore: 0.3656441717791411

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7427822351455688
	RegressionCompetitionScore: 0.37484662576687117



Validation scores:
	RegressionAUROC: 0.7163447141647339
	RegressionCompetitionScore: 0.26288343558282207



Validation scores:
	RegressionAUROC: 0.7486349940299988
	RegressionCompetitionScore: 0.35828220858895704



Validation scores:
	RegressionAUROC: 0.7516224384307861
	RegressionCompetitionScore: 0.37423312883435583



Validation scores:
	RegressionAUROC: 0.7517650127410889
	RegressionCompetitionScore: 0.3595092024539877



Validation scores:
	RegressionAUROC: 0.7489566206932068
	RegressionCompetitionScore: 0.3619631901840491



Validation scores:
	RegressionAUROC: 0.7431402206420898
	RegressionCompetitionScore: 0.3257668711656442

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.172. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3656441717791411
     Test RegressionAUROC            0.7429449558258057
Test RegressionCompetitionScore      0.3656441717791411
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 15:19:04,877][0m Trial 240 finished with value: 0.3656441717791411 and parameters: {'lr': 0.0003302872745930019, 'dropout': 0.4151575831381519, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 563, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0004710386131861919, 'dropout': 0.4444713472657776, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 616, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 56.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
56.0 K    Trainable params
0         Non-trainable params
56.0 K    Total params
0.224     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6328188180923462
	RegressionCompetitionScore: 0.2996932515337423

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6779346466064453
	RegressionCompetitionScore: 0.300920245398773



Validation scores:
	RegressionAUROC: 0.7088814377784729
	RegressionCompetitionScore: 0.35920245398773004



Validation scores:
	RegressionAUROC: 0.7208327651023865
	RegressionCompetitionScore: 0.36411042944785277

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.735587477684021
	RegressionCompetitionScore: 0.3693251533742331

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7476048469543457
	RegressionCompetitionScore: 0.36717791411042944



Validation scores:
	RegressionAUROC: 0.7557661533355713
	RegressionCompetitionScore: 0.3708588957055215



Validation scores:
	RegressionAUROC: 0.7592040300369263
	RegressionCompetitionScore: 0.37208588957055216



Validation scores:
	RegressionAUROC: 0.7619352340698242
	RegressionCompetitionScore: 0.35368098159509204

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7558135390281677
	RegressionCompetitionScore: 0.36503067484662577



Validation scores:
	RegressionAUROC: 0.761271595954895
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7589534521102905
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7539198398590088
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7603660821914673
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.776470422744751
	RegressionCompetitionScore: 0.3901840490797546

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7487044930458069
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7612643241882324
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.776054859161377
	RegressionCompetitionScore: 0.44263803680981595



Validation scores:
	RegressionAUROC: 0.7795308828353882
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7763535976409912
	RegressionCompetitionScore: 0.45766871165644174



Validation scores:
	RegressionAUROC: 0.7800965309143066
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7365942001342773
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.165. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3901840490797546
     Test RegressionAUROC             0.776470422744751
Test RegressionCompetitionScore      0.3901840490797546
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 15:28:05,572][0m Trial 241 finished with value: 0.3901840490797546 and parameters: {'lr': 0.0004710386131861919, 'dropout': 0.4444713472657776, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 616, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0005436977309728104, 'dropout': 0.4515916780579036, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 592, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 54.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
54.8 K    Trainable params
0         Non-trainable params
54.8 K    Total params
0.219     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.653579592704773
	RegressionCompetitionScore: 0.2659509202453988

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.7136333584785461
	RegressionCompetitionScore: 0.3058282208588957

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7190353870391846
	RegressionCompetitionScore: 0.36595092024539877



Validation scores:
	RegressionAUROC: 0.7267711758613586
	RegressionCompetitionScore: 0.37699386503067484



Validation scores:
	RegressionAUROC: 0.7272318601608276
	RegressionCompetitionScore: 0.37484662576687117



Validation scores:
	RegressionAUROC: 0.740291178226471
	RegressionCompetitionScore: 0.41595092024539876



Validation scores:
	RegressionAUROC: 0.7517041563987732
	RegressionCompetitionScore: 0.4401840490797546

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7393324375152588
	RegressionCompetitionScore: 0.40521472392638036



Validation scores:
	RegressionAUROC: 0.7210280299186707
	RegressionCompetitionScore: 0.34202453987730064



Validation scores:
	RegressionAUROC: 0.7556629180908203
	RegressionCompetitionScore: 0.37852760736196317



Validation scores:
	RegressionAUROC: 0.7488371133804321
	RegressionCompetitionScore: 0.399079754601227



Validation scores:
	RegressionAUROC: 0.7489601969718933
	RegressionCompetitionScore: 0.3932515337423313



Validation scores:
	RegressionAUROC: 0.7619491815567017
	RegressionCompetitionScore: 0.38588957055214723

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7606976628303528
	RegressionCompetitionScore: 0.39631901840490796



Validation scores:
	RegressionAUROC: 0.7632496953010559
	RegressionCompetitionScore: 0.38773006134969323



Validation scores:
	RegressionAUROC: 0.757411003112793
	RegressionCompetitionScore: 0.4156441717791411



Validation scores:
	RegressionAUROC: 0.7502700090408325
	RegressionCompetitionScore: 0.36073619631901843



Validation scores:
	RegressionAUROC: 0.7432873249053955
	RegressionCompetitionScore: 0.39263803680981596



Validation scores:
	RegressionAUROC: 0.7385128736495972
	RegressionCompetitionScore: 0.3168711656441718



Validation scores:
	RegressionAUROC: 0.7477418184280396
	RegressionCompetitionScore: 0.3803680981595092

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.166. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38588957055214723
     Test RegressionAUROC            0.7619491815567017
Test RegressionCompetitionScore      0.38588957055214723
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 15:36:18,505][0m Trial 242 finished with value: 0.38588957055214723 and parameters: {'lr': 0.0005436977309728104, 'dropout': 0.4515916780579036, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 592, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0002937430323156556, 'dropout': 0.42107328256172083, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 609, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 45.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
41.4 K    Trainable params
3.6 K     Non-trainable params
45.0 K    Total params
0.180     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6793501973152161
	RegressionCompetitionScore: 0.2668711656441718

Metric val_loss improved. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.7106464505195618
	RegressionCompetitionScore: 0.31901840490797545

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7154176831245422
	RegressionCompetitionScore: 0.34049079754601225



Validation scores:
	RegressionAUROC: 0.7271757125854492
	RegressionCompetitionScore: 0.35828220858895704

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.740497350692749
	RegressionCompetitionScore: 0.38282208588957056



Validation scores:
	RegressionAUROC: 0.7368981838226318
	RegressionCompetitionScore: 0.4208588957055215



Validation scores:
	RegressionAUROC: 0.7478088140487671
	RegressionCompetitionScore: 0.38374233128834356



Validation scores:
	RegressionAUROC: 0.7391474843025208
	RegressionCompetitionScore: 0.3960122699386503

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.740010142326355
	RegressionCompetitionScore: 0.402760736196319



Validation scores:
	RegressionAUROC: 0.7655084729194641
	RegressionCompetitionScore: 0.41840490797546015



Validation scores:
	RegressionAUROC: 0.7599903345108032
	RegressionCompetitionScore: 0.3628834355828221



Validation scores:
	RegressionAUROC: 0.7740486860275269
	RegressionCompetitionScore: 0.42668711656441716



Validation scores:
	RegressionAUROC: 0.7795191407203674
	RegressionCompetitionScore: 0.39171779141104296



Validation scores:
	RegressionAUROC: 0.7679173946380615
	RegressionCompetitionScore: 0.3901840490797546



Validation scores:
	RegressionAUROC: 0.7798105478286743
	RegressionCompetitionScore: 0.3889570552147239

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.779255747795105
	RegressionCompetitionScore: 0.42392638036809815



Validation scores:
	RegressionAUROC: 0.7865098714828491
	RegressionCompetitionScore: 0.41932515337423315



Validation scores:
	RegressionAUROC: 0.7860411405563354
	RegressionCompetitionScore: 0.4223926380368098



Validation scores:
	RegressionAUROC: 0.7788342237472534
	RegressionCompetitionScore: 0.43650306748466255



Validation scores:
	RegressionAUROC: 0.7925138473510742
	RegressionCompetitionScore: 0.45674846625766874



Validation scores:
	RegressionAUROC: 0.7856190800666809
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7861915826797485
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.162. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3889570552147239
     Test RegressionAUROC            0.7798105478286743
Test RegressionCompetitionScore      0.3889570552147239
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 15:45:17,691][0m Trial 243 finished with value: 0.3889570552147239 and parameters: {'lr': 0.0002937430323156556, 'dropout': 0.42107328256172083, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 609, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0009793278911011886, 'dropout': 0.4772136210438267, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 572, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 33.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
33.6 K    Trainable params
0         Non-trainable params
33.6 K    Total params
0.135     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6980403065681458
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.310


Validation scores:
	RegressionAUROC: 0.7102637887001038
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.063 >= min_delta = 0.0. New best score: 0.247


Validation scores:
	RegressionAUROC: 0.7002882957458496
	RegressionCompetitionScore: 0.18619631901840492

Metric val_loss improved by 0.061 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7290040254592896
	RegressionCompetitionScore: 0.3450920245398773

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7306416034698486
	RegressionCompetitionScore: 0.32607361963190185

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7271623611450195
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7418692708015442
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7253544330596924
	RegressionCompetitionScore: 0.25552147239263806



Validation scores:
	RegressionAUROC: 0.744025707244873
	RegressionCompetitionScore: 0.28865030674846626



Validation scores:
	RegressionAUROC: 0.755402684211731
	RegressionCompetitionScore: 0.3708588957055215



Validation scores:
	RegressionAUROC: 0.7510203719139099
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6675434112548828
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.32607361963190185
     Test RegressionAUROC            0.7306416034698486
Test RegressionCompetitionScore      0.32607361963190185
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 15:50:23,641][0m Trial 244 finished with value: 0.32607361963190185 and parameters: {'lr': 0.0009793278911011886, 'dropout': 0.4772136210438267, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 572, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00039223110592229117, 'dropout': 0.4404743256415274, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 631, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 56.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
56.8 K    Trainable params
0         Non-trainable params
56.8 K    Total params
0.227     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5072463154792786
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.6916272640228271
	RegressionCompetitionScore: 0.25245398773006134

Metric val_loss improved. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7079683542251587
	RegressionCompetitionScore: 0.3116564417177914

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7002607583999634
	RegressionCompetitionScore: 0.25950920245398773



Validation scores:
	RegressionAUROC: 0.72438645362854
	RegressionCompetitionScore: 0.3131901840490798



Validation scores:
	RegressionAUROC: 0.7430174350738525
	RegressionCompetitionScore: 0.36441717791411044



Validation scores:
	RegressionAUROC: 0.7510331273078918
	RegressionCompetitionScore: 0.3834355828220859

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7555859088897705
	RegressionCompetitionScore: 0.39171779141104296

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7367600202560425
	RegressionCompetitionScore: 0.3901840490797546



Validation scores:
	RegressionAUROC: 0.7494905591011047
	RegressionCompetitionScore: 0.3843558282208589



Validation scores:
	RegressionAUROC: 0.7482718229293823
	RegressionCompetitionScore: 0.36503067484662577



Validation scores:
	RegressionAUROC: 0.7510966062545776
	RegressionCompetitionScore: 0.3070552147239264

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7569667100906372
	RegressionCompetitionScore: 0.3665644171779141



Validation scores:
	RegressionAUROC: 0.7246711850166321
	RegressionCompetitionScore: 0.26625766871165646



Validation scores:
	RegressionAUROC: 0.7377459406852722
	RegressionCompetitionScore: 0.346319018404908



Validation scores:
	RegressionAUROC: 0.767845630645752
	RegressionCompetitionScore: 0.40613496932515336



Validation scores:
	RegressionAUROC: 0.7731727361679077
	RegressionCompetitionScore: 0.3049079754601227

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.160


Validation scores:
	RegressionAUROC: 0.754896879196167
	RegressionCompetitionScore: 0.36073619631901843



Validation scores:
	RegressionAUROC: 0.757382869720459
	RegressionCompetitionScore: 0.3754601226993865



Validation scores:
	RegressionAUROC: 0.769131064414978
	RegressionCompetitionScore: 0.40337423312883436



Validation scores:
	RegressionAUROC: 0.7790117263793945
	RegressionCompetitionScore: 0.4012269938650307



Validation scores:
	RegressionAUROC: 0.765099823474884
	RegressionCompetitionScore: 0.2598159509202454



Validation scores:
	RegressionAUROC: 0.7741477489471436
	RegressionCompetitionScore: 0.38098159509202456



Validation scores:
	RegressionAUROC: 0.7674323916435242
	RegressionCompetitionScore: 0.35030674846625764

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.160. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3049079754601227
     Test RegressionAUROC            0.7731727361679077
Test RegressionCompetitionScore      0.3049079754601227
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 15:59:49,878][0m Trial 245 finished with value: 0.3049079754601227 and parameters: {'lr': 0.00039223110592229117, 'dropout': 0.4404743256415274, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 631, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0007063347352893213, 'dropout': 0.5078877973265369, 'd_model_multiplier': 16, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 542, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 957 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
957 K     Trainable params
0         Non-trainable params
957 K     Total params
3.831     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5072463750839233
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.6050707101821899
	RegressionCompetitionScore: 0.07638036809815951

Metric val_loss improved. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5008876919746399
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6853944063186646
	RegressionCompetitionScore: 0.27361963190184047



Validation scores:
	RegressionAUROC: 0.6646785140037537
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5839481949806213
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5216749310493469
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5861377716064453
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.215. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.07638036809815951
     Test RegressionAUROC            0.6050707101821899
Test RegressionCompetitionScore      0.07638036809815951
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 16:03:29,351][0m Trial 246 finished with value: 0.07638036809815951 and parameters: {'lr': 0.0007063347352893213, 'dropout': 0.5078877973265369, 'd_model_multiplier': 16, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 542, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.06594038589412886, 'dropout': 0.8678963512737005, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 653, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 57.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
54.3 K    Trainable params
3.6 K     Non-trainable params
57.9 K    Total params
0.232     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6908212900161743
	RegressionCompetitionScore: 0.391304347826087



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.651


Validation scores:
	RegressionAUROC: 0.647202730178833
	RegressionCompetitionScore: 0.28957055214723926

Metric val_loss improved by 1.273 >= min_delta = 0.0. New best score: 0.378


Validation scores:
	RegressionAUROC: 0.6069506406784058
	RegressionCompetitionScore: 0.2401840490797546

Metric val_loss improved by 0.117 >= min_delta = 0.0. New best score: 0.261


Validation scores:
	RegressionAUROC: 0.38398972153663635
	RegressionCompetitionScore: 0.09846625766871166

Metric val_loss improved by 0.049 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.42055827379226685
	RegressionCompetitionScore: 0.008895705521472393

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.46267426013946533
	RegressionCompetitionScore: 0.06687116564417178



Validation scores:
	RegressionAUROC: 0.49555349349975586
	RegressionCompetitionScore: 0.08742331288343558



Validation scores:
	RegressionAUROC: 0.3393137753009796
	RegressionCompetitionScore: 0.036503067484662574



Validation scores:
	RegressionAUROC: 0.34918123483657837
	RegressionCompetitionScore: 0.034662576687116566



Validation scores:
	RegressionAUROC: 0.6513898968696594
	RegressionCompetitionScore: 0.24969325153374233



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5817449688911438
	RegressionCompetitionScore: 0.09141104294478528

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore          0.008895705521472393
     Test RegressionAUROC            0.42055827379226685
Test RegressionCompetitionScore     0.008895705521472393
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 16:08:35,914][0m Trial 247 finished with value: 0.008895705521472393 and parameters: {'lr': 0.06594038589412886, 'dropout': 0.8678963512737005, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 653, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00029014980555510024, 'dropout': 0.4023663395781746, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 64, 'dim_feedforward': 110, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 168 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
168 K     Trainable params
0         Non-trainable params
168 K     Total params
0.674     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2753623127937317
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6797314882278442
	RegressionCompetitionScore: 0.29846625766871165

Metric val_loss improved. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7174093723297119
	RegressionCompetitionScore: 0.3015337423312883



Validation scores:
	RegressionAUROC: 0.7242321968078613
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7382300496101379
	RegressionCompetitionScore: 0.37760736196319017



Validation scores:
	RegressionAUROC: 0.728866457939148
	RegressionCompetitionScore: 0.3610429447852761

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7273897528648376
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7371838688850403
	RegressionCompetitionScore: 0.36503067484662577



Validation scores:
	RegressionAUROC: 0.7409141063690186
	RegressionCompetitionScore: 0.3736196319018405



Validation scores:
	RegressionAUROC: 0.7186362743377686
	RegressionCompetitionScore: 0.31441717791411045



Validation scores:
	RegressionAUROC: 0.7458198070526123
	RegressionCompetitionScore: 0.39723926380368096



Validation scores:
	RegressionAUROC: 0.7451401948928833
	RegressionCompetitionScore: 0.38098159509202456

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7524421811103821
	RegressionCompetitionScore: 0.3773006134969325

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7359508275985718
	RegressionCompetitionScore: 0.34202453987730064



Validation scores:
	RegressionAUROC: 0.7402992844581604
	RegressionCompetitionScore: 0.3558282208588957



Validation scores:
	RegressionAUROC: 0.7657598853111267
	RegressionCompetitionScore: 0.40521472392638036



Validation scores:
	RegressionAUROC: 0.7603992819786072
	RegressionCompetitionScore: 0.4138036809815951



Validation scores:
	RegressionAUROC: 0.7689811587333679
	RegressionCompetitionScore: 0.38282208588957056



Validation scores:
	RegressionAUROC: 0.782710075378418
	RegressionCompetitionScore: 0.4217791411042945



Validation scores:
	RegressionAUROC: 0.7733386754989624
	RegressionCompetitionScore: 0.40245398773006136

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.166. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3773006134969325
     Test RegressionAUROC            0.7524421811103821
Test RegressionCompetitionScore      0.3773006134969325
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 16:18:28,224][0m Trial 248 finished with value: 0.3773006134969325 and parameters: {'lr': 0.00029014980555510024, 'dropout': 0.4023663395781746, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 64, 'dim_feedforward': 110, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0005831905292961151, 'dropout': 0.4596923883246184, 'd_model_multiplier': 64, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 578, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 7.1 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
7.1 M     Trainable params
0         Non-trainable params
7.1 M     Total params
28.277    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6521738767623901
	RegressionCompetitionScore: 0.30434782608695654



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 24.421


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 20.078 >= min_delta = 0.0. New best score: 4.343


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 3.287 >= min_delta = 0.0. New best score: 1.056


Validation scores:
	RegressionAUROC: 0.5907302498817444
	RegressionCompetitionScore: 0.23895705521472393

Metric val_loss improved by 0.576 >= min_delta = 0.0. New best score: 0.479


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6026161909103394
	RegressionCompetitionScore: 0.25122699386503067

Metric val_loss improved by 0.109 >= min_delta = 0.0. New best score: 0.370


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5285835266113281
	RegressionCompetitionScore: 0.1745398773006135



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4758400619029999
	RegressionCompetitionScore: 0.09110429447852761

Metric val_loss improved by 0.092 >= min_delta = 0.0. New best score: 0.278


Validation scores:
	RegressionAUROC: 0.44044220447540283
	RegressionCompetitionScore: 0.08404907975460123

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5737965703010559
	RegressionCompetitionScore: 0.14079754601226993

Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5737189054489136
	RegressionCompetitionScore: 0.016564417177914112

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.4123094081878662
	RegressionCompetitionScore: 0.02638036809815951



Validation scores:
	RegressionAUROC: 0.3780013918876648
	RegressionCompetitionScore: 0.02822085889570552



Validation scores:
	RegressionAUROC: 0.6427693367004395
	RegressionCompetitionScore: 0.27300613496932513



Validation scores:
	RegressionAUROC: 0.46595144271850586
	RegressionCompetitionScore: 0.03619631901840491



Validation scores:
	RegressionAUROC: 0.6048253774642944
	RegressionCompetitionScore: 0.08957055214723926



Validation scores:
	RegressionAUROC: 0.4520152807235718
	RegressionCompetitionScore: 0.06288343558282208



Validation scores:
	RegressionAUROC: 0.4590476453304291
	RegressionCompetitionScore: 0.06196319018404908

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.56630539894104
	RegressionCompetitionScore: 0.0696319018404908



Validation scores:
	RegressionAUROC: 0.41885077953338623
	RegressionCompetitionScore: 0.011042944785276074



Validation scores:
	RegressionAUROC: 0.4736477732658386
	RegressionCompetitionScore: 0.04325153374233129



Validation scores:
	RegressionAUROC: 0.3738536238670349
	RegressionCompetitionScore: 0.04570552147239264



Validation scores:
	RegressionAUROC: 0.3947184383869171
	RegressionCompetitionScore: 0.03128834355828221



Validation scores:
	RegressionAUROC: 0.35471218824386597
	RegressionCompetitionScore: 0.02607361963190184



Validation scores:
	RegressionAUROC: 0.46520328521728516
	RegressionCompetitionScore: 0.05

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.06196319018404908
     Test RegressionAUROC            0.4590476453304291
Test RegressionCompetitionScore      0.06196319018404908
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 16:31:11,886][0m Trial 249 finished with value: 0.06196319018404908 and parameters: {'lr': 0.0005831905292961151, 'dropout': 0.4596923883246184, 'd_model_multiplier': 64, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 578, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0004552188630740481, 'dropout': 0.49131077335210727, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 88, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 27.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
27.2 K    Trainable params
0         Non-trainable params
27.2 K    Total params
0.109     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4637681245803833
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6485985517501831
	RegressionCompetitionScore: 0.27024539877300613

Metric val_loss improved. New best score: 0.245


Validation scores:
	RegressionAUROC: 0.6729501485824585
	RegressionCompetitionScore: 0.2794478527607362

Metric val_loss improved by 0.058 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7114145159721375
	RegressionCompetitionScore: 0.27361963190184047

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.733735203742981
	RegressionCompetitionScore: 0.3815950920245399

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.743068277835846
	RegressionCompetitionScore: 0.3911042944785276

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7617658376693726
	RegressionCompetitionScore: 0.39386503067484663



Validation scores:
	RegressionAUROC: 0.7548785209655762
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.7567806243896484
	RegressionCompetitionScore: 0.39171779141104296



Validation scores:
	RegressionAUROC: 0.74403977394104
	RegressionCompetitionScore: 0.3337423312883436



Validation scores:
	RegressionAUROC: 0.7606468200683594
	RegressionCompetitionScore: 0.36871165644171777



Validation scores:
	RegressionAUROC: 0.7598099112510681
	RegressionCompetitionScore: 0.38282208588957056

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7700710892677307
	RegressionCompetitionScore: 0.4067484662576687



Validation scores:
	RegressionAUROC: 0.7569247484207153
	RegressionCompetitionScore: 0.37484662576687117



Validation scores:
	RegressionAUROC: 0.7711765766143799
	RegressionCompetitionScore: 0.4273006134969325



Validation scores:
	RegressionAUROC: 0.7647303342819214
	RegressionCompetitionScore: 0.3993865030674847



Validation scores:
	RegressionAUROC: 0.7756865620613098
	RegressionCompetitionScore: 0.3895705521472393



Validation scores:
	RegressionAUROC: 0.7814609408378601
	RegressionCompetitionScore: 0.4190184049079755



Validation scores:
	RegressionAUROC: 0.785938560962677
	RegressionCompetitionScore: 0.47638036809815953

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.167. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38282208588957056
     Test RegressionAUROC            0.7598099112510681
Test RegressionCompetitionScore      0.38282208588957056
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 16:38:37,544][0m Trial 250 finished with value: 0.38282208588957056 and parameters: {'lr': 0.0004552188630740481, 'dropout': 0.49131077335210727, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 88, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0016724317564667766, 'dropout': 0.44670556943506423, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 451, 'batch_size': 1024, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 47.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
44.0 K    Trainable params
3.6 K     Non-trainable params
47.6 K    Total params
0.190     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5024154782295227
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 2.476


Validation scores:
	RegressionAUROC: 0.4003264307975769
	RegressionCompetitionScore: 0.09723926380368098

Metric val_loss improved by 2.022 >= min_delta = 0.0. New best score: 0.454


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.3922661542892456
	RegressionCompetitionScore: 0.08742331288343558

Metric val_loss improved by 0.230 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.4968404173851013
	RegressionCompetitionScore: 0.09233128834355828



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4569213092327118
	RegressionCompetitionScore: 0.09263803680981596

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.5823482275009155
	RegressionCompetitionScore: 0.09723926380368098



Validation scores:
	RegressionAUROC: 0.6457304954528809
	RegressionCompetitionScore: 0.1294478527607362



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.56483393907547
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6708246469497681
	RegressionCompetitionScore: 0.25306748466257667



Validation scores:
	RegressionAUROC: 0.5022324323654175
	RegressionCompetitionScore: 0.0049079754601227

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.211. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.09263803680981596
     Test RegressionAUROC            0.4569213092327118
Test RegressionCompetitionScore      0.09263803680981596
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 16:45:19,502][0m Trial 251 finished with value: 0.09263803680981596 and parameters: {'lr': 0.0016724317564667766, 'dropout': 0.44670556943506423, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 451, 'batch_size': 1024, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.000269026011047713, 'dropout': 0.42731977783965536, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 407, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 45.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
45.3 K    Trainable params
0         Non-trainable params
45.3 K    Total params
0.181     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5458937287330627
	RegressionCompetitionScore: 0.391304347826087



Validation scores:
	RegressionAUROC: 0.6718282103538513
	RegressionCompetitionScore: 0.13711656441717793

Metric val_loss improved. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6945673227310181
	RegressionCompetitionScore: 0.3116564417177914

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.7202258110046387
	RegressionCompetitionScore: 0.3346625766871166

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7148338556289673
	RegressionCompetitionScore: 0.2831288343558282



Validation scores:
	RegressionAUROC: 0.7222243547439575
	RegressionCompetitionScore: 0.34355828220858897



Validation scores:
	RegressionAUROC: 0.7458487749099731
	RegressionCompetitionScore: 0.35245398773006137

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7498576641082764
	RegressionCompetitionScore: 0.3579754601226994

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7440276145935059
	RegressionCompetitionScore: 0.37760736196319017



Validation scores:
	RegressionAUROC: 0.7287236452102661
	RegressionCompetitionScore: 0.36411042944785277



Validation scores:
	RegressionAUROC: 0.7635540962219238
	RegressionCompetitionScore: 0.4085889570552147



Validation scores:
	RegressionAUROC: 0.7521499395370483
	RegressionCompetitionScore: 0.3852760736196319



Validation scores:
	RegressionAUROC: 0.760800838470459
	RegressionCompetitionScore: 0.37760736196319017



Validation scores:
	RegressionAUROC: 0.7404259443283081
	RegressionCompetitionScore: 0.3319018404907976



Validation scores:
	RegressionAUROC: 0.7523239850997925
	RegressionCompetitionScore: 0.3763803680981595

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7547813653945923
	RegressionCompetitionScore: 0.37392638036809817



Validation scores:
	RegressionAUROC: 0.7570716142654419
	RegressionCompetitionScore: 0.3595092024539877

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.769095778465271
	RegressionCompetitionScore: 0.38466257668711656



Validation scores:
	RegressionAUROC: 0.7635833621025085
	RegressionCompetitionScore: 0.3932515337423313



Validation scores:
	RegressionAUROC: 0.7550848722457886
	RegressionCompetitionScore: 0.3656441717791411



Validation scores:
	RegressionAUROC: 0.7742620706558228
	RegressionCompetitionScore: 0.40061349693251536



Validation scores:
	RegressionAUROC: 0.7576892375946045
	RegressionCompetitionScore: 0.3791411042944785



Validation scores:
	RegressionAUROC: 0.7618037462234497
	RegressionCompetitionScore: 0.35337423312883437



Validation scores:
	RegressionAUROC: 0.7578548789024353
	RegressionCompetitionScore: 0.3401840490797546

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.167. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3595092024539877
     Test RegressionAUROC            0.7570716142654419
Test RegressionCompetitionScore      0.3595092024539877
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 16:54:42,783][0m Trial 252 finished with value: 0.3595092024539877 and parameters: {'lr': 0.000269026011047713, 'dropout': 0.42731977783965536, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 407, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0008199404937853384, 'dropout': 0.7157740889334729, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 595, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 44.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
44.5 K    Trainable params
0         Non-trainable params
44.5 K    Total params
0.178     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49669933319091797
	RegressionCompetitionScore: 0.08742331288343558

Metric val_loss improved. New best score: 0.291


Validation scores:
	RegressionAUROC: 0.619388997554779
	RegressionCompetitionScore: 0.2776073619631902

Metric val_loss improved by 0.067 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.7009104490280151
	RegressionCompetitionScore: 0.22699386503067484

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6549465656280518
	RegressionCompetitionScore: 0.2334355828220859



Validation scores:
	RegressionAUROC: 0.6360324621200562
	RegressionCompetitionScore: 0.22975460122699387



Validation scores:
	RegressionAUROC: 0.705778956413269
	RegressionCompetitionScore: 0.2687116564417178

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.695754885673523
	RegressionCompetitionScore: 0.25858895705521473



Validation scores:
	RegressionAUROC: 0.7012418508529663
	RegressionCompetitionScore: 0.24785276073619633



Validation scores:
	RegressionAUROC: 0.7003374099731445
	RegressionCompetitionScore: 0.27361963190184047



Validation scores:
	RegressionAUROC: 0.6466968059539795
	RegressionCompetitionScore: 0.12975460122699387



Validation scores:
	RegressionAUROC: 0.6393894553184509
	RegressionCompetitionScore: 0.1303680981595092



Validation scores:
	RegressionAUROC: 0.6705243587493896
	RegressionCompetitionScore: 0.2883435582822086



Validation scores:
	RegressionAUROC: 0.6969573497772217
	RegressionCompetitionScore: 0.2907975460122699

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.184. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2687116564417178
     Test RegressionAUROC             0.705778956413269
Test RegressionCompetitionScore      0.2687116564417178
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 17:00:11,746][0m Trial 253 finished with value: 0.2687116564417178 and parameters: {'lr': 0.0008199404937853384, 'dropout': 0.7157740889334729, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 595, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00036778261927166144, 'dropout': 0.4806514820861096, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 621, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 88.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
88.9 K    Trainable params
0         Non-trainable params
88.9 K    Total params
0.356     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.46666666865348816
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7111654877662659
	RegressionCompetitionScore: 0.3067484662576687

Metric val_loss improved. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.6177096366882324
	RegressionCompetitionScore: 0.14294478527607363



Validation scores:
	RegressionAUROC: 0.6253939270973206
	RegressionCompetitionScore: 0.09877300613496932



Validation scores:
	RegressionAUROC: 0.6261093616485596
	RegressionCompetitionScore: 0.13098159509202453



Validation scores:
	RegressionAUROC: 0.631345808506012
	RegressionCompetitionScore: 0.12576687116564417



Validation scores:
	RegressionAUROC: 0.6243595480918884
	RegressionCompetitionScore: 0.24846625766871167



Validation scores:
	RegressionAUROC: 0.6253626346588135
	RegressionCompetitionScore: 0.22484662576687117



Validation scores:
	RegressionAUROC: 0.6499186158180237
	RegressionCompetitionScore: 0.26012269938650306

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.186. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3067484662576687
     Test RegressionAUROC            0.7111654877662659
Test RegressionCompetitionScore      0.3067484662576687
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 17:04:34,197][0m Trial 254 finished with value: 0.3067484662576687 and parameters: {'lr': 0.00036778261927166144, 'dropout': 0.4806514820861096, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 621, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.002284130212498202, 'dropout': 0.6267067075815376, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 600, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 55.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
51.6 K    Trainable params
3.6 K     Non-trainable params
55.2 K    Total params
0.221     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5314009785652161
	RegressionCompetitionScore: 0.30434782608695654



Validation scores:
	RegressionAUROC: 0.6434366703033447
	RegressionCompetitionScore: 0.10030674846625767

Metric val_loss improved. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.6405267715454102
	RegressionCompetitionScore: 0.2401840490797546

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6454882621765137
	RegressionCompetitionScore: 0.2303680981595092



Validation scores:
	RegressionAUROC: 0.5961589217185974
	RegressionCompetitionScore: 0.24049079754601227



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2401840490797546
     Test RegressionAUROC            0.6405267715454102
Test RegressionCompetitionScore      0.2401840490797546
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 17:08:31,598][0m Trial 255 finished with value: 0.2401840490797546 and parameters: {'lr': 0.002284130212498202, 'dropout': 0.6267067075815376, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 600, 'batch_size': 32, 'pos_encoding': 'fixed', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0009650671926288737, 'dropout': 0.4681773849587007, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 642, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 57.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
57.3 K    Trainable params
0         Non-trainable params
57.3 K    Total params
0.229     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.30917876958847046
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6698646545410156
	RegressionCompetitionScore: 0.22699386503067484

Metric val_loss improved. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6751182675361633
	RegressionCompetitionScore: 0.25337423312883434

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6950154304504395
	RegressionCompetitionScore: 0.3006134969325153



Validation scores:
	RegressionAUROC: 0.7109910845756531
	RegressionCompetitionScore: 0.3521472392638037

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.7299976944923401
	RegressionCompetitionScore: 0.36901840490797544

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7306666374206543
	RegressionCompetitionScore: 0.3496932515337423



Validation scores:
	RegressionAUROC: 0.7373670339584351
	RegressionCompetitionScore: 0.345398773006135

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7227026224136353
	RegressionCompetitionScore: 0.3374233128834356



Validation scores:
	RegressionAUROC: 0.7296870946884155
	RegressionCompetitionScore: 0.36073619631901843

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.6880874037742615
	RegressionCompetitionScore: 0.2745398773006135



Validation scores:
	RegressionAUROC: 0.7150501608848572
	RegressionCompetitionScore: 0.27607361963190186



Validation scores:
	RegressionAUROC: 0.7172608375549316
	RegressionCompetitionScore: 0.24785276073619633



Validation scores:
	RegressionAUROC: 0.7181420922279358
	RegressionCompetitionScore: 0.2665644171779141



Validation scores:
	RegressionAUROC: 0.7196677923202515
	RegressionCompetitionScore: 0.30920245398773005



Validation scores:
	RegressionAUROC: 0.7354864478111267
	RegressionCompetitionScore: 0.3570552147239264



Validation scores:
	RegressionAUROC: 0.7387276887893677
	RegressionCompetitionScore: 0.3588957055214724

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.178. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36073619631901843
     Test RegressionAUROC            0.7296870946884155
Test RegressionCompetitionScore      0.36073619631901843
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 17:15:15,125][0m Trial 256 finished with value: 0.36073619631901843 and parameters: {'lr': 0.0009650671926288737, 'dropout': 0.4681773849587007, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 642, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0005366488770455452, 'dropout': 0.436490412791987, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 101, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 67.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
67.5 K    Trainable params
0         Non-trainable params
67.5 K    Total params
0.270     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.31884056329727173
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.6726053953170776
	RegressionCompetitionScore: 0.32791411042944785

Metric val_loss improved. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7165409922599792
	RegressionCompetitionScore: 0.33496932515337424



Validation scores:
	RegressionAUROC: 0.7109512686729431
	RegressionCompetitionScore: 0.31625766871165645

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7076196670532227
	RegressionCompetitionScore: 0.31717791411042945



Validation scores:
	RegressionAUROC: 0.7286279201507568
	RegressionCompetitionScore: 0.38588957055214723



Validation scores:
	RegressionAUROC: 0.7237620949745178
	RegressionCompetitionScore: 0.36993865030674844



Validation scores:
	RegressionAUROC: 0.7398245334625244
	RegressionCompetitionScore: 0.40245398773006136



Validation scores:
	RegressionAUROC: 0.7331743836402893
	RegressionCompetitionScore: 0.38926380368098157

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7406847476959229
	RegressionCompetitionScore: 0.40521472392638036



Validation scores:
	RegressionAUROC: 0.7387824654579163
	RegressionCompetitionScore: 0.3282208588957055



Validation scores:
	RegressionAUROC: 0.7587690949440002
	RegressionCompetitionScore: 0.3871165644171779



Validation scores:
	RegressionAUROC: 0.7581945657730103
	RegressionCompetitionScore: 0.3558282208588957

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7618448138237
	RegressionCompetitionScore: 0.38220858895705523

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7597708106040955
	RegressionCompetitionScore: 0.399079754601227

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7792865037918091
	RegressionCompetitionScore: 0.42914110429447855

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7682713270187378
	RegressionCompetitionScore: 0.400920245398773



Validation scores:
	RegressionAUROC: 0.7824200391769409
	RegressionCompetitionScore: 0.38834355828220857



Validation scores:
	RegressionAUROC: 0.7836712002754211
	RegressionCompetitionScore: 0.41932515337423315



Validation scores:
	RegressionAUROC: 0.7684983015060425
	RegressionCompetitionScore: 0.3647239263803681



Validation scores:
	RegressionAUROC: 0.7761983871459961
	RegressionCompetitionScore: 0.4003067484662577



Validation scores:
	RegressionAUROC: 0.7751514911651611
	RegressionCompetitionScore: 0.38374233128834356



Validation scores:
	RegressionAUROC: 0.7864694595336914
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.165. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.42914110429447855
     Test RegressionAUROC            0.7792865037918091
Test RegressionCompetitionScore      0.42914110429447855
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 17:24:24,342][0m Trial 257 finished with value: 0.42914110429447855 and parameters: {'lr': 0.0005366488770455452, 'dropout': 0.436490412791987, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 101, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0004641940527662124, 'dropout': 0.43693717938695303, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 104, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 67.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
67.9 K    Trainable params
0         Non-trainable params
67.9 K    Total params
0.272     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.48792269825935364
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6874394416809082
	RegressionCompetitionScore: 0.27699386503067486

Metric val_loss improved. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.7135187387466431
	RegressionCompetitionScore: 0.28957055214723926

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.7251919507980347
	RegressionCompetitionScore: 0.3588957055214724

Metric val_loss improved by 0.041 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7235409021377563
	RegressionCompetitionScore: 0.36595092024539877



Validation scores:
	RegressionAUROC: 0.7107724547386169
	RegressionCompetitionScore: 0.27085889570552146



Validation scores:
	RegressionAUROC: 0.7487519979476929
	RegressionCompetitionScore: 0.37239263803680983



Validation scores:
	RegressionAUROC: 0.74846351146698
	RegressionCompetitionScore: 0.3595092024539877

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7488874197006226
	RegressionCompetitionScore: 0.3684049079754601



Validation scores:
	RegressionAUROC: 0.7365493178367615
	RegressionCompetitionScore: 0.3791411042944785



Validation scores:
	RegressionAUROC: 0.7512078285217285
	RegressionCompetitionScore: 0.37055214723926383



Validation scores:
	RegressionAUROC: 0.7492060661315918
	RegressionCompetitionScore: 0.36441717791411044



Validation scores:
	RegressionAUROC: 0.7467092275619507
	RegressionCompetitionScore: 0.3665644171779141



Validation scores:
	RegressionAUROC: 0.7392116785049438
	RegressionCompetitionScore: 0.34049079754601225



Validation scores:
	RegressionAUROC: 0.7418311834335327
	RegressionCompetitionScore: 0.37852760736196317

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.171. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3595092024539877
     Test RegressionAUROC             0.74846351146698
Test RegressionCompetitionScore      0.3595092024539877
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 17:30:24,437][0m Trial 258 finished with value: 0.3595092024539877 and parameters: {'lr': 0.0004641940527662124, 'dropout': 0.43693717938695303, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 104, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0005469351651109319, 'dropout': 0.45144212938631667, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 80, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 64.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
64.8 K    Trainable params
0         Non-trainable params
64.8 K    Total params
0.259     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6086956262588501
	RegressionCompetitionScore: 0.34782608695652173



Validation scores:
	RegressionAUROC: 0.7302775382995605
	RegressionCompetitionScore: 0.35521472392638037

Metric val_loss improved. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7158659100532532
	RegressionCompetitionScore: 0.28190184049079753



Validation scores:
	RegressionAUROC: 0.7173351049423218
	RegressionCompetitionScore: 0.33220858895705524

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7055681943893433
	RegressionCompetitionScore: 0.3414110429447853



Validation scores:
	RegressionAUROC: 0.7199582457542419
	RegressionCompetitionScore: 0.3389570552147239



Validation scores:
	RegressionAUROC: 0.7357079982757568
	RegressionCompetitionScore: 0.37791411042944784



Validation scores:
	RegressionAUROC: 0.7217109203338623
	RegressionCompetitionScore: 0.35460122699386504



Validation scores:
	RegressionAUROC: 0.7256801128387451
	RegressionCompetitionScore: 0.3539877300613497

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7275291681289673
	RegressionCompetitionScore: 0.37852760736196317



Validation scores:
	RegressionAUROC: 0.7247481346130371
	RegressionCompetitionScore: 0.3895705521472393



Validation scores:
	RegressionAUROC: 0.7331511378288269
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6935383677482605
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6968604326248169
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7415100932121277
	RegressionCompetitionScore: 0.35276073619631904



Validation scores:
	RegressionAUROC: 0.73683762550354
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3539877300613497
     Test RegressionAUROC            0.7256801128387451
Test RegressionCompetitionScore      0.3539877300613497
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 17:36:46,398][0m Trial 259 finished with value: 0.3539877300613497 and parameters: {'lr': 0.0005469351651109319, 'dropout': 0.45144212938631667, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 80, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0007201674752167498, 'dropout': 0.4195058744670382, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 32, 'dim_feedforward': 558, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 86.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
86.3 K    Trainable params
0         Non-trainable params
86.3 K    Total params
0.345     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4444444477558136
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6774492859840393
	RegressionCompetitionScore: 0.31012269938650305

Metric val_loss improved. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7182602882385254
	RegressionCompetitionScore: 0.348159509202454

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7122952342033386
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6737746000289917
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7302440404891968
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6501016616821289
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6899434328079224
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7110370397567749
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7040616273880005
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.180. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.348159509202454
     Test RegressionAUROC            0.7182602882385254
Test RegressionCompetitionScore       0.348159509202454
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 17:40:42,211][0m Trial 260 finished with value: 0.348159509202454 and parameters: {'lr': 0.0007201674752167498, 'dropout': 0.4195058744670382, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 32, 'dim_feedforward': 558, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0003520403000860844, 'dropout': 0.43332406227176345, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 526, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 122 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
122 K     Trainable params
0         Non-trainable params
122 K     Total params
0.491     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.54347825050354
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6994013786315918
	RegressionCompetitionScore: 0.23865030674846627

Metric val_loss improved. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7326643466949463
	RegressionCompetitionScore: 0.3665644171779141



Validation scores:
	RegressionAUROC: 0.700620174407959
	RegressionCompetitionScore: 0.27300613496932513

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7297981977462769
	RegressionCompetitionScore: 0.35644171779141104

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7474944591522217
	RegressionCompetitionScore: 0.37975460122699384

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7244032025337219
	RegressionCompetitionScore: 0.2987730061349693



Validation scores:
	RegressionAUROC: 0.7650437355041504
	RegressionCompetitionScore: 0.38190184049079756



Validation scores:
	RegressionAUROC: 0.7622959613800049
	RegressionCompetitionScore: 0.39171779141104296



Validation scores:
	RegressionAUROC: 0.7677002549171448
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.7815884351730347
	RegressionCompetitionScore: 0.4223926380368098

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7746186256408691
	RegressionCompetitionScore: 0.39447852760736196

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7732074856758118
	RegressionCompetitionScore: 0.38680981595092023

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7646293044090271
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7801146507263184
	RegressionCompetitionScore: 0.41319018404907976



Validation scores:
	RegressionAUROC: 0.7642272710800171
	RegressionCompetitionScore: 0.39447852760736196



Validation scores:
	RegressionAUROC: 0.7737511396408081
	RegressionCompetitionScore: 0.42300613496932515



Validation scores:
	RegressionAUROC: 0.7784650325775146
	RegressionCompetitionScore: 0.3825153374233129



Validation scores:
	RegressionAUROC: 0.7892184257507324
	RegressionCompetitionScore: 0.42024539877300615



Validation scores:
	RegressionAUROC: 0.7768580913543701
	RegressionCompetitionScore: 0.40705521472392636

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.162. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38680981595092023
     Test RegressionAUROC            0.7732074856758118
Test RegressionCompetitionScore      0.38680981595092023
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 17:48:42,442][0m Trial 261 finished with value: 0.38680981595092023 and parameters: {'lr': 0.0003520403000860844, 'dropout': 0.43332406227176345, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 526, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0011055880592697868, 'dropout': 0.4585774108045881, 'd_model_multiplier': 32, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 99, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 14.2 M
1 | loss_fn | MSELoss | 0     
------------------------------------
14.2 M    Trainable params
0         Non-trainable params
14.2 M    Total params
56.706    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5072463750839233
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 644.752


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 281.301 >= min_delta = 0.0. New best score: 363.451


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 288.992 >= min_delta = 0.0. New best score: 74.459


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 1.242 >= min_delta = 0.0. New best score: 73.217


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 36.760 >= min_delta = 0.0. New best score: 36.457


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 35.399 >= min_delta = 0.0. New best score: 1.058


Validation scores:
	RegressionAUROC: 0.5006623268127441
	RegressionCompetitionScore: 0.003987730061349694



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4748912751674652
	RegressionCompetitionScore: 0.044171779141104296

Metric val_loss improved by 0.758 >= min_delta = 0.0. New best score: 0.300


Validation scores:
	RegressionAUROC: 0.4297098219394684
	RegressionCompetitionScore: 0.05214723926380368



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5635581016540527
	RegressionCompetitionScore: 0.07392638036809816

Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.257


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.257. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.07392638036809816
     Test RegressionAUROC            0.5635581016540527
Test RegressionCompetitionScore      0.07392638036809816
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 18:03:16,133][0m Trial 262 finished with value: 0.07392638036809816 and parameters: {'lr': 0.0011055880592697868, 'dropout': 0.4585774108045881, 'd_model_multiplier': 32, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 99, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.000249826119242445, 'dropout': 0.4414798575320487, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 618, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 66.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
66.9 K    Trainable params
0         Non-trainable params
66.9 K    Total params
0.268     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6000000238418579
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.6897820830345154
	RegressionCompetitionScore: 0.1285276073619632

Metric val_loss improved. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.714102566242218
	RegressionCompetitionScore: 0.28588957055214725

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7128663063049316
	RegressionCompetitionScore: 0.3245398773006135

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7270846366882324
	RegressionCompetitionScore: 0.38282208588957056

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7309175729751587
	RegressionCompetitionScore: 0.38098159509202456



Validation scores:
	RegressionAUROC: 0.7601931691169739
	RegressionCompetitionScore: 0.38098159509202456



Validation scores:
	RegressionAUROC: 0.7395199537277222
	RegressionCompetitionScore: 0.348159509202454

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7735450267791748
	RegressionCompetitionScore: 0.37699386503067484



Validation scores:
	RegressionAUROC: 0.7620691061019897
	RegressionCompetitionScore: 0.36503067484662577

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7688419818878174
	RegressionCompetitionScore: 0.3834355828220859

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7779521942138672
	RegressionCompetitionScore: 0.37208588957055216



Validation scores:
	RegressionAUROC: 0.7510175108909607
	RegressionCompetitionScore: 0.36411042944785277



Validation scores:
	RegressionAUROC: 0.7621538639068604
	RegressionCompetitionScore: 0.35



Validation scores:
	RegressionAUROC: 0.795353889465332
	RegressionCompetitionScore: 0.38312883435582823

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.154


Validation scores:
	RegressionAUROC: 0.7851639986038208
	RegressionCompetitionScore: 0.40061349693251536



Validation scores:
	RegressionAUROC: 0.785942554473877
	RegressionCompetitionScore: 0.3619631901840491



Validation scores:
	RegressionAUROC: 0.785760223865509
	RegressionCompetitionScore: 0.3585889570552147



Validation scores:
	RegressionAUROC: 0.7824209332466125
	RegressionCompetitionScore: 0.3978527607361963



Validation scores:
	RegressionAUROC: 0.7841740846633911
	RegressionCompetitionScore: 0.37239263803680983



Validation scores:
	RegressionAUROC: 0.7651736736297607
	RegressionCompetitionScore: 0.3392638036809816



Validation scores:
	RegressionAUROC: 0.7812471389770508
	RegressionCompetitionScore: 0.3487730061349693

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.154. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38312883435582823
     Test RegressionAUROC             0.795353889465332
Test RegressionCompetitionScore      0.38312883435582823
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 18:13:04,282][0m Trial 263 finished with value: 0.38312883435582823 and parameters: {'lr': 0.000249826119242445, 'dropout': 0.4414798575320487, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 618, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0005217042392093437, 'dropout': 0.6082174572746883, 'd_model_multiplier': 64, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 1023, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 6.8 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
6.8 M     Trainable params
0         Non-trainable params
6.8 M     Total params
27.168    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.25120770931243896
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 10.357


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 7.709 >= min_delta = 0.0. New best score: 2.648


Validation scores:
	RegressionAUROC: 0.6933902502059937
	RegressionCompetitionScore: 0.1736196319018405

Metric val_loss improved by 2.396 >= min_delta = 0.0. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.681656539440155
	RegressionCompetitionScore: 0.20429447852760735

Metric val_loss improved by 0.036 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6925456523895264
	RegressionCompetitionScore: 0.20705521472392638

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5810036659240723
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6501556038856506
	RegressionCompetitionScore: 0.11380368098159509



Validation scores:
	RegressionAUROC: 0.6748330593109131
	RegressionCompetitionScore: 0.20460122699386504



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.197. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.20705521472392638
     Test RegressionAUROC            0.6925456523895264
Test RegressionCompetitionScore      0.20705521472392638
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 18:18:27,539][0m Trial 264 finished with value: 0.20705521472392638 and parameters: {'lr': 0.0005217042392093437, 'dropout': 0.6082174572746883, 'd_model_multiplier': 64, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 1023, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00034422411131658655, 'dropout': 0.41319021218805674, 'd_model_multiplier': 16, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 583, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 566 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
566 K     Trainable params
0         Non-trainable params
566 K     Total params
2.268     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4589371681213379
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6231189966201782
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.491


Validation scores:
	RegressionAUROC: 0.7040442228317261
	RegressionCompetitionScore: 0.27085889570552146

Metric val_loss improved by 0.192 >= min_delta = 0.0. New best score: 0.299


Validation scores:
	RegressionAUROC: 0.6932676434516907
	RegressionCompetitionScore: 0.18742331288343558

Metric val_loss improved by 0.063 >= min_delta = 0.0. New best score: 0.236


Validation scores:
	RegressionAUROC: 0.7120094299316406
	RegressionCompetitionScore: 0.27024539877300613



Validation scores:
	RegressionAUROC: 0.7120850682258606
	RegressionCompetitionScore: 0.3638036809815951

Metric val_loss improved by 0.042 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7121104001998901
	RegressionCompetitionScore: 0.34263803680981597



Validation scores:
	RegressionAUROC: 0.7082817554473877
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7136174440383911
	RegressionCompetitionScore: 0.35460122699386504



Validation scores:
	RegressionAUROC: 0.7090362310409546
	RegressionCompetitionScore: 0.33588957055214724



Validation scores:
	RegressionAUROC: 0.7272907495498657
	RegressionCompetitionScore: 0.350920245398773



Validation scores:
	RegressionAUROC: 0.7273419499397278
	RegressionCompetitionScore: 0.35736196319018404

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7060755491256714
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7156602740287781
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7356911897659302
	RegressionCompetitionScore: 0.3708588957055215

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7340942621231079
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7343719005584717
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7194693088531494
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7389872074127197
	RegressionCompetitionScore: 0.3803680981595092



Validation scores:
	RegressionAUROC: 0.7117037773132324
	RegressionCompetitionScore: 0.3303680981595092



Validation scores:
	RegressionAUROC: 0.731930136680603
	RegressionCompetitionScore: 0.33159509202453985



Validation scores:
	RegressionAUROC: 0.6771707534790039
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.176. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3708588957055215
     Test RegressionAUROC            0.7356911897659302
Test RegressionCompetitionScore      0.3708588957055215
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 18:27:06,490][0m Trial 265 finished with value: 0.3708588957055215 and parameters: {'lr': 0.00034422411131658655, 'dropout': 0.41319021218805674, 'd_model_multiplier': 16, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 583, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0006596189677566999, 'dropout': 0.4311691855235787, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 64, 'dim_feedforward': 64, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 150 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
150 K     Trainable params
0         Non-trainable params
150 K     Total params
0.603     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5362318754196167
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.635626494884491
	RegressionCompetitionScore: 0.26533742331288346

Metric val_loss improved. New best score: 0.670


Validation scores:
	RegressionAUROC: 0.6075660586357117
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.210 >= min_delta = 0.0. New best score: 0.459


Validation scores:
	RegressionAUROC: 0.6941718459129333
	RegressionCompetitionScore: 0.24478527607361963

Metric val_loss improved by 0.274 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7018120884895325
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7171140313148499
	RegressionCompetitionScore: 0.3319018404907976



Validation scores:
	RegressionAUROC: 0.7052050828933716
	RegressionCompetitionScore: 0.28865030674846626

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7154900431632996
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7215192317962646
	RegressionCompetitionScore: 0.3131901840490798



Validation scores:
	RegressionAUROC: 0.6946432590484619
	RegressionCompetitionScore: 0.3165644171779141



Validation scores:
	RegressionAUROC: 0.7017179727554321
	RegressionCompetitionScore: 0.34294478527607364



Validation scores:
	RegressionAUROC: 0.7059978246688843
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7160377502441406
	RegressionCompetitionScore: 0.3104294478527607



Validation scores:
	RegressionAUROC: 0.7006518244743347
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.28865030674846626
     Test RegressionAUROC            0.7052050828933716
Test RegressionCompetitionScore      0.28865030674846626
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 18:34:03,522][0m Trial 266 finished with value: 0.28865030674846626 and parameters: {'lr': 0.0006596189677566999, 'dropout': 0.4311691855235787, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 64, 'dim_feedforward': 64, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00020052420632048025, 'dropout': 0.46578861530709914, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 663, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 70.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
70.0 K    Trainable params
0         Non-trainable params
70.0 K    Total params
0.280     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.45410627126693726
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.6817485094070435
	RegressionCompetitionScore: 0.18067484662576688

Metric val_loss improved. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.6646603345870972
	RegressionCompetitionScore: 0.29478527607361965



Validation scores:
	RegressionAUROC: 0.7071770429611206
	RegressionCompetitionScore: 0.18619631901840492

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.7218526601791382
	RegressionCompetitionScore: 0.32515337423312884



Validation scores:
	RegressionAUROC: 0.7154757380485535
	RegressionCompetitionScore: 0.3506134969325153



Validation scores:
	RegressionAUROC: 0.7202576398849487
	RegressionCompetitionScore: 0.35429447852760737

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.7251670360565186
	RegressionCompetitionScore: 0.3441717791411043



Validation scores:
	RegressionAUROC: 0.728024959564209
	RegressionCompetitionScore: 0.346319018404908



Validation scores:
	RegressionAUROC: 0.7444871664047241
	RegressionCompetitionScore: 0.39386503067484663

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.7474801540374756
	RegressionCompetitionScore: 0.3389570552147239



Validation scores:
	RegressionAUROC: 0.745428740978241
	RegressionCompetitionScore: 0.37147239263803683

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7519973516464233
	RegressionCompetitionScore: 0.37668711656441717

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7449570894241333
	RegressionCompetitionScore: 0.36871165644171777



Validation scores:
	RegressionAUROC: 0.7349947690963745
	RegressionCompetitionScore: 0.35368098159509204



Validation scores:
	RegressionAUROC: 0.7567919492721558
	RegressionCompetitionScore: 0.3736196319018405

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7456738948822021
	RegressionCompetitionScore: 0.3693251533742331



Validation scores:
	RegressionAUROC: 0.7465533018112183
	RegressionCompetitionScore: 0.35552147239263804



Validation scores:
	RegressionAUROC: 0.7313091158866882
	RegressionCompetitionScore: 0.36533742331288344



Validation scores:
	RegressionAUROC: 0.738107442855835
	RegressionCompetitionScore: 0.37791411042944784



Validation scores:
	RegressionAUROC: 0.7412419319152832
	RegressionCompetitionScore: 0.35245398773006137



Validation scores:
	RegressionAUROC: 0.7357786893844604
	RegressionCompetitionScore: 0.3656441717791411

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7436983585357666
	RegressionCompetitionScore: 0.37607361963190183



Validation scores:
	RegressionAUROC: 0.7405111789703369
	RegressionCompetitionScore: 0.39815950920245397



Validation scores:
	RegressionAUROC: 0.7384406328201294
	RegressionCompetitionScore: 0.37300613496932516



Validation scores:
	RegressionAUROC: 0.7503440380096436
	RegressionCompetitionScore: 0.3987730061349693



Validation scores:
	RegressionAUROC: 0.7598493099212646
	RegressionCompetitionScore: 0.40429447852760736

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7493768334388733
	RegressionCompetitionScore: 0.38558282208588956



Validation scores:
	RegressionAUROC: 0.7478654384613037
	RegressionCompetitionScore: 0.3889570552147239



Validation scores:
	RegressionAUROC: 0.7554956078529358
	RegressionCompetitionScore: 0.39355828220858896



Validation scores:
	RegressionAUROC: 0.7633211016654968
	RegressionCompetitionScore: 0.3880368098159509



Validation scores:
	RegressionAUROC: 0.7498051524162292
	RegressionCompetitionScore: 0.38128834355828223

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7698887586593628
	RegressionCompetitionScore: 0.4125766871165644

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.7545697093009949
	RegressionCompetitionScore: 0.39662576687116563



Validation scores:
	RegressionAUROC: 0.7557995319366455
	RegressionCompetitionScore: 0.3895705521472393



Validation scores:
	RegressionAUROC: 0.7504086494445801
	RegressionCompetitionScore: 0.41042944785276075



Validation scores:
	RegressionAUROC: 0.7660978436470032
	RegressionCompetitionScore: 0.40828220858895703



Validation scores:
	RegressionAUROC: 0.7537686228752136
	RegressionCompetitionScore: 0.39969325153374236



Validation scores:
	RegressionAUROC: 0.7484201192855835
	RegressionCompetitionScore: 0.4012269938650307



Validation scores:
	RegressionAUROC: 0.7515017986297607
	RegressionCompetitionScore: 0.4049079754601227

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.161. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4125766871165644
     Test RegressionAUROC            0.7698887586593628
Test RegressionCompetitionScore      0.4125766871165644
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 18:49:45,681][0m Trial 267 finished with value: 0.4125766871165644 and parameters: {'lr': 0.00020052420632048025, 'dropout': 0.46578861530709914, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 663, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00027009775511985533, 'dropout': 0.4968071743886611, 'd_model_multiplier': 2, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 662, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 146 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
146 K     Trainable params
0         Non-trainable params
146 K     Total params
0.584     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.524154543876648
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6662188768386841
	RegressionCompetitionScore: 0.2076687116564417

Metric val_loss improved. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6945593357086182
	RegressionCompetitionScore: 0.23006134969325154

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7026652097702026
	RegressionCompetitionScore: 0.30030674846625766

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7102808356285095
	RegressionCompetitionScore: 0.36134969325153377



Validation scores:
	RegressionAUROC: 0.7293225526809692
	RegressionCompetitionScore: 0.36226993865030677

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7398362159729004
	RegressionCompetitionScore: 0.40736196319018403



Validation scores:
	RegressionAUROC: 0.7514562010765076
	RegressionCompetitionScore: 0.38742331288343557

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7401164770126343
	RegressionCompetitionScore: 0.36411042944785277



Validation scores:
	RegressionAUROC: 0.7277522087097168
	RegressionCompetitionScore: 0.38496932515337423



Validation scores:
	RegressionAUROC: 0.7341676950454712
	RegressionCompetitionScore: 0.35368098159509204



Validation scores:
	RegressionAUROC: 0.7471532225608826
	RegressionCompetitionScore: 0.35368098159509204



Validation scores:
	RegressionAUROC: 0.758063018321991
	RegressionCompetitionScore: 0.36533742331288344



Validation scores:
	RegressionAUROC: 0.7573734521865845
	RegressionCompetitionScore: 0.38926380368098157



Validation scores:
	RegressionAUROC: 0.7457077503204346
	RegressionCompetitionScore: 0.39570552147239263

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.169. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38742331288343557
     Test RegressionAUROC            0.7514562010765076
Test RegressionCompetitionScore      0.38742331288343557
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 18:55:42,691][0m Trial 268 finished with value: 0.38742331288343557 and parameters: {'lr': 0.00027009775511985533, 'dropout': 0.4968071743886611, 'd_model_multiplier': 2, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 662, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.000397919678234665, 'dropout': 0.48144812657325736, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 113, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 32.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
32.6 K    Trainable params
0         Non-trainable params
32.6 K    Total params
0.130     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6000000238418579
	RegressionCompetitionScore: 0.2



Validation scores:
	RegressionAUROC: 0.7000426054000854
	RegressionCompetitionScore: 0.31257668711656444

Metric val_loss improved. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.712325394153595
	RegressionCompetitionScore: 0.3595092024539877



Validation scores:
	RegressionAUROC: 0.7199137806892395
	RegressionCompetitionScore: 0.3263803680981595



Validation scores:
	RegressionAUROC: 0.7338478565216064
	RegressionCompetitionScore: 0.39754601226993863

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7330321073532104
	RegressionCompetitionScore: 0.3993865030674847



Validation scores:
	RegressionAUROC: 0.7112777829170227
	RegressionCompetitionScore: 0.3423312883435583

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7530595660209656
	RegressionCompetitionScore: 0.36533742331288344

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7583779096603394
	RegressionCompetitionScore: 0.37392638036809817



Validation scores:
	RegressionAUROC: 0.7632907629013062
	RegressionCompetitionScore: 0.38558282208588956



Validation scores:
	RegressionAUROC: 0.7426439523696899
	RegressionCompetitionScore: 0.3361963190184049



Validation scores:
	RegressionAUROC: 0.7620046138763428
	RegressionCompetitionScore: 0.3273006134969325

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7606927156448364
	RegressionCompetitionScore: 0.36441717791411044



Validation scores:
	RegressionAUROC: 0.7587260603904724
	RegressionCompetitionScore: 0.3570552147239264



Validation scores:
	RegressionAUROC: 0.7724353075027466
	RegressionCompetitionScore: 0.3365030674846626

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7623201608657837
	RegressionCompetitionScore: 0.3303680981595092



Validation scores:
	RegressionAUROC: 0.7842390537261963
	RegressionCompetitionScore: 0.36779141104294477



Validation scores:
	RegressionAUROC: 0.7811403870582581
	RegressionCompetitionScore: 0.3628834355828221



Validation scores:
	RegressionAUROC: 0.794915497303009
	RegressionCompetitionScore: 0.4260736196319018

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.158


Validation scores:
	RegressionAUROC: 0.7908585071563721
	RegressionCompetitionScore: 0.40429447852760736



Validation scores:
	RegressionAUROC: 0.7779362797737122
	RegressionCompetitionScore: 0.35030674846625764



Validation scores:
	RegressionAUROC: 0.7810369729995728
	RegressionCompetitionScore: 0.37116564417177916



Validation scores:
	RegressionAUROC: 0.7680310010910034
	RegressionCompetitionScore: 0.3806748466257669



Validation scores:
	RegressionAUROC: 0.7730899453163147
	RegressionCompetitionScore: 0.39386503067484663



Validation scores:
	RegressionAUROC: 0.795417308807373
	RegressionCompetitionScore: 0.37239263803680983



Validation scores:
	RegressionAUROC: 0.7915529012680054
	RegressionCompetitionScore: 0.4334355828220859

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.158. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4260736196319018
     Test RegressionAUROC             0.794915497303009
Test RegressionCompetitionScore      0.4260736196319018
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 19:06:56,575][0m Trial 269 finished with value: 0.4260736196319018 and parameters: {'lr': 0.000397919678234665, 'dropout': 0.48144812657325736, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 113, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00047195045420838033, 'dropout': 0.4725606217260285, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 491, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 58.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
58.3 K    Trainable params
0         Non-trainable params
58.3 K    Total params
0.233     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3333333134651184
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6902636289596558
	RegressionCompetitionScore: 0.1668711656441718

Metric val_loss improved. New best score: 0.236


Validation scores:
	RegressionAUROC: 0.6620324850082397
	RegressionCompetitionScore: 0.12147239263803682

Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6929492950439453
	RegressionCompetitionScore: 0.24386503067484663

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.6532702445983887
	RegressionCompetitionScore: 0.28282208588957053



Validation scores:
	RegressionAUROC: 0.6468634009361267
	RegressionCompetitionScore: 0.23558282208588957



Validation scores:
	RegressionAUROC: 0.6530494093894958
	RegressionCompetitionScore: 0.22607361963190184



Validation scores:
	RegressionAUROC: 0.7062233090400696
	RegressionCompetitionScore: 0.26993865030674846

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.6976802349090576
	RegressionCompetitionScore: 0.2960122699386503



Validation scores:
	RegressionAUROC: 0.6745482087135315
	RegressionCompetitionScore: 0.2677914110429448



Validation scores:
	RegressionAUROC: 0.6989198923110962
	RegressionCompetitionScore: 0.2929447852760736



Validation scores:
	RegressionAUROC: 0.6933161020278931
	RegressionCompetitionScore: 0.3104294478527607



Validation scores:
	RegressionAUROC: 0.7302297353744507
	RegressionCompetitionScore: 0.34662576687116564



Validation scores:
	RegressionAUROC: 0.722214937210083
	RegressionCompetitionScore: 0.3319018404907976

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7260838747024536
	RegressionCompetitionScore: 0.34171779141104297



Validation scores:
	RegressionAUROC: 0.704473614692688
	RegressionCompetitionScore: 0.3156441717791411



Validation scores:
	RegressionAUROC: 0.7185165882110596
	RegressionCompetitionScore: 0.33159509202453985



Validation scores:
	RegressionAUROC: 0.705267608165741
	RegressionCompetitionScore: 0.22914110429447854



Validation scores:
	RegressionAUROC: 0.7234928607940674
	RegressionCompetitionScore: 0.2987730061349693



Validation scores:
	RegressionAUROC: 0.7548878192901611
	RegressionCompetitionScore: 0.3334355828220859

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.747575044631958
	RegressionCompetitionScore: 0.32085889570552145



Validation scores:
	RegressionAUROC: 0.7553750872612
	RegressionCompetitionScore: 0.3079754601226994



Validation scores:
	RegressionAUROC: 0.7589863538742065
	RegressionCompetitionScore: 0.3039877300613497



Validation scores:
	RegressionAUROC: 0.7547559142112732
	RegressionCompetitionScore: 0.296319018404908

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7592200040817261
	RegressionCompetitionScore: 0.2898773006134969



Validation scores:
	RegressionAUROC: 0.7505260705947876
	RegressionCompetitionScore: 0.2785276073619632



Validation scores:
	RegressionAUROC: 0.7382932901382446
	RegressionCompetitionScore: 0.2650306748466258



Validation scores:
	RegressionAUROC: 0.7854676246643066
	RegressionCompetitionScore: 0.3254601226993865



Validation scores:
	RegressionAUROC: 0.778933048248291
	RegressionCompetitionScore: 0.4076687116564417

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7821236252784729
	RegressionCompetitionScore: 0.3588957055214724



Validation scores:
	RegressionAUROC: 0.7726833820343018
	RegressionCompetitionScore: 0.24447852760736197

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7526558637619019
	RegressionCompetitionScore: 0.3361963190184049



Validation scores:
	RegressionAUROC: 0.7789841890335083
	RegressionCompetitionScore: 0.4003067484662577



Validation scores:
	RegressionAUROC: 0.7683426141738892
	RegressionCompetitionScore: 0.3309815950920245



Validation scores:
	RegressionAUROC: 0.7734867930412292
	RegressionCompetitionScore: 0.32239263803680984



Validation scores:
	RegressionAUROC: 0.7776473760604858
	RegressionCompetitionScore: 0.37515337423312883



Validation scores:
	RegressionAUROC: 0.7624759078025818
	RegressionCompetitionScore: 0.27975460122699386



Validation scores:
	RegressionAUROC: 0.7727506160736084
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.162. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.24447852760736197
     Test RegressionAUROC            0.7726833820343018
Test RegressionCompetitionScore      0.24447852760736197
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 19:23:52,919][0m Trial 270 finished with value: 0.24447852760736197 and parameters: {'lr': 0.00047195045420838033, 'dropout': 0.4725606217260285, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 491, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0008654163394719234, 'dropout': 0.4847051115008065, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 687, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 71.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
71.6 K    Trainable params
0         Non-trainable params
71.6 K    Total params
0.286     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2666666507720947
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6650334000587463
	RegressionCompetitionScore: 0.12177914110429448

Metric val_loss improved. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6038771271705627
	RegressionCompetitionScore: 0.1147239263803681



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49976176023483276
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49955546855926514
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6206108331680298
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6223406791687012
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5644777417182922
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.205. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.12177914110429448
     Test RegressionAUROC            0.6650334000587463
Test RegressionCompetitionScore      0.12177914110429448
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 19:27:54,173][0m Trial 271 finished with value: 0.12177914110429448 and parameters: {'lr': 0.0008654163394719234, 'dropout': 0.4847051115008065, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 687, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00039494238487248156, 'dropout': 0.4813219037114542, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 368, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 49.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
49.9 K    Trainable params
0         Non-trainable params
49.9 K    Total params
0.200     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6000000238418579
	RegressionCompetitionScore: 0.2



Validation scores:
	RegressionAUROC: 0.6814761161804199
	RegressionCompetitionScore: 0.20552147239263804

Metric val_loss improved. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.6897501945495605
	RegressionCompetitionScore: 0.13190184049079753

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6843228340148926
	RegressionCompetitionScore: 0.19049079754601228



Validation scores:
	RegressionAUROC: 0.6517307758331299
	RegressionCompetitionScore: 0.23496932515337424



Validation scores:
	RegressionAUROC: 0.6567763090133667
	RegressionCompetitionScore: 0.24570552147239264

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.7058317065238953
	RegressionCompetitionScore: 0.31441717791411045

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.687897801399231
	RegressionCompetitionScore: 0.253680981595092

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7068315744400024
	RegressionCompetitionScore: 0.2917177914110429



Validation scores:
	RegressionAUROC: 0.5513346791267395
	RegressionCompetitionScore: 0.10061349693251534



Validation scores:
	RegressionAUROC: 0.7026267647743225
	RegressionCompetitionScore: 0.3325153374233129



Validation scores:
	RegressionAUROC: 0.6484673619270325
	RegressionCompetitionScore: 0.1273006134969325



Validation scores:
	RegressionAUROC: 0.7136949300765991
	RegressionCompetitionScore: 0.3570552147239264



Validation scores:
	RegressionAUROC: 0.7095442414283752
	RegressionCompetitionScore: 0.36165644171779143



Validation scores:
	RegressionAUROC: 0.6994966268539429
	RegressionCompetitionScore: 0.36993865030674844

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.190. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.253680981595092
     Test RegressionAUROC             0.687897801399231
Test RegressionCompetitionScore       0.253680981595092
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 19:34:38,631][0m Trial 272 finished with value: 0.253680981595092 and parameters: {'lr': 0.00039494238487248156, 'dropout': 0.4813219037114542, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 368, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00021268211823536926, 'dropout': 0.469783876622467, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 123, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 35.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
35.7 K    Trainable params
0         Non-trainable params
35.7 K    Total params
0.143     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6837975978851318
	RegressionCompetitionScore: 0.2812883435582822

Metric val_loss improved. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6761369109153748
	RegressionCompetitionScore: 0.2763803680981595



Validation scores:
	RegressionAUROC: 0.7041760683059692
	RegressionCompetitionScore: 0.2837423312883436



Validation scores:
	RegressionAUROC: 0.7097947001457214
	RegressionCompetitionScore: 0.2926380368098159

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7197460532188416
	RegressionCompetitionScore: 0.294478527607362



Validation scores:
	RegressionAUROC: 0.7369491457939148
	RegressionCompetitionScore: 0.3432515337423313



Validation scores:
	RegressionAUROC: 0.7538319826126099
	RegressionCompetitionScore: 0.41226993865030676

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7589234113693237
	RegressionCompetitionScore: 0.37760736196319017

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.75309818983078
	RegressionCompetitionScore: 0.3638036809815951



Validation scores:
	RegressionAUROC: 0.7813825607299805
	RegressionCompetitionScore: 0.400920245398773

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7855360507965088
	RegressionCompetitionScore: 0.38558282208588956

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.157


Validation scores:
	RegressionAUROC: 0.7997522950172424
	RegressionCompetitionScore: 0.41932515337423315



Validation scores:
	RegressionAUROC: 0.7889132499694824
	RegressionCompetitionScore: 0.4279141104294479



Validation scores:
	RegressionAUROC: 0.804414689540863
	RegressionCompetitionScore: 0.4251533742331288



Validation scores:
	RegressionAUROC: 0.7945430874824524
	RegressionCompetitionScore: 0.4226993865030675

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.153


Validation scores:
	RegressionAUROC: 0.8019387722015381
	RegressionCompetitionScore: 0.4352760736196319



Validation scores:
	RegressionAUROC: 0.7949668169021606
	RegressionCompetitionScore: 0.4226993865030675



Validation scores:
	RegressionAUROC: 0.7980101108551025
	RegressionCompetitionScore: 0.4233128834355828



Validation scores:
	RegressionAUROC: 0.8063830137252808
	RegressionCompetitionScore: 0.45245398773006135

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.152


Validation scores:
	RegressionAUROC: 0.7946962714195251
	RegressionCompetitionScore: 0.39815950920245397



Validation scores:
	RegressionAUROC: 0.7871549129486084
	RegressionCompetitionScore: 0.40644171779141103



Validation scores:
	RegressionAUROC: 0.786338210105896
	RegressionCompetitionScore: 0.4273006134969325



Validation scores:
	RegressionAUROC: 0.7688869833946228
	RegressionCompetitionScore: 0.4171779141104294



Validation scores:
	RegressionAUROC: 0.7917747497558594
	RegressionCompetitionScore: 0.41503067484662576



Validation scores:
	RegressionAUROC: 0.781493067741394
	RegressionCompetitionScore: 0.42822085889570555



Validation scores:
	RegressionAUROC: 0.7890307903289795
	RegressionCompetitionScore: 0.4076687116564417

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.152. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.45245398773006135
     Test RegressionAUROC            0.8063830137252808
Test RegressionCompetitionScore      0.45245398773006135
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 19:46:45,677][0m Trial 273 finished with value: 0.45245398773006135 and parameters: {'lr': 0.00021268211823536926, 'dropout': 0.469783876622467, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 123, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00021852257570631112, 'dropout': 0.46987086504198367, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 121, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 35.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
35.5 K    Trainable params
0         Non-trainable params
35.5 K    Total params
0.142     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6603254675865173
	RegressionCompetitionScore: 0.2196319018404908

Metric val_loss improved. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6723935604095459
	RegressionCompetitionScore: 0.26012269938650306

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7028472423553467
	RegressionCompetitionScore: 0.3309815950920245

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7057588696479797
	RegressionCompetitionScore: 0.34294478527607364



Validation scores:
	RegressionAUROC: 0.7397549748420715
	RegressionCompetitionScore: 0.3684049079754601

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7509866952896118
	RegressionCompetitionScore: 0.38098159509202456

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.746852695941925
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7467283010482788
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7546093463897705
	RegressionCompetitionScore: 0.37423312883435583



Validation scores:
	RegressionAUROC: 0.7621183395385742
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.762823224067688
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7425345182418823
	RegressionCompetitionScore: 0.345398773006135



Validation scores:
	RegressionAUROC: 0.7566143274307251
	RegressionCompetitionScore: 0.39355828220858896

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38098159509202456
     Test RegressionAUROC            0.7509866952896118
Test RegressionCompetitionScore      0.38098159509202456
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 19:53:02,622][0m Trial 274 finished with value: 0.38098159509202456 and parameters: {'lr': 0.00021852257570631112, 'dropout': 0.46987086504198367, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 121, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 5.335237279186261e-07, 'dropout': 0.5930302399125413, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 108, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 34.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
34.4 K    Trainable params
0         Non-trainable params
34.4 K    Total params
0.138     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.9333332777023315
	RegressionCompetitionScore: 0.8



Validation scores:
	RegressionAUROC: 0.4903739094734192
	RegressionCompetitionScore: 0.0892638036809816

Metric val_loss improved. New best score: 0.364


Validation scores:
	RegressionAUROC: 0.4852854013442993
	RegressionCompetitionScore: 0.08803680981595093

Metric val_loss improved by 0.061 >= min_delta = 0.0. New best score: 0.303


Validation scores:
	RegressionAUROC: 0.4808787405490875
	RegressionCompetitionScore: 0.08496932515337423

Metric val_loss improved by 0.036 >= min_delta = 0.0. New best score: 0.267


Validation scores:
	RegressionAUROC: 0.47850143909454346
	RegressionCompetitionScore: 0.08374233128834356

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.4804823398590088
	RegressionCompetitionScore: 0.08006134969325153

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.245


Validation scores:
	RegressionAUROC: 0.4794594347476959
	RegressionCompetitionScore: 0.08190184049079755

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.245


Validation scores:
	RegressionAUROC: 0.4788389801979065
	RegressionCompetitionScore: 0.08251533742331288



Validation scores:
	RegressionAUROC: 0.48183274269104004
	RegressionCompetitionScore: 0.0794478527607362



Validation scores:
	RegressionAUROC: 0.48409754037857056
	RegressionCompetitionScore: 0.08220858895705521



Validation scores:
	RegressionAUROC: 0.48707956075668335
	RegressionCompetitionScore: 0.0843558282208589



Validation scores:
	RegressionAUROC: 0.4886942207813263
	RegressionCompetitionScore: 0.08098159509202454



Validation scores:
	RegressionAUROC: 0.4909558892250061
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49291837215423584
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.245. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.08190184049079755
     Test RegressionAUROC            0.4794594347476959
Test RegressionCompetitionScore      0.08190184049079755
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 19:59:22,212][0m Trial 275 finished with value: 0.08190184049079755 and parameters: {'lr': 5.335237279186261e-07, 'dropout': 0.5930302399125413, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 108, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00020530072269003054, 'dropout': 0.4507946671467338, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 124, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 33.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
33.3 K    Trainable params
0         Non-trainable params
33.3 K    Total params
0.133     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5333333015441895
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.670245349407196
	RegressionCompetitionScore: 0.32515337423312884

Metric val_loss improved. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7209720015525818
	RegressionCompetitionScore: 0.36441717791411044

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7325173616409302
	RegressionCompetitionScore: 0.3773006134969325



Validation scores:
	RegressionAUROC: 0.7488546371459961
	RegressionCompetitionScore: 0.4085889570552147



Validation scores:
	RegressionAUROC: 0.7739353179931641
	RegressionCompetitionScore: 0.4174846625766871

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.769388735294342
	RegressionCompetitionScore: 0.36257668711656443



Validation scores:
	RegressionAUROC: 0.7751287221908569
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7872352600097656
	RegressionCompetitionScore: 0.3815950920245399



Validation scores:
	RegressionAUROC: 0.790738582611084
	RegressionCompetitionScore: 0.42300613496932515

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7735569477081299
	RegressionCompetitionScore: 0.4233128834355828



Validation scores:
	RegressionAUROC: 0.7859277725219727
	RegressionCompetitionScore: 0.40061349693251536



Validation scores:
	RegressionAUROC: 0.7631274461746216
	RegressionCompetitionScore: 0.3889570552147239



Validation scores:
	RegressionAUROC: 0.7692893743515015
	RegressionCompetitionScore: 0.38282208588957056



Validation scores:
	RegressionAUROC: 0.7845814824104309
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7786561250686646
	RegressionCompetitionScore: 0.4306748466257669



Validation scores:
	RegressionAUROC: 0.7770741581916809
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.164. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.42300613496932515
     Test RegressionAUROC             0.790738582611084
Test RegressionCompetitionScore      0.42300613496932515
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 20:06:44,221][0m Trial 276 finished with value: 0.42300613496932515 and parameters: {'lr': 0.00020530072269003054, 'dropout': 0.4507946671467338, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 124, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0002179993658734552, 'dropout': 0.451566404142945, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 161, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 35.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
35.8 K    Trainable params
0         Non-trainable params
35.8 K    Total params
0.143     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7011178731918335
	RegressionCompetitionScore: 0.26380368098159507

Metric val_loss improved. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7201744318008423
	RegressionCompetitionScore: 0.3266871165644172



Validation scores:
	RegressionAUROC: 0.7257934808731079
	RegressionCompetitionScore: 0.3579754601226994



Validation scores:
	RegressionAUROC: 0.7390918731689453
	RegressionCompetitionScore: 0.3889570552147239

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7463365793228149
	RegressionCompetitionScore: 0.38987730061349696

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7744093537330627
	RegressionCompetitionScore: 0.34171779141104297

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7660799026489258
	RegressionCompetitionScore: 0.3300613496932515



Validation scores:
	RegressionAUROC: 0.7769891023635864
	RegressionCompetitionScore: 0.38128834355828223



Validation scores:
	RegressionAUROC: 0.7643907070159912
	RegressionCompetitionScore: 0.36165644171779143



Validation scores:
	RegressionAUROC: 0.7681474685668945
	RegressionCompetitionScore: 0.24171779141104294



Validation scores:
	RegressionAUROC: 0.7819207906723022
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7583699226379395
	RegressionCompetitionScore: 0.3717791411042945



Validation scores:
	RegressionAUROC: 0.7641055583953857
	RegressionCompetitionScore: 0.38312883435582823

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.163. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.34171779141104297
     Test RegressionAUROC            0.7744093537330627
Test RegressionCompetitionScore      0.34171779141104297
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 20:12:54,925][0m Trial 277 finished with value: 0.34171779141104297 and parameters: {'lr': 0.0002179993658734552, 'dropout': 0.451566404142945, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 161, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0006174295708789756, 'dropout': 0.4919732612196481, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 147, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 34.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
34.9 K    Trainable params
0         Non-trainable params
34.9 K    Total params
0.140     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7333333492279053
	RegressionCompetitionScore: 0.6



Validation scores:
	RegressionAUROC: 0.6779682636260986
	RegressionCompetitionScore: 0.12239263803680982

Metric val_loss improved. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6844342947006226
	RegressionCompetitionScore: 0.2098159509202454

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6719653606414795
	RegressionCompetitionScore: 0.22914110429447854



Validation scores:
	RegressionAUROC: 0.7007254958152771
	RegressionCompetitionScore: 0.2837423312883436

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6891665458679199
	RegressionCompetitionScore: 0.28159509202453986



Validation scores:
	RegressionAUROC: 0.7041284441947937
	RegressionCompetitionScore: 0.3030674846625767



Validation scores:
	RegressionAUROC: 0.6965128183364868
	RegressionCompetitionScore: 0.30460122699386505



Validation scores:
	RegressionAUROC: 0.6943525075912476
	RegressionCompetitionScore: 0.3392638036809816



Validation scores:
	RegressionAUROC: 0.6884750723838806
	RegressionCompetitionScore: 0.3365030674846626



Validation scores:
	RegressionAUROC: 0.69968581199646
	RegressionCompetitionScore: 0.3371165644171779



Validation scores:
	RegressionAUROC: 0.6857369542121887
	RegressionCompetitionScore: 0.35153374233128837

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.189. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2837423312883436
     Test RegressionAUROC            0.7007254958152771
Test RegressionCompetitionScore      0.2837423312883436
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 20:18:15,157][0m Trial 278 finished with value: 0.2837423312883436 and parameters: {'lr': 0.0006174295708789756, 'dropout': 0.4919732612196481, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 147, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.001146345838030583, 'dropout': 0.47488772898557435, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 956, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 89.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
89.9 K    Trainable params
0         Non-trainable params
89.9 K    Total params
0.360     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6020082235336304
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.380


Validation scores:
	RegressionAUROC: 0.7091280221939087
	RegressionCompetitionScore: 0.24846625766871167

Metric val_loss improved by 0.152 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.7078924179077148
	RegressionCompetitionScore: 0.27515337423312886

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.7229733467102051
	RegressionCompetitionScore: 0.3647239263803681



Validation scores:
	RegressionAUROC: 0.702079176902771
	RegressionCompetitionScore: 0.3352760736196319



Validation scores:
	RegressionAUROC: 0.7108031511306763
	RegressionCompetitionScore: 0.37760736196319017



Validation scores:
	RegressionAUROC: 0.6813778281211853
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6524197459220886
	RegressionCompetitionScore: 0.14171779141104293

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.7020241618156433
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7052392959594727
	RegressionCompetitionScore: 0.30368098159509205



Validation scores:
	RegressionAUROC: 0.7081793546676636
	RegressionCompetitionScore: 0.3085889570552147



Validation scores:
	RegressionAUROC: 0.632077157497406
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7108302116394043
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.702126681804657
	RegressionCompetitionScore: 0.302760736196319



Validation scores:
	RegressionAUROC: 0.6314691305160522
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.201. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.14171779141104293
     Test RegressionAUROC            0.6524197459220886
Test RegressionCompetitionScore      0.14171779141104293
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 20:24:31,705][0m Trial 279 finished with value: 0.14171779141104293 and parameters: {'lr': 0.001146345838030583, 'dropout': 0.47488772898557435, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 956, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00019700551422860662, 'dropout': 0.46404024954208917, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 130, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 41.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
41.4 K    Trainable params
0         Non-trainable params
41.4 K    Total params
0.165     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.36666664481163025
	RegressionCompetitionScore: 0.2



Validation scores:
	RegressionAUROC: 0.6745700836181641
	RegressionCompetitionScore: 0.1960122699386503

Metric val_loss improved. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.700096607208252
	RegressionCompetitionScore: 0.32331288343558284



Validation scores:
	RegressionAUROC: 0.716611385345459
	RegressionCompetitionScore: 0.3138036809815951

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7119252681732178
	RegressionCompetitionScore: 0.26042944785276073



Validation scores:
	RegressionAUROC: 0.7334264516830444
	RegressionCompetitionScore: 0.38374233128834356

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7303133010864258
	RegressionCompetitionScore: 0.34570552147239264

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7480219602584839
	RegressionCompetitionScore: 0.402760736196319



Validation scores:
	RegressionAUROC: 0.7459622621536255
	RegressionCompetitionScore: 0.37515337423312883



Validation scores:
	RegressionAUROC: 0.7520049810409546
	RegressionCompetitionScore: 0.37392638036809817

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7572144269943237
	RegressionCompetitionScore: 0.3226993865030675



Validation scores:
	RegressionAUROC: 0.7609614133834839
	RegressionCompetitionScore: 0.40613496932515336



Validation scores:
	RegressionAUROC: 0.7494140863418579
	RegressionCompetitionScore: 0.37668711656441717



Validation scores:
	RegressionAUROC: 0.735470175743103
	RegressionCompetitionScore: 0.3383435582822086



Validation scores:
	RegressionAUROC: 0.7458823323249817
	RegressionCompetitionScore: 0.3067484662576687



Validation scores:
	RegressionAUROC: 0.7555487155914307
	RegressionCompetitionScore: 0.402760736196319



Validation scores:
	RegressionAUROC: 0.7299023270606995
	RegressionCompetitionScore: 0.3226993865030675

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.168. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37392638036809817
     Test RegressionAUROC            0.7520049810409546
Test RegressionCompetitionScore      0.37392638036809817
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 20:32:48,442][0m Trial 280 finished with value: 0.37392638036809817 and parameters: {'lr': 0.00019700551422860662, 'dropout': 0.46404024954208917, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 130, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00031492303718901445, 'dropout': 0.44557314815442367, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 282, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 44.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
44.1 K    Trainable params
0         Non-trainable params
44.1 K    Total params
0.176     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7039340734481812
	RegressionCompetitionScore: 0.3052147239263804

Metric val_loss improved. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7276177406311035
	RegressionCompetitionScore: 0.3309815950920245

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7465735673904419
	RegressionCompetitionScore: 0.38098159509202456

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7478327751159668
	RegressionCompetitionScore: 0.36993865030674844



Validation scores:
	RegressionAUROC: 0.7574774026870728
	RegressionCompetitionScore: 0.37791411042944784

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7766664028167725
	RegressionCompetitionScore: 0.37852760736196317

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.7721120119094849
	RegressionCompetitionScore: 0.38680981595092023



Validation scores:
	RegressionAUROC: 0.765864372253418
	RegressionCompetitionScore: 0.38834355828220857



Validation scores:
	RegressionAUROC: 0.7744449377059937
	RegressionCompetitionScore: 0.4049079754601227



Validation scores:
	RegressionAUROC: 0.7821411490440369
	RegressionCompetitionScore: 0.4214723926380368



Validation scores:
	RegressionAUROC: 0.7890204787254333
	RegressionCompetitionScore: 0.40613496932515336

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.157


Validation scores:
	RegressionAUROC: 0.7946258187294006
	RegressionCompetitionScore: 0.44171779141104295



Validation scores:
	RegressionAUROC: 0.7720343470573425
	RegressionCompetitionScore: 0.41779141104294476



Validation scores:
	RegressionAUROC: 0.7865097522735596
	RegressionCompetitionScore: 0.41932515337423315



Validation scores:
	RegressionAUROC: 0.7866292595863342
	RegressionCompetitionScore: 0.4322085889570552



Validation scores:
	RegressionAUROC: 0.7982486486434937
	RegressionCompetitionScore: 0.4469325153374233

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.153


Validation scores:
	RegressionAUROC: 0.7964631915092468
	RegressionCompetitionScore: 0.40797546012269936



Validation scores:
	RegressionAUROC: 0.7833148241043091
	RegressionCompetitionScore: 0.4236196319018405



Validation scores:
	RegressionAUROC: 0.7687557935714722
	RegressionCompetitionScore: 0.35153374233128837



Validation scores:
	RegressionAUROC: 0.7861608266830444
	RegressionCompetitionScore: 0.40828220858895703



Validation scores:
	RegressionAUROC: 0.7940846681594849
	RegressionCompetitionScore: 0.4279141104294479



Validation scores:
	RegressionAUROC: 0.7957496643066406
	RegressionCompetitionScore: 0.451840490797546



Validation scores:
	RegressionAUROC: 0.7955845594406128
	RegressionCompetitionScore: 0.4469325153374233

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.153. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4469325153374233
     Test RegressionAUROC            0.7982486486434937
Test RegressionCompetitionScore      0.4469325153374233
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 20:42:11,346][0m Trial 281 finished with value: 0.4469325153374233 and parameters: {'lr': 0.00031492303718901445, 'dropout': 0.44557314815442367, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 282, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0005157909799989024, 'dropout': 0.6437337487573986, 'd_model_multiplier': 2, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 94, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 52.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
52.3 K    Trainable params
0         Non-trainable params
52.3 K    Total params
0.209     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6520432233810425
	RegressionCompetitionScore: 0.10644171779141104

Metric val_loss improved. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.673237144947052
	RegressionCompetitionScore: 0.0950920245398773



Validation scores:
	RegressionAUROC: 0.6763473749160767
	RegressionCompetitionScore: 0.17760736196319019



Validation scores:
	RegressionAUROC: 0.663989782333374
	RegressionCompetitionScore: 0.19141104294478528



Validation scores:
	RegressionAUROC: 0.6771283149719238
	RegressionCompetitionScore: 0.1423312883435583



Validation scores:
	RegressionAUROC: 0.623924732208252
	RegressionCompetitionScore: 0.1156441717791411



Validation scores:
	RegressionAUROC: 0.5066133737564087
	RegressionCompetitionScore: 0.12239263803680982



Validation scores:
	RegressionAUROC: 0.6120617389678955
	RegressionCompetitionScore: 0.10613496932515337

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.211. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10644171779141104
     Test RegressionAUROC            0.6520432233810425
Test RegressionCompetitionScore      0.10644171779141104
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 20:45:45,449][0m Trial 282 finished with value: 0.10644171779141104 and parameters: {'lr': 0.0005157909799989024, 'dropout': 0.6437337487573986, 'd_model_multiplier': 2, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 94, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0007487600628779847, 'dropout': 0.4448398508854928, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 282, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 49.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
49.2 K    Trainable params
0         Non-trainable params
49.2 K    Total params
0.197     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.664517879486084
	RegressionCompetitionScore: 0.1607361963190184

Metric val_loss improved. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.6896929144859314
	RegressionCompetitionScore: 0.2855828220858896

Metric val_loss improved by 0.044 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7030959129333496
	RegressionCompetitionScore: 0.2920245398773006



Validation scores:
	RegressionAUROC: 0.7009443044662476
	RegressionCompetitionScore: 0.2874233128834356

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.6967442631721497
	RegressionCompetitionScore: 0.2926380368098159



Validation scores:
	RegressionAUROC: 0.7020891904830933
	RegressionCompetitionScore: 0.3168711656441718



Validation scores:
	RegressionAUROC: 0.7225086688995361
	RegressionCompetitionScore: 0.3343558282208589

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7269816994667053
	RegressionCompetitionScore: 0.3585889570552147



Validation scores:
	RegressionAUROC: 0.6655821800231934
	RegressionCompetitionScore: 0.15153374233128836



Validation scores:
	RegressionAUROC: 0.7198578119277954
	RegressionCompetitionScore: 0.3282208588957055



Validation scores:
	RegressionAUROC: 0.7226467132568359
	RegressionCompetitionScore: 0.3085889570552147



Validation scores:
	RegressionAUROC: 0.7242581844329834
	RegressionCompetitionScore: 0.37392638036809817



Validation scores:
	RegressionAUROC: 0.7300453186035156
	RegressionCompetitionScore: 0.3558282208588957



Validation scores:
	RegressionAUROC: 0.7167868614196777
	RegressionCompetitionScore: 0.3352760736196319

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3343558282208589
     Test RegressionAUROC            0.7225086688995361
Test RegressionCompetitionScore      0.3343558282208589
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 20:51:46,700][0m Trial 283 finished with value: 0.3343558282208589 and parameters: {'lr': 0.0007487600628779847, 'dropout': 0.4448398508854928, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 282, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.007295171146259211, 'dropout': 0.4496282936360339, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 116, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 32.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
32.8 K    Trainable params
0         Non-trainable params
32.8 K    Total params
0.131     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.432


Validation scores:
	RegressionAUROC: 0.57509845495224
	RegressionCompetitionScore: 0.061042944785276075

Metric val_loss improved by 1.134 >= min_delta = 0.0. New best score: 0.298


Validation scores:
	RegressionAUROC: 0.3693517744541168
	RegressionCompetitionScore: 0.046625766871165646

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.274


Validation scores:
	RegressionAUROC: 0.6002576947212219
	RegressionCompetitionScore: 0.0843558282208589

Metric val_loss improved by 0.052 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.5238342881202698
	RegressionCompetitionScore: 0.09049079754601227



Validation scores:
	RegressionAUROC: 0.6091311573982239
	RegressionCompetitionScore: 0.10153374233128834

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6250932812690735
	RegressionCompetitionScore: 0.18282208588957055



Validation scores:
	RegressionAUROC: 0.40470463037490845
	RegressionCompetitionScore: 0.05674846625766871



Validation scores:
	RegressionAUROC: 0.38573649525642395
	RegressionCompetitionScore: 0.07515337423312883



Validation scores:
	RegressionAUROC: 0.3834274113178253
	RegressionCompetitionScore: 0.07085889570552147



Validation scores:
	RegressionAUROC: 0.5638164281845093
	RegressionCompetitionScore: 0.06809815950920245



Validation scores:
	RegressionAUROC: 0.4616129398345947
	RegressionCompetitionScore: 0.0794478527607362



Validation scores:
	RegressionAUROC: 0.6259055137634277
	RegressionCompetitionScore: 0.2803680981595092

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10153374233128834
     Test RegressionAUROC            0.6091311573982239
Test RegressionCompetitionScore      0.10153374233128834
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 20:57:19,266][0m Trial 284 finished with value: 0.10153374233128834 and parameters: {'lr': 0.007295171146259211, 'dropout': 0.4496282936360339, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 116, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 3.8064323248133433e-07, 'dropout': 0.4372840452078534, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 304, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 45.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
45.6 K    Trainable params
0         Non-trainable params
45.6 K    Total params
0.182     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6231884360313416
	RegressionCompetitionScore: 0.34782608695652173



Validation scores:
	RegressionAUROC: 0.6181400418281555
	RegressionCompetitionScore: 0.19386503067484662

Metric val_loss improved. New best score: 0.539


Validation scores:
	RegressionAUROC: 0.6141202449798584
	RegressionCompetitionScore: 0.19263803680981595

Metric val_loss improved by 0.069 >= min_delta = 0.0. New best score: 0.470


Validation scores:
	RegressionAUROC: 0.6144983768463135
	RegressionCompetitionScore: 0.19202453987730062

Metric val_loss improved by 0.059 >= min_delta = 0.0. New best score: 0.411


Validation scores:
	RegressionAUROC: 0.6143600940704346
	RegressionCompetitionScore: 0.18957055214723925

Metric val_loss improved by 0.051 >= min_delta = 0.0. New best score: 0.360


Validation scores:
	RegressionAUROC: 0.6142345666885376
	RegressionCompetitionScore: 0.19049079754601228

Metric val_loss improved by 0.042 >= min_delta = 0.0. New best score: 0.318


Validation scores:
	RegressionAUROC: 0.6141986846923828
	RegressionCompetitionScore: 0.19110429447852761

Metric val_loss improved by 0.034 >= min_delta = 0.0. New best score: 0.284


Validation scores:
	RegressionAUROC: 0.6142256259918213
	RegressionCompetitionScore: 0.19325153374233128

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.257


Validation scores:
	RegressionAUROC: 0.6147921085357666
	RegressionCompetitionScore: 0.20122699386503068

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.239


Validation scores:
	RegressionAUROC: 0.6151813864707947
	RegressionCompetitionScore: 0.201840490797546

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.6156383752822876
	RegressionCompetitionScore: 0.20613496932515338

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.6158308386802673
	RegressionCompetitionScore: 0.2076687116564417

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6162608861923218
	RegressionCompetitionScore: 0.20797546012269938

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6167373657226562
	RegressionCompetitionScore: 0.20889570552147238

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6174726486206055
	RegressionCompetitionScore: 0.21595092024539878

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6179959177970886
	RegressionCompetitionScore: 0.21533742331288344



Validation scores:
	RegressionAUROC: 0.6184629201889038
	RegressionCompetitionScore: 0.2165644171779141



Validation scores:
	RegressionAUROC: 0.6192372441291809
	RegressionCompetitionScore: 0.22392638036809817



Validation scores:
	RegressionAUROC: 0.6198116540908813
	RegressionCompetitionScore: 0.2294478527607362



Validation scores:
	RegressionAUROC: 0.6204504370689392
	RegressionCompetitionScore: 0.23251533742331287



Validation scores:
	RegressionAUROC: 0.620801568031311
	RegressionCompetitionScore: 0.23404907975460124



Validation scores:
	RegressionAUROC: 0.620781421661377
	RegressionCompetitionScore: 0.23496932515337424

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.202. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.21595092024539878
     Test RegressionAUROC            0.6174726486206055
Test RegressionCompetitionScore      0.21595092024539878
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 21:06:04,369][0m Trial 285 finished with value: 0.21595092024539878 and parameters: {'lr': 3.8064323248133433e-07, 'dropout': 0.4372840452078534, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 304, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00034885425635835046, 'dropout': 0.4294797594612057, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 323, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 197 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
197 K     Trainable params
0         Non-trainable params
197 K     Total params
0.792     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5333333611488342
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.7139701247215271
	RegressionCompetitionScore: 0.2773006134969325

Metric val_loss improved. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.6905655860900879
	RegressionCompetitionScore: 0.3138036809815951



Validation scores:
	RegressionAUROC: 0.7206937074661255
	RegressionCompetitionScore: 0.3506134969325153

Metric val_loss improved by 0.076 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7158677577972412
	RegressionCompetitionScore: 0.35644171779141104



Validation scores:
	RegressionAUROC: 0.707389235496521
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7174979448318481
	RegressionCompetitionScore: 0.37515337423312883



Validation scores:
	RegressionAUROC: 0.7121766805648804
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7204418182373047
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7221351861953735
	RegressionCompetitionScore: 0.3904907975460123



Validation scores:
	RegressionAUROC: 0.7141543626785278
	RegressionCompetitionScore: 0.3365030674846626

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3506134969325153
     Test RegressionAUROC            0.7206937074661255
Test RegressionCompetitionScore      0.3506134969325153
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 21:11:55,089][0m Trial 286 finished with value: 0.3506134969325153 and parameters: {'lr': 0.00034885425635835046, 'dropout': 0.4294797594612057, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 323, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0014199910373637013, 'dropout': 0.500248328407339, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 162, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 35.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
35.9 K    Trainable params
0         Non-trainable params
35.9 K    Total params
0.144     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6135265827178955
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.7054940462112427
	RegressionCompetitionScore: 0.30736196319018405

Metric val_loss improved. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6972292065620422
	RegressionCompetitionScore: 0.22116564417177914



Validation scores:
	RegressionAUROC: 0.7090721130371094
	RegressionCompetitionScore: 0.26533742331288346

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6827676296234131
	RegressionCompetitionScore: 0.27791411042944786



Validation scores:
	RegressionAUROC: 0.7242400646209717
	RegressionCompetitionScore: 0.38404907975460123

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7276599407196045
	RegressionCompetitionScore: 0.36717791411042944

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7305564880371094
	RegressionCompetitionScore: 0.35521472392638037

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7344101667404175
	RegressionCompetitionScore: 0.3478527607361963



Validation scores:
	RegressionAUROC: 0.7333804965019226
	RegressionCompetitionScore: 0.36349693251533743



Validation scores:
	RegressionAUROC: 0.7188764810562134
	RegressionCompetitionScore: 0.26226993865030673



Validation scores:
	RegressionAUROC: 0.728751540184021
	RegressionCompetitionScore: 0.3598159509202454



Validation scores:
	RegressionAUROC: 0.7306447625160217
	RegressionCompetitionScore: 0.34049079754601225



Validation scores:
	RegressionAUROC: 0.730138897895813
	RegressionCompetitionScore: 0.3512269938650307



Validation scores:
	RegressionAUROC: 0.7343159914016724
	RegressionCompetitionScore: 0.3414110429447853

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7455163598060608
	RegressionCompetitionScore: 0.3460122699386503



Validation scores:
	RegressionAUROC: 0.7409582138061523
	RegressionCompetitionScore: 0.30736196319018405



Validation scores:
	RegressionAUROC: 0.7483896613121033
	RegressionCompetitionScore: 0.3407975460122699



Validation scores:
	RegressionAUROC: 0.7352098226547241
	RegressionCompetitionScore: 0.3168711656441718



Validation scores:
	RegressionAUROC: 0.7219405174255371
	RegressionCompetitionScore: 0.296319018404908



Validation scores:
	RegressionAUROC: 0.7430389523506165
	RegressionCompetitionScore: 0.3300613496932515



Validation scores:
	RegressionAUROC: 0.7409297227859497
	RegressionCompetitionScore: 0.27883435582822086

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3414110429447853
     Test RegressionAUROC            0.7343159914016724
Test RegressionCompetitionScore      0.3414110429447853
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 21:20:30,284][0m Trial 287 finished with value: 0.3414110429447853 and parameters: {'lr': 0.0014199910373637013, 'dropout': 0.500248328407339, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 162, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00031320027537331163, 'dropout': 0.4829270546088728, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 135, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 34.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
34.1 K    Trainable params
0         Non-trainable params
34.1 K    Total params
0.136     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5333333015441895
	RegressionCompetitionScore: 0.2



Validation scores:
	RegressionAUROC: 0.66671222448349
	RegressionCompetitionScore: 0.2865030674846626

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.7131972312927246
	RegressionCompetitionScore: 0.3177914110429448

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7174529433250427
	RegressionCompetitionScore: 0.34202453987730064

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7399837970733643
	RegressionCompetitionScore: 0.3825153374233129

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7626171112060547
	RegressionCompetitionScore: 0.3901840490797546

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7757416367530823
	RegressionCompetitionScore: 0.3696319018404908

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7834681272506714
	RegressionCompetitionScore: 0.3588957055214724

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.160


Validation scores:
	RegressionAUROC: 0.7909355163574219
	RegressionCompetitionScore: 0.3914110429447853

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.156


Validation scores:
	RegressionAUROC: 0.7783927917480469
	RegressionCompetitionScore: 0.39846625766871163



Validation scores:
	RegressionAUROC: 0.7963248491287231
	RegressionCompetitionScore: 0.38588957055214723

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.155


Validation scores:
	RegressionAUROC: 0.7894269227981567
	RegressionCompetitionScore: 0.3684049079754601



Validation scores:
	RegressionAUROC: 0.7855961322784424
	RegressionCompetitionScore: 0.36134969325153377



Validation scores:
	RegressionAUROC: 0.7770993709564209
	RegressionCompetitionScore: 0.4098159509202454



Validation scores:
	RegressionAUROC: 0.7858663201332092
	RegressionCompetitionScore: 0.4174846625766871



Validation scores:
	RegressionAUROC: 0.7738757133483887
	RegressionCompetitionScore: 0.38374233128834356



Validation scores:
	RegressionAUROC: 0.7920058965682983
	RegressionCompetitionScore: 0.404601226993865



Validation scores:
	RegressionAUROC: 0.7841117978096008
	RegressionCompetitionScore: 0.37392638036809817

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.155. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38588957055214723
     Test RegressionAUROC            0.7963248491287231
Test RegressionCompetitionScore      0.38588957055214723
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 21:28:20,298][0m Trial 288 finished with value: 0.38588957055214723 and parameters: {'lr': 0.00031320027537331163, 'dropout': 0.4829270546088728, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 135, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 2.803571731728002e-07, 'dropout': 0.4545284279252311, 'd_model_multiplier': 2, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 556, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 109 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
109 K     Trainable params
0         Non-trainable params
109 K     Total params
0.436     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4993501901626587
	RegressionCompetitionScore: 0.0009202453987730061

Metric val_loss improved. New best score: 1.043


Validation scores:
	RegressionAUROC: 0.4993501901626587
	RegressionCompetitionScore: 0.0009202453987730061

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 1.039


Validation scores:
	RegressionAUROC: 0.4993501901626587
	RegressionCompetitionScore: 0.0009202453987730061

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 1.037


Validation scores:
	RegressionAUROC: 0.4993501901626587
	RegressionCompetitionScore: 0.0009202453987730061

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 1.033


Validation scores:
	RegressionAUROC: 0.4993501901626587
	RegressionCompetitionScore: 0.0009202453987730061

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 1.031


Validation scores:
	RegressionAUROC: 0.4993501901626587
	RegressionCompetitionScore: 0.0009202453987730061

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 1.027


Validation scores:
	RegressionAUROC: 0.4993501901626587
	RegressionCompetitionScore: 0.0009202453987730061

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 1.023


Validation scores:
	RegressionAUROC: 0.4993501901626587
	RegressionCompetitionScore: 0.0009202453987730061

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 1.021


Validation scores:
	RegressionAUROC: 0.4993501901626587
	RegressionCompetitionScore: 0.0009202453987730061

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 1.018


Validation scores:
	RegressionAUROC: 0.4995031952857971
	RegressionCompetitionScore: 0.001226993865030675

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 1.016


Validation scores:
	RegressionAUROC: 0.4995031952857971
	RegressionCompetitionScore: 0.001226993865030675

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 1.012


Validation scores:
	RegressionAUROC: 0.4995031952857971
	RegressionCompetitionScore: 0.001226993865030675

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 1.008


Validation scores:
	RegressionAUROC: 0.4995031952857971
	RegressionCompetitionScore: 0.001226993865030675

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 1.006


Validation scores:
	RegressionAUROC: 0.4995031952857971
	RegressionCompetitionScore: 0.001226993865030675

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 1.002


Validation scores:
	RegressionAUROC: 0.4995031952857971
	RegressionCompetitionScore: 0.001226993865030675

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 1.000


Validation scores:
	RegressionAUROC: 0.49965623021125793
	RegressionCompetitionScore: 0.0015337423312883436

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.997


Validation scores:
	RegressionAUROC: 0.4999622702598572
	RegressionCompetitionScore: 0.002147239263803681

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.993


Validation scores:
	RegressionAUROC: 0.4999622702598572
	RegressionCompetitionScore: 0.002147239263803681

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.991


Validation scores:
	RegressionAUROC: 0.4999622702598572
	RegressionCompetitionScore: 0.002147239263803681

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.987


Validation scores:
	RegressionAUROC: 0.4999622702598572
	RegressionCompetitionScore: 0.002147239263803681

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.985


Validation scores:
	RegressionAUROC: 0.5001153945922852
	RegressionCompetitionScore: 0.00245398773006135

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.981


Validation scores:
	RegressionAUROC: 0.5001153945922852
	RegressionCompetitionScore: 0.00245398773006135

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.978


Validation scores:
	RegressionAUROC: 0.5001153945922852
	RegressionCompetitionScore: 0.00245398773006135

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.976


Validation scores:
	RegressionAUROC: 0.5001153945922852
	RegressionCompetitionScore: 0.00245398773006135

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.972


Validation scores:
	RegressionAUROC: 0.4998939633369446
	RegressionCompetitionScore: 0.00245398773006135

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.970


Validation scores:
	RegressionAUROC: 0.4998256266117096
	RegressionCompetitionScore: 0.0027607361963190185

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.966


Validation scores:
	RegressionAUROC: 0.4998256266117096
	RegressionCompetitionScore: 0.0027607361963190185

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.963


Validation scores:
	RegressionAUROC: 0.4998256266117096
	RegressionCompetitionScore: 0.0027607361963190185

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.961


Validation scores:
	RegressionAUROC: 0.4998256266117096
	RegressionCompetitionScore: 0.0027607361963190185

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.957


Validation scores:
	RegressionAUROC: 0.49997851252555847
	RegressionCompetitionScore: 0.003067484662576687

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.955


Validation scores:
	RegressionAUROC: 0.500131368637085
	RegressionCompetitionScore: 0.003374233128834356

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.951


Validation scores:
	RegressionAUROC: 0.500131368637085
	RegressionCompetitionScore: 0.003374233128834356

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.948


Validation scores:
	RegressionAUROC: 0.500131368637085
	RegressionCompetitionScore: 0.003374233128834356

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.946


Validation scores:
	RegressionAUROC: 0.500131368637085
	RegressionCompetitionScore: 0.003374233128834356

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.942


Validation scores:
	RegressionAUROC: 0.4999102056026459
	RegressionCompetitionScore: 0.003374233128834356

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.940


Validation scores:
	RegressionAUROC: 0.4999102056026459
	RegressionCompetitionScore: 0.003374233128834356

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.937


Validation scores:
	RegressionAUROC: 0.4999102056026459
	RegressionCompetitionScore: 0.003374233128834356

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.933


Validation scores:
	RegressionAUROC: 0.4999102056026459
	RegressionCompetitionScore: 0.003374233128834356

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.931


Validation scores:
	RegressionAUROC: 0.5000630617141724
	RegressionCompetitionScore: 0.0036809815950920245

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.928


Validation scores:
	RegressionAUROC: 0.5000630617141724
	RegressionCompetitionScore: 0.0036809815950920245

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.926


Validation scores:
	RegressionAUROC: 0.5003687739372253
	RegressionCompetitionScore: 0.004294478527607362

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.922


Validation scores:
	RegressionAUROC: 0.5005215406417847
	RegressionCompetitionScore: 0.004601226993865031

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.918


Validation scores:
	RegressionAUROC: 0.5005215406417847
	RegressionCompetitionScore: 0.004601226993865031

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.917


Validation scores:
	RegressionAUROC: 0.5005215406417847
	RegressionCompetitionScore: 0.004601226993865031

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.913


Validation scores:
	RegressionAUROC: 0.5005214214324951
	RegressionCompetitionScore: 0.004601226993865031

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.911


Validation scores:
	RegressionAUROC: 0.5006742477416992
	RegressionCompetitionScore: 0.0049079754601227

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.908


Validation scores:
	RegressionAUROC: 0.5006740689277649
	RegressionCompetitionScore: 0.0049079754601227

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.904


Validation scores:
	RegressionAUROC: 0.5006740689277649
	RegressionCompetitionScore: 0.0049079754601227

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.902


Validation scores:
	RegressionAUROC: 0.500826895236969
	RegressionCompetitionScore: 0.005214723926380368

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.899


Validation scores:
	RegressionAUROC: 0.500826895236969
	RegressionCompetitionScore: 0.005214723926380368

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.897
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore          0.005214723926380368
     Test RegressionAUROC             0.500826895236969
Test RegressionCompetitionScore     0.005214723926380368
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 21:48:23,652][0m Trial 289 finished with value: 0.005214723926380368 and parameters: {'lr': 2.803571731728002e-07, 'dropout': 0.4545284279252311, 'd_model_multiplier': 2, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 556, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0005791541650834386, 'dropout': 0.44089187234576077, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 94, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 31.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
31.3 K    Trainable params
0         Non-trainable params
31.3 K    Total params
0.125     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3091787099838257
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6412227153778076
	RegressionCompetitionScore: 0.1254601226993865

Metric val_loss improved. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6940727233886719
	RegressionCompetitionScore: 0.2785276073619632

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.7238991260528564
	RegressionCompetitionScore: 0.3205521472392638

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7161046266555786
	RegressionCompetitionScore: 0.3187116564417178



Validation scores:
	RegressionAUROC: 0.7258620858192444
	RegressionCompetitionScore: 0.36349693251533743

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7472399473190308
	RegressionCompetitionScore: 0.3276073619631902

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7553899884223938
	RegressionCompetitionScore: 0.35



Validation scores:
	RegressionAUROC: 0.755020797252655
	RegressionCompetitionScore: 0.3325153374233129



Validation scores:
	RegressionAUROC: 0.7431511282920837
	RegressionCompetitionScore: 0.3441717791411043



Validation scores:
	RegressionAUROC: 0.7760651707649231
	RegressionCompetitionScore: 0.4098159509202454

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7784745693206787
	RegressionCompetitionScore: 0.36871165644171777



Validation scores:
	RegressionAUROC: 0.7643774151802063
	RegressionCompetitionScore: 0.37300613496932516



Validation scores:
	RegressionAUROC: 0.7702840566635132
	RegressionCompetitionScore: 0.4245398773006135



Validation scores:
	RegressionAUROC: 0.7748522162437439
	RegressionCompetitionScore: 0.4171779141104294



Validation scores:
	RegressionAUROC: 0.7817071676254272
	RegressionCompetitionScore: 0.39723926380368096



Validation scores:
	RegressionAUROC: 0.7852455377578735
	RegressionCompetitionScore: 0.38834355828220857

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7781772613525391
	RegressionCompetitionScore: 0.37975460122699384



Validation scores:
	RegressionAUROC: 0.7805016040802002
	RegressionCompetitionScore: 0.3843558282208589

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7776296138763428
	RegressionCompetitionScore: 0.41042944785276075



Validation scores:
	RegressionAUROC: 0.7856032252311707
	RegressionCompetitionScore: 0.3923312883435583



Validation scores:
	RegressionAUROC: 0.7722880840301514
	RegressionCompetitionScore: 0.3638036809815951

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.7624235153198242
	RegressionCompetitionScore: 0.345398773006135



Validation scores:
	RegressionAUROC: 0.7773382663726807
	RegressionCompetitionScore: 0.37116564417177916



Validation scores:
	RegressionAUROC: 0.7737540006637573
	RegressionCompetitionScore: 0.4092024539877301



Validation scores:
	RegressionAUROC: 0.7772103548049927
	RegressionCompetitionScore: 0.40337423312883436



Validation scores:
	RegressionAUROC: 0.7824304103851318
	RegressionCompetitionScore: 0.37147239263803683



Validation scores:
	RegressionAUROC: 0.777292013168335
	RegressionCompetitionScore: 0.37975460122699384



Validation scores:
	RegressionAUROC: 0.7727372646331787
	RegressionCompetitionScore: 0.4030674846625767

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.161. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3638036809815951
     Test RegressionAUROC            0.7722880840301514
Test RegressionCompetitionScore      0.3638036809815951
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 21:59:50,810][0m Trial 290 finished with value: 0.3638036809815951 and parameters: {'lr': 0.0005791541650834386, 'dropout': 0.44089187234576077, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 94, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0010046002821751205, 'dropout': 0.4691812886949235, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 358, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 42.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
42.8 K    Trainable params
0         Non-trainable params
42.8 K    Total params
0.171     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4333333373069763
	RegressionCompetitionScore: 0.2



Validation scores:
	RegressionAUROC: 0.5805199146270752
	RegressionCompetitionScore: 0.24570552147239264

Metric val_loss improved. New best score: 0.319


Validation scores:
	RegressionAUROC: 0.6673678159713745
	RegressionCompetitionScore: 0.23803680981595093

Metric val_loss improved by 0.119 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6626349687576294
	RegressionCompetitionScore: 0.2134969325153374



Validation scores:
	RegressionAUROC: 0.6636115312576294
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.504395067691803
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.599747896194458
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.677850604057312
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6933455467224121
	RegressionCompetitionScore: 0.3070552147239264

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.200. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.23803680981595093
     Test RegressionAUROC            0.6673678159713745
Test RegressionCompetitionScore      0.23803680981595093
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 22:04:07,513][0m Trial 291 finished with value: 0.23803680981595093 and parameters: {'lr': 0.0010046002821751205, 'dropout': 0.4691812886949235, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 358, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 2.627366052247276e-06, 'dropout': 0.5833651535292089, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 183, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 78.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
78.2 K    Trainable params
0         Non-trainable params
78.2 K    Total params
0.313     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5120773315429688
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.3844204246997833
	RegressionCompetitionScore: 0.05705521472392638

Metric val_loss improved. New best score: 0.300


Validation scores:
	RegressionAUROC: 0.3835870623588562
	RegressionCompetitionScore: 0.0558282208588957

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.288


Validation scores:
	RegressionAUROC: 0.38725054264068604
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.39044326543807983
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.3984410762786865
	RegressionCompetitionScore: 0.058588957055214726

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.286


Validation scores:
	RegressionAUROC: 0.40726912021636963
	RegressionCompetitionScore: 0.06595092024539877

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.272


Validation scores:
	RegressionAUROC: 0.41222134232521057
	RegressionCompetitionScore: 0.06441717791411043

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.257


Validation scores:
	RegressionAUROC: 0.41964757442474365
	RegressionCompetitionScore: 0.06932515337423313

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.244


Validation scores:
	RegressionAUROC: 0.4247620105743408
	RegressionCompetitionScore: 0.07423312883435583

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.243


Validation scores:
	RegressionAUROC: 0.4294244945049286
	RegressionCompetitionScore: 0.07822085889570553

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.241


Validation scores:
	RegressionAUROC: 0.4340927004814148
	RegressionCompetitionScore: 0.07883435582822086



Validation scores:
	RegressionAUROC: 0.4425903856754303
	RegressionCompetitionScore: 0.0852760736196319



Validation scores:
	RegressionAUROC: 0.4495014250278473
	RegressionCompetitionScore: 0.0892638036809816



Validation scores:
	RegressionAUROC: 0.45945411920547485
	RegressionCompetitionScore: 0.09263803680981596

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.4657997190952301
	RegressionCompetitionScore: 0.09478527607361963

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.4730318784713745
	RegressionCompetitionScore: 0.09355828220858896

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.4785807132720947
	RegressionCompetitionScore: 0.09171779141104294

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.4875810146331787
	RegressionCompetitionScore: 0.09693251533742331



Validation scores:
	RegressionAUROC: 0.49462413787841797
	RegressionCompetitionScore: 0.09938650306748466



Validation scores:
	RegressionAUROC: 0.5041602253913879
	RegressionCompetitionScore: 0.09877300613496932



Validation scores:
	RegressionAUROC: 0.5239983797073364
	RegressionCompetitionScore: 0.10245398773006135

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5371014475822449
	RegressionCompetitionScore: 0.10398773006134969

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5526065826416016
	RegressionCompetitionScore: 0.10828220858895705

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5687616467475891
	RegressionCompetitionScore: 0.10766871165644172

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5780503749847412
	RegressionCompetitionScore: 0.10736196319018405



Validation scores:
	RegressionAUROC: 0.5921344757080078
	RegressionCompetitionScore: 0.1098159509202454

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.603304922580719
	RegressionCompetitionScore: 0.1147239263803681



Validation scores:
	RegressionAUROC: 0.6121214032173157
	RegressionCompetitionScore: 0.11595092024539877



Validation scores:
	RegressionAUROC: 0.6190407276153564
	RegressionCompetitionScore: 0.11533742331288344



Validation scores:
	RegressionAUROC: 0.6248974204063416
	RegressionCompetitionScore: 0.11717791411042945



Validation scores:
	RegressionAUROC: 0.6399763226509094
	RegressionCompetitionScore: 0.12515337423312883

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6503790020942688
	RegressionCompetitionScore: 0.1245398773006135

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6584458351135254
	RegressionCompetitionScore: 0.12699386503067484

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6683923602104187
	RegressionCompetitionScore: 0.1312883435582822

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6766401529312134
	RegressionCompetitionScore: 0.13803680981595093

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6820348501205444
	RegressionCompetitionScore: 0.15337423312883436



Validation scores:
	RegressionAUROC: 0.6863123178482056
	RegressionCompetitionScore: 0.15184049079754602



Validation scores:
	RegressionAUROC: 0.6878623962402344
	RegressionCompetitionScore: 0.15552147239263803



Validation scores:
	RegressionAUROC: 0.6913405656814575
	RegressionCompetitionScore: 0.16809815950920245



Validation scores:
	RegressionAUROC: 0.692171573638916
	RegressionCompetitionScore: 0.16533742331288342



Validation scores:
	RegressionAUROC: 0.6974892616271973
	RegressionCompetitionScore: 0.18834355828220858

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7008862495422363
	RegressionCompetitionScore: 0.2067484662576687

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7026911973953247
	RegressionCompetitionScore: 0.2049079754601227



Validation scores:
	RegressionAUROC: 0.7046046257019043
	RegressionCompetitionScore: 0.20644171779141104

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7057645916938782
	RegressionCompetitionScore: 0.2076687116564417



Validation scores:
	RegressionAUROC: 0.7063214182853699
	RegressionCompetitionScore: 0.20552147239263804



Validation scores:
	RegressionAUROC: 0.7071359753608704
	RegressionCompetitionScore: 0.20828220858895705



Validation scores:
	RegressionAUROC: 0.7072598934173584
	RegressionCompetitionScore: 0.201840490797546



Validation scores:
	RegressionAUROC: 0.7078619003295898
	RegressionCompetitionScore: 0.20644171779141104



Validation scores:
	RegressionAUROC: 0.7079529166221619
	RegressionCompetitionScore: 0.20705521472392638

`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.20644171779141104
     Test RegressionAUROC            0.7046046257019043
Test RegressionCompetitionScore      0.20644171779141104
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 22:24:19,259][0m Trial 292 finished with value: 0.20644171779141104 and parameters: {'lr': 2.627366052247276e-06, 'dropout': 0.5833651535292089, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 183, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00019356760505382674, 'dropout': 0.6066225227583516, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 111, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 34.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
34.7 K    Trainable params
0         Non-trainable params
34.7 K    Total params
0.139     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6521739363670349
	RegressionCompetitionScore: 0.5217391304347826



Validation scores:
	RegressionAUROC: 0.4266298711299896
	RegressionCompetitionScore: 0.08282208588957055

Metric val_loss improved. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.507357120513916
	RegressionCompetitionScore: 0.09785276073619632

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.6292636394500732
	RegressionCompetitionScore: 0.10245398773006135

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6155948638916016
	RegressionCompetitionScore: 0.100920245398773



Validation scores:
	RegressionAUROC: 0.6795527935028076
	RegressionCompetitionScore: 0.18527607361963191

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.6879435777664185
	RegressionCompetitionScore: 0.18006134969325152



Validation scores:
	RegressionAUROC: 0.7139391899108887
	RegressionCompetitionScore: 0.347239263803681



Validation scores:
	RegressionAUROC: 0.7169979810714722
	RegressionCompetitionScore: 0.3567484662576687



Validation scores:
	RegressionAUROC: 0.7204908728599548
	RegressionCompetitionScore: 0.36625766871165644

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.7196651101112366
	RegressionCompetitionScore: 0.38312883435582823



Validation scores:
	RegressionAUROC: 0.7168254852294922
	RegressionCompetitionScore: 0.37668711656441717

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7048237323760986
	RegressionCompetitionScore: 0.35920245398773004



Validation scores:
	RegressionAUROC: 0.7170586585998535
	RegressionCompetitionScore: 0.3312883435582822

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7398877143859863
	RegressionCompetitionScore: 0.35460122699386504

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7377581596374512
	RegressionCompetitionScore: 0.35337423312883437

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7243697643280029
	RegressionCompetitionScore: 0.3334355828220859



Validation scores:
	RegressionAUROC: 0.7500485181808472
	RegressionCompetitionScore: 0.3407975460122699



Validation scores:
	RegressionAUROC: 0.7467783689498901
	RegressionCompetitionScore: 0.3300613496932515



Validation scores:
	RegressionAUROC: 0.7316738367080688
	RegressionCompetitionScore: 0.33773006134969324



Validation scores:
	RegressionAUROC: 0.7582007050514221
	RegressionCompetitionScore: 0.36319018404907977



Validation scores:
	RegressionAUROC: 0.7571488618850708
	RegressionCompetitionScore: 0.35153374233128837

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7540481090545654
	RegressionCompetitionScore: 0.36134969325153377



Validation scores:
	RegressionAUROC: 0.7501025199890137
	RegressionCompetitionScore: 0.3595092024539877



Validation scores:
	RegressionAUROC: 0.7454083561897278
	RegressionCompetitionScore: 0.27699386503067486



Validation scores:
	RegressionAUROC: 0.7585622668266296
	RegressionCompetitionScore: 0.3825153374233129



Validation scores:
	RegressionAUROC: 0.770584762096405
	RegressionCompetitionScore: 0.36871165644171777

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7574318051338196
	RegressionCompetitionScore: 0.38312883435582823



Validation scores:
	RegressionAUROC: 0.749620795249939
	RegressionCompetitionScore: 0.349079754601227



Validation scores:
	RegressionAUROC: 0.7551831007003784
	RegressionCompetitionScore: 0.38558282208588956



Validation scores:
	RegressionAUROC: 0.7572405934333801
	RegressionCompetitionScore: 0.37300613496932516



Validation scores:
	RegressionAUROC: 0.7616385221481323
	RegressionCompetitionScore: 0.3911042944785276



Validation scores:
	RegressionAUROC: 0.7606701850891113
	RegressionCompetitionScore: 0.3806748466257669



Validation scores:
	RegressionAUROC: 0.7485846281051636
	RegressionCompetitionScore: 0.37300613496932516

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.168. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36871165644171777
     Test RegressionAUROC             0.770584762096405
Test RegressionCompetitionScore      0.36871165644171777
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 22:37:49,769][0m Trial 293 finished with value: 0.36871165644171777 and parameters: {'lr': 0.00019356760505382674, 'dropout': 0.6066225227583516, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 111, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.02912820997057103, 'dropout': 0.42756934054034623, 'd_model_multiplier': 32, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 143, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.3 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.3 M     Trainable params
0         Non-trainable params
1.3 M     Total params
5.060     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.54347825050354
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 48842.805


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 45423.367 >= min_delta = 0.0. New best score: 3419.436


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 2973.148 >= min_delta = 0.0. New best score: 446.287


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 431.148 >= min_delta = 0.0. New best score: 15.139


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 4.713 >= min_delta = 0.0. New best score: 10.426


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 2.867 >= min_delta = 0.0. New best score: 7.558


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 5.587 >= min_delta = 0.0. New best score: 1.972


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 1.153 >= min_delta = 0.0. New best score: 0.819


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.819. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 22:45:47,931][0m Trial 294 finished with value: 0.0 and parameters: {'lr': 0.02912820997057103, 'dropout': 0.42756934054034623, 'd_model_multiplier': 32, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 143, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 1.0360134600281975e-06, 'dropout': 0.6178253757039512, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 569, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 53.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
53.6 K    Trainable params
0         Non-trainable params
53.6 K    Total params
0.214     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.13333332538604736
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.423988938331604
	RegressionCompetitionScore: 0.05920245398773006

Metric val_loss improved. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.42269304394721985
	RegressionCompetitionScore: 0.05674846625766871



Validation scores:
	RegressionAUROC: 0.42016807198524475
	RegressionCompetitionScore: 0.05705521472392638



Validation scores:
	RegressionAUROC: 0.41999566555023193
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4169074296951294
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4262012541294098
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.44663941860198975
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4401896595954895
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.232. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.05920245398773006
     Test RegressionAUROC             0.423988938331604
Test RegressionCompetitionScore      0.05920245398773006
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 22:49:37,772][0m Trial 295 finished with value: 0.05920245398773006 and parameters: {'lr': 1.0360134600281975e-06, 'dropout': 0.6178253757039512, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 569, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0004362548931747563, 'dropout': 0.45429959865407654, 'd_model_multiplier': 64, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 533, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 6.9 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
6.9 M     Trainable params
0         Non-trainable params
6.9 M     Total params
27.539    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.425


Validation scores:
	RegressionAUROC: 0.5675437450408936
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 1.057 >= min_delta = 0.0. New best score: 0.368


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6930927038192749
	RegressionCompetitionScore: 0.2665644171779141



Validation scores:
	RegressionAUROC: 0.6867632269859314
	RegressionCompetitionScore: 0.27883435582822086

Metric val_loss improved by 0.059 >= min_delta = 0.0. New best score: 0.309


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5442991852760315
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6592435240745544
	RegressionCompetitionScore: 0.14171779141104293



Validation scores:
	RegressionAUROC: 0.6564191579818726
	RegressionCompetitionScore: 0.20245398773006135

Metric val_loss improved by 0.079 >= min_delta = 0.0. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.6709190011024475
	RegressionCompetitionScore: 0.09907975460122699



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6798992156982422
	RegressionCompetitionScore: 0.1196319018404908



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6759393215179443
	RegressionCompetitionScore: 0.13466257668711656



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.230. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.20245398773006135
     Test RegressionAUROC            0.6564191579818726
Test RegressionCompetitionScore      0.20245398773006135
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 22:57:17,440][0m Trial 296 finished with value: 0.20245398773006135 and parameters: {'lr': 0.0004362548931747563, 'dropout': 0.45429959865407654, 'd_model_multiplier': 64, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 533, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.002373642537178589, 'dropout': 0.4075903886907755, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 258, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 88.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
88.0 K    Trainable params
0         Non-trainable params
88.0 K    Total params
0.352     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.649


Validation scores:
	RegressionAUROC: 0.659757673740387
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.361 >= min_delta = 0.0. New best score: 0.289


Validation scores:
	RegressionAUROC: 0.5827181339263916
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6970584392547607
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.055 >= min_delta = 0.0. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.693499743938446
	RegressionCompetitionScore: 0.3282208588957055

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.7130271196365356
	RegressionCompetitionScore: 0.29846625766871165



Validation scores:
	RegressionAUROC: 0.7085787057876587
	RegressionCompetitionScore: 0.36993865030674844



Validation scores:
	RegressionAUROC: 0.7104548215866089
	RegressionCompetitionScore: 0.33588957055214724



Validation scores:
	RegressionAUROC: 0.7124472856521606
	RegressionCompetitionScore: 0.3052147239263804



Validation scores:
	RegressionAUROC: 0.7065478563308716
	RegressionCompetitionScore: 0.27208588957055213



Validation scores:
	RegressionAUROC: 0.7182307243347168
	RegressionCompetitionScore: 0.34478527607361964

Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.720946729183197
	RegressionCompetitionScore: 0.34263803680981597



Validation scores:
	RegressionAUROC: 0.718147873878479
	RegressionCompetitionScore: 0.36503067484662577



Validation scores:
	RegressionAUROC: 0.7241861820220947
	RegressionCompetitionScore: 0.36809815950920244



Validation scores:
	RegressionAUROC: 0.6657099723815918
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6881670951843262
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6815093755722046
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7000460624694824
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.180. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.34478527607361964
     Test RegressionAUROC            0.7182307243347168
Test RegressionCompetitionScore      0.34478527607361964
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 23:04:52,265][0m Trial 297 finished with value: 0.34478527607361964 and parameters: {'lr': 0.002373642537178589, 'dropout': 0.4075903886907755, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 258, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.00027188677344687, 'dropout': 0.44360347230482916, 'd_model_multiplier': 16, 'num_layers': 8, 'n_heads': 8, 'dim_feedforward': 81, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 833 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
833 K     Trainable params
0         Non-trainable params
833 K     Total params
3.336     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.26570045948028564
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.625


Validation scores:
	RegressionAUROC: 0.6817561388015747
	RegressionCompetitionScore: 0.2647239263803681

Metric val_loss improved by 0.207 >= min_delta = 0.0. New best score: 0.418


Validation scores:
	RegressionAUROC: 0.7056810855865479
	RegressionCompetitionScore: 0.26104294478527607

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.410


Validation scores:
	RegressionAUROC: 0.7176617383956909
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.174 >= min_delta = 0.0. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.7318199872970581
	RegressionCompetitionScore: 0.3693251533742331



Validation scores:
	RegressionAUROC: 0.7335665822029114
	RegressionCompetitionScore: 0.39079754601226996

Metric val_loss improved by 0.055 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7393898963928223
	RegressionCompetitionScore: 0.3871165644171779



Validation scores:
	RegressionAUROC: 0.732799768447876
	RegressionCompetitionScore: 0.3328220858895706



Validation scores:
	RegressionAUROC: 0.7497200965881348
	RegressionCompetitionScore: 0.38312883435582823



Validation scores:
	RegressionAUROC: 0.749498724937439
	RegressionCompetitionScore: 0.3619631901840491



Validation scores:
	RegressionAUROC: 0.7440522313117981
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7496179342269897
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7239530086517334
	RegressionCompetitionScore: 0.2883435582822086

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.180. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.39079754601226996
     Test RegressionAUROC            0.7335665822029114
Test RegressionCompetitionScore      0.39079754601226996
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 23:10:38,094][0m Trial 298 finished with value: 0.39079754601226996 and parameters: {'lr': 0.00027188677344687, 'dropout': 0.44360347230482916, 'd_model_multiplier': 16, 'num_layers': 8, 'n_heads': 8, 'dim_feedforward': 81, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0007330561238204192, 'dropout': 0.6798870751083984, 'd_model_multiplier': 2, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 413, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 75.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
75.3 K    Trainable params
0         Non-trainable params
75.3 K    Total params
0.301     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6859902739524841
	RegressionCompetitionScore: 0.4782608695652174



Validation scores:
	RegressionAUROC: 0.6564515829086304
	RegressionCompetitionScore: 0.09355828220858896

Metric val_loss improved. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6361998319625854
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6513848304748535
	RegressionCompetitionScore: 0.28773006134969326



Validation scores:
	RegressionAUROC: 0.6484827995300293
	RegressionCompetitionScore: 0.19723926380368098



Validation scores:
	RegressionAUROC: 0.5848163366317749
	RegressionCompetitionScore: 0.1147239263803681



Validation scores:
	RegressionAUROC: 0.652429461479187
	RegressionCompetitionScore: 0.11503067484662577



Validation scores:
	RegressionAUROC: 0.6828781366348267
	RegressionCompetitionScore: 0.1374233128834356



Validation scores:
	RegressionAUROC: 0.6852525472640991
	RegressionCompetitionScore: 0.12423312883435583

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.205. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.09355828220858896
     Test RegressionAUROC            0.6564515829086304
Test RegressionCompetitionScore      0.09355828220858896
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 23:14:10,135][0m Trial 299 finished with value: 0.09355828220858896 and parameters: {'lr': 0.0007330561238204192, 'dropout': 0.6798870751083984, 'd_model_multiplier': 2, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 413, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 198 with value: 0.45858895705521474.[0m
Starting trial with params:
{'lr': 0.0004204313315799624, 'dropout': 0.4901606643414324, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 126, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 26.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
26.1 K    Trainable params
0         Non-trainable params
26.1 K    Total params
0.104     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.32367148995399475
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6887591481208801
	RegressionCompetitionScore: 0.19631901840490798

Metric val_loss improved. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.695399284362793
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7358682155609131
	RegressionCompetitionScore: 0.36165644171779143



Validation scores:
	RegressionAUROC: 0.7201076149940491
	RegressionCompetitionScore: 0.37607361963190183



Validation scores:
	RegressionAUROC: 0.7365450263023376
	RegressionCompetitionScore: 0.3674846625766871



Validation scores:
	RegressionAUROC: 0.7489534020423889
	RegressionCompetitionScore: 0.37760736196319017

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7503077983856201
	RegressionCompetitionScore: 0.39539877300613496



Validation scores:
	RegressionAUROC: 0.7584899067878723
	RegressionCompetitionScore: 0.40245398773006136



Validation scores:
	RegressionAUROC: 0.7600345015525818
	RegressionCompetitionScore: 0.42760736196319016



Validation scores:
	RegressionAUROC: 0.7813612818717957
	RegressionCompetitionScore: 0.37423312883435583

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7715275883674622
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7697312235832214
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7902851104736328
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7838321924209595
	RegressionCompetitionScore: 0.4147239263803681



Validation scores:
	RegressionAUROC: 0.7868924736976624
	RegressionCompetitionScore: 0.41779141104294476

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.8016326427459717
	RegressionCompetitionScore: 0.44171779141104295

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7770181894302368
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.8076180219650269
	RegressionCompetitionScore: 0.4644171779141104

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.789048433303833
	RegressionCompetitionScore: 0.4251533742331288



Validation scores:
	RegressionAUROC: 0.8078187704086304
	RegressionCompetitionScore: 0.4723926380368098



Validation scores:
	RegressionAUROC: 0.7871149778366089
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7944491505622864
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.8039568662643433
	RegressionCompetitionScore: 0.4616564417177914



Validation scores:
	RegressionAUROC: 0.8112979531288147
	RegressionCompetitionScore: 0.4705521472392638



Validation scores:
	RegressionAUROC: 0.7967305183410645
	RegressionCompetitionScore: 0.44969325153374234

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.167. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4644171779141104
     Test RegressionAUROC            0.8076180219650269
Test RegressionCompetitionScore      0.4644171779141104
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 23:24:12,220][0m Trial 300 finished with value: 0.4644171779141104 and parameters: {'lr': 0.0004204313315799624, 'dropout': 0.4901606643414324, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 126, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0002337140721491388, 'dropout': 0.4927366999048832, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 123, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 26.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
26.0 K    Trainable params
0         Non-trainable params
26.0 K    Total params
0.104     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5940673351287842
	RegressionCompetitionScore: 0.2223926380368098

Metric val_loss improved. New best score: 0.316


Validation scores:
	RegressionAUROC: 0.6083601713180542
	RegressionCompetitionScore: 0.20950920245398774



Validation scores:
	RegressionAUROC: 0.6171550750732422
	RegressionCompetitionScore: 0.16717791411042945



Validation scores:
	RegressionAUROC: 0.6707953810691833
	RegressionCompetitionScore: 0.28496932515337425



Validation scores:
	RegressionAUROC: 0.6836796402931213
	RegressionCompetitionScore: 0.27883435582822086



Validation scores:
	RegressionAUROC: 0.7321106195449829
	RegressionCompetitionScore: 0.38773006134969323



Validation scores:
	RegressionAUROC: 0.7104743719100952
	RegressionCompetitionScore: 0.3585889570552147



Validation scores:
	RegressionAUROC: 0.7171423435211182
	RegressionCompetitionScore: 0.3576687116564417

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.316. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2223926380368098
     Test RegressionAUROC            0.5940673351287842
Test RegressionCompetitionScore      0.2223926380368098
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 23:27:46,922][0m Trial 301 finished with value: 0.2223926380368098 and parameters: {'lr': 0.0002337140721491388, 'dropout': 0.4927366999048832, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 123, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 5.057021592991452e-06, 'dropout': 0.5074762799920701, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 32, 'dim_feedforward': 101, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 89.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
89.4 K    Trainable params
0         Non-trainable params
89.4 K    Total params
0.358     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.31884056329727173
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5164458751678467
	RegressionCompetitionScore: 0.11349693251533742

Metric val_loss improved. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.5614331364631653
	RegressionCompetitionScore: 0.1392638036809816

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.590360701084137
	RegressionCompetitionScore: 0.17668711656441718

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6065660715103149
	RegressionCompetitionScore: 0.20061349693251534

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6149044632911682
	RegressionCompetitionScore: 0.22085889570552147

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6205087304115295
	RegressionCompetitionScore: 0.22208588957055214

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6261414289474487
	RegressionCompetitionScore: 0.2294478527607362

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.631604790687561
	RegressionCompetitionScore: 0.23773006134969324



Validation scores:
	RegressionAUROC: 0.6365367770195007
	RegressionCompetitionScore: 0.2469325153374233



Validation scores:
	RegressionAUROC: 0.6409716606140137
	RegressionCompetitionScore: 0.25061349693251533



Validation scores:
	RegressionAUROC: 0.6418390274047852
	RegressionCompetitionScore: 0.24662576687116564

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6437866687774658
	RegressionCompetitionScore: 0.248159509202454

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6460741758346558
	RegressionCompetitionScore: 0.25398773006134967



Validation scores:
	RegressionAUROC: 0.6492587327957153
	RegressionCompetitionScore: 0.25674846625766873

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.654126763343811
	RegressionCompetitionScore: 0.2579754601226994



Validation scores:
	RegressionAUROC: 0.6577348709106445
	RegressionCompetitionScore: 0.25858895705521473



Validation scores:
	RegressionAUROC: 0.6615561246871948
	RegressionCompetitionScore: 0.2668711656441718



Validation scores:
	RegressionAUROC: 0.6641687154769897
	RegressionCompetitionScore: 0.2757668711656442



Validation scores:
	RegressionAUROC: 0.6659717559814453
	RegressionCompetitionScore: 0.27791411042944786



Validation scores:
	RegressionAUROC: 0.6683452725410461
	RegressionCompetitionScore: 0.2822085889570552



Validation scores:
	RegressionAUROC: 0.6664076447486877
	RegressionCompetitionScore: 0.27607361963190186

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.666107177734375
	RegressionCompetitionScore: 0.2791411042944785



Validation scores:
	RegressionAUROC: 0.668363094329834
	RegressionCompetitionScore: 0.28251533742331286



Validation scores:
	RegressionAUROC: 0.6684787273406982
	RegressionCompetitionScore: 0.2852760736196319



Validation scores:
	RegressionAUROC: 0.6692206859588623
	RegressionCompetitionScore: 0.29049079754601226



Validation scores:
	RegressionAUROC: 0.6733534932136536
	RegressionCompetitionScore: 0.2907975460122699



Validation scores:
	RegressionAUROC: 0.6796914339065552
	RegressionCompetitionScore: 0.2978527607361963



Validation scores:
	RegressionAUROC: 0.6831139326095581
	RegressionCompetitionScore: 0.29233128834355826

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.190. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.27607361963190186
     Test RegressionAUROC            0.6664076447486877
Test RegressionCompetitionScore      0.27607361963190186
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 23:40:21,575][0m Trial 302 finished with value: 0.27607361963190186 and parameters: {'lr': 5.057021592991452e-06, 'dropout': 0.5074762799920701, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 32, 'dim_feedforward': 101, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0003734693315984702, 'dropout': 0.47924930147648515, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 152, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 29.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
29.4 K    Trainable params
0         Non-trainable params
29.4 K    Total params
0.118     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.39613524079322815
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6926642656326294
	RegressionCompetitionScore: 0.29662576687116565

Metric val_loss improved. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.7091709971427917
	RegressionCompetitionScore: 0.21042944785276074

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7342445254325867
	RegressionCompetitionScore: 0.345398773006135

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7355678081512451
	RegressionCompetitionScore: 0.33957055214723925



Validation scores:
	RegressionAUROC: 0.730210542678833
	RegressionCompetitionScore: 0.34938650306748464



Validation scores:
	RegressionAUROC: 0.7560330033302307
	RegressionCompetitionScore: 0.38588957055214723

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7611156702041626
	RegressionCompetitionScore: 0.38374233128834356



Validation scores:
	RegressionAUROC: 0.7618070840835571
	RegressionCompetitionScore: 0.4058282208588957

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7547271251678467
	RegressionCompetitionScore: 0.37239263803680983



Validation scores:
	RegressionAUROC: 0.7666445970535278
	RegressionCompetitionScore: 0.38496932515337423



Validation scores:
	RegressionAUROC: 0.7642998695373535
	RegressionCompetitionScore: 0.3610429447852761

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7672541737556458
	RegressionCompetitionScore: 0.33067484662576685



Validation scores:
	RegressionAUROC: 0.7560254335403442
	RegressionCompetitionScore: 0.3383435582822086



Validation scores:
	RegressionAUROC: 0.7744739055633545
	RegressionCompetitionScore: 0.39386503067484663

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7862333059310913
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.77424156665802
	RegressionCompetitionScore: 0.3604294478527607



Validation scores:
	RegressionAUROC: 0.7854037880897522
	RegressionCompetitionScore: 0.38834355828220857

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.158


Validation scores:
	RegressionAUROC: 0.7753363847732544
	RegressionCompetitionScore: 0.3684049079754601



Validation scores:
	RegressionAUROC: 0.7710096836090088
	RegressionCompetitionScore: 0.40705521472392636



Validation scores:
	RegressionAUROC: 0.7870006561279297
	RegressionCompetitionScore: 0.44355828220858895



Validation scores:
	RegressionAUROC: 0.7777166366577148
	RegressionCompetitionScore: 0.3619631901840491



Validation scores:
	RegressionAUROC: 0.7715709805488586
	RegressionCompetitionScore: 0.40245398773006136



Validation scores:
	RegressionAUROC: 0.7772406339645386
	RegressionCompetitionScore: 0.42208588957055215



Validation scores:
	RegressionAUROC: 0.7989726066589355
	RegressionCompetitionScore: 0.4368098159509202

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.153


Validation scores:
	RegressionAUROC: 0.7802383899688721
	RegressionCompetitionScore: 0.4223926380368098



Validation scores:
	RegressionAUROC: 0.7958276271820068
	RegressionCompetitionScore: 0.4067484662576687



Validation scores:
	RegressionAUROC: 0.7925540208816528
	RegressionCompetitionScore: 0.3904907975460123



Validation scores:
	RegressionAUROC: 0.7928059101104736
	RegressionCompetitionScore: 0.4450920245398773



Validation scores:
	RegressionAUROC: 0.796485185623169
	RegressionCompetitionScore: 0.44539877300613495



Validation scores:
	RegressionAUROC: 0.8008796572685242
	RegressionCompetitionScore: 0.4352760736196319



Validation scores:
	RegressionAUROC: 0.7916338443756104
	RegressionCompetitionScore: 0.4312883435582822

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.153. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4368098159509202
     Test RegressionAUROC            0.7989726066589355
Test RegressionCompetitionScore      0.4368098159509202
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 23:52:46,956][0m Trial 303 finished with value: 0.4368098159509202 and parameters: {'lr': 0.0003734693315984702, 'dropout': 0.47924930147648515, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 152, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0004235121650173966, 'dropout': 0.4775282939688134, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 118, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 25.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
25.9 K    Trainable params
0         Non-trainable params
25.9 K    Total params
0.104     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6610987186431885
	RegressionCompetitionScore: 0.23006134969325154

Metric val_loss improved. New best score: 0.283


Validation scores:
	RegressionAUROC: 0.709314227104187
	RegressionCompetitionScore: 0.2745398773006135

Metric val_loss improved by 0.101 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.70119309425354
	RegressionCompetitionScore: 0.27085889570552146



Validation scores:
	RegressionAUROC: 0.7215752601623535
	RegressionCompetitionScore: 0.2960122699386503



Validation scores:
	RegressionAUROC: 0.7299494743347168
	RegressionCompetitionScore: 0.28680981595092025



Validation scores:
	RegressionAUROC: 0.7548274993896484
	RegressionCompetitionScore: 0.3628834355828221

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7523559331893921
	RegressionCompetitionScore: 0.35460122699386504



Validation scores:
	RegressionAUROC: 0.7495893239974976
	RegressionCompetitionScore: 0.3383435582822086



Validation scores:
	RegressionAUROC: 0.709025502204895
	RegressionCompetitionScore: 0.22392638036809817



Validation scores:
	RegressionAUROC: 0.7595846652984619
	RegressionCompetitionScore: 0.39171779141104296



Validation scores:
	RegressionAUROC: 0.7669135332107544
	RegressionCompetitionScore: 0.33312883435582824



Validation scores:
	RegressionAUROC: 0.7566734552383423
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7455298900604248
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.173. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3628834355828221
     Test RegressionAUROC            0.7548274993896484
Test RegressionCompetitionScore      0.3628834355828221
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-05 23:58:15,131][0m Trial 304 finished with value: 0.3628834355828221 and parameters: {'lr': 0.0004235121650173966, 'dropout': 0.4775282939688134, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 118, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.00033074361637737735, 'dropout': 0.4853150294034056, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 158, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 26.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
26.6 K    Trainable params
0         Non-trainable params
26.6 K    Total params
0.106     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.40096616744995117
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.7091941833496094
	RegressionCompetitionScore: 0.32177914110429445

Metric val_loss improved. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.7048593759536743
	RegressionCompetitionScore: 0.3245398773006135

Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7108171582221985
	RegressionCompetitionScore: 0.3193251533742331

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.723895788192749
	RegressionCompetitionScore: 0.34938650306748464

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7317478060722351
	RegressionCompetitionScore: 0.36349693251533743



Validation scores:
	RegressionAUROC: 0.7427490949630737
	RegressionCompetitionScore: 0.3549079754601227

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7446826696395874
	RegressionCompetitionScore: 0.345398773006135



Validation scores:
	RegressionAUROC: 0.7516590356826782
	RegressionCompetitionScore: 0.38374233128834356

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7223167419433594
	RegressionCompetitionScore: 0.26042944785276073



Validation scores:
	RegressionAUROC: 0.7604764103889465
	RegressionCompetitionScore: 0.37576687116564417



Validation scores:
	RegressionAUROC: 0.7634835839271545
	RegressionCompetitionScore: 0.3815950920245399



Validation scores:
	RegressionAUROC: 0.7670142650604248
	RegressionCompetitionScore: 0.3929447852760736



Validation scores:
	RegressionAUROC: 0.7315531969070435
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7513893842697144
	RegressionCompetitionScore: 0.4085889570552147

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7548125982284546
	RegressionCompetitionScore: 0.38650306748466257



Validation scores:
	RegressionAUROC: 0.7595496773719788
	RegressionCompetitionScore: 0.37975460122699384



Validation scores:
	RegressionAUROC: 0.7582834362983704
	RegressionCompetitionScore: 0.36809815950920244



Validation scores:
	RegressionAUROC: 0.7646384835243225
	RegressionCompetitionScore: 0.37975460122699384



Validation scores:
	RegressionAUROC: 0.7684190273284912
	RegressionCompetitionScore: 0.3904907975460123



Validation scores:
	RegressionAUROC: 0.7691125869750977
	RegressionCompetitionScore: 0.39662576687116563



Validation scores:
	RegressionAUROC: 0.7695576548576355
	RegressionCompetitionScore: 0.4098159509202454

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.169. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4085889570552147
     Test RegressionAUROC            0.7513893842697144
Test RegressionCompetitionScore      0.4085889570552147
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 00:07:18,847][0m Trial 305 finished with value: 0.4085889570552147 and parameters: {'lr': 0.00033074361637737735, 'dropout': 0.4853150294034056, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 158, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0003166206663268133, 'dropout': 0.48460991410556364, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 168, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 26.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
26.8 K    Trainable params
0         Non-trainable params
26.8 K    Total params
0.107     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6946391463279724
	RegressionCompetitionScore: 0.3236196319018405

Metric val_loss improved. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7158952355384827
	RegressionCompetitionScore: 0.3512269938650307

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.6959935426712036
	RegressionCompetitionScore: 0.15245398773006136



Validation scores:
	RegressionAUROC: 0.7176178097724915
	RegressionCompetitionScore: 0.33865030674846625



Validation scores:
	RegressionAUROC: 0.7341283559799194
	RegressionCompetitionScore: 0.36349693251533743



Validation scores:
	RegressionAUROC: 0.7369903326034546
	RegressionCompetitionScore: 0.34171779141104297



Validation scores:
	RegressionAUROC: 0.7416647672653198
	RegressionCompetitionScore: 0.3530674846625767



Validation scores:
	RegressionAUROC: 0.7476269006729126
	RegressionCompetitionScore: 0.36809815950920244



Validation scores:
	RegressionAUROC: 0.7463433742523193
	RegressionCompetitionScore: 0.39723926380368096

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.181. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3512269938650307
     Test RegressionAUROC            0.7158952355384827
Test RegressionCompetitionScore      0.3512269938650307
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 00:11:53,286][0m Trial 306 finished with value: 0.3512269938650307 and parameters: {'lr': 0.0003166206663268133, 'dropout': 0.48460991410556364, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 168, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0005829983106911528, 'dropout': 0.4724461816955996, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 152, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 26.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
26.5 K    Trainable params
0         Non-trainable params
26.5 K    Total params
0.106     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6961662173271179
	RegressionCompetitionScore: 0.3138036809815951

Metric val_loss improved. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.7241940498352051
	RegressionCompetitionScore: 0.3

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.705001950263977
	RegressionCompetitionScore: 0.27515337423312886



Validation scores:
	RegressionAUROC: 0.7470983266830444
	RegressionCompetitionScore: 0.3782208588957055



Validation scores:
	RegressionAUROC: 0.7283751964569092
	RegressionCompetitionScore: 0.3254601226993865



Validation scores:
	RegressionAUROC: 0.7579158544540405
	RegressionCompetitionScore: 0.3506134969325153

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7678871154785156
	RegressionCompetitionScore: 0.34294478527607364



Validation scores:
	RegressionAUROC: 0.7626762390136719
	RegressionCompetitionScore: 0.34846625766871164



Validation scores:
	RegressionAUROC: 0.7762519717216492
	RegressionCompetitionScore: 0.35920245398773004



Validation scores:
	RegressionAUROC: 0.7824170589447021
	RegressionCompetitionScore: 0.3165644171779141



Validation scores:
	RegressionAUROC: 0.7951768636703491
	RegressionCompetitionScore: 0.3920245398773006

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.160


Validation scores:
	RegressionAUROC: 0.7652064561843872
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7647327780723572
	RegressionCompetitionScore: 0.32085889570552145



Validation scores:
	RegressionAUROC: 0.7854375839233398
	RegressionCompetitionScore: 0.40521472392638036



Validation scores:
	RegressionAUROC: 0.7887105941772461
	RegressionCompetitionScore: 0.37699386503067484



Validation scores:
	RegressionAUROC: 0.7987737655639648
	RegressionCompetitionScore: 0.43466257668711655



Validation scores:
	RegressionAUROC: 0.7995445132255554
	RegressionCompetitionScore: 0.39631901840490796



Validation scores:
	RegressionAUROC: 0.791154682636261
	RegressionCompetitionScore: 0.4306748466257669

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.160. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3920245398773006
     Test RegressionAUROC            0.7951768636703491
Test RegressionCompetitionScore      0.3920245398773006
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 00:19:26,788][0m Trial 307 finished with value: 0.3920245398773006 and parameters: {'lr': 0.0005829983106911528, 'dropout': 0.4724461816955996, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 152, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.00037651027062678464, 'dropout': 0.4679481197498732, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 235, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 27.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
27.9 K    Trainable params
0         Non-trainable params
27.9 K    Total params
0.112     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6473429799079895
	RegressionCompetitionScore: 0.4782608695652174



Validation scores:
	RegressionAUROC: 0.7047932147979736
	RegressionCompetitionScore: 0.18404907975460122

Metric val_loss improved. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7030811309814453
	RegressionCompetitionScore: 0.22914110429447854



Validation scores:
	RegressionAUROC: 0.7174305319786072
	RegressionCompetitionScore: 0.3294478527607362

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7487839460372925
	RegressionCompetitionScore: 0.39969325153374236

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7470107078552246
	RegressionCompetitionScore: 0.40736196319018403

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7651537656784058
	RegressionCompetitionScore: 0.401840490797546

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7717356085777283
	RegressionCompetitionScore: 0.42576687116564416



Validation scores:
	RegressionAUROC: 0.7654207348823547
	RegressionCompetitionScore: 0.4107361963190184



Validation scores:
	RegressionAUROC: 0.7376899123191833
	RegressionCompetitionScore: 0.30214723926380366



Validation scores:
	RegressionAUROC: 0.764919638633728
	RegressionCompetitionScore: 0.3576687116564417



Validation scores:
	RegressionAUROC: 0.7832581400871277
	RegressionCompetitionScore: 0.4039877300613497

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.160


Validation scores:
	RegressionAUROC: 0.7917097210884094
	RegressionCompetitionScore: 0.4049079754601227

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.156


Validation scores:
	RegressionAUROC: 0.7920117378234863
	RegressionCompetitionScore: 0.4579754601226994



Validation scores:
	RegressionAUROC: 0.7886689305305481
	RegressionCompetitionScore: 0.43558282208588955



Validation scores:
	RegressionAUROC: 0.784062922000885
	RegressionCompetitionScore: 0.45337423312883435



Validation scores:
	RegressionAUROC: 0.783547580242157
	RegressionCompetitionScore: 0.4573619631901841



Validation scores:
	RegressionAUROC: 0.7845841646194458
	RegressionCompetitionScore: 0.447239263803681



Validation scores:
	RegressionAUROC: 0.7876220941543579
	RegressionCompetitionScore: 0.44263803680981595



Validation scores:
	RegressionAUROC: 0.7950200438499451
	RegressionCompetitionScore: 0.40736196319018403

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.156. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4049079754601227
     Test RegressionAUROC            0.7917097210884094
Test RegressionCompetitionScore      0.4049079754601227
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 00:27:09,382][0m Trial 308 finished with value: 0.4049079754601227 and parameters: {'lr': 0.00037651027062678464, 'dropout': 0.4679481197498732, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 235, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.00036200828739353446, 'dropout': 0.4650387875846823, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 245, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 28.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
28.1 K    Trainable params
0         Non-trainable params
28.1 K    Total params
0.112     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.260869562625885
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.71695876121521
	RegressionCompetitionScore: 0.32975460122699385

Metric val_loss improved. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7277381420135498
	RegressionCompetitionScore: 0.33588957055214724



Validation scores:
	RegressionAUROC: 0.7319218516349792
	RegressionCompetitionScore: 0.34662576687116564



Validation scores:
	RegressionAUROC: 0.7268083095550537
	RegressionCompetitionScore: 0.36717791411042944



Validation scores:
	RegressionAUROC: 0.7431235909461975
	RegressionCompetitionScore: 0.33680981595092024

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7532638311386108
	RegressionCompetitionScore: 0.39662576687116563



Validation scores:
	RegressionAUROC: 0.7499020099639893
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7471873760223389
	RegressionCompetitionScore: 0.3871165644171779



Validation scores:
	RegressionAUROC: 0.7436646223068237
	RegressionCompetitionScore: 0.4039877300613497

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7391853332519531
	RegressionCompetitionScore: 0.252760736196319



Validation scores:
	RegressionAUROC: 0.7410724759101868
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7373418807983398
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7458953261375427
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7555480003356934
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.757412314414978
	RegressionCompetitionScore: 0.37944785276073617



Validation scores:
	RegressionAUROC: 0.7684706449508667
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.178. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4039877300613497
     Test RegressionAUROC            0.7436646223068237
Test RegressionCompetitionScore      0.4039877300613497
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 00:33:42,601][0m Trial 309 finished with value: 0.4039877300613497 and parameters: {'lr': 0.00036200828739353446, 'dropout': 0.4650387875846823, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 245, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0003860935613316939, 'dropout': 0.48004467410159346, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 176, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 26.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
26.9 K    Trainable params
0         Non-trainable params
26.9 K    Total params
0.108     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6908212900161743
	RegressionCompetitionScore: 0.5217391304347826



Validation scores:
	RegressionAUROC: 0.6802217364311218
	RegressionCompetitionScore: 0.28865030674846626

Metric val_loss improved. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.7067429423332214
	RegressionCompetitionScore: 0.23895705521472393

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.733942449092865
	RegressionCompetitionScore: 0.3211656441717791



Validation scores:
	RegressionAUROC: 0.7245278358459473
	RegressionCompetitionScore: 0.3122699386503067



Validation scores:
	RegressionAUROC: 0.7506735324859619
	RegressionCompetitionScore: 0.3588957055214724

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7555657029151917
	RegressionCompetitionScore: 0.3717791411042945



Validation scores:
	RegressionAUROC: 0.7584869861602783
	RegressionCompetitionScore: 0.3696319018404908



Validation scores:
	RegressionAUROC: 0.7461984157562256
	RegressionCompetitionScore: 0.3506134969325153



Validation scores:
	RegressionAUROC: 0.7520158290863037
	RegressionCompetitionScore: 0.3901840490797546



Validation scores:
	RegressionAUROC: 0.7526608109474182
	RegressionCompetitionScore: 0.3061349693251534



Validation scores:
	RegressionAUROC: 0.7518505454063416
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.762251079082489
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3588957055214724
     Test RegressionAUROC            0.7506735324859619
Test RegressionCompetitionScore      0.3588957055214724
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 00:38:46,752][0m Trial 310 finished with value: 0.3588957055214724 and parameters: {'lr': 0.0003860935613316939, 'dropout': 0.48004467410159346, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 176, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.00028235899612075546, 'dropout': 0.4918290671541631, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 206, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 27.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
27.4 K    Trainable params
0         Non-trainable params
27.4 K    Total params
0.110     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4830917716026306
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6324467658996582
	RegressionCompetitionScore: 0.10644171779141104

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6974027752876282
	RegressionCompetitionScore: 0.3202453987730061

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7092001438140869
	RegressionCompetitionScore: 0.29233128834355826

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.6962648630142212
	RegressionCompetitionScore: 0.25061349693251533



Validation scores:
	RegressionAUROC: 0.7202292680740356
	RegressionCompetitionScore: 0.34662576687116564



Validation scores:
	RegressionAUROC: 0.7319910526275635
	RegressionCompetitionScore: 0.34570552147239264



Validation scores:
	RegressionAUROC: 0.7165019512176514
	RegressionCompetitionScore: 0.36411042944785277



Validation scores:
	RegressionAUROC: 0.732215940952301
	RegressionCompetitionScore: 0.37699386503067484



Validation scores:
	RegressionAUROC: 0.744392991065979
	RegressionCompetitionScore: 0.37484662576687117



Validation scores:
	RegressionAUROC: 0.7314965724945068
	RegressionCompetitionScore: 0.38220858895705523

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.182. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.29233128834355826
     Test RegressionAUROC            0.7092001438140869
Test RegressionCompetitionScore      0.29233128834355826
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 00:43:02,806][0m Trial 311 finished with value: 0.29233128834355826 and parameters: {'lr': 0.00028235899612075546, 'dropout': 0.4918290671541631, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 206, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.00038989647966131325, 'dropout': 0.46486290341227976, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 253, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 28.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
28.2 K    Trainable params
0         Non-trainable params
28.2 K    Total params
0.113     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6878716349601746
	RegressionCompetitionScore: 0.2233128834355828

Metric val_loss improved. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.707697868347168
	RegressionCompetitionScore: 0.3006134969325153

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7129271030426025
	RegressionCompetitionScore: 0.3159509202453988



Validation scores:
	RegressionAUROC: 0.7342711091041565
	RegressionCompetitionScore: 0.3334355828220859

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7407259345054626
	RegressionCompetitionScore: 0.3156441717791411



Validation scores:
	RegressionAUROC: 0.7370442152023315
	RegressionCompetitionScore: 0.2898773006134969

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7342109084129333
	RegressionCompetitionScore: 0.3248466257668712

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7441102862358093
	RegressionCompetitionScore: 0.3389570552147239

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7018519639968872
	RegressionCompetitionScore: 0.23558282208588957



Validation scores:
	RegressionAUROC: 0.742315411567688
	RegressionCompetitionScore: 0.3254601226993865



Validation scores:
	RegressionAUROC: 0.7490603923797607
	RegressionCompetitionScore: 0.30030674846625766

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7428916692733765
	RegressionCompetitionScore: 0.34263803680981597



Validation scores:
	RegressionAUROC: 0.7290987968444824
	RegressionCompetitionScore: 0.24355828220858897



Validation scores:
	RegressionAUROC: 0.7229588031768799
	RegressionCompetitionScore: 0.24141104294478527



Validation scores:
	RegressionAUROC: 0.7436730265617371
	RegressionCompetitionScore: 0.24723926380368097



Validation scores:
	RegressionAUROC: 0.7407680153846741
	RegressionCompetitionScore: 0.2883435582822086



Validation scores:
	RegressionAUROC: 0.7459094524383545
	RegressionCompetitionScore: 0.3355828220858896



Validation scores:
	RegressionAUROC: 0.7484302520751953
	RegressionCompetitionScore: 0.3579754601226994

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.30030674846625766
     Test RegressionAUROC            0.7490603923797607
Test RegressionCompetitionScore      0.30030674846625766
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 00:50:22,962][0m Trial 312 finished with value: 0.30030674846625766 and parameters: {'lr': 0.00038989647966131325, 'dropout': 0.46486290341227976, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 253, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0001676947575927243, 'dropout': 0.47251619126688843, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 226, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 27.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
27.8 K    Trainable params
0         Non-trainable params
27.8 K    Total params
0.111     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6280192136764526
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.669937789440155
	RegressionCompetitionScore: 0.2579754601226994

Metric val_loss improved. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7197989225387573
	RegressionCompetitionScore: 0.34754601226993864

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7311950922012329
	RegressionCompetitionScore: 0.36257668711656443

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7122234106063843
	RegressionCompetitionScore: 0.34202453987730064



Validation scores:
	RegressionAUROC: 0.7406132221221924
	RegressionCompetitionScore: 0.36533742331288344



Validation scores:
	RegressionAUROC: 0.7502861022949219
	RegressionCompetitionScore: 0.37515337423312883

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7553176879882812
	RegressionCompetitionScore: 0.38006134969325156



Validation scores:
	RegressionAUROC: 0.7414329648017883
	RegressionCompetitionScore: 0.36901840490797544



Validation scores:
	RegressionAUROC: 0.7402130365371704
	RegressionCompetitionScore: 0.38128834355828223



Validation scores:
	RegressionAUROC: 0.7507575154304504
	RegressionCompetitionScore: 0.39355828220858896



Validation scores:
	RegressionAUROC: 0.7408885955810547
	RegressionCompetitionScore: 0.39754601226993863



Validation scores:
	RegressionAUROC: 0.7614583373069763
	RegressionCompetitionScore: 0.39631901840490796

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7487119436264038
	RegressionCompetitionScore: 0.38282208588957056



Validation scores:
	RegressionAUROC: 0.7613956332206726
	RegressionCompetitionScore: 0.41932515337423315

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7493172883987427
	RegressionCompetitionScore: 0.34938650306748464



Validation scores:
	RegressionAUROC: 0.7636682391166687
	RegressionCompetitionScore: 0.3914110429447853



Validation scores:
	RegressionAUROC: 0.762274444103241
	RegressionCompetitionScore: 0.37484662576687117



Validation scores:
	RegressionAUROC: 0.7554544806480408
	RegressionCompetitionScore: 0.3708588957055215



Validation scores:
	RegressionAUROC: 0.764114260673523
	RegressionCompetitionScore: 0.39079754601226996



Validation scores:
	RegressionAUROC: 0.7568700313568115
	RegressionCompetitionScore: 0.36411042944785277



Validation scores:
	RegressionAUROC: 0.7610701322555542
	RegressionCompetitionScore: 0.37852760736196317

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.169. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.41932515337423315
     Test RegressionAUROC            0.7613956332206726
Test RegressionCompetitionScore      0.41932515337423315
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 00:58:51,945][0m Trial 313 finished with value: 0.41932515337423315 and parameters: {'lr': 0.0001676947575927243, 'dropout': 0.47251619126688843, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 226, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0001730639790636828, 'dropout': 0.4859331982141082, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 225, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 27.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
27.7 K    Trainable params
0         Non-trainable params
27.7 K    Total params
0.111     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5893719792366028
	RegressionCompetitionScore: 0.30434782608695654



Validation scores:
	RegressionAUROC: 0.6631066799163818
	RegressionCompetitionScore: 0.3116564417177914

Metric val_loss improved. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.7033580541610718
	RegressionCompetitionScore: 0.3328220858895706

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7018285989761353
	RegressionCompetitionScore: 0.3214723926380368

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7183873057365417
	RegressionCompetitionScore: 0.3496932515337423

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.722204327583313
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.7255795001983643
	RegressionCompetitionScore: 0.3604294478527607

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7389047145843506
	RegressionCompetitionScore: 0.3815950920245399



Validation scores:
	RegressionAUROC: 0.7405223846435547
	RegressionCompetitionScore: 0.36779141104294477



Validation scores:
	RegressionAUROC: 0.7415951490402222
	RegressionCompetitionScore: 0.36411042944785277



Validation scores:
	RegressionAUROC: 0.7636712193489075
	RegressionCompetitionScore: 0.3901840490797546



Validation scores:
	RegressionAUROC: 0.7422948479652405
	RegressionCompetitionScore: 0.37208588957055216

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7577784061431885
	RegressionCompetitionScore: 0.38220858895705523



Validation scores:
	RegressionAUROC: 0.7688512802124023
	RegressionCompetitionScore: 0.39662576687116563



Validation scores:
	RegressionAUROC: 0.7685276865959167
	RegressionCompetitionScore: 0.4058282208588957



Validation scores:
	RegressionAUROC: 0.771994948387146
	RegressionCompetitionScore: 0.3745398773006135

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7748566269874573
	RegressionCompetitionScore: 0.3708588957055215



Validation scores:
	RegressionAUROC: 0.7862304449081421
	RegressionCompetitionScore: 0.401840490797546



Validation scores:
	RegressionAUROC: 0.7851941585540771
	RegressionCompetitionScore: 0.400920245398773

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.7880783677101135
	RegressionCompetitionScore: 0.43006134969325155



Validation scores:
	RegressionAUROC: 0.7937819957733154
	RegressionCompetitionScore: 0.4092024539877301

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.157


Validation scores:
	RegressionAUROC: 0.7908955812454224
	RegressionCompetitionScore: 0.4021472392638037



Validation scores:
	RegressionAUROC: 0.7905162572860718
	RegressionCompetitionScore: 0.3861963190184049



Validation scores:
	RegressionAUROC: 0.7879388332366943
	RegressionCompetitionScore: 0.401840490797546



Validation scores:
	RegressionAUROC: 0.7880011200904846
	RegressionCompetitionScore: 0.4245398773006135



Validation scores:
	RegressionAUROC: 0.787982702255249
	RegressionCompetitionScore: 0.400920245398773

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.156


Validation scores:
	RegressionAUROC: 0.7923440337181091
	RegressionCompetitionScore: 0.41779141104294476



Validation scores:
	RegressionAUROC: 0.7952242493629456
	RegressionCompetitionScore: 0.40429447852760736



Validation scores:
	RegressionAUROC: 0.7904255390167236
	RegressionCompetitionScore: 0.43098159509202455



Validation scores:
	RegressionAUROC: 0.7865557074546814
	RegressionCompetitionScore: 0.4297546012269939



Validation scores:
	RegressionAUROC: 0.7875477075576782
	RegressionCompetitionScore: 0.3904907975460123



Validation scores:
	RegressionAUROC: 0.7992326617240906
	RegressionCompetitionScore: 0.41932515337423315



Validation scores:
	RegressionAUROC: 0.7976177930831909
	RegressionCompetitionScore: 0.4395705521472393

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.156. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.400920245398773
     Test RegressionAUROC             0.787982702255249
Test RegressionCompetitionScore       0.400920245398773
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 01:11:34,675][0m Trial 314 finished with value: 0.400920245398773 and parameters: {'lr': 0.0001730639790636828, 'dropout': 0.4859331982141082, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 225, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.00015404255607880262, 'dropout': 0.4792756375576861, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 276, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 28.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
28.6 K    Trainable params
0         Non-trainable params
28.6 K    Total params
0.114     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5821256041526794
	RegressionCompetitionScore: 0.30434782608695654



Validation scores:
	RegressionAUROC: 0.6611517667770386
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.263


Validation scores:
	RegressionAUROC: 0.695609986782074
	RegressionCompetitionScore: 0.3095092024539877

Metric val_loss improved by 0.050 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.7066249251365662
	RegressionCompetitionScore: 0.2116564417177914

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.7173250913619995
	RegressionCompetitionScore: 0.293558282208589

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7110207676887512
	RegressionCompetitionScore: 0.3156441717791411



Validation scores:
	RegressionAUROC: 0.7242994904518127
	RegressionCompetitionScore: 0.3254601226993865



Validation scores:
	RegressionAUROC: 0.7190128564834595
	RegressionCompetitionScore: 0.3389570552147239



Validation scores:
	RegressionAUROC: 0.7180556654930115
	RegressionCompetitionScore: 0.31441717791411045



Validation scores:
	RegressionAUROC: 0.7272846698760986
	RegressionCompetitionScore: 0.3374233128834356



Validation scores:
	RegressionAUROC: 0.7044421434402466
	RegressionCompetitionScore: 0.3236196319018405



Validation scores:
	RegressionAUROC: 0.73759925365448
	RegressionCompetitionScore: 0.32699386503067485

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.190. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.293558282208589
     Test RegressionAUROC            0.7173250913619995
Test RegressionCompetitionScore       0.293558282208589
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 01:16:13,649][0m Trial 315 finished with value: 0.293558282208589 and parameters: {'lr': 0.00015404255607880262, 'dropout': 0.4792756375576861, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 276, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0002311269201629343, 'dropout': 0.4588028226595961, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 218, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 27.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
27.6 K    Trainable params
0         Non-trainable params
27.6 K    Total params
0.110     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4251207709312439
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.7152947783470154
	RegressionCompetitionScore: 0.32607361963190185

Metric val_loss improved. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7176733613014221
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7214423418045044
	RegressionCompetitionScore: 0.30736196319018405

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7343282699584961
	RegressionCompetitionScore: 0.3598159509202454

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7436209321022034
	RegressionCompetitionScore: 0.3717791411042945



Validation scores:
	RegressionAUROC: 0.7493611574172974
	RegressionCompetitionScore: 0.38098159509202456

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.742516279220581
	RegressionCompetitionScore: 0.345398773006135



Validation scores:
	RegressionAUROC: 0.7316524386405945
	RegressionCompetitionScore: 0.34846625766871164



Validation scores:
	RegressionAUROC: 0.7398233413696289
	RegressionCompetitionScore: 0.347239263803681



Validation scores:
	RegressionAUROC: 0.7413274645805359
	RegressionCompetitionScore: 0.3441717791411043



Validation scores:
	RegressionAUROC: 0.7305020093917847
	RegressionCompetitionScore: 0.3061349693251534



Validation scores:
	RegressionAUROC: 0.7517046928405762
	RegressionCompetitionScore: 0.3595092024539877



Validation scores:
	RegressionAUROC: 0.7268562316894531
	RegressionCompetitionScore: 0.31533742331288345

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.172. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38098159509202456
     Test RegressionAUROC            0.7493611574172974
Test RegressionCompetitionScore      0.38098159509202456
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 01:21:40,205][0m Trial 316 finished with value: 0.38098159509202456 and parameters: {'lr': 0.0002311269201629343, 'dropout': 0.4588028226595961, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 218, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0001872478776148817, 'dropout': 0.600668464086631, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 233, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 32.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
32.2 K    Trainable params
0         Non-trainable params
32.2 K    Total params
0.129     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2632850408554077
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.4937203526496887
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.335


Validation scores:
	RegressionAUROC: 0.5591955780982971
	RegressionCompetitionScore: 0.1058282208588957

Metric val_loss improved by 0.094 >= min_delta = 0.0. New best score: 0.241


Validation scores:
	RegressionAUROC: 0.6185648441314697
	RegressionCompetitionScore: 0.1570552147239264

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.6345860362052917
	RegressionCompetitionScore: 0.19539877300613498

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.634520411491394
	RegressionCompetitionScore: 0.20705521472392638



Validation scores:
	RegressionAUROC: 0.6407514810562134
	RegressionCompetitionScore: 0.20644171779141104

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6502448320388794
	RegressionCompetitionScore: 0.2223926380368098



Validation scores:
	RegressionAUROC: 0.6552777290344238
	RegressionCompetitionScore: 0.2196319018404908



Validation scores:
	RegressionAUROC: 0.6598791480064392
	RegressionCompetitionScore: 0.2116564417177914

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6638427972793579
	RegressionCompetitionScore: 0.20613496932515338



Validation scores:
	RegressionAUROC: 0.6644768714904785
	RegressionCompetitionScore: 0.20889570552147238



Validation scores:
	RegressionAUROC: 0.6647943258285522
	RegressionCompetitionScore: 0.20736196319018405



Validation scores:
	RegressionAUROC: 0.6707702279090881
	RegressionCompetitionScore: 0.2196319018404908



Validation scores:
	RegressionAUROC: 0.6752191781997681
	RegressionCompetitionScore: 0.2343558282208589



Validation scores:
	RegressionAUROC: 0.6733925342559814
	RegressionCompetitionScore: 0.24141104294478527



Validation scores:
	RegressionAUROC: 0.6695778965950012
	RegressionCompetitionScore: 0.24539877300613497

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.194. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2116564417177914
     Test RegressionAUROC            0.6598791480064392
Test RegressionCompetitionScore      0.2116564417177914
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 01:28:17,109][0m Trial 317 finished with value: 0.2116564417177914 and parameters: {'lr': 0.0001872478776148817, 'dropout': 0.600668464086631, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 233, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0008002495571060433, 'dropout': 0.4725952632716372, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 456, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 31.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
31.7 K    Trainable params
0         Non-trainable params
31.7 K    Total params
0.127     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4589371681213379
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.7061833143234253
	RegressionCompetitionScore: 0.3325153374233129

Metric val_loss improved. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.7141753435134888
	RegressionCompetitionScore: 0.3389570552147239

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7239789962768555
	RegressionCompetitionScore: 0.3773006134969325

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7353218197822571
	RegressionCompetitionScore: 0.38987730061349696

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7490035891532898
	RegressionCompetitionScore: 0.3941717791411043



Validation scores:
	RegressionAUROC: 0.7418134212493896
	RegressionCompetitionScore: 0.3610429447852761

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7413163185119629
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7327654361724854
	RegressionCompetitionScore: 0.3506134969325153



Validation scores:
	RegressionAUROC: 0.7656228542327881
	RegressionCompetitionScore: 0.4058282208588957



Validation scores:
	RegressionAUROC: 0.7576172351837158
	RegressionCompetitionScore: 0.39723926380368096



Validation scores:
	RegressionAUROC: 0.7639074921607971
	RegressionCompetitionScore: 0.35644171779141104

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7615953087806702
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7485930919647217
	RegressionCompetitionScore: 0.36411042944785277



Validation scores:
	RegressionAUROC: 0.7709536552429199
	RegressionCompetitionScore: 0.4098159509202454



Validation scores:
	RegressionAUROC: 0.7884118556976318
	RegressionCompetitionScore: 0.39969325153374236

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7777954339981079
	RegressionCompetitionScore: 0.403680981595092



Validation scores:
	RegressionAUROC: 0.7926609516143799
	RegressionCompetitionScore: 0.39662576687116563



Validation scores:
	RegressionAUROC: 0.7791755199432373
	RegressionCompetitionScore: 0.3754601226993865



Validation scores:
	RegressionAUROC: 0.7995468378067017
	RegressionCompetitionScore: 0.4607361963190184



Validation scores:
	RegressionAUROC: 0.7921015024185181
	RegressionCompetitionScore: 0.45858895705521474



Validation scores:
	RegressionAUROC: 0.783812940120697
	RegressionCompetitionScore: 0.4343558282208589



Validation scores:
	RegressionAUROC: 0.7539719939231873
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.165. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.39969325153374236
     Test RegressionAUROC            0.7884118556976318
Test RegressionCompetitionScore      0.39969325153374236
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 01:37:09,310][0m Trial 318 finished with value: 0.39969325153374236 and parameters: {'lr': 0.0008002495571060433, 'dropout': 0.4725952632716372, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 456, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0005166510349380432, 'dropout': 0.40126768115331096, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 742, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 49.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
49.5 K    Trainable params
0         Non-trainable params
49.5 K    Total params
0.198     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6844037771224976
	RegressionCompetitionScore: 0.25

Metric val_loss improved. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.707979142665863
	RegressionCompetitionScore: 0.3343558282208589

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6540018320083618
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.692638635635376
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7152435779571533
	RegressionCompetitionScore: 0.35245398773006137



Validation scores:
	RegressionAUROC: 0.5657020807266235
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5732451677322388
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5664729475975037
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5174515843391418
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.203. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3343558282208589
     Test RegressionAUROC             0.707979142665863
Test RegressionCompetitionScore      0.3343558282208589
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 01:41:14,575][0m Trial 319 finished with value: 0.3343558282208589 and parameters: {'lr': 0.0005166510349380432, 'dropout': 0.40126768115331096, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 742, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.00013421860035672605, 'dropout': 0.49421012817921806, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 64, 'dim_feedforward': 204, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 118 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
118 K     Trainable params
0         Non-trainable params
118 K     Total params
0.473     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.30917873978614807
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.5810757875442505
	RegressionCompetitionScore: 0.1294478527607362

Metric val_loss improved. New best score: 0.503


Validation scores:
	RegressionAUROC: 0.5184988975524902
	RegressionCompetitionScore: 0.11288343558282209



Validation scores:
	RegressionAUROC: 0.5136105418205261
	RegressionCompetitionScore: 0.10429447852760736

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.495


Validation scores:
	RegressionAUROC: 0.49966225028038025
	RegressionCompetitionScore: 0.10889570552147239



Validation scores:
	RegressionAUROC: 0.543051540851593
	RegressionCompetitionScore: 0.13159509202453987



Validation scores:
	RegressionAUROC: 0.5742020606994629
	RegressionCompetitionScore: 0.148159509202454

Metric val_loss improved by 0.086 >= min_delta = 0.0. New best score: 0.409


Validation scores:
	RegressionAUROC: 0.5032767057418823
	RegressionCompetitionScore: 0.11319018404907975



Validation scores:
	RegressionAUROC: 0.5838176608085632
	RegressionCompetitionScore: 0.15276073619631902



Validation scores:
	RegressionAUROC: 0.5514458417892456
	RegressionCompetitionScore: 0.16625766871165645



Validation scores:
	RegressionAUROC: 0.5863940715789795
	RegressionCompetitionScore: 0.21993865030674847



Validation scores:
	RegressionAUROC: 0.6179989576339722
	RegressionCompetitionScore: 0.17822085889570552



Validation scores:
	RegressionAUROC: 0.5022002458572388
	RegressionCompetitionScore: 0.13098159509202453



Validation scores:
	RegressionAUROC: 0.5396829843521118
	RegressionCompetitionScore: 0.12361963190184048

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.409. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.148159509202454
     Test RegressionAUROC            0.5742020606994629
Test RegressionCompetitionScore       0.148159509202454
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 01:46:47,251][0m Trial 320 finished with value: 0.148159509202454 and parameters: {'lr': 0.00013421860035672605, 'dropout': 0.49421012817921806, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 64, 'dim_feedforward': 204, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.00025785975113058865, 'dropout': 0.47455735620711154, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 192, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 30.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
30.8 K    Trainable params
0         Non-trainable params
30.8 K    Total params
0.123     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5169082283973694
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6700737476348877
	RegressionCompetitionScore: 0.3039877300613497

Metric val_loss improved. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6848353743553162
	RegressionCompetitionScore: 0.3116564417177914



Validation scores:
	RegressionAUROC: 0.7072939872741699
	RegressionCompetitionScore: 0.3665644171779141

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7112020254135132
	RegressionCompetitionScore: 0.36165644171779143



Validation scores:
	RegressionAUROC: 0.7044689655303955
	RegressionCompetitionScore: 0.3389570552147239



Validation scores:
	RegressionAUROC: 0.7475453019142151
	RegressionCompetitionScore: 0.3987730061349693

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7517258524894714
	RegressionCompetitionScore: 0.3604294478527607



Validation scores:
	RegressionAUROC: 0.7389363050460815
	RegressionCompetitionScore: 0.37208588957055216

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7373377680778503
	RegressionCompetitionScore: 0.36717791411042944



Validation scores:
	RegressionAUROC: 0.7348533272743225
	RegressionCompetitionScore: 0.3638036809815951



Validation scores:
	RegressionAUROC: 0.7381337881088257
	RegressionCompetitionScore: 0.3432515337423313



Validation scores:
	RegressionAUROC: 0.7515205144882202
	RegressionCompetitionScore: 0.37668711656441717

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7441844344139099
	RegressionCompetitionScore: 0.3478527607361963

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7438629269599915
	RegressionCompetitionScore: 0.3806748466257669



Validation scores:
	RegressionAUROC: 0.7465479373931885
	RegressionCompetitionScore: 0.3745398773006135

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7541730403900146
	RegressionCompetitionScore: 0.3987730061349693

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7546582221984863
	RegressionCompetitionScore: 0.3450920245398773



Validation scores:
	RegressionAUROC: 0.7503104209899902
	RegressionCompetitionScore: 0.3815950920245399



Validation scores:
	RegressionAUROC: 0.7586852312088013
	RegressionCompetitionScore: 0.36411042944785277

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7454177141189575
	RegressionCompetitionScore: 0.3604294478527607



Validation scores:
	RegressionAUROC: 0.7512505054473877
	RegressionCompetitionScore: 0.3674846625766871



Validation scores:
	RegressionAUROC: 0.7622056603431702
	RegressionCompetitionScore: 0.37055214723926383



Validation scores:
	RegressionAUROC: 0.759037971496582
	RegressionCompetitionScore: 0.3656441717791411

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7522500157356262
	RegressionCompetitionScore: 0.3595092024539877



Validation scores:
	RegressionAUROC: 0.765493631362915
	RegressionCompetitionScore: 0.3895705521472393



Validation scores:
	RegressionAUROC: 0.7802808880805969
	RegressionCompetitionScore: 0.3895705521472393

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7654781341552734
	RegressionCompetitionScore: 0.36012269938650304



Validation scores:
	RegressionAUROC: 0.7559319138526917
	RegressionCompetitionScore: 0.3665644171779141



Validation scores:
	RegressionAUROC: 0.7540991306304932
	RegressionCompetitionScore: 0.26717791411042946



Validation scores:
	RegressionAUROC: 0.7507705688476562
	RegressionCompetitionScore: 0.3398773006134969



Validation scores:
	RegressionAUROC: 0.758155107498169
	RegressionCompetitionScore: 0.3411042944785276



Validation scores:
	RegressionAUROC: 0.7711349725723267
	RegressionCompetitionScore: 0.39478527607361963



Validation scores:
	RegressionAUROC: 0.7643467783927917
	RegressionCompetitionScore: 0.37484662576687117

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.162. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3895705521472393
     Test RegressionAUROC            0.7802808880805969
Test RegressionCompetitionScore      0.3895705521472393
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 01:59:57,440][0m Trial 321 finished with value: 0.3895705521472393 and parameters: {'lr': 0.00025785975113058865, 'dropout': 0.47455735620711154, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 192, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 1.3466766085776166e-06, 'dropout': 0.754440144332159, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 144, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 26.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
26.4 K    Trainable params
0         Non-trainable params
26.4 K    Total params
0.105     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3913043439388275
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.4118537902832031
	RegressionCompetitionScore: 0.055521472392638035

Metric val_loss improved. New best score: 0.254


Validation scores:
	RegressionAUROC: 0.41186344623565674
	RegressionCompetitionScore: 0.0558282208588957



Validation scores:
	RegressionAUROC: 0.4118586778640747
	RegressionCompetitionScore: 0.055521472392638035



Validation scores:
	RegressionAUROC: 0.4119325578212738
	RegressionCompetitionScore: 0.055521472392638035



Validation scores:
	RegressionAUROC: 0.41198790073394775
	RegressionCompetitionScore: 0.055521472392638035



Validation scores:
	RegressionAUROC: 0.41207823157310486
	RegressionCompetitionScore: 0.055521472392638035



Validation scores:
	RegressionAUROC: 0.412117063999176
	RegressionCompetitionScore: 0.055521472392638035



Validation scores:
	RegressionAUROC: 0.412139356136322
	RegressionCompetitionScore: 0.055521472392638035

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.254. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore          0.055521472392638035
     Test RegressionAUROC            0.4118537902832031
Test RegressionCompetitionScore     0.055521472392638035
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 02:03:30,504][0m Trial 322 finished with value: 0.055521472392638035 and parameters: {'lr': 1.3466766085776166e-06, 'dropout': 0.754440144332159, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 144, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0009472551467185686, 'dropout': 0.4502317494631508, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 297, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 34.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
34.3 K    Trainable params
0         Non-trainable params
34.3 K    Total params
0.137     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6620305776596069
	RegressionCompetitionScore: 0.26380368098159507

Metric val_loss improved. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6904720067977905
	RegressionCompetitionScore: 0.2684049079754601

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6969029307365417
	RegressionCompetitionScore: 0.298159509202454



Validation scores:
	RegressionAUROC: 0.7036943435668945
	RegressionCompetitionScore: 0.2659509202453988

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7165138721466064
	RegressionCompetitionScore: 0.3196319018404908

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7202437520027161
	RegressionCompetitionScore: 0.3478527607361963



Validation scores:
	RegressionAUROC: 0.7370782494544983
	RegressionCompetitionScore: 0.3567484662576687



Validation scores:
	RegressionAUROC: 0.7348763346672058
	RegressionCompetitionScore: 0.3530674846625767

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7324748039245605
	RegressionCompetitionScore: 0.3579754601226994



Validation scores:
	RegressionAUROC: 0.7002624273300171
	RegressionCompetitionScore: 0.23987730061349694



Validation scores:
	RegressionAUROC: 0.7238390445709229
	RegressionCompetitionScore: 0.3174846625766871



Validation scores:
	RegressionAUROC: 0.6568611860275269
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.68181973695755
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.695705771446228
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.725548505783081
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.182. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3530674846625767
     Test RegressionAUROC            0.7348763346672058
Test RegressionCompetitionScore      0.3530674846625767
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 02:09:45,911][0m Trial 323 finished with value: 0.3530674846625767 and parameters: {'lr': 0.0009472551467185686, 'dropout': 0.4502317494631508, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 297, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.00010744655692224796, 'dropout': 0.41481530073888506, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 170, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 30.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
30.0 K    Trainable params
0         Non-trainable params
30.0 K    Total params
0.120     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7065041661262512
	RegressionCompetitionScore: 0.30214723926380366

Metric val_loss improved. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.7197775840759277
	RegressionCompetitionScore: 0.18036809815950922

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.7448870539665222
	RegressionCompetitionScore: 0.39631901840490796

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7474873065948486
	RegressionCompetitionScore: 0.3895705521472393



Validation scores:
	RegressionAUROC: 0.7440707683563232
	RegressionCompetitionScore: 0.38865030674846623



Validation scores:
	RegressionAUROC: 0.7526280879974365
	RegressionCompetitionScore: 0.37883435582822084

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7491030097007751
	RegressionCompetitionScore: 0.3834355828220859



Validation scores:
	RegressionAUROC: 0.7474716305732727
	RegressionCompetitionScore: 0.37331288343558283



Validation scores:
	RegressionAUROC: 0.7352982759475708
	RegressionCompetitionScore: 0.3398773006134969



Validation scores:
	RegressionAUROC: 0.7567003965377808
	RegressionCompetitionScore: 0.36226993865030677



Validation scores:
	RegressionAUROC: 0.7539936304092407
	RegressionCompetitionScore: 0.38834355828220857

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7427815794944763
	RegressionCompetitionScore: 0.3684049079754601



Validation scores:
	RegressionAUROC: 0.7476818561553955
	RegressionCompetitionScore: 0.37423312883435583



Validation scores:
	RegressionAUROC: 0.7523860335350037
	RegressionCompetitionScore: 0.38926380368098157



Validation scores:
	RegressionAUROC: 0.7556890249252319
	RegressionCompetitionScore: 0.38773006134969323



Validation scores:
	RegressionAUROC: 0.7489686608314514
	RegressionCompetitionScore: 0.3506134969325153



Validation scores:
	RegressionAUROC: 0.7559155225753784
	RegressionCompetitionScore: 0.3806748466257669



Validation scores:
	RegressionAUROC: 0.742749035358429
	RegressionCompetitionScore: 0.32607361963190185

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.169. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38834355828220857
     Test RegressionAUROC            0.7539936304092407
Test RegressionCompetitionScore      0.38834355828220857
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 02:17:36,315][0m Trial 324 finished with value: 0.38834355828220857 and parameters: {'lr': 0.00010744655692224796, 'dropout': 0.41481530073888506, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 170, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.00031037257206458554, 'dropout': 0.461348766334885, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 128, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 26.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
26.1 K    Trainable params
0         Non-trainable params
26.1 K    Total params
0.104     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.54347825050354
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.7010692358016968
	RegressionCompetitionScore: 0.28067484662576686

Metric val_loss improved. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.709143877029419
	RegressionCompetitionScore: 0.28496932515337425

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7097845077514648
	RegressionCompetitionScore: 0.26104294478527607



Validation scores:
	RegressionAUROC: 0.7125799655914307
	RegressionCompetitionScore: 0.29141104294478526



Validation scores:
	RegressionAUROC: 0.7438561916351318
	RegressionCompetitionScore: 0.38773006134969323

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7519236207008362
	RegressionCompetitionScore: 0.37576687116564417

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7576043009757996
	RegressionCompetitionScore: 0.39079754601226996



Validation scores:
	RegressionAUROC: 0.7530010938644409
	RegressionCompetitionScore: 0.37392638036809817



Validation scores:
	RegressionAUROC: 0.7540497183799744
	RegressionCompetitionScore: 0.38558282208588956



Validation scores:
	RegressionAUROC: 0.7740217447280884
	RegressionCompetitionScore: 0.37791411042944784



Validation scores:
	RegressionAUROC: 0.7683526277542114
	RegressionCompetitionScore: 0.37791411042944784

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7769951820373535
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7704840898513794
	RegressionCompetitionScore: 0.3791411042944785



Validation scores:
	RegressionAUROC: 0.7835426926612854
	RegressionCompetitionScore: 0.44263803680981595

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7894223928451538
	RegressionCompetitionScore: 0.4174846625766871

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.159


Validation scores:
	RegressionAUROC: 0.7868859171867371
	RegressionCompetitionScore: 0.4469325153374233



Validation scores:
	RegressionAUROC: 0.7845029234886169
	RegressionCompetitionScore: 0.4254601226993865



Validation scores:
	RegressionAUROC: 0.791574239730835
	RegressionCompetitionScore: 0.4361963190184049



Validation scores:
	RegressionAUROC: 0.783643364906311
	RegressionCompetitionScore: 0.4039877300613497



Validation scores:
	RegressionAUROC: 0.7979070544242859
	RegressionCompetitionScore: 0.43190184049079755



Validation scores:
	RegressionAUROC: 0.7993870377540588
	RegressionCompetitionScore: 0.43742331288343556

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.158


Validation scores:
	RegressionAUROC: 0.8025604486465454
	RegressionCompetitionScore: 0.46226993865030674



Validation scores:
	RegressionAUROC: 0.7829842567443848
	RegressionCompetitionScore: 0.37300613496932516



Validation scores:
	RegressionAUROC: 0.8016740083694458
	RegressionCompetitionScore: 0.4315950920245399

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.155


Validation scores:
	RegressionAUROC: 0.8000904321670532
	RegressionCompetitionScore: 0.4588957055214724



Validation scores:
	RegressionAUROC: 0.7827101349830627
	RegressionCompetitionScore: 0.43190184049079755



Validation scores:
	RegressionAUROC: 0.7986735701560974
	RegressionCompetitionScore: 0.4297546012269939



Validation scores:
	RegressionAUROC: 0.8033899068832397
	RegressionCompetitionScore: 0.47024539877300614



Validation scores:
	RegressionAUROC: 0.7925357818603516
	RegressionCompetitionScore: 0.45



Validation scores:
	RegressionAUROC: 0.7829773426055908
	RegressionCompetitionScore: 0.39079754601226996



Validation scores:
	RegressionAUROC: 0.787186324596405
	RegressionCompetitionScore: 0.3969325153374233

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.155. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4315950920245399
     Test RegressionAUROC            0.8016740083694458
Test RegressionCompetitionScore      0.4315950920245399
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 02:29:58,632][0m Trial 325 finished with value: 0.4315950920245399 and parameters: {'lr': 0.00031037257206458554, 'dropout': 0.461348766334885, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 128, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.012253235899608875, 'dropout': 0.45291059268322253, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 148, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 29.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
29.3 K    Trainable params
0         Non-trainable params
29.3 K    Total params
0.117     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5169081687927246
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 10.519


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 8.149 >= min_delta = 0.0. New best score: 2.370


Validation scores:
	RegressionAUROC: 0.6208574771881104
	RegressionCompetitionScore: 0.1276073619631902

Metric val_loss improved by 2.115 >= min_delta = 0.0. New best score: 0.255


Validation scores:
	RegressionAUROC: 0.6617591381072998
	RegressionCompetitionScore: 0.16104294478527606

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.249


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6618243455886841
	RegressionCompetitionScore: 0.1276073619631902



Validation scores:
	RegressionAUROC: 0.6629456281661987
	RegressionCompetitionScore: 0.1334355828220859



Validation scores:
	RegressionAUROC: 0.6674386858940125
	RegressionCompetitionScore: 0.20061349693251534

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.6091236472129822
	RegressionCompetitionScore: 0.1205521472392638



Validation scores:
	RegressionAUROC: 0.6315825581550598
	RegressionCompetitionScore: 0.12269938650306748



Validation scores:
	RegressionAUROC: 0.5526145696640015
	RegressionCompetitionScore: 0.11533742331288344

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5843091011047363
	RegressionCompetitionScore: 0.12024539877300613



Validation scores:
	RegressionAUROC: 0.4507569968700409
	RegressionCompetitionScore: 0.029447852760736196

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.4408644735813141
	RegressionCompetitionScore: 0.03680981595092025



Validation scores:
	RegressionAUROC: 0.606181800365448
	RegressionCompetitionScore: 0.18711656441717792



Validation scores:
	RegressionAUROC: 0.41935673356056213
	RegressionCompetitionScore: 0.044171779141104296



Validation scores:
	RegressionAUROC: 0.539128303527832
	RegressionCompetitionScore: 0.18220858895705522



Validation scores:
	RegressionAUROC: 0.4530829191207886
	RegressionCompetitionScore: 0.038957055214723924



Validation scores:
	RegressionAUROC: 0.43598514795303345
	RegressionCompetitionScore: 0.04631901840490798



Validation scores:
	RegressionAUROC: 0.4501338303089142
	RegressionCompetitionScore: 0.06257668711656442

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.210. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore          0.029447852760736196
     Test RegressionAUROC            0.4507569968700409
Test RegressionCompetitionScore     0.029447852760736196
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 02:38:13,656][0m Trial 326 finished with value: 0.029447852760736196 and parameters: {'lr': 0.012253235899608875, 'dropout': 0.45291059268322253, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 148, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0002836811039737508, 'dropout': 0.4854703627115586, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 137, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 26.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
26.2 K    Trainable params
0         Non-trainable params
26.2 K    Total params
0.105     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5990338325500488
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.7016459107398987
	RegressionCompetitionScore: 0.31993865030674845

Metric val_loss improved. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7020148038864136
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7252835035324097
	RegressionCompetitionScore: 0.3211656441717791



Validation scores:
	RegressionAUROC: 0.7173646092414856
	RegressionCompetitionScore: 0.3168711656441718



Validation scores:
	RegressionAUROC: 0.7512348294258118
	RegressionCompetitionScore: 0.37791411042944784

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7492363452911377
	RegressionCompetitionScore: 0.3647239263803681



Validation scores:
	RegressionAUROC: 0.7501519918441772
	RegressionCompetitionScore: 0.37760736196319017



Validation scores:
	RegressionAUROC: 0.7074049711227417
	RegressionCompetitionScore: 0.25644171779141106



Validation scores:
	RegressionAUROC: 0.7140079736709595
	RegressionCompetitionScore: 0.25950920245398773



Validation scores:
	RegressionAUROC: 0.7218387722969055
	RegressionCompetitionScore: 0.2901840490797546



Validation scores:
	RegressionAUROC: 0.7426741719245911
	RegressionCompetitionScore: 0.32085889570552145



Validation scores:
	RegressionAUROC: 0.7307500839233398
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37791411042944784
     Test RegressionAUROC            0.7512348294258118
Test RegressionCompetitionScore      0.37791411042944784
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 02:43:20,594][0m Trial 327 finished with value: 0.37791411042944784 and parameters: {'lr': 0.0002836811039737508, 'dropout': 0.4854703627115586, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 137, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0002131535506935265, 'dropout': 0.5721730144307355, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 513, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 41.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
41.7 K    Trainable params
0         Non-trainable params
41.7 K    Total params
0.167     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.555555522441864
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6607456803321838
	RegressionCompetitionScore: 0.27607361963190186

Metric val_loss improved. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.697251558303833
	RegressionCompetitionScore: 0.251840490797546



Validation scores:
	RegressionAUROC: 0.7017459273338318
	RegressionCompetitionScore: 0.28404907975460125



Validation scores:
	RegressionAUROC: 0.7169369459152222
	RegressionCompetitionScore: 0.3184049079754601

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.727866530418396
	RegressionCompetitionScore: 0.348159509202454

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7425376176834106
	RegressionCompetitionScore: 0.36993865030674844



Validation scores:
	RegressionAUROC: 0.7405414581298828
	RegressionCompetitionScore: 0.34263803680981597



Validation scores:
	RegressionAUROC: 0.7418130040168762
	RegressionCompetitionScore: 0.3236196319018405

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7446388006210327
	RegressionCompetitionScore: 0.36533742331288344



Validation scores:
	RegressionAUROC: 0.7331994771957397
	RegressionCompetitionScore: 0.33865030674846625



Validation scores:
	RegressionAUROC: 0.7560995221138
	RegressionCompetitionScore: 0.344478527607362

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7469419836997986
	RegressionCompetitionScore: 0.3309815950920245



Validation scores:
	RegressionAUROC: 0.7446359395980835
	RegressionCompetitionScore: 0.3441717791411043



Validation scores:
	RegressionAUROC: 0.7482107877731323
	RegressionCompetitionScore: 0.34263803680981597



Validation scores:
	RegressionAUROC: 0.7537941932678223
	RegressionCompetitionScore: 0.3530674846625767



Validation scores:
	RegressionAUROC: 0.7521151900291443
	RegressionCompetitionScore: 0.297239263803681



Validation scores:
	RegressionAUROC: 0.7537482976913452
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7420437932014465
	RegressionCompetitionScore: 0.3361963190184049

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.168. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.344478527607362
     Test RegressionAUROC              0.7560995221138
Test RegressionCompetitionScore       0.344478527607362
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 02:50:44,889][0m Trial 328 finished with value: 0.344478527607362 and parameters: {'lr': 0.0002131535506935265, 'dropout': 0.5721730144307355, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 513, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.003985591590928499, 'dropout': 0.4598207013797253, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 128, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 36.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
36.1 K    Trainable params
0         Non-trainable params
36.1 K    Total params
0.144     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3333333134651184
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.3870854377746582
	RegressionCompetitionScore: 0.051533742331288344

Metric val_loss improved. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.6633414030075073
	RegressionCompetitionScore: 0.18251533742331288

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.631568431854248
	RegressionCompetitionScore: 0.07116564417177915

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.4800741374492645
	RegressionCompetitionScore: 0.08466257668711656



Validation scores:
	RegressionAUROC: 0.6725772619247437
	RegressionCompetitionScore: 0.0852760736196319



Validation scores:
	RegressionAUROC: 0.6619510650634766
	RegressionCompetitionScore: 0.09233128834355828



Validation scores:
	RegressionAUROC: 0.663243293762207
	RegressionCompetitionScore: 0.10766871165644172



Validation scores:
	RegressionAUROC: 0.33944153785705566
	RegressionCompetitionScore: 0.01901840490797546



Validation scores:
	RegressionAUROC: 0.4348858594894409
	RegressionCompetitionScore: 0.017484662576687116



Validation scores:
	RegressionAUROC: 0.5000665187835693
	RegressionCompetitionScore: 0.025460122699386502

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.07116564417177915
     Test RegressionAUROC             0.631568431854248
Test RegressionCompetitionScore      0.07116564417177915
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 02:55:40,753][0m Trial 329 finished with value: 0.07116564417177915 and parameters: {'lr': 0.003985591590928499, 'dropout': 0.4598207013797253, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 128, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.000569480201709898, 'dropout': 0.4232318572659631, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 168, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 36.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
36.3 K    Trainable params
0         Non-trainable params
36.3 K    Total params
0.145     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3285024166107178
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.7034004926681519
	RegressionCompetitionScore: 0.22116564417177914

Metric val_loss improved. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.7383667826652527
	RegressionCompetitionScore: 0.34754601226993864

Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7438886761665344
	RegressionCompetitionScore: 0.38773006134969323

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7638144493103027
	RegressionCompetitionScore: 0.39754601226993863

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7721706628799438
	RegressionCompetitionScore: 0.4030674846625767

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7869670391082764
	RegressionCompetitionScore: 0.41779141104294476

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7853110432624817
	RegressionCompetitionScore: 0.41226993865030676



Validation scores:
	RegressionAUROC: 0.7890722751617432
	RegressionCompetitionScore: 0.41134969325153375



Validation scores:
	RegressionAUROC: 0.7714602947235107
	RegressionCompetitionScore: 0.37883435582822084



Validation scores:
	RegressionAUROC: 0.778805673122406
	RegressionCompetitionScore: 0.42392638036809815



Validation scores:
	RegressionAUROC: 0.7860509157180786
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7730951309204102
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7706292867660522
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.162. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.41779141104294476
     Test RegressionAUROC            0.7869670391082764
Test RegressionCompetitionScore      0.41779141104294476
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 03:01:13,071][0m Trial 330 finished with value: 0.41779141104294476 and parameters: {'lr': 0.000569480201709898, 'dropout': 0.4232318572659631, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 168, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0013154194530003401, 'dropout': 0.41672384898401, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 154, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 35.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
35.4 K    Trainable params
0         Non-trainable params
35.4 K    Total params
0.141     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4661835730075836
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.679430365562439
	RegressionCompetitionScore: 0.2644171779141104

Metric val_loss improved. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7226396799087524
	RegressionCompetitionScore: 0.3273006134969325

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7456943988800049
	RegressionCompetitionScore: 0.345398773006135



Validation scores:
	RegressionAUROC: 0.7347769737243652
	RegressionCompetitionScore: 0.3567484662576687

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7440380454063416
	RegressionCompetitionScore: 0.35184049079754603

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7457137107849121
	RegressionCompetitionScore: 0.3726993865030675

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7318092584609985
	RegressionCompetitionScore: 0.3487730061349693



Validation scores:
	RegressionAUROC: 0.7252013683319092
	RegressionCompetitionScore: 0.36533742331288344



Validation scores:
	RegressionAUROC: 0.7330939173698425
	RegressionCompetitionScore: 0.3226993865030675



Validation scores:
	RegressionAUROC: 0.7493847608566284
	RegressionCompetitionScore: 0.35

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7313829660415649
	RegressionCompetitionScore: 0.2674846625766871



Validation scores:
	RegressionAUROC: 0.731407642364502
	RegressionCompetitionScore: 0.2579754601226994



Validation scores:
	RegressionAUROC: 0.7325835227966309
	RegressionCompetitionScore: 0.2705521472392638



Validation scores:
	RegressionAUROC: 0.7494935989379883
	RegressionCompetitionScore: 0.3610429447852761



Validation scores:
	RegressionAUROC: 0.7482887506484985
	RegressionCompetitionScore: 0.2696319018404908



Validation scores:
	RegressionAUROC: 0.7323298454284668
	RegressionCompetitionScore: 0.2549079754601227



Validation scores:
	RegressionAUROC: 0.7362184524536133
	RegressionCompetitionScore: 0.23742331288343557

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.173. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                  0.35
     Test RegressionAUROC            0.7493847608566284
Test RegressionCompetitionScore             0.35
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 03:08:19,294][0m Trial 331 finished with value: 0.35 and parameters: {'lr': 0.0013154194530003401, 'dropout': 0.41672384898401, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 154, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0006163864036006436, 'dropout': 0.42276213230104426, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 185, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 37.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
37.5 K    Trainable params
0         Non-trainable params
37.5 K    Total params
0.150     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.32367148995399475
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.6874331831932068
	RegressionCompetitionScore: 0.1696319018404908

Metric val_loss improved. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.7070468664169312
	RegressionCompetitionScore: 0.298159509202454

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.7217333316802979
	RegressionCompetitionScore: 0.35153374233128837

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7355598211288452
	RegressionCompetitionScore: 0.37607361963190183



Validation scores:
	RegressionAUROC: 0.7593645453453064
	RegressionCompetitionScore: 0.40061349693251536



Validation scores:
	RegressionAUROC: 0.7723675966262817
	RegressionCompetitionScore: 0.37239263803680983

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7888269424438477
	RegressionCompetitionScore: 0.401840490797546

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.158


Validation scores:
	RegressionAUROC: 0.7915866374969482
	RegressionCompetitionScore: 0.42760736196319016



Validation scores:
	RegressionAUROC: 0.7716883420944214
	RegressionCompetitionScore: 0.36134969325153377



Validation scores:
	RegressionAUROC: 0.784895122051239
	RegressionCompetitionScore: 0.3901840490797546



Validation scores:
	RegressionAUROC: 0.7871314287185669
	RegressionCompetitionScore: 0.35644171779141104



Validation scores:
	RegressionAUROC: 0.7995405197143555
	RegressionCompetitionScore: 0.4196319018404908

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.154


Validation scores:
	RegressionAUROC: 0.7896608114242554
	RegressionCompetitionScore: 0.4386503067484663



Validation scores:
	RegressionAUROC: 0.7868509292602539
	RegressionCompetitionScore: 0.4058282208588957



Validation scores:
	RegressionAUROC: 0.7945523858070374
	RegressionCompetitionScore: 0.4217791411042945



Validation scores:
	RegressionAUROC: 0.7923433184623718
	RegressionCompetitionScore: 0.40797546012269936



Validation scores:
	RegressionAUROC: 0.8024839758872986
	RegressionCompetitionScore: 0.4128834355828221



Validation scores:
	RegressionAUROC: 0.797737717628479
	RegressionCompetitionScore: 0.404601226993865



Validation scores:
	RegressionAUROC: 0.7868285179138184
	RegressionCompetitionScore: 0.36073619631901843

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.154. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4196319018404908
     Test RegressionAUROC            0.7995405197143555
Test RegressionCompetitionScore      0.4196319018404908
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 03:16:10,097][0m Trial 332 finished with value: 0.4196319018404908 and parameters: {'lr': 0.0006163864036006436, 'dropout': 0.42276213230104426, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 185, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0006328689152332907, 'dropout': 0.4257889725663501, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 175, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 36.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
36.8 K    Trainable params
0         Non-trainable params
36.8 K    Total params
0.147     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5333333611488342
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.656566858291626
	RegressionCompetitionScore: 0.2223926380368098

Metric val_loss improved. New best score: 0.237


Validation scores:
	RegressionAUROC: 0.6609151363372803
	RegressionCompetitionScore: 0.27208588957055213

Metric val_loss improved by 0.042 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.7003461122512817
	RegressionCompetitionScore: 0.28159509202453986



Validation scores:
	RegressionAUROC: 0.6722761392593384
	RegressionCompetitionScore: 0.27423312883435585



Validation scores:
	RegressionAUROC: 0.7059006094932556
	RegressionCompetitionScore: 0.3165644171779141

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.711800217628479
	RegressionCompetitionScore: 0.3033742331288344

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7209390997886658
	RegressionCompetitionScore: 0.3156441717791411



Validation scores:
	RegressionAUROC: 0.7112683057785034
	RegressionCompetitionScore: 0.3236196319018405



Validation scores:
	RegressionAUROC: 0.7345656156539917
	RegressionCompetitionScore: 0.3558282208588957



Validation scores:
	RegressionAUROC: 0.7435232400894165
	RegressionCompetitionScore: 0.37699386503067484



Validation scores:
	RegressionAUROC: 0.7386270761489868
	RegressionCompetitionScore: 0.3300613496932515



Validation scores:
	RegressionAUROC: 0.7157497406005859
	RegressionCompetitionScore: 0.32699386503067485



Validation scores:
	RegressionAUROC: 0.7163745164871216
	RegressionCompetitionScore: 0.2950920245398773

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.181. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3033742331288344
     Test RegressionAUROC             0.711800217628479
Test RegressionCompetitionScore      0.3033742331288344
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 03:22:21,573][0m Trial 333 finished with value: 0.3033742331288344 and parameters: {'lr': 0.0006328689152332907, 'dropout': 0.4257889725663501, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 175, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0009645378707500707, 'dropout': 0.40077602825951547, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 191, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 41.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
41.5 K    Trainable params
0         Non-trainable params
41.5 K    Total params
0.166     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.34299516677856445
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6647043228149414
	RegressionCompetitionScore: 0.12239263803680982

Metric val_loss improved. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.7000949382781982
	RegressionCompetitionScore: 0.3141104294478528

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7163150906562805
	RegressionCompetitionScore: 0.3361963190184049



Validation scores:
	RegressionAUROC: 0.7261943221092224
	RegressionCompetitionScore: 0.33067484662576685

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7219555377960205
	RegressionCompetitionScore: 0.31257668711656444



Validation scores:
	RegressionAUROC: 0.7474110722541809
	RegressionCompetitionScore: 0.32699386503067485



Validation scores:
	RegressionAUROC: 0.731644868850708
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7486681938171387
	RegressionCompetitionScore: 0.36687116564417177

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7286713123321533
	RegressionCompetitionScore: 0.2911042944785276



Validation scores:
	RegressionAUROC: 0.7547646164894104
	RegressionCompetitionScore: 0.37607361963190183

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7616767287254333
	RegressionCompetitionScore: 0.38680981595092023



Validation scores:
	RegressionAUROC: 0.7687755823135376
	RegressionCompetitionScore: 0.4153374233128834



Validation scores:
	RegressionAUROC: 0.7537128329277039
	RegressionCompetitionScore: 0.38865030674846623



Validation scores:
	RegressionAUROC: 0.7745148539543152
	RegressionCompetitionScore: 0.41226993865030676

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.762591540813446
	RegressionCompetitionScore: 0.38282208588957056



Validation scores:
	RegressionAUROC: 0.7774465084075928
	RegressionCompetitionScore: 0.37607361963190183



Validation scores:
	RegressionAUROC: 0.7854386568069458
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.779186487197876
	RegressionCompetitionScore: 0.4171779141104294

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7691107988357544
	RegressionCompetitionScore: 0.39263803680981596



Validation scores:
	RegressionAUROC: 0.7806333303451538
	RegressionCompetitionScore: 0.39263803680981596



Validation scores:
	RegressionAUROC: 0.7806895971298218
	RegressionCompetitionScore: 0.4134969325153374

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7688334584236145
	RegressionCompetitionScore: 0.41779141104294476



Validation scores:
	RegressionAUROC: 0.7825543284416199
	RegressionCompetitionScore: 0.41932515337423315



Validation scores:
	RegressionAUROC: 0.7790465950965881
	RegressionCompetitionScore: 0.399079754601227



Validation scores:
	RegressionAUROC: 0.766518235206604
	RegressionCompetitionScore: 0.42576687116564416



Validation scores:
	RegressionAUROC: 0.7753620743751526
	RegressionCompetitionScore: 0.44171779141104295



Validation scores:
	RegressionAUROC: 0.7966030836105347
	RegressionCompetitionScore: 0.450920245398773

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.7768343091011047
	RegressionCompetitionScore: 0.3763803680981595



Validation scores:
	RegressionAUROC: 0.7568544149398804
	RegressionCompetitionScore: 0.3202453987730061



Validation scores:
	RegressionAUROC: 0.7747215032577515
	RegressionCompetitionScore: 0.4331288343558282



Validation scores:
	RegressionAUROC: 0.7732517123222351
	RegressionCompetitionScore: 0.4279141104294479



Validation scores:
	RegressionAUROC: 0.7706848978996277
	RegressionCompetitionScore: 0.4352760736196319



Validation scores:
	RegressionAUROC: 0.7820716500282288
	RegressionCompetitionScore: 0.42300613496932515



Validation scores:
	RegressionAUROC: 0.7789397239685059
	RegressionCompetitionScore: 0.4205521472392638

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.161. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.450920245398773
     Test RegressionAUROC            0.7966030836105347
Test RegressionCompetitionScore       0.450920245398773
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 03:36:04,686][0m Trial 334 finished with value: 0.450920245398773 and parameters: {'lr': 0.0009645378707500707, 'dropout': 0.40077602825951547, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 191, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0011124058580794123, 'dropout': 0.41341168684053026, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 187, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 41.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
41.1 K    Trainable params
0         Non-trainable params
41.1 K    Total params
0.164     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5169081687927246
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6761674880981445
	RegressionCompetitionScore: 0.19785276073619631

Metric val_loss improved. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.6859811544418335
	RegressionCompetitionScore: 0.12300613496932515



Validation scores:
	RegressionAUROC: 0.7111774682998657
	RegressionCompetitionScore: 0.3374233128834356

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.7124802470207214
	RegressionCompetitionScore: 0.3598159509202454

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6838024854660034
	RegressionCompetitionScore: 0.3773006134969325



Validation scores:
	RegressionAUROC: 0.729828953742981
	RegressionCompetitionScore: 0.3423312883435583



Validation scores:
	RegressionAUROC: 0.6973348259925842
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7159856557846069
	RegressionCompetitionScore: 0.3365030674846626



Validation scores:
	RegressionAUROC: 0.7073413133621216
	RegressionCompetitionScore: 0.21625766871165644



Validation scores:
	RegressionAUROC: 0.7085322737693787
	RegressionCompetitionScore: 0.24754601226993864



Validation scores:
	RegressionAUROC: 0.7204722762107849
	RegressionCompetitionScore: 0.3361963190184049

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.202. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3598159509202454
     Test RegressionAUROC            0.7124802470207214
Test RegressionCompetitionScore      0.3598159509202454
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 03:40:49,974][0m Trial 335 finished with value: 0.3598159509202454 and parameters: {'lr': 0.0011124058580794123, 'dropout': 0.41341168684053026, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 187, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.000785323088991175, 'dropout': 0.4028701941767584, 'd_model_multiplier': 32, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 198, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.1 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
2.1 M     Trainable params
0         Non-trainable params
2.1 M     Total params
8.326     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.47826087474823
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.4383417069911957
	RegressionCompetitionScore: 0.08987730061349693

Metric val_loss improved. New best score: 0.312


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6306455135345459
	RegressionCompetitionScore: 0.20214723926380368

Metric val_loss improved by 0.100 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.66219162940979
	RegressionCompetitionScore: 0.08987730061349693

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6093427538871765
	RegressionCompetitionScore: 0.1116564417177914



Validation scores:
	RegressionAUROC: 0.6865857839584351
	RegressionCompetitionScore: 0.13895705521472393



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.210. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.08987730061349693
     Test RegressionAUROC             0.66219162940979
Test RegressionCompetitionScore      0.08987730061349693
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 03:46:26,082][0m Trial 336 finished with value: 0.08987730061349693 and parameters: {'lr': 0.000785323088991175, 'dropout': 0.4028701941767584, 'd_model_multiplier': 32, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 198, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 300 with value: 0.4644171779141104.[0m
Starting trial with params:
{'lr': 0.0008628517041227239, 'dropout': 0.4192821526246893, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 189, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 44.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
44.8 K    Trainable params
0         Non-trainable params
44.8 K    Total params
0.179     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5039148926734924
	RegressionCompetitionScore: 0.09938650306748466

Metric val_loss improved. New best score: 0.223


Validation scores:
	RegressionAUROC: 0.6048195362091064
	RegressionCompetitionScore: 0.11257668711656442

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.626027524471283
	RegressionCompetitionScore: 0.10950920245398774

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6501722931861877
	RegressionCompetitionScore: 0.17914110429447852

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6831159591674805
	RegressionCompetitionScore: 0.26717791411042946



Validation scores:
	RegressionAUROC: 0.6995339393615723
	RegressionCompetitionScore: 0.2785276073619632

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.7285634875297546
	RegressionCompetitionScore: 0.3285276073619632

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7529180645942688
	RegressionCompetitionScore: 0.3895705521472393

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.779059648513794
	RegressionCompetitionScore: 0.4110429447852761



Validation scores:
	RegressionAUROC: 0.7871999740600586
	RegressionCompetitionScore: 0.41932515337423315

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7681965231895447
	RegressionCompetitionScore: 0.39570552147239263



Validation scores:
	RegressionAUROC: 0.7837234139442444
	RegressionCompetitionScore: 0.41319018404907976



Validation scores:
	RegressionAUROC: 0.7884716987609863
	RegressionCompetitionScore: 0.4226993865030675



Validation scores:
	RegressionAUROC: 0.7939947843551636
	RegressionCompetitionScore: 0.44355828220858895



Validation scores:
	RegressionAUROC: 0.7984764575958252
	RegressionCompetitionScore: 0.4607361963190184

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.8026504516601562
	RegressionCompetitionScore: 0.4677914110429448



Validation scores:
	RegressionAUROC: 0.809615433216095
	RegressionCompetitionScore: 0.4852760736196319

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.8014549016952515
	RegressionCompetitionScore: 0.4414110429447853



Validation scores:
	RegressionAUROC: 0.799697995185852
	RegressionCompetitionScore: 0.4521472392638037



Validation scores:
	RegressionAUROC: 0.8054745197296143
	RegressionCompetitionScore: 0.4662576687116564



Validation scores:
	RegressionAUROC: 0.8002607822418213
	RegressionCompetitionScore: 0.44631901840490795



Validation scores:
	RegressionAUROC: 0.7928715348243713
	RegressionCompetitionScore: 0.4469325153374233



Validation scores:
	RegressionAUROC: 0.7992784976959229
	RegressionCompetitionScore: 0.44877300613496934



Validation scores:
	RegressionAUROC: 0.7936634421348572
	RegressionCompetitionScore: 0.4592024539877301

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.163. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4852760736196319
     Test RegressionAUROC             0.809615433216095
Test RegressionCompetitionScore      0.4852760736196319
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 03:56:06,648][0m Trial 337 finished with value: 0.4852760736196319 and parameters: {'lr': 0.0008628517041227239, 'dropout': 0.4192821526246893, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 189, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0013219973881139439, 'dropout': 0.4071652590783248, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 845, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 111 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
111 K     Trainable params
0         Non-trainable params
111 K     Total params
0.447     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.40879231691360474
	RegressionCompetitionScore: 0.10613496932515337

Metric val_loss improved. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.47440481185913086
	RegressionCompetitionScore: 0.06257668711656442



Validation scores:
	RegressionAUROC: 0.6524187922477722
	RegressionCompetitionScore: 0.12576687116564417



Validation scores:
	RegressionAUROC: 0.6880531311035156
	RegressionCompetitionScore: 0.11687116564417178

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.683043360710144
	RegressionCompetitionScore: 0.2223926380368098

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.6749109625816345
	RegressionCompetitionScore: 0.20521472392638038

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6457231044769287
	RegressionCompetitionScore: 0.08987730061349693



Validation scores:
	RegressionAUROC: 0.3672195076942444
	RegressionCompetitionScore: 0.06779141104294478



Validation scores:
	RegressionAUROC: 0.4928091764450073
	RegressionCompetitionScore: 0.08006134969325153

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5777002573013306
	RegressionCompetitionScore: 0.08957055214723926



Validation scores:
	RegressionAUROC: 0.5585116147994995
	RegressionCompetitionScore: 0.08220858895705521



Validation scores:
	RegressionAUROC: 0.5951635241508484
	RegressionCompetitionScore: 0.07423312883435583



Validation scores:
	RegressionAUROC: 0.42553043365478516
	RegressionCompetitionScore: 0.05276073619631902



Validation scores:
	RegressionAUROC: 0.6422374248504639
	RegressionCompetitionScore: 0.09785276073619632



Validation scores:
	RegressionAUROC: 0.6503057479858398
	RegressionCompetitionScore: 0.09018404907975461



Validation scores:
	RegressionAUROC: 0.6603043675422668
	RegressionCompetitionScore: 0.09723926380368098

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.08006134969325153
     Test RegressionAUROC            0.4928091764450073
Test RegressionCompetitionScore      0.08006134969325153
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 04:02:50,643][0m Trial 338 finished with value: 0.08006134969325153 and parameters: {'lr': 0.0013219973881139439, 'dropout': 0.4071652590783248, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 845, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0009896517379565893, 'dropout': 0.42091184390076064, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 204, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 42.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
42.6 K    Trainable params
0         Non-trainable params
42.6 K    Total params
0.170     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6647162437438965
	RegressionCompetitionScore: 0.2598159509202454

Metric val_loss improved. New best score: 0.253


Validation scores:
	RegressionAUROC: 0.6943386793136597
	RegressionCompetitionScore: 0.2843558282208589

Metric val_loss improved by 0.064 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6930121183395386
	RegressionCompetitionScore: 0.28251533742331286



Validation scores:
	RegressionAUROC: 0.715667724609375
	RegressionCompetitionScore: 0.33588957055214724



Validation scores:
	RegressionAUROC: 0.7114518880844116
	RegressionCompetitionScore: 0.34754601226993864



Validation scores:
	RegressionAUROC: 0.7314251661300659
	RegressionCompetitionScore: 0.400920245398773

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7241202592849731
	RegressionCompetitionScore: 0.3782208588957055



Validation scores:
	RegressionAUROC: 0.7296500205993652
	RegressionCompetitionScore: 0.3726993865030675



Validation scores:
	RegressionAUROC: 0.7293810248374939
	RegressionCompetitionScore: 0.36441717791411044



Validation scores:
	RegressionAUROC: 0.7330515384674072
	RegressionCompetitionScore: 0.35337423312883437



Validation scores:
	RegressionAUROC: 0.7428241968154907
	RegressionCompetitionScore: 0.3414110429447853



Validation scores:
	RegressionAUROC: 0.7436901926994324
	RegressionCompetitionScore: 0.3374233128834356



Validation scores:
	RegressionAUROC: 0.7340283393859863
	RegressionCompetitionScore: 0.3708588957055215

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.173. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.400920245398773
     Test RegressionAUROC            0.7314251661300659
Test RegressionCompetitionScore       0.400920245398773
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 04:08:21,226][0m Trial 339 finished with value: 0.400920245398773 and parameters: {'lr': 0.0009896517379565893, 'dropout': 0.42091184390076064, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 204, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0008032322074611285, 'dropout': 0.400039613862784, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 719, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 98.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
98.9 K    Trainable params
0         Non-trainable params
98.9 K    Total params
0.396     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.519184947013855
	RegressionCompetitionScore: 0.11809815950920245

Metric val_loss improved. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.6902507543563843
	RegressionCompetitionScore: 0.2625766871165644

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6957377791404724
	RegressionCompetitionScore: 0.28159509202453986

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.7069333791732788
	RegressionCompetitionScore: 0.31104294478527605

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.7032161355018616
	RegressionCompetitionScore: 0.2763803680981595

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7151875495910645
	RegressionCompetitionScore: 0.31196319018404906



Validation scores:
	RegressionAUROC: 0.6820350289344788
	RegressionCompetitionScore: 0.29386503067484665



Validation scores:
	RegressionAUROC: 0.6827431917190552
	RegressionCompetitionScore: 0.3355828220858896



Validation scores:
	RegressionAUROC: 0.6919292211532593
	RegressionCompetitionScore: 0.38190184049079756



Validation scores:
	RegressionAUROC: 0.7124899625778198
	RegressionCompetitionScore: 0.34846625766871164

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7283878326416016
	RegressionCompetitionScore: 0.35460122699386504



Validation scores:
	RegressionAUROC: 0.7196548581123352
	RegressionCompetitionScore: 0.3352760736196319

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7141152024269104
	RegressionCompetitionScore: 0.3496932515337423



Validation scores:
	RegressionAUROC: 0.7372522354125977
	RegressionCompetitionScore: 0.38374233128834356

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7341015338897705
	RegressionCompetitionScore: 0.37668711656441717

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7345331907272339
	RegressionCompetitionScore: 0.39662576687116563



Validation scores:
	RegressionAUROC: 0.7379767298698425
	RegressionCompetitionScore: 0.4012269938650307



Validation scores:
	RegressionAUROC: 0.7340047359466553
	RegressionCompetitionScore: 0.4039877300613497



Validation scores:
	RegressionAUROC: 0.7376470565795898
	RegressionCompetitionScore: 0.3950920245398773



Validation scores:
	RegressionAUROC: 0.7275776863098145
	RegressionCompetitionScore: 0.404601226993865



Validation scores:
	RegressionAUROC: 0.7192678451538086
	RegressionCompetitionScore: 0.3352760736196319



Validation scores:
	RegressionAUROC: 0.7342753410339355
	RegressionCompetitionScore: 0.38588957055214723

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.173. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37668711656441717
     Test RegressionAUROC            0.7341015338897705
Test RegressionCompetitionScore      0.37668711656441717
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 04:17:30,150][0m Trial 340 finished with value: 0.37668711656441717 and parameters: {'lr': 0.0008032322074611285, 'dropout': 0.400039613862784, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 719, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0015356806402935562, 'dropout': 0.4182970258753206, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 186, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 41.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
41.0 K    Trainable params
0         Non-trainable params
41.0 K    Total params
0.164     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6455643177032471
	RegressionCompetitionScore: 0.15061349693251533

Metric val_loss improved. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.5167557001113892
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6823396682739258
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7008851766586304
	RegressionCompetitionScore: 0.2754601226993865

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.7018619775772095
	RegressionCompetitionScore: 0.30736196319018405



Validation scores:
	RegressionAUROC: 0.7059390544891357
	RegressionCompetitionScore: 0.30736196319018405

Metric val_loss improved by 0.027 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6328468322753906
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7195732593536377
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.6577870845794678
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6920376420021057
	RegressionCompetitionScore: 0.3469325153374233



Validation scores:
	RegressionAUROC: 0.7005360722541809
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7090967893600464
	RegressionCompetitionScore: 0.3282208588957055



Validation scores:
	RegressionAUROC: 0.7083868384361267
	RegressionCompetitionScore: 0.3205521472392638

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.194. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.30736196319018405
     Test RegressionAUROC            0.7059390544891357
Test RegressionCompetitionScore      0.30736196319018405
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 04:22:58,863][0m Trial 341 finished with value: 0.30736196319018405 and parameters: {'lr': 0.0015356806402935562, 'dropout': 0.4182970258753206, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 186, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0006510606953184109, 'dropout': 0.4103695300901003, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 176, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 36.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
36.9 K    Trainable params
0         Non-trainable params
36.9 K    Total params
0.147     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6859903335571289
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.6938566565513611
	RegressionCompetitionScore: 0.1165644171779141

Metric val_loss improved. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6888651847839355
	RegressionCompetitionScore: 0.25061349693251533

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7192621231079102
	RegressionCompetitionScore: 0.3398773006134969

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7221665382385254
	RegressionCompetitionScore: 0.36595092024539877

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7285171151161194
	RegressionCompetitionScore: 0.37147239263803683

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7448664903640747
	RegressionCompetitionScore: 0.3852760736196319

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7492126822471619
	RegressionCompetitionScore: 0.3834355828220859



Validation scores:
	RegressionAUROC: 0.7454055547714233
	RegressionCompetitionScore: 0.3598159509202454



Validation scores:
	RegressionAUROC: 0.7422271966934204
	RegressionCompetitionScore: 0.39815950920245397

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7580806016921997
	RegressionCompetitionScore: 0.4187116564417178



Validation scores:
	RegressionAUROC: 0.7569800019264221
	RegressionCompetitionScore: 0.40613496932515336

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7677925825119019
	RegressionCompetitionScore: 0.4030674846625767



Validation scores:
	RegressionAUROC: 0.7528401613235474
	RegressionCompetitionScore: 0.3530674846625767



Validation scores:
	RegressionAUROC: 0.7605975866317749
	RegressionCompetitionScore: 0.4134969325153374

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7641319632530212
	RegressionCompetitionScore: 0.4187116564417178



Validation scores:
	RegressionAUROC: 0.7557355165481567
	RegressionCompetitionScore: 0.38680981595092023



Validation scores:
	RegressionAUROC: 0.7662834525108337
	RegressionCompetitionScore: 0.3871165644171779



Validation scores:
	RegressionAUROC: 0.7631508111953735
	RegressionCompetitionScore: 0.3773006134969325



Validation scores:
	RegressionAUROC: 0.7615943551063538
	RegressionCompetitionScore: 0.4190184049079755



Validation scores:
	RegressionAUROC: 0.7601171731948853
	RegressionCompetitionScore: 0.4199386503067485



Validation scores:
	RegressionAUROC: 0.7633810043334961
	RegressionCompetitionScore: 0.40337423312883436

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.166. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4134969325153374
     Test RegressionAUROC            0.7605975866317749
Test RegressionCompetitionScore      0.4134969325153374
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 04:31:30,397][0m Trial 342 finished with value: 0.4134969325153374 and parameters: {'lr': 0.0006510606953184109, 'dropout': 0.4103695300901003, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 176, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005872878030208096, 'dropout': 0.4121929320892507, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 221, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 39.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
39.9 K    Trainable params
0         Non-trainable params
39.9 K    Total params
0.160     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5550065040588379
	RegressionCompetitionScore: 0.18220858895705522

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6118277907371521
	RegressionCompetitionScore: 0.2865030674846626

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6343839764595032
	RegressionCompetitionScore: 0.2812883435582822

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.680348813533783
	RegressionCompetitionScore: 0.2865030674846626

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6870021820068359
	RegressionCompetitionScore: 0.3024539877300613



Validation scores:
	RegressionAUROC: 0.7052806615829468
	RegressionCompetitionScore: 0.3539877300613497

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7138722538948059
	RegressionCompetitionScore: 0.36226993865030677



Validation scores:
	RegressionAUROC: 0.7307440042495728
	RegressionCompetitionScore: 0.37024539877300616

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7266086339950562
	RegressionCompetitionScore: 0.35276073619631904



Validation scores:
	RegressionAUROC: 0.7705642580986023
	RegressionCompetitionScore: 0.3978527607361963



Validation scores:
	RegressionAUROC: 0.7836709022521973
	RegressionCompetitionScore: 0.37300613496932516



Validation scores:
	RegressionAUROC: 0.7880556583404541
	RegressionCompetitionScore: 0.4236196319018405



Validation scores:
	RegressionAUROC: 0.7933349609375
	RegressionCompetitionScore: 0.44171779141104295

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.795624315738678
	RegressionCompetitionScore: 0.43098159509202455



Validation scores:
	RegressionAUROC: 0.808524489402771
	RegressionCompetitionScore: 0.43987730061349695

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.159


Validation scores:
	RegressionAUROC: 0.8069418668746948
	RegressionCompetitionScore: 0.43895705521472395

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.157


Validation scores:
	RegressionAUROC: 0.8040511608123779
	RegressionCompetitionScore: 0.451840490797546



Validation scores:
	RegressionAUROC: 0.7842538356781006
	RegressionCompetitionScore: 0.4260736196319018



Validation scores:
	RegressionAUROC: 0.8011994957923889
	RegressionCompetitionScore: 0.4306748466257669



Validation scores:
	RegressionAUROC: 0.8044160008430481
	RegressionCompetitionScore: 0.4340490797546012



Validation scores:
	RegressionAUROC: 0.8043442368507385
	RegressionCompetitionScore: 0.4361963190184049



Validation scores:
	RegressionAUROC: 0.8043004274368286
	RegressionCompetitionScore: 0.4245398773006135



Validation scores:
	RegressionAUROC: 0.8006199598312378
	RegressionCompetitionScore: 0.4653374233128834

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.157. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.43895705521472395
     Test RegressionAUROC            0.8069418668746948
Test RegressionCompetitionScore      0.43895705521472395
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 04:40:47,844][0m Trial 343 finished with value: 0.43895705521472395 and parameters: {'lr': 0.0005872878030208096, 'dropout': 0.4121929320892507, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 221, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0006490357530945173, 'dropout': 0.40813421987529186, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 228, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 40.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
40.4 K    Trainable params
0         Non-trainable params
40.4 K    Total params
0.162     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7198067903518677
	RegressionCompetitionScore: 0.43478260869565216



Validation scores:
	RegressionAUROC: 0.6760544180870056
	RegressionCompetitionScore: 0.30552147239263805

Metric val_loss improved. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6878000497817993
	RegressionCompetitionScore: 0.301840490797546

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7011145353317261
	RegressionCompetitionScore: 0.33220858895705524



Validation scores:
	RegressionAUROC: 0.7048056125640869
	RegressionCompetitionScore: 0.32975460122699385

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7188413143157959
	RegressionCompetitionScore: 0.37055214723926383

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7363473176956177
	RegressionCompetitionScore: 0.37975460122699384

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7456898093223572
	RegressionCompetitionScore: 0.3843558282208589



Validation scores:
	RegressionAUROC: 0.7412974834442139
	RegressionCompetitionScore: 0.39846625766871163

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.74333256483078
	RegressionCompetitionScore: 0.3993865030674847



Validation scores:
	RegressionAUROC: 0.7529346346855164
	RegressionCompetitionScore: 0.39539877300613496



Validation scores:
	RegressionAUROC: 0.7387552261352539
	RegressionCompetitionScore: 0.3904907975460123



Validation scores:
	RegressionAUROC: 0.758606493473053
	RegressionCompetitionScore: 0.3567484662576687

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7556225061416626
	RegressionCompetitionScore: 0.40797546012269936



Validation scores:
	RegressionAUROC: 0.7571209669113159
	RegressionCompetitionScore: 0.3880368098159509



Validation scores:
	RegressionAUROC: 0.7663426995277405
	RegressionCompetitionScore: 0.4340490797546012



Validation scores:
	RegressionAUROC: 0.7698268890380859
	RegressionCompetitionScore: 0.43098159509202455



Validation scores:
	RegressionAUROC: 0.7636813521385193
	RegressionCompetitionScore: 0.38496932515337423



Validation scores:
	RegressionAUROC: 0.7708735466003418
	RegressionCompetitionScore: 0.39570552147239263



Validation scores:
	RegressionAUROC: 0.7626264095306396
	RegressionCompetitionScore: 0.37024539877300616

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.164. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3567484662576687
     Test RegressionAUROC             0.758606493473053
Test RegressionCompetitionScore      0.3567484662576687
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 04:48:31,189][0m Trial 344 finished with value: 0.3567484662576687 and parameters: {'lr': 0.0006490357530945173, 'dropout': 0.40813421987529186, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 228, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 1.8235121220031436e-07, 'dropout': 0.41631403192880806, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 208, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 39.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
39.0 K    Trainable params
0         Non-trainable params
39.0 K    Total params
0.156     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6159420609474182
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.540908932685852
	RegressionCompetitionScore: 0.14079754601226993

Metric val_loss improved. New best score: 0.599


Validation scores:
	RegressionAUROC: 0.5449868440628052
	RegressionCompetitionScore: 0.1383435582822086

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.588


Validation scores:
	RegressionAUROC: 0.5463672280311584
	RegressionCompetitionScore: 0.13957055214723926

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.578


Validation scores:
	RegressionAUROC: 0.5436074137687683
	RegressionCompetitionScore: 0.1383435582822086

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.567


Validation scores:
	RegressionAUROC: 0.542736828327179
	RegressionCompetitionScore: 0.13803680981595093

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.557


Validation scores:
	RegressionAUROC: 0.5401619672775269
	RegressionCompetitionScore: 0.13803680981595093

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.546


Validation scores:
	RegressionAUROC: 0.540286123752594
	RegressionCompetitionScore: 0.1374233128834356

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.537


Validation scores:
	RegressionAUROC: 0.5390303134918213
	RegressionCompetitionScore: 0.13773006134969326

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.527


Validation scores:
	RegressionAUROC: 0.536449670791626
	RegressionCompetitionScore: 0.13773006134969326

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.517


Validation scores:
	RegressionAUROC: 0.5348840355873108
	RegressionCompetitionScore: 0.13865030674846626

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.507


Validation scores:
	RegressionAUROC: 0.5343783497810364
	RegressionCompetitionScore: 0.13895705521472393

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.497


Validation scores:
	RegressionAUROC: 0.5346437096595764
	RegressionCompetitionScore: 0.13711656441717793

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.487


Validation scores:
	RegressionAUROC: 0.5350539088249207
	RegressionCompetitionScore: 0.13588957055214723

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.478


Validation scores:
	RegressionAUROC: 0.5351871848106384
	RegressionCompetitionScore: 0.13558282208588956

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.469


Validation scores:
	RegressionAUROC: 0.5344777703285217
	RegressionCompetitionScore: 0.13558282208588956

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.461


Validation scores:
	RegressionAUROC: 0.5333834290504456
	RegressionCompetitionScore: 0.13404907975460123

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.452


Validation scores:
	RegressionAUROC: 0.5327682495117188
	RegressionCompetitionScore: 0.13374233128834356

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.443


Validation scores:
	RegressionAUROC: 0.532256007194519
	RegressionCompetitionScore: 0.13374233128834356

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.434


Validation scores:
	RegressionAUROC: 0.5314335227012634
	RegressionCompetitionScore: 0.1322085889570552

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.426


Validation scores:
	RegressionAUROC: 0.5308160781860352
	RegressionCompetitionScore: 0.1294478527607362

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.419


Validation scores:
	RegressionAUROC: 0.5303124189376831
	RegressionCompetitionScore: 0.1273006134969325

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.410


Validation scores:
	RegressionAUROC: 0.5300502777099609
	RegressionCompetitionScore: 0.12607361963190183

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.402


Validation scores:
	RegressionAUROC: 0.5297116041183472
	RegressionCompetitionScore: 0.12515337423312883

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.395


Validation scores:
	RegressionAUROC: 0.5293596386909485
	RegressionCompetitionScore: 0.12331288343558282

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.388


Validation scores:
	RegressionAUROC: 0.5290224552154541
	RegressionCompetitionScore: 0.12269938650306748

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.381


Validation scores:
	RegressionAUROC: 0.5286742448806763
	RegressionCompetitionScore: 0.1245398773006135

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.374


Validation scores:
	RegressionAUROC: 0.5281810760498047
	RegressionCompetitionScore: 0.12269938650306748

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.367


Validation scores:
	RegressionAUROC: 0.5276497602462769
	RegressionCompetitionScore: 0.12177914110429448

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.360


Validation scores:
	RegressionAUROC: 0.5271696448326111
	RegressionCompetitionScore: 0.11871165644171779

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.354


Validation scores:
	RegressionAUROC: 0.5267611145973206
	RegressionCompetitionScore: 0.11779141104294479

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.348


Validation scores:
	RegressionAUROC: 0.5264325141906738
	RegressionCompetitionScore: 0.11779141104294479

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.342


Validation scores:
	RegressionAUROC: 0.5260778069496155
	RegressionCompetitionScore: 0.11595092024539877

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.336


Validation scores:
	RegressionAUROC: 0.525686502456665
	RegressionCompetitionScore: 0.11441717791411044

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.331


Validation scores:
	RegressionAUROC: 0.5253943800926208
	RegressionCompetitionScore: 0.11441717791411044

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.325


Validation scores:
	RegressionAUROC: 0.524887204170227
	RegressionCompetitionScore: 0.11441717791411044

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.320


Validation scores:
	RegressionAUROC: 0.5242654085159302
	RegressionCompetitionScore: 0.11349693251533742

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.315


Validation scores:
	RegressionAUROC: 0.5238848924636841
	RegressionCompetitionScore: 0.1116564417177914

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.310


Validation scores:
	RegressionAUROC: 0.5234519243240356
	RegressionCompetitionScore: 0.10889570552147239

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.305


Validation scores:
	RegressionAUROC: 0.5230472087860107
	RegressionCompetitionScore: 0.10828220858895705

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.300


Validation scores:
	RegressionAUROC: 0.5226858854293823
	RegressionCompetitionScore: 0.10858895705521472

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.296


Validation scores:
	RegressionAUROC: 0.5222185850143433
	RegressionCompetitionScore: 0.10797546012269939

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.291


Validation scores:
	RegressionAUROC: 0.5219493508338928
	RegressionCompetitionScore: 0.10736196319018405

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.287


Validation scores:
	RegressionAUROC: 0.5215787887573242
	RegressionCompetitionScore: 0.10644171779141104

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.283


Validation scores:
	RegressionAUROC: 0.5214051008224487
	RegressionCompetitionScore: 0.10644171779141104

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.279


Validation scores:
	RegressionAUROC: 0.5213130116462708
	RegressionCompetitionScore: 0.1049079754601227

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.276


Validation scores:
	RegressionAUROC: 0.5210859179496765
	RegressionCompetitionScore: 0.10429447852760736

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.272


Validation scores:
	RegressionAUROC: 0.5209776759147644
	RegressionCompetitionScore: 0.10429447852760736

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.269


Validation scores:
	RegressionAUROC: 0.5206523537635803
	RegressionCompetitionScore: 0.10337423312883436

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.266


Validation scores:
	RegressionAUROC: 0.5205386877059937
	RegressionCompetitionScore: 0.10429447852760736

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.263


Validation scores:
	RegressionAUROC: 0.5202029943466187
	RegressionCompetitionScore: 0.10460122699386504

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.260
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10460122699386504
     Test RegressionAUROC            0.5202029943466187
Test RegressionCompetitionScore      0.10460122699386504
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 05:08:10,505][0m Trial 345 finished with value: 0.10460122699386504 and parameters: {'lr': 1.8235121220031436e-07, 'dropout': 0.41631403192880806, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 208, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005615318123470195, 'dropout': 0.42332038443210707, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 177, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 36.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
36.9 K    Trainable params
0         Non-trainable params
36.9 K    Total params
0.148     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.256038635969162
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6511116027832031
	RegressionCompetitionScore: 0.23650306748466257

Metric val_loss improved. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6470643281936646
	RegressionCompetitionScore: 0.2549079754601227



Validation scores:
	RegressionAUROC: 0.6704775094985962
	RegressionCompetitionScore: 0.249079754601227



Validation scores:
	RegressionAUROC: 0.6852131485939026
	RegressionCompetitionScore: 0.2634969325153374



Validation scores:
	RegressionAUROC: 0.6795457601547241
	RegressionCompetitionScore: 0.26288343558282207



Validation scores:
	RegressionAUROC: 0.7018717527389526
	RegressionCompetitionScore: 0.27883435582822086



Validation scores:
	RegressionAUROC: 0.714812159538269
	RegressionCompetitionScore: 0.29386503067484665



Validation scores:
	RegressionAUROC: 0.7218368649482727
	RegressionCompetitionScore: 0.3487730061349693

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.195. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.23650306748466257
     Test RegressionAUROC            0.6511116027832031
Test RegressionCompetitionScore      0.23650306748466257
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 05:11:41,018][0m Trial 346 finished with value: 0.23650306748466257 and parameters: {'lr': 0.0005615318123470195, 'dropout': 0.42332038443210707, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 177, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005288978511540916, 'dropout': 0.407424940494077, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 214, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 39.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
39.5 K    Trainable params
0         Non-trainable params
39.5 K    Total params
0.158     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3357487916946411
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6505146622657776
	RegressionCompetitionScore: 0.12269938650306748

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6636573672294617
	RegressionCompetitionScore: 0.16441717791411042

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6769918203353882
	RegressionCompetitionScore: 0.2549079754601227

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7065337300300598
	RegressionCompetitionScore: 0.3254601226993865

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7085477113723755
	RegressionCompetitionScore: 0.32239263803680984



Validation scores:
	RegressionAUROC: 0.7284195423126221
	RegressionCompetitionScore: 0.3889570552147239

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7327377796173096
	RegressionCompetitionScore: 0.39171779141104296



Validation scores:
	RegressionAUROC: 0.7176316976547241
	RegressionCompetitionScore: 0.31012269938650305



Validation scores:
	RegressionAUROC: 0.7462217807769775
	RegressionCompetitionScore: 0.40061349693251536

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7543600797653198
	RegressionCompetitionScore: 0.39539877300613496



Validation scores:
	RegressionAUROC: 0.7626721858978271
	RegressionCompetitionScore: 0.3595092024539877

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7754751443862915
	RegressionCompetitionScore: 0.39846625766871163



Validation scores:
	RegressionAUROC: 0.7756185531616211
	RegressionCompetitionScore: 0.41503067484662576



Validation scores:
	RegressionAUROC: 0.7837573885917664
	RegressionCompetitionScore: 0.4214723926380368

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7860010266304016
	RegressionCompetitionScore: 0.43558282208588955

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7929694652557373
	RegressionCompetitionScore: 0.4156441717791411

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.158


Validation scores:
	RegressionAUROC: 0.778731107711792
	RegressionCompetitionScore: 0.40429447852760736



Validation scores:
	RegressionAUROC: 0.7842015624046326
	RegressionCompetitionScore: 0.4165644171779141



Validation scores:
	RegressionAUROC: 0.7866919040679932
	RegressionCompetitionScore: 0.39478527607361963



Validation scores:
	RegressionAUROC: 0.776116669178009
	RegressionCompetitionScore: 0.3920245398773006



Validation scores:
	RegressionAUROC: 0.7844117879867554
	RegressionCompetitionScore: 0.40644171779141103



Validation scores:
	RegressionAUROC: 0.8030084371566772
	RegressionCompetitionScore: 0.43895705521472395

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.154


Validation scores:
	RegressionAUROC: 0.7841253280639648
	RegressionCompetitionScore: 0.4377300613496933



Validation scores:
	RegressionAUROC: 0.8090664148330688
	RegressionCompetitionScore: 0.43558282208588955

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.152


Validation scores:
	RegressionAUROC: 0.7973036766052246
	RegressionCompetitionScore: 0.4322085889570552



Validation scores:
	RegressionAUROC: 0.7935789823532104
	RegressionCompetitionScore: 0.4469325153374233



Validation scores:
	RegressionAUROC: 0.7624576091766357
	RegressionCompetitionScore: 0.4217791411042945



Validation scores:
	RegressionAUROC: 0.7622240781784058
	RegressionCompetitionScore: 0.4196319018404908



Validation scores:
	RegressionAUROC: 0.7815403938293457
	RegressionCompetitionScore: 0.4260736196319018



Validation scores:
	RegressionAUROC: 0.7811720967292786
	RegressionCompetitionScore: 0.4303680981595092



Validation scores:
	RegressionAUROC: 0.7750797271728516
	RegressionCompetitionScore: 0.4322085889570552

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.152. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.43558282208588955
     Test RegressionAUROC            0.8090664148330688
Test RegressionCompetitionScore      0.43558282208588955
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 05:24:06,862][0m Trial 347 finished with value: 0.43558282208588955 and parameters: {'lr': 0.0005288978511540916, 'dropout': 0.407424940494077, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 214, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0007401543782180739, 'dropout': 0.411042660737083, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 225, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 44.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
44.4 K    Trainable params
0         Non-trainable params
44.4 K    Total params
0.177     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3526570200920105
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6419724225997925
	RegressionCompetitionScore: 0.14079754601226993

Metric val_loss improved. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.6628710627555847
	RegressionCompetitionScore: 0.17760736196319019

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.6735789179801941
	RegressionCompetitionScore: 0.18803680981595092



Validation scores:
	RegressionAUROC: 0.6972492933273315
	RegressionCompetitionScore: 0.22423312883435584

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.711179256439209
	RegressionCompetitionScore: 0.3432515337423313



Validation scores:
	RegressionAUROC: 0.731577455997467
	RegressionCompetitionScore: 0.34294478527607364



Validation scores:
	RegressionAUROC: 0.7273030281066895
	RegressionCompetitionScore: 0.36687116564417177



Validation scores:
	RegressionAUROC: 0.7300848364830017
	RegressionCompetitionScore: 0.34938650306748464

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7369101047515869
	RegressionCompetitionScore: 0.36134969325153377

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7430825233459473
	RegressionCompetitionScore: 0.35030674846625764



Validation scores:
	RegressionAUROC: 0.75284343957901
	RegressionCompetitionScore: 0.35030674846625764



Validation scores:
	RegressionAUROC: 0.7687334418296814
	RegressionCompetitionScore: 0.403680981595092



Validation scores:
	RegressionAUROC: 0.7628567218780518
	RegressionCompetitionScore: 0.37239263803680983



Validation scores:
	RegressionAUROC: 0.76902174949646
	RegressionCompetitionScore: 0.41411042944785276

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7660691738128662
	RegressionCompetitionScore: 0.3932515337423313



Validation scores:
	RegressionAUROC: 0.7798143625259399
	RegressionCompetitionScore: 0.4368098159509202

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7674118280410767
	RegressionCompetitionScore: 0.3656441717791411



Validation scores:
	RegressionAUROC: 0.7715710997581482
	RegressionCompetitionScore: 0.3895705521472393



Validation scores:
	RegressionAUROC: 0.7788326144218445
	RegressionCompetitionScore: 0.41503067484662576



Validation scores:
	RegressionAUROC: 0.7718579173088074
	RegressionCompetitionScore: 0.39539877300613496



Validation scores:
	RegressionAUROC: 0.7802820205688477
	RegressionCompetitionScore: 0.38987730061349696



Validation scores:
	RegressionAUROC: 0.7799960374832153
	RegressionCompetitionScore: 0.3920245398773006

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.157


Validation scores:
	RegressionAUROC: 0.7798317670822144
	RegressionCompetitionScore: 0.403680981595092



Validation scores:
	RegressionAUROC: 0.7742313742637634
	RegressionCompetitionScore: 0.3895705521472393



Validation scores:
	RegressionAUROC: 0.7768262624740601
	RegressionCompetitionScore: 0.36257668711656443



Validation scores:
	RegressionAUROC: 0.7902079820632935
	RegressionCompetitionScore: 0.42116564417177915



Validation scores:
	RegressionAUROC: 0.7722299695014954
	RegressionCompetitionScore: 0.37024539877300616



Validation scores:
	RegressionAUROC: 0.782691478729248
	RegressionCompetitionScore: 0.3914110429447853



Validation scores:
	RegressionAUROC: 0.7818597555160522
	RegressionCompetitionScore: 0.3834355828220859

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.157. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3920245398773006
     Test RegressionAUROC            0.7799960374832153
Test RegressionCompetitionScore      0.3920245398773006
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 05:35:47,247][0m Trial 348 finished with value: 0.3920245398773006 and parameters: {'lr': 0.0007401543782180739, 'dropout': 0.411042660737083, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 225, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005157408557187433, 'dropout': 0.40330071612063945, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 209, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 39.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
39.1 K    Trainable params
0         Non-trainable params
39.1 K    Total params
0.156     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5700483322143555
	RegressionCompetitionScore: 0.30434782608695654



Validation scores:
	RegressionAUROC: 0.6715329885482788
	RegressionCompetitionScore: 0.25398773006134967

Metric val_loss improved. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6969475746154785
	RegressionCompetitionScore: 0.3128834355828221



Validation scores:
	RegressionAUROC: 0.7182778716087341
	RegressionCompetitionScore: 0.3122699386503067

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.727492094039917
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.7280749082565308
	RegressionCompetitionScore: 0.3895705521472393



Validation scores:
	RegressionAUROC: 0.7262910008430481
	RegressionCompetitionScore: 0.37331288343558283

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7294423580169678
	RegressionCompetitionScore: 0.3763803680981595



Validation scores:
	RegressionAUROC: 0.728447675704956
	RegressionCompetitionScore: 0.3684049079754601



Validation scores:
	RegressionAUROC: 0.7421703338623047
	RegressionCompetitionScore: 0.41319018404907976



Validation scores:
	RegressionAUROC: 0.7473369240760803
	RegressionCompetitionScore: 0.35736196319018404



Validation scores:
	RegressionAUROC: 0.7399898171424866
	RegressionCompetitionScore: 0.3763803680981595



Validation scores:
	RegressionAUROC: 0.740624189376831
	RegressionCompetitionScore: 0.35



Validation scores:
	RegressionAUROC: 0.7331777215003967
	RegressionCompetitionScore: 0.3588957055214724

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37331288343558283
     Test RegressionAUROC            0.7262910008430481
Test RegressionCompetitionScore      0.37331288343558283
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 05:41:15,945][0m Trial 349 finished with value: 0.37331288343558283 and parameters: {'lr': 0.0005157408557187433, 'dropout': 0.40330071612063945, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 209, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.000892180433904771, 'dropout': 0.4113186184639902, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 192, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 45.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
45.1 K    Trainable params
0         Non-trainable params
45.1 K    Total params
0.181     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.43478262424468994
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.4899910092353821
	RegressionCompetitionScore: 0.1

Metric val_loss improved. New best score: 0.240


Validation scores:
	RegressionAUROC: 0.608991265296936
	RegressionCompetitionScore: 0.26134969325153373

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6697225570678711
	RegressionCompetitionScore: 0.2561349693251534

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6771202087402344
	RegressionCompetitionScore: 0.25950920245398773



Validation scores:
	RegressionAUROC: 0.6961530447006226
	RegressionCompetitionScore: 0.28957055214723926



Validation scores:
	RegressionAUROC: 0.6956397294998169
	RegressionCompetitionScore: 0.3

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7317403554916382
	RegressionCompetitionScore: 0.3469325153374233

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7297265529632568
	RegressionCompetitionScore: 0.34355828220858897



Validation scores:
	RegressionAUROC: 0.7467260360717773
	RegressionCompetitionScore: 0.36503067484662577



Validation scores:
	RegressionAUROC: 0.7525800466537476
	RegressionCompetitionScore: 0.38128834355828223



Validation scores:
	RegressionAUROC: 0.7387645244598389
	RegressionCompetitionScore: 0.36595092024539877



Validation scores:
	RegressionAUROC: 0.7580002546310425
	RegressionCompetitionScore: 0.3901840490797546

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7426372766494751
	RegressionCompetitionScore: 0.3398773006134969



Validation scores:
	RegressionAUROC: 0.7724418044090271
	RegressionCompetitionScore: 0.40153374233128836



Validation scores:
	RegressionAUROC: 0.7867732644081116
	RegressionCompetitionScore: 0.40429447852760736

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.8008009195327759
	RegressionCompetitionScore: 0.43742331288343556

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.156


Validation scores:
	RegressionAUROC: 0.7884045839309692
	RegressionCompetitionScore: 0.4361963190184049



Validation scores:
	RegressionAUROC: 0.7836620211601257
	RegressionCompetitionScore: 0.4236196319018405



Validation scores:
	RegressionAUROC: 0.7701427936553955
	RegressionCompetitionScore: 0.41595092024539876



Validation scores:
	RegressionAUROC: 0.7914187908172607
	RegressionCompetitionScore: 0.4414110429447853



Validation scores:
	RegressionAUROC: 0.7836799025535583
	RegressionCompetitionScore: 0.4116564417177914



Validation scores:
	RegressionAUROC: 0.7911583781242371
	RegressionCompetitionScore: 0.4162576687116564



Validation scores:
	RegressionAUROC: 0.7702678442001343
	RegressionCompetitionScore: 0.43374233128834355

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.156. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.43742331288343556
     Test RegressionAUROC            0.8008009195327759
Test RegressionCompetitionScore      0.43742331288343556
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 05:50:39,640][0m Trial 350 finished with value: 0.43742331288343556 and parameters: {'lr': 0.000892180433904771, 'dropout': 0.4113186184639902, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 192, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0009287856951210419, 'dropout': 0.42212109385869434, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 238, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 49.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
49.8 K    Trainable params
0         Non-trainable params
49.8 K    Total params
0.199     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6381433010101318
	RegressionCompetitionScore: 0.26932515337423313

Metric val_loss improved. New best score: 0.278


Validation scores:
	RegressionAUROC: 0.63401198387146
	RegressionCompetitionScore: 0.25

Metric val_loss improved by 0.068 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6328227519989014
	RegressionCompetitionScore: 0.21687116564417178



Validation scores:
	RegressionAUROC: 0.670881986618042
	RegressionCompetitionScore: 0.26411042944785273

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6929249167442322
	RegressionCompetitionScore: 0.29386503067484665



Validation scores:
	RegressionAUROC: 0.6899230480194092
	RegressionCompetitionScore: 0.31441717791411045



Validation scores:
	RegressionAUROC: 0.7148491144180298
	RegressionCompetitionScore: 0.34263803680981597

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7188875079154968
	RegressionCompetitionScore: 0.346319018404908



Validation scores:
	RegressionAUROC: 0.7264847159385681
	RegressionCompetitionScore: 0.33067484662576685



Validation scores:
	RegressionAUROC: 0.6923574209213257
	RegressionCompetitionScore: 0.18343558282208589



Validation scores:
	RegressionAUROC: 0.7186969518661499
	RegressionCompetitionScore: 0.34478527607361964



Validation scores:
	RegressionAUROC: 0.7249408960342407
	RegressionCompetitionScore: 0.33865030674846625



Validation scores:
	RegressionAUROC: 0.7314765453338623
	RegressionCompetitionScore: 0.33773006134969324

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7207627892494202
	RegressionCompetitionScore: 0.3230061349693252



Validation scores:
	RegressionAUROC: 0.7206231355667114
	RegressionCompetitionScore: 0.3567484662576687



Validation scores:
	RegressionAUROC: 0.7247359156608582
	RegressionCompetitionScore: 0.38190184049079756



Validation scores:
	RegressionAUROC: 0.7218183279037476
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7003563642501831
	RegressionCompetitionScore: 0.31441717791411045



Validation scores:
	RegressionAUROC: 0.7141939401626587
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7284230589866638
	RegressionCompetitionScore: 0.3521472392638037

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.186. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.33773006134969324
     Test RegressionAUROC            0.7314765453338623
Test RegressionCompetitionScore      0.33773006134969324
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 05:58:53,529][0m Trial 351 finished with value: 0.33773006134969324 and parameters: {'lr': 0.0009287856951210419, 'dropout': 0.42212109385869434, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 238, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005443196708575453, 'dropout': 0.40164641050328115, 'd_model_multiplier': 64, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 804, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 13.6 M
1 | loss_fn | MSELoss | 0     
------------------------------------
13.6 M    Trainable params
0         Non-trainable params
13.6 M    Total params
54.511    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 27.737


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 20.650 >= min_delta = 0.0. New best score: 7.087


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 6.474 >= min_delta = 0.0. New best score: 0.614


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.103 >= min_delta = 0.0. New best score: 0.511


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.45451366901397705
	RegressionCompetitionScore: 0.0785276073619632



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.042 >= min_delta = 0.0. New best score: 0.469


Validation scores:
	RegressionAUROC: 0.5923197269439697
	RegressionCompetitionScore: 0.18957055214723925

Metric val_loss improved by 0.153 >= min_delta = 0.0. New best score: 0.316


Validation scores:
	RegressionAUROC: 0.43484580516815186
	RegressionCompetitionScore: 0.0687116564417178

Metric val_loss improved by 0.087 >= min_delta = 0.0. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.48513537645339966
	RegressionCompetitionScore: 0.04969325153374233



Validation scores:
	RegressionAUROC: 0.600344181060791
	RegressionCompetitionScore: 0.19815950920245398

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5908451676368713
	RegressionCompetitionScore: 0.10766871165644172



Validation scores:
	RegressionAUROC: 0.5965186953544617
	RegressionCompetitionScore: 0.22269938650306748

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5273325443267822
	RegressionCompetitionScore: 0.0696319018404908



Validation scores:
	RegressionAUROC: 0.4861310124397278
	RegressionCompetitionScore: 0.004294478527607362



Validation scores:
	RegressionAUROC: 0.4859817326068878
	RegressionCompetitionScore: 0.03374233128834356

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5836218595504761
	RegressionCompetitionScore: 0.11104294478527607



Validation scores:
	RegressionAUROC: 0.43799829483032227
	RegressionCompetitionScore: 0.02116564417177914



Validation scores:
	RegressionAUROC: 0.5131114721298218
	RegressionCompetitionScore: 0.001226993865030675



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.48974913358688354
	RegressionCompetitionScore: 0.001226993865030675



Validation scores:
	RegressionAUROC: 0.49824029207229614
	RegressionCompetitionScore: 0.011349693251533743



Validation scores:
	RegressionAUROC: 0.5523866415023804
	RegressionCompetitionScore: 0.08466257668711656

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.03374233128834356
     Test RegressionAUROC            0.4859817326068878
Test RegressionCompetitionScore      0.03374233128834356
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 06:16:01,977][0m Trial 352 finished with value: 0.03374233128834356 and parameters: {'lr': 0.0005443196708575453, 'dropout': 0.40164641050328115, 'd_model_multiplier': 64, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 804, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0010913065476099645, 'dropout': 0.4276763721411337, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 194, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 49.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
49.0 K    Trainable params
0         Non-trainable params
49.0 K    Total params
0.196     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5024154186248779
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5778939127922058
	RegressionCompetitionScore: 0.10368098159509202

Metric val_loss improved. New best score: 0.327


Validation scores:
	RegressionAUROC: 0.6461118459701538
	RegressionCompetitionScore: 0.10429447852760736

Metric val_loss improved by 0.038 >= min_delta = 0.0. New best score: 0.289


Validation scores:
	RegressionAUROC: 0.6596179008483887
	RegressionCompetitionScore: 0.18128834355828222

Metric val_loss improved by 0.086 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6826832294464111
	RegressionCompetitionScore: 0.2067484662576687



Validation scores:
	RegressionAUROC: 0.691913366317749
	RegressionCompetitionScore: 0.23098159509202454

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.6852179765701294
	RegressionCompetitionScore: 0.2733128834355828

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7107342481613159
	RegressionCompetitionScore: 0.3371165644171779

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.6822841167449951
	RegressionCompetitionScore: 0.3107361963190184



Validation scores:
	RegressionAUROC: 0.7096957564353943
	RegressionCompetitionScore: 0.3337423312883436



Validation scores:
	RegressionAUROC: 0.7139822244644165
	RegressionCompetitionScore: 0.34938650306748464



Validation scores:
	RegressionAUROC: 0.7198659181594849
	RegressionCompetitionScore: 0.35644171779141104



Validation scores:
	RegressionAUROC: 0.721689760684967
	RegressionCompetitionScore: 0.349079754601227



Validation scores:
	RegressionAUROC: 0.7179002165794373
	RegressionCompetitionScore: 0.3039877300613497



Validation scores:
	RegressionAUROC: 0.7181488275527954
	RegressionCompetitionScore: 0.3058282208588957

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.180. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3371165644171779
     Test RegressionAUROC            0.7107342481613159
Test RegressionCompetitionScore      0.3371165644171779
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 06:21:58,400][0m Trial 353 finished with value: 0.3371165644171779 and parameters: {'lr': 0.0010913065476099645, 'dropout': 0.4276763721411337, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 194, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0007296955517904002, 'dropout': 0.41288227374158276, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 215, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 43.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
43.5 K    Trainable params
0         Non-trainable params
43.5 K    Total params
0.174     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7439613342285156
	RegressionCompetitionScore: 0.5217391304347826



Validation scores:
	RegressionAUROC: 0.5573387145996094
	RegressionCompetitionScore: 0.09693251533742331

Metric val_loss improved. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6369615793228149
	RegressionCompetitionScore: 0.13312883435582823



Validation scores:
	RegressionAUROC: 0.6618295907974243
	RegressionCompetitionScore: 0.13374233128834356

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6618003249168396
	RegressionCompetitionScore: 0.1754601226993865



Validation scores:
	RegressionAUROC: 0.633925199508667
	RegressionCompetitionScore: 0.18619631901840492



Validation scores:
	RegressionAUROC: 0.6388522386550903
	RegressionCompetitionScore: 0.25644171779141106



Validation scores:
	RegressionAUROC: 0.6699855327606201
	RegressionCompetitionScore: 0.2659509202453988



Validation scores:
	RegressionAUROC: 0.6754062175750732
	RegressionCompetitionScore: 0.27361963190184047



Validation scores:
	RegressionAUROC: 0.6782258749008179
	RegressionCompetitionScore: 0.2733128834355828

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.7012599110603333
	RegressionCompetitionScore: 0.2855828220858896



Validation scores:
	RegressionAUROC: 0.6949623823165894
	RegressionCompetitionScore: 0.28190184049079753

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6980328559875488
	RegressionCompetitionScore: 0.32699386503067485



Validation scores:
	RegressionAUROC: 0.7097947001457214
	RegressionCompetitionScore: 0.34570552147239264



Validation scores:
	RegressionAUROC: 0.7247833013534546
	RegressionCompetitionScore: 0.35184049079754603

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7253541350364685
	RegressionCompetitionScore: 0.3638036809815951

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7359572649002075
	RegressionCompetitionScore: 0.40337423312883436

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7715941667556763
	RegressionCompetitionScore: 0.3960122699386503

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7633644342422485
	RegressionCompetitionScore: 0.39631901840490796

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7711592316627502
	RegressionCompetitionScore: 0.4049079754601227

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.765680193901062
	RegressionCompetitionScore: 0.4196319018404908



Validation scores:
	RegressionAUROC: 0.7738305926322937
	RegressionCompetitionScore: 0.41779141104294476

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.160


Validation scores:
	RegressionAUROC: 0.781226634979248
	RegressionCompetitionScore: 0.4205521472392638



Validation scores:
	RegressionAUROC: 0.7762265205383301
	RegressionCompetitionScore: 0.451840490797546



Validation scores:
	RegressionAUROC: 0.772468626499176
	RegressionCompetitionScore: 0.4404907975460123



Validation scores:
	RegressionAUROC: 0.776701807975769
	RegressionCompetitionScore: 0.4447852760736196



Validation scores:
	RegressionAUROC: 0.7733631134033203
	RegressionCompetitionScore: 0.4322085889570552



Validation scores:
	RegressionAUROC: 0.7947787642478943
	RegressionCompetitionScore: 0.44079754601226995



Validation scores:
	RegressionAUROC: 0.7813920974731445
	RegressionCompetitionScore: 0.4199386503067485

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.160. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.41779141104294476
     Test RegressionAUROC            0.7738305926322937
Test RegressionCompetitionScore      0.41779141104294476
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 06:33:12,369][0m Trial 354 finished with value: 0.41779141104294476 and parameters: {'lr': 0.0007296955517904002, 'dropout': 0.41288227374158276, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 215, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004943073274253446, 'dropout': 0.4100999770987865, 'd_model_multiplier': 16, 'num_layers': 5, 'n_heads': 64, 'dim_feedforward': 203, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 24.1 M
1 | loss_fn | MSELoss | 0     
------------------------------------
24.1 M    Trainable params
0         Non-trainable params
24.1 M    Total params
96.219    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 319.345


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 50.116 >= min_delta = 0.0. New best score: 269.229


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 265.433 >= min_delta = 0.0. New best score: 3.796


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 2.728 >= min_delta = 0.0. New best score: 1.068


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.677 >= min_delta = 0.0. New best score: 0.392


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.46167272329330444
	RegressionCompetitionScore: 0.05122699386503068

Metric val_loss improved by 0.154 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5056715607643127
	RegressionCompetitionScore: 0.06656441717791411



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49762284755706787
	RegressionCompetitionScore: 0.0656441717791411

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.238. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.05122699386503068
     Test RegressionAUROC            0.46167272329330444
Test RegressionCompetitionScore      0.05122699386503068
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 06:56:03,543][0m Trial 355 finished with value: 0.05122699386503068 and parameters: {'lr': 0.0004943073274253446, 'dropout': 0.4100999770987865, 'd_model_multiplier': 16, 'num_layers': 5, 'n_heads': 64, 'dim_feedforward': 203, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0007386600315380593, 'dropout': 0.40120304335900636, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 221, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 48.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
48.1 K    Trainable params
0         Non-trainable params
48.1 K    Total params
0.192     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6714975833892822
	RegressionCompetitionScore: 0.34782608695652173



Validation scores:
	RegressionAUROC: 0.5467669367790222
	RegressionCompetitionScore: 0.10858895705521472

Metric val_loss improved. New best score: 0.242


Validation scores:
	RegressionAUROC: 0.616979718208313
	RegressionCompetitionScore: 0.2665644171779141

Metric val_loss improved by 0.034 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6780691146850586
	RegressionCompetitionScore: 0.2733128834355828

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.6747019290924072
	RegressionCompetitionScore: 0.252760736196319



Validation scores:
	RegressionAUROC: 0.6962790489196777
	RegressionCompetitionScore: 0.2911042944785276



Validation scores:
	RegressionAUROC: 0.7104628086090088
	RegressionCompetitionScore: 0.3205521472392638



Validation scores:
	RegressionAUROC: 0.716907799243927
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7292936444282532
	RegressionCompetitionScore: 0.37944785276073617



Validation scores:
	RegressionAUROC: 0.7481644153594971
	RegressionCompetitionScore: 0.35828220858895704

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.735749363899231
	RegressionCompetitionScore: 0.34263803680981597



Validation scores:
	RegressionAUROC: 0.7403312921524048
	RegressionCompetitionScore: 0.35184049079754603

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7511128187179565
	RegressionCompetitionScore: 0.3763803680981595



Validation scores:
	RegressionAUROC: 0.7472394704818726
	RegressionCompetitionScore: 0.3647239263803681



Validation scores:
	RegressionAUROC: 0.7497761249542236
	RegressionCompetitionScore: 0.3806748466257669



Validation scores:
	RegressionAUROC: 0.7624258995056152
	RegressionCompetitionScore: 0.3895705521472393

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7618603706359863
	RegressionCompetitionScore: 0.40950920245398775



Validation scores:
	RegressionAUROC: 0.7675088047981262
	RegressionCompetitionScore: 0.3843558282208589



Validation scores:
	RegressionAUROC: 0.762688159942627
	RegressionCompetitionScore: 0.3834355828220859



Validation scores:
	RegressionAUROC: 0.7728608250617981
	RegressionCompetitionScore: 0.4088957055214724



Validation scores:
	RegressionAUROC: 0.7676483392715454
	RegressionCompetitionScore: 0.39570552147239263



Validation scores:
	RegressionAUROC: 0.7689255475997925
	RegressionCompetitionScore: 0.35460122699386504



Validation scores:
	RegressionAUROC: 0.7814961671829224
	RegressionCompetitionScore: 0.402760736196319

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7712677717208862
	RegressionCompetitionScore: 0.404601226993865



Validation scores:
	RegressionAUROC: 0.7754706740379333
	RegressionCompetitionScore: 0.38374233128834356



Validation scores:
	RegressionAUROC: 0.7771786451339722
	RegressionCompetitionScore: 0.39631901840490796



Validation scores:
	RegressionAUROC: 0.7708743214607239
	RegressionCompetitionScore: 0.3932515337423313



Validation scores:
	RegressionAUROC: 0.7782239317893982
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7702833414077759
	RegressionCompetitionScore: 0.4110429447852761



Validation scores:
	RegressionAUROC: 0.769515335559845
	RegressionCompetitionScore: 0.39263803680981596

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.172. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.402760736196319
     Test RegressionAUROC            0.7814961671829224
Test RegressionCompetitionScore       0.402760736196319
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 07:07:45,154][0m Trial 356 finished with value: 0.402760736196319 and parameters: {'lr': 0.0007386600315380593, 'dropout': 0.40120304335900636, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 221, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005166935860627919, 'dropout': 0.4129821647209268, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 249, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 46.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
46.4 K    Trainable params
0         Non-trainable params
46.4 K    Total params
0.186     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3164251148700714
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6613242626190186
	RegressionCompetitionScore: 0.11840490797546012

Metric val_loss improved. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6922650337219238
	RegressionCompetitionScore: 0.2855828220858896

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6899486184120178
	RegressionCompetitionScore: 0.2757668711656442

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6999878883361816
	RegressionCompetitionScore: 0.2822085889570552

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7190068960189819
	RegressionCompetitionScore: 0.34049079754601225



Validation scores:
	RegressionAUROC: 0.7125177383422852
	RegressionCompetitionScore: 0.3187116564417178



Validation scores:
	RegressionAUROC: 0.7427338361740112
	RegressionCompetitionScore: 0.37760736196319017



Validation scores:
	RegressionAUROC: 0.7321628332138062
	RegressionCompetitionScore: 0.3754601226993865



Validation scores:
	RegressionAUROC: 0.7310006618499756
	RegressionCompetitionScore: 0.37852760736196317



Validation scores:
	RegressionAUROC: 0.7490003705024719
	RegressionCompetitionScore: 0.3914110429447853



Validation scores:
	RegressionAUROC: 0.7447082996368408
	RegressionCompetitionScore: 0.43895705521472395

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.185. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2822085889570552
     Test RegressionAUROC            0.6999878883361816
Test RegressionCompetitionScore      0.2822085889570552
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 07:12:25,945][0m Trial 357 finished with value: 0.2822085889570552 and parameters: {'lr': 0.0005166935860627919, 'dropout': 0.4129821647209268, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 249, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0007034522962205773, 'dropout': 0.6265117397007607, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 218, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 43.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
43.8 K    Trainable params
0         Non-trainable params
43.8 K    Total params
0.175     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5748792290687561
	RegressionCompetitionScore: 0.34782608695652173



Validation scores:
	RegressionAUROC: 0.6131810545921326
	RegressionCompetitionScore: 0.09907975460122699

Metric val_loss improved. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6152283549308777
	RegressionCompetitionScore: 0.09631901840490797



Validation scores:
	RegressionAUROC: 0.6219544410705566
	RegressionCompetitionScore: 0.09693251533742331



Validation scores:
	RegressionAUROC: 0.5797744393348694
	RegressionCompetitionScore: 0.09846625766871166



Validation scores:
	RegressionAUROC: 0.5093259811401367
	RegressionCompetitionScore: 0.09233128834355828

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5356540679931641
	RegressionCompetitionScore: 0.09447852760736196



Validation scores:
	RegressionAUROC: 0.5336840152740479
	RegressionCompetitionScore: 0.09662576687116564



Validation scores:
	RegressionAUROC: 0.5379465818405151
	RegressionCompetitionScore: 0.09478527607361963



Validation scores:
	RegressionAUROC: 0.5947616100311279
	RegressionCompetitionScore: 0.09202453987730061



Validation scores:
	RegressionAUROC: 0.5786975622177124
	RegressionCompetitionScore: 0.09601226993865031



Validation scores:
	RegressionAUROC: 0.5603978633880615
	RegressionCompetitionScore: 0.09754601226993866



Validation scores:
	RegressionAUROC: 0.5359809994697571
	RegressionCompetitionScore: 0.10613496932515337

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5424045920372009
	RegressionCompetitionScore: 0.1067484662576687



Validation scores:
	RegressionAUROC: 0.5331892371177673
	RegressionCompetitionScore: 0.1067484662576687



Validation scores:
	RegressionAUROC: 0.5830178260803223
	RegressionCompetitionScore: 0.11595092024539877



Validation scores:
	RegressionAUROC: 0.5453957319259644
	RegressionCompetitionScore: 0.12208588957055215



Validation scores:
	RegressionAUROC: 0.5371280908584595
	RegressionCompetitionScore: 0.12607361963190183



Validation scores:
	RegressionAUROC: 0.6287974119186401
	RegressionCompetitionScore: 0.1276073619631902



Validation scores:
	RegressionAUROC: 0.616633415222168
	RegressionCompetitionScore: 0.14049079754601226

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6239007711410522
	RegressionCompetitionScore: 0.14938650306748466



Validation scores:
	RegressionAUROC: 0.663752555847168
	RegressionCompetitionScore: 0.30828220858895705



Validation scores:
	RegressionAUROC: 0.6533085703849792
	RegressionCompetitionScore: 0.2920245398773006



Validation scores:
	RegressionAUROC: 0.6456767320632935
	RegressionCompetitionScore: 0.2892638036809816



Validation scores:
	RegressionAUROC: 0.6614782810211182
	RegressionCompetitionScore: 0.2644171779141104



Validation scores:
	RegressionAUROC: 0.6578087210655212
	RegressionCompetitionScore: 0.30920245398773005

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6674057245254517
	RegressionCompetitionScore: 0.2696319018404908



Validation scores:
	RegressionAUROC: 0.6367056369781494
	RegressionCompetitionScore: 0.3049079754601227



Validation scores:
	RegressionAUROC: 0.5679142475128174
	RegressionCompetitionScore: 0.13680981595092023



Validation scores:
	RegressionAUROC: 0.6537340879440308
	RegressionCompetitionScore: 0.3067484662576687



Validation scores:
	RegressionAUROC: 0.6359319090843201
	RegressionCompetitionScore: 0.3165644171779141



Validation scores:
	RegressionAUROC: 0.6616562008857727
	RegressionCompetitionScore: 0.2926380368098159

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6428053379058838
	RegressionCompetitionScore: 0.2880368098159509



Validation scores:
	RegressionAUROC: 0.6411969065666199
	RegressionCompetitionScore: 0.28404907975460125



Validation scores:
	RegressionAUROC: 0.5011991262435913
	RegressionCompetitionScore: 0.08742331288343558



Validation scores:
	RegressionAUROC: 0.6494095921516418
	RegressionCompetitionScore: 0.2883435582822086



Validation scores:
	RegressionAUROC: 0.6549458503723145
	RegressionCompetitionScore: 0.29233128834355826



Validation scores:
	RegressionAUROC: 0.640486478805542
	RegressionCompetitionScore: 0.29325153374233126



Validation scores:
	RegressionAUROC: 0.6301665306091309
	RegressionCompetitionScore: 0.25644171779141106

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.200. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2926380368098159
     Test RegressionAUROC            0.6616562008857727
Test RegressionCompetitionScore      0.2926380368098159
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 07:27:34,888][0m Trial 358 finished with value: 0.2926380368098159 and parameters: {'lr': 0.0007034522962205773, 'dropout': 0.6265117397007607, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 218, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0018938927685576816, 'dropout': 0.43286343655285725, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 184, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 40.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
40.9 K    Trainable params
0         Non-trainable params
40.9 K    Total params
0.163     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7463767528533936
	RegressionCompetitionScore: 0.5652173913043478



Validation scores:
	RegressionAUROC: 0.6314268112182617
	RegressionCompetitionScore: 0.10061349693251534

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.627810001373291
	RegressionCompetitionScore: 0.2754601226993865



Validation scores:
	RegressionAUROC: 0.6546367406845093
	RegressionCompetitionScore: 0.26411042944785273

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6744997501373291
	RegressionCompetitionScore: 0.28680981595092025



Validation scores:
	RegressionAUROC: 0.6722525358200073
	RegressionCompetitionScore: 0.27423312883435585



Validation scores:
	RegressionAUROC: 0.6918888092041016
	RegressionCompetitionScore: 0.2763803680981595

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6946172118186951
	RegressionCompetitionScore: 0.3159509202453988



Validation scores:
	RegressionAUROC: 0.6688312292098999
	RegressionCompetitionScore: 0.31441717791411045



Validation scores:
	RegressionAUROC: 0.6871589422225952
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6746060848236084
	RegressionCompetitionScore: 0.31717791411042945



Validation scores:
	RegressionAUROC: 0.6551816463470459
	RegressionCompetitionScore: 0.29049079754601226



Validation scores:
	RegressionAUROC: 0.6560710668563843
	RegressionCompetitionScore: 0.28251533742331286



Validation scores:
	RegressionAUROC: 0.6800958514213562
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.189. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2763803680981595
     Test RegressionAUROC            0.6918888092041016
Test RegressionCompetitionScore      0.2763803680981595
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 07:33:01,173][0m Trial 359 finished with value: 0.2763803680981595 and parameters: {'lr': 0.0018938927685576816, 'dropout': 0.43286343655285725, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 184, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.001253720167793141, 'dropout': 0.7850416969672137, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 188, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 44.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
44.7 K    Trainable params
0         Non-trainable params
44.7 K    Total params
0.179     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.408035546541214
	RegressionCompetitionScore: 0.07668711656441718

Metric val_loss improved. New best score: 0.461


Validation scores:
	RegressionAUROC: 0.39562109112739563
	RegressionCompetitionScore: 0.10245398773006135

Metric val_loss improved by 0.076 >= min_delta = 0.0. New best score: 0.385


Validation scores:
	RegressionAUROC: 0.4097307026386261
	RegressionCompetitionScore: 0.10184049079754601



Validation scores:
	RegressionAUROC: 0.4143871068954468
	RegressionCompetitionScore: 0.10521472392638037



Validation scores:
	RegressionAUROC: 0.40980756282806396
	RegressionCompetitionScore: 0.11595092024539877



Validation scores:
	RegressionAUROC: 0.41627299785614014
	RegressionCompetitionScore: 0.11717791411042945



Validation scores:
	RegressionAUROC: 0.4253356456756592
	RegressionCompetitionScore: 0.1205521472392638

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.380


Validation scores:
	RegressionAUROC: 0.42706024646759033
	RegressionCompetitionScore: 0.10521472392638037

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.369


Validation scores:
	RegressionAUROC: 0.4253501296043396
	RegressionCompetitionScore: 0.09447852760736196

Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.326


Validation scores:
	RegressionAUROC: 0.42663633823394775
	RegressionCompetitionScore: 0.07392638036809816



Validation scores:
	RegressionAUROC: 0.4268399477005005
	RegressionCompetitionScore: 0.07607361963190185

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.289


Validation scores:
	RegressionAUROC: 0.4258694052696228
	RegressionCompetitionScore: 0.09110429447852761

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.263


Validation scores:
	RegressionAUROC: 0.4263184070587158
	RegressionCompetitionScore: 0.1



Validation scores:
	RegressionAUROC: 0.4288714528083801
	RegressionCompetitionScore: 0.10644171779141104

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.257


Validation scores:
	RegressionAUROC: 0.423908531665802
	RegressionCompetitionScore: 0.11104294478527607



Validation scores:
	RegressionAUROC: 0.42196035385131836
	RegressionCompetitionScore: 0.1049079754601227

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.254


Validation scores:
	RegressionAUROC: 0.42294949293136597
	RegressionCompetitionScore: 0.10521472392638037

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.241


Validation scores:
	RegressionAUROC: 0.4183182716369629
	RegressionCompetitionScore: 0.10368098159509202



Validation scores:
	RegressionAUROC: 0.4210147261619568
	RegressionCompetitionScore: 0.09447852760736196



Validation scores:
	RegressionAUROC: 0.4178048372268677
	RegressionCompetitionScore: 0.08742331288343558



Validation scores:
	RegressionAUROC: 0.4198797047138214
	RegressionCompetitionScore: 0.08803680981595093



Validation scores:
	RegressionAUROC: 0.42609983682632446
	RegressionCompetitionScore: 0.09202453987730061

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.4248352646827698
	RegressionCompetitionScore: 0.09079754601226994

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.42984914779663086
	RegressionCompetitionScore: 0.07269938650306748



Validation scores:
	RegressionAUROC: 0.42973631620407104
	RegressionCompetitionScore: 0.05920245398773006



Validation scores:
	RegressionAUROC: 0.4300289750099182
	RegressionCompetitionScore: 0.0598159509202454



Validation scores:
	RegressionAUROC: 0.4306056797504425
	RegressionCompetitionScore: 0.05889570552147239

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.4171421527862549
	RegressionCompetitionScore: 0.07024539877300613



Validation scores:
	RegressionAUROC: 0.4322529137134552
	RegressionCompetitionScore: 0.07423312883435583



Validation scores:
	RegressionAUROC: 0.46178001165390015
	RegressionCompetitionScore: 0.08220858895705521



Validation scores:
	RegressionAUROC: 0.6248060464859009
	RegressionCompetitionScore: 0.23680981595092024



Validation scores:
	RegressionAUROC: 0.5604817867279053
	RegressionCompetitionScore: 0.17822085889570552

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5458151698112488
	RegressionCompetitionScore: 0.11901840490797547



Validation scores:
	RegressionAUROC: 0.5561937689781189
	RegressionCompetitionScore: 0.15030674846625766



Validation scores:
	RegressionAUROC: 0.5537086725234985
	RegressionCompetitionScore: 0.14447852760736196



Validation scores:
	RegressionAUROC: 0.5401815176010132
	RegressionCompetitionScore: 0.100920245398773



Validation scores:
	RegressionAUROC: 0.5063879489898682
	RegressionCompetitionScore: 0.06319018404907975



Validation scores:
	RegressionAUROC: 0.5389736890792847
	RegressionCompetitionScore: 0.10920245398773006



Validation scores:
	RegressionAUROC: 0.5717560052871704
	RegressionCompetitionScore: 0.13312883435582823

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.17822085889570552
     Test RegressionAUROC            0.5604817867279053
Test RegressionCompetitionScore      0.17822085889570552
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 07:48:34,937][0m Trial 360 finished with value: 0.17822085889570552 and parameters: {'lr': 0.001253720167793141, 'dropout': 0.7850416969672137, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 188, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00042093906002222336, 'dropout': 0.42423328592951914, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 215, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 43.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
43.5 K    Trainable params
0         Non-trainable params
43.5 K    Total params
0.174     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6512523889541626
	RegressionCompetitionScore: 0.1196319018404908

Metric val_loss improved. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.6293193101882935
	RegressionCompetitionScore: 0.27423312883435585

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6426243782043457
	RegressionCompetitionScore: 0.26932515337423313

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.681475818157196
	RegressionCompetitionScore: 0.28773006134969326

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7141029238700867
	RegressionCompetitionScore: 0.3334355828220859

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.6824504733085632
	RegressionCompetitionScore: 0.2950920245398773



Validation scores:
	RegressionAUROC: 0.69637131690979
	RegressionCompetitionScore: 0.302760736196319



Validation scores:
	RegressionAUROC: 0.7003263235092163
	RegressionCompetitionScore: 0.3095092024539877



Validation scores:
	RegressionAUROC: 0.7017580270767212
	RegressionCompetitionScore: 0.34846625766871164



Validation scores:
	RegressionAUROC: 0.7056430578231812
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7146727442741394
	RegressionCompetitionScore: 0.34386503067484664



Validation scores:
	RegressionAUROC: 0.7187094688415527
	RegressionCompetitionScore: 0.34846625766871164

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.178. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3334355828220859
     Test RegressionAUROC            0.7141029238700867
Test RegressionCompetitionScore      0.3334355828220859
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 07:53:41,520][0m Trial 361 finished with value: 0.3334355828220859 and parameters: {'lr': 0.00042093906002222336, 'dropout': 0.42423328592951914, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 215, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.000949948515682918, 'dropout': 0.5807105911461098, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 271, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 43.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
43.3 K    Trainable params
0         Non-trainable params
43.3 K    Total params
0.173     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3913043141365051
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6083211898803711
	RegressionCompetitionScore: 0.19938650306748465

Metric val_loss improved. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6678077578544617
	RegressionCompetitionScore: 0.26993865030674846



Validation scores:
	RegressionAUROC: 0.6403765678405762
	RegressionCompetitionScore: 0.24938650306748467



Validation scores:
	RegressionAUROC: 0.6181094646453857
	RegressionCompetitionScore: 0.2273006134969325



Validation scores:
	RegressionAUROC: 0.6244401931762695
	RegressionCompetitionScore: 0.2570552147239264



Validation scores:
	RegressionAUROC: 0.6652121543884277
	RegressionCompetitionScore: 0.24079754601226994



Validation scores:
	RegressionAUROC: 0.6788701415061951
	RegressionCompetitionScore: 0.16411042944785276



Validation scores:
	RegressionAUROC: 0.6887362003326416
	RegressionCompetitionScore: 0.15950920245398773

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6731109619140625
	RegressionCompetitionScore: 0.26196319018404907



Validation scores:
	RegressionAUROC: 0.674852192401886
	RegressionCompetitionScore: 0.2598159509202454



Validation scores:
	RegressionAUROC: 0.6709201335906982
	RegressionCompetitionScore: 0.2659509202453988

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6696895360946655
	RegressionCompetitionScore: 0.2987730061349693

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6705349683761597
	RegressionCompetitionScore: 0.2776073619631902

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6964825391769409
	RegressionCompetitionScore: 0.3214723926380368



Validation scores:
	RegressionAUROC: 0.7020889520645142
	RegressionCompetitionScore: 0.3184049079754601



Validation scores:
	RegressionAUROC: 0.6760668158531189
	RegressionCompetitionScore: 0.3469325153374233



Validation scores:
	RegressionAUROC: 0.6753997802734375
	RegressionCompetitionScore: 0.3496932515337423

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.676184356212616
	RegressionCompetitionScore: 0.28251533742331286

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6818586587905884
	RegressionCompetitionScore: 0.2223926380368098



Validation scores:
	RegressionAUROC: 0.6894047260284424
	RegressionCompetitionScore: 0.23773006134969324



Validation scores:
	RegressionAUROC: 0.6951066255569458
	RegressionCompetitionScore: 0.23680981595092024

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.6809442639350891
	RegressionCompetitionScore: 0.1901840490797546



Validation scores:
	RegressionAUROC: 0.6573899984359741
	RegressionCompetitionScore: 0.14263803680981596



Validation scores:
	RegressionAUROC: 0.6743185520172119
	RegressionCompetitionScore: 0.18957055214723925



Validation scores:
	RegressionAUROC: 0.6720144748687744
	RegressionCompetitionScore: 0.17423312883435582



Validation scores:
	RegressionAUROC: 0.6677017211914062
	RegressionCompetitionScore: 0.17576687116564418



Validation scores:
	RegressionAUROC: 0.6460071206092834
	RegressionCompetitionScore: 0.1696319018404908



Validation scores:
	RegressionAUROC: 0.6650482416152954
	RegressionCompetitionScore: 0.19662576687116565

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.192. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.23680981595092024
     Test RegressionAUROC            0.6951066255569458
Test RegressionCompetitionScore      0.23680981595092024
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 08:04:46,451][0m Trial 362 finished with value: 0.23680981595092024 and parameters: {'lr': 0.000949948515682918, 'dropout': 0.5807105911461098, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 271, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00045628139458148674, 'dropout': 0.41670918053092154, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 168, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 36.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
36.3 K    Trainable params
0         Non-trainable params
36.3 K    Total params
0.145     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.30917873978614807
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6568840146064758
	RegressionCompetitionScore: 0.2184049079754601

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6794087886810303
	RegressionCompetitionScore: 0.1441717791411043



Validation scores:
	RegressionAUROC: 0.6998549699783325
	RegressionCompetitionScore: 0.13282208588957056



Validation scores:
	RegressionAUROC: 0.708734393119812
	RegressionCompetitionScore: 0.20368098159509201



Validation scores:
	RegressionAUROC: 0.7179813385009766
	RegressionCompetitionScore: 0.2837423312883436



Validation scores:
	RegressionAUROC: 0.7392233610153198
	RegressionCompetitionScore: 0.36595092024539877

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7463229894638062
	RegressionCompetitionScore: 0.38128834355828223



Validation scores:
	RegressionAUROC: 0.7399407625198364
	RegressionCompetitionScore: 0.37024539877300616



Validation scores:
	RegressionAUROC: 0.7338453531265259
	RegressionCompetitionScore: 0.3647239263803681



Validation scores:
	RegressionAUROC: 0.7413159608840942
	RegressionCompetitionScore: 0.3852760736196319



Validation scores:
	RegressionAUROC: 0.7406694293022156
	RegressionCompetitionScore: 0.37699386503067484



Validation scores:
	RegressionAUROC: 0.754084587097168
	RegressionCompetitionScore: 0.38558282208588956



Validation scores:
	RegressionAUROC: 0.7134115695953369
	RegressionCompetitionScore: 0.2411042944785276

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.172. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36595092024539877
     Test RegressionAUROC            0.7392233610153198
Test RegressionCompetitionScore      0.36595092024539877
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 08:10:12,501][0m Trial 363 finished with value: 0.36595092024539877 and parameters: {'lr': 0.00045628139458148674, 'dropout': 0.41670918053092154, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 168, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.000693668143424307, 'dropout': 0.4005531258564602, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 191, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 45.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
45.0 K    Trainable params
0         Non-trainable params
45.0 K    Total params
0.180     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6445906162261963
	RegressionCompetitionScore: 0.09447852760736196

Metric val_loss improved. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6548652648925781
	RegressionCompetitionScore: 0.08496932515337423

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6453412771224976
	RegressionCompetitionScore: 0.09386503067484663



Validation scores:
	RegressionAUROC: 0.6789562702178955
	RegressionCompetitionScore: 0.301840490797546

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.7012544870376587
	RegressionCompetitionScore: 0.3085889570552147

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7145944833755493
	RegressionCompetitionScore: 0.34049079754601225



Validation scores:
	RegressionAUROC: 0.6938506364822388
	RegressionCompetitionScore: 0.3107361963190184



Validation scores:
	RegressionAUROC: 0.7044476270675659
	RegressionCompetitionScore: 0.31809815950920245



Validation scores:
	RegressionAUROC: 0.728853702545166
	RegressionCompetitionScore: 0.35644171779141104



Validation scores:
	RegressionAUROC: 0.735721230506897
	RegressionCompetitionScore: 0.3389570552147239



Validation scores:
	RegressionAUROC: 0.7301087379455566
	RegressionCompetitionScore: 0.3398773006134969



Validation scores:
	RegressionAUROC: 0.7510641813278198
	RegressionCompetitionScore: 0.35276073619631904

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7426396012306213
	RegressionCompetitionScore: 0.3579754601226994

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7414714694023132
	RegressionCompetitionScore: 0.37607361963190183



Validation scores:
	RegressionAUROC: 0.7453079223632812
	RegressionCompetitionScore: 0.3684049079754601



Validation scores:
	RegressionAUROC: 0.7575498819351196
	RegressionCompetitionScore: 0.3929447852760736

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7487605810165405
	RegressionCompetitionScore: 0.402760736196319



Validation scores:
	RegressionAUROC: 0.7570928335189819
	RegressionCompetitionScore: 0.3806748466257669



Validation scores:
	RegressionAUROC: 0.7549387216567993
	RegressionCompetitionScore: 0.40644171779141103



Validation scores:
	RegressionAUROC: 0.7501444816589355
	RegressionCompetitionScore: 0.3506134969325153



Validation scores:
	RegressionAUROC: 0.753236711025238
	RegressionCompetitionScore: 0.4144171779141104



Validation scores:
	RegressionAUROC: 0.7562199831008911
	RegressionCompetitionScore: 0.405521472392638



Validation scores:
	RegressionAUROC: 0.7501347064971924
	RegressionCompetitionScore: 0.3647239263803681

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3929447852760736
     Test RegressionAUROC            0.7575498819351196
Test RegressionCompetitionScore      0.3929447852760736
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 08:19:27,486][0m Trial 364 finished with value: 0.3929447852760736 and parameters: {'lr': 0.000693668143424307, 'dropout': 0.4005531258564602, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 191, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005852101788683497, 'dropout': 0.4350366844944357, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 240, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 41.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
41.2 K    Trainable params
0         Non-trainable params
41.2 K    Total params
0.165     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6570048332214355
	RegressionCompetitionScore: 0.34782608695652173



Validation scores:
	RegressionAUROC: 0.6568105220794678
	RegressionCompetitionScore: 0.25828220858895706

Metric val_loss improved. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6957552433013916
	RegressionCompetitionScore: 0.3058282208588957

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7243417501449585
	RegressionCompetitionScore: 0.3079754601226994



Validation scores:
	RegressionAUROC: 0.7176207304000854
	RegressionCompetitionScore: 0.2929447852760736

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.702602744102478
	RegressionCompetitionScore: 0.30828220858895705

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.728859543800354
	RegressionCompetitionScore: 0.37300613496932516



Validation scores:
	RegressionAUROC: 0.7237840294837952
	RegressionCompetitionScore: 0.3619631901840491



Validation scores:
	RegressionAUROC: 0.7357097864151001
	RegressionCompetitionScore: 0.37760736196319017



Validation scores:
	RegressionAUROC: 0.7354840040206909
	RegressionCompetitionScore: 0.3803680981595092



Validation scores:
	RegressionAUROC: 0.7472221851348877
	RegressionCompetitionScore: 0.348159509202454



Validation scores:
	RegressionAUROC: 0.7429264187812805
	RegressionCompetitionScore: 0.34754601226993864



Validation scores:
	RegressionAUROC: 0.7496906518936157
	RegressionCompetitionScore: 0.37576687116564417

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7464932799339294
	RegressionCompetitionScore: 0.3628834355828221



Validation scores:
	RegressionAUROC: 0.7499978542327881
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.7418813705444336
	RegressionCompetitionScore: 0.31625766871165645



Validation scores:
	RegressionAUROC: 0.7591691017150879
	RegressionCompetitionScore: 0.3871165644171779



Validation scores:
	RegressionAUROC: 0.7436770796775818
	RegressionCompetitionScore: 0.3693251533742331



Validation scores:
	RegressionAUROC: 0.7578480839729309
	RegressionCompetitionScore: 0.37668711656441717



Validation scores:
	RegressionAUROC: 0.7600604295730591
	RegressionCompetitionScore: 0.37331288343558283

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37576687116564417
     Test RegressionAUROC            0.7496906518936157
Test RegressionCompetitionScore      0.37576687116564417
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 08:27:08,495][0m Trial 365 finished with value: 0.37576687116564417 and parameters: {'lr': 0.0005852101788683497, 'dropout': 0.4350366844944357, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 240, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 7.354417098992898e-07, 'dropout': 0.4180996420063778, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 163, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 39.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
39.1 K    Trainable params
0         Non-trainable params
39.1 K    Total params
0.156     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49977806210517883
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.017


Validation scores:
	RegressionAUROC: 0.5011751055717468
	RegressionCompetitionScore: 0.0036809815950920245

Metric val_loss improved by 0.214 >= min_delta = 0.0. New best score: 0.803


Validation scores:
	RegressionAUROC: 0.5362200140953064
	RegressionCompetitionScore: 0.1322085889570552

Metric val_loss improved by 0.188 >= min_delta = 0.0. New best score: 0.615


Validation scores:
	RegressionAUROC: 0.5137404203414917
	RegressionCompetitionScore: 0.1423312883435583

Metric val_loss improved by 0.154 >= min_delta = 0.0. New best score: 0.461


Validation scores:
	RegressionAUROC: 0.5159648060798645
	RegressionCompetitionScore: 0.14938650306748466

Metric val_loss improved by 0.111 >= min_delta = 0.0. New best score: 0.351


Validation scores:
	RegressionAUROC: 0.5183382034301758
	RegressionCompetitionScore: 0.15552147239263803

Metric val_loss improved by 0.071 >= min_delta = 0.0. New best score: 0.280


Validation scores:
	RegressionAUROC: 0.5200467109680176
	RegressionCompetitionScore: 0.15736196319018406

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.248


Validation scores:
	RegressionAUROC: 0.5219905376434326
	RegressionCompetitionScore: 0.15644171779141106

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.5229122638702393
	RegressionCompetitionScore: 0.1598159509202454

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.5229058265686035
	RegressionCompetitionScore: 0.15950920245398773

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.5236729979515076
	RegressionCompetitionScore: 0.1628834355828221

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.524971604347229
	RegressionCompetitionScore: 0.16441717791411042

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5248031616210938
	RegressionCompetitionScore: 0.16809815950920245

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.525275468826294
	RegressionCompetitionScore: 0.16717791411042945



Validation scores:
	RegressionAUROC: 0.5259277820587158
	RegressionCompetitionScore: 0.16809815950920245

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5263949632644653
	RegressionCompetitionScore: 0.1677914110429448

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5265980958938599
	RegressionCompetitionScore: 0.16809815950920245

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5269283056259155
	RegressionCompetitionScore: 0.1696319018404908



Validation scores:
	RegressionAUROC: 0.5274981260299683
	RegressionCompetitionScore: 0.1687116564417178



Validation scores:
	RegressionAUROC: 0.5273924469947815
	RegressionCompetitionScore: 0.1687116564417178



Validation scores:
	RegressionAUROC: 0.5292144417762756
	RegressionCompetitionScore: 0.17239263803680982

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.5296974182128906
	RegressionCompetitionScore: 0.1705521472392638

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.5301306247711182
	RegressionCompetitionScore: 0.17177914110429449



Validation scores:
	RegressionAUROC: 0.5310412049293518
	RegressionCompetitionScore: 0.17239263803680982



Validation scores:
	RegressionAUROC: 0.5321455001831055
	RegressionCompetitionScore: 0.17208588957055215



Validation scores:
	RegressionAUROC: 0.5308364629745483
	RegressionCompetitionScore: 0.17392638036809815

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.5306875705718994
	RegressionCompetitionScore: 0.1736196319018405

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.5318140983581543
	RegressionCompetitionScore: 0.17484662576687116



Validation scores:
	RegressionAUROC: 0.5323718190193176
	RegressionCompetitionScore: 0.17576687116564418



Validation scores:
	RegressionAUROC: 0.5331348180770874
	RegressionCompetitionScore: 0.17699386503067485



Validation scores:
	RegressionAUROC: 0.5341935753822327
	RegressionCompetitionScore: 0.17668711656441718

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.5355925559997559
	RegressionCompetitionScore: 0.17760736196319019



Validation scores:
	RegressionAUROC: 0.535341739654541
	RegressionCompetitionScore: 0.1794478527607362



Validation scores:
	RegressionAUROC: 0.5360262393951416
	RegressionCompetitionScore: 0.17914110429447852



Validation scores:
	RegressionAUROC: 0.536817729473114
	RegressionCompetitionScore: 0.17975460122699385



Validation scores:
	RegressionAUROC: 0.5371919870376587
	RegressionCompetitionScore: 0.18220858895705522

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.537548303604126
	RegressionCompetitionScore: 0.18404907975460122

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5374782085418701
	RegressionCompetitionScore: 0.18435582822085889



Validation scores:
	RegressionAUROC: 0.5374268293380737
	RegressionCompetitionScore: 0.18588957055214725



Validation scores:
	RegressionAUROC: 0.5380123853683472
	RegressionCompetitionScore: 0.18865030674846625



Validation scores:
	RegressionAUROC: 0.5400679707527161
	RegressionCompetitionScore: 0.18680981595092025

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5409108400344849
	RegressionCompetitionScore: 0.18711656441717792

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5419511795043945
	RegressionCompetitionScore: 0.18987730061349692



Validation scores:
	RegressionAUROC: 0.5422765016555786
	RegressionCompetitionScore: 0.18957055214723925



Validation scores:
	RegressionAUROC: 0.5428249835968018
	RegressionCompetitionScore: 0.19202453987730062



Validation scores:
	RegressionAUROC: 0.5429710745811462
	RegressionCompetitionScore: 0.19263803680981595

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5434629917144775
	RegressionCompetitionScore: 0.19263803680981595

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.543715238571167
	RegressionCompetitionScore: 0.19386503067484662



Validation scores:
	RegressionAUROC: 0.5442286133766174
	RegressionCompetitionScore: 0.1950920245398773



Validation scores:
	RegressionAUROC: 0.5439789295196533
	RegressionCompetitionScore: 0.19570552147239265

`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.19263803680981595
     Test RegressionAUROC            0.5434629917144775
Test RegressionCompetitionScore      0.19263803680981595
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 08:46:42,986][0m Trial 366 finished with value: 0.19263803680981595 and parameters: {'lr': 7.354417098992898e-07, 'dropout': 0.4180996420063778, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 163, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0008354029794471829, 'dropout': 0.4273844628104527, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 159, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 35.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
35.7 K    Trainable params
0         Non-trainable params
35.7 K    Total params
0.143     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.21256038546562195
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5230533480644226
	RegressionCompetitionScore: 0.10460122699386504

Metric val_loss improved. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.5971332788467407
	RegressionCompetitionScore: 0.12515337423312883



Validation scores:
	RegressionAUROC: 0.6567032337188721
	RegressionCompetitionScore: 0.25736196319018406

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.658867597579956
	RegressionCompetitionScore: 0.25674846625766873

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6979354619979858
	RegressionCompetitionScore: 0.3165644171779141

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7044678926467896
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.7144309878349304
	RegressionCompetitionScore: 0.3266871165644172



Validation scores:
	RegressionAUROC: 0.7116745710372925
	RegressionCompetitionScore: 0.28343558282208586



Validation scores:
	RegressionAUROC: 0.7265217304229736
	RegressionCompetitionScore: 0.3665644171779141

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7363671660423279
	RegressionCompetitionScore: 0.3423312883435583



Validation scores:
	RegressionAUROC: 0.7379778623580933
	RegressionCompetitionScore: 0.36226993865030677



Validation scores:
	RegressionAUROC: 0.7369349002838135
	RegressionCompetitionScore: 0.35429447852760737



Validation scores:
	RegressionAUROC: 0.7486411333084106
	RegressionCompetitionScore: 0.36993865030674844

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7361672520637512
	RegressionCompetitionScore: 0.33404907975460124



Validation scores:
	RegressionAUROC: 0.767311155796051
	RegressionCompetitionScore: 0.3932515337423313



Validation scores:
	RegressionAUROC: 0.767583429813385
	RegressionCompetitionScore: 0.41595092024539876



Validation scores:
	RegressionAUROC: 0.770960807800293
	RegressionCompetitionScore: 0.400920245398773



Validation scores:
	RegressionAUROC: 0.7664405107498169
	RegressionCompetitionScore: 0.34570552147239264



Validation scores:
	RegressionAUROC: 0.7802916169166565
	RegressionCompetitionScore: 0.4098159509202454

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7701135873794556
	RegressionCompetitionScore: 0.3407975460122699



Validation scores:
	RegressionAUROC: 0.7673130035400391
	RegressionCompetitionScore: 0.38282208588957056



Validation scores:
	RegressionAUROC: 0.7745143175125122
	RegressionCompetitionScore: 0.3806748466257669

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7787827253341675
	RegressionCompetitionScore: 0.3923312883435583



Validation scores:
	RegressionAUROC: 0.7858859300613403
	RegressionCompetitionScore: 0.4092024539877301



Validation scores:
	RegressionAUROC: 0.7767223715782166
	RegressionCompetitionScore: 0.3923312883435583



Validation scores:
	RegressionAUROC: 0.7782014608383179
	RegressionCompetitionScore: 0.4138036809815951



Validation scores:
	RegressionAUROC: 0.7886524200439453
	RegressionCompetitionScore: 0.4288343558282209



Validation scores:
	RegressionAUROC: 0.7868961095809937
	RegressionCompetitionScore: 0.4156441717791411



Validation scores:
	RegressionAUROC: 0.7824087142944336
	RegressionCompetitionScore: 0.3960122699386503

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3806748466257669
     Test RegressionAUROC            0.7745143175125122
Test RegressionCompetitionScore      0.3806748466257669
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 08:58:10,977][0m Trial 367 finished with value: 0.3806748466257669 and parameters: {'lr': 0.0008354029794471829, 'dropout': 0.4273844628104527, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 159, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00044660427809503167, 'dropout': 0.5551598835683957, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 205, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 38.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
38.8 K    Trainable params
0         Non-trainable params
38.8 K    Total params
0.155     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6328502297401428
	RegressionCompetitionScore: 0.34782608695652173



Validation scores:
	RegressionAUROC: 0.5283348560333252
	RegressionCompetitionScore: 0.14539877300613496

Metric val_loss improved. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5217782258987427
	RegressionCompetitionScore: 0.10214723926380367



Validation scores:
	RegressionAUROC: 0.5332190990447998
	RegressionCompetitionScore: 0.08496932515337423

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5577586889266968
	RegressionCompetitionScore: 0.12208588957055215



Validation scores:
	RegressionAUROC: 0.5676970481872559
	RegressionCompetitionScore: 0.1156441717791411

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5927169322967529
	RegressionCompetitionScore: 0.1432515337423313

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6188319325447083
	RegressionCompetitionScore: 0.18098159509202455



Validation scores:
	RegressionAUROC: 0.6258554458618164
	RegressionCompetitionScore: 0.22392638036809817



Validation scores:
	RegressionAUROC: 0.6231390237808228
	RegressionCompetitionScore: 0.24478527607361963

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6200838685035706
	RegressionCompetitionScore: 0.25337423312883434



Validation scores:
	RegressionAUROC: 0.6141852140426636
	RegressionCompetitionScore: 0.24785276073619633



Validation scores:
	RegressionAUROC: 0.6138358116149902
	RegressionCompetitionScore: 0.2469325153374233



Validation scores:
	RegressionAUROC: 0.6158301830291748
	RegressionCompetitionScore: 0.24631901840490797



Validation scores:
	RegressionAUROC: 0.6196863055229187
	RegressionCompetitionScore: 0.24447852760736197

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6288326382637024
	RegressionCompetitionScore: 0.24969325153374233



Validation scores:
	RegressionAUROC: 0.6427434086799622
	RegressionCompetitionScore: 0.25674846625766873

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6489638090133667
	RegressionCompetitionScore: 0.2441717791411043



Validation scores:
	RegressionAUROC: 0.6526786684989929
	RegressionCompetitionScore: 0.23588957055214724

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6592310667037964
	RegressionCompetitionScore: 0.23865030674846627



Validation scores:
	RegressionAUROC: 0.6603989601135254
	RegressionCompetitionScore: 0.25736196319018406



Validation scores:
	RegressionAUROC: 0.6572948694229126
	RegressionCompetitionScore: 0.2588957055214724



Validation scores:
	RegressionAUROC: 0.663306474685669
	RegressionCompetitionScore: 0.25398773006134967



Validation scores:
	RegressionAUROC: 0.6746573448181152
	RegressionCompetitionScore: 0.25736196319018406



Validation scores:
	RegressionAUROC: 0.6792497634887695
	RegressionCompetitionScore: 0.19570552147239265

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6875544786453247
	RegressionCompetitionScore: 0.21779141104294478

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6972060203552246
	RegressionCompetitionScore: 0.2714723926380368

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.708594024181366
	RegressionCompetitionScore: 0.2880368098159509

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7137559652328491
	RegressionCompetitionScore: 0.29846625766871165



Validation scores:
	RegressionAUROC: 0.7110511064529419
	RegressionCompetitionScore: 0.26932515337423313



Validation scores:
	RegressionAUROC: 0.7262925505638123
	RegressionCompetitionScore: 0.300920245398773



Validation scores:
	RegressionAUROC: 0.7295531630516052
	RegressionCompetitionScore: 0.3245398773006135



Validation scores:
	RegressionAUROC: 0.7310577034950256
	RegressionCompetitionScore: 0.32883435582822085

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7341508865356445
	RegressionCompetitionScore: 0.3355828220858896



Validation scores:
	RegressionAUROC: 0.7323342561721802
	RegressionCompetitionScore: 0.34846625766871164



Validation scores:
	RegressionAUROC: 0.7298905849456787
	RegressionCompetitionScore: 0.35736196319018404



Validation scores:
	RegressionAUROC: 0.7202073335647583
	RegressionCompetitionScore: 0.3211656441717791



Validation scores:
	RegressionAUROC: 0.7315971255302429
	RegressionCompetitionScore: 0.350920245398773



Validation scores:
	RegressionAUROC: 0.7402441501617432
	RegressionCompetitionScore: 0.36411042944785277



Validation scores:
	RegressionAUROC: 0.7343629598617554
	RegressionCompetitionScore: 0.3361963190184049

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.32883435582822085
     Test RegressionAUROC            0.7310577034950256
Test RegressionCompetitionScore      0.32883435582822085
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 09:13:26,022][0m Trial 368 finished with value: 0.32883435582822085 and parameters: {'lr': 0.00044660427809503167, 'dropout': 0.5551598835683957, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 205, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.001254052274096962, 'dropout': 0.41177920715647, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 32, 'dim_feedforward': 259, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 151 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
151 K     Trainable params
0         Non-trainable params
151 K     Total params
0.607     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5072463750839233
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 50.971


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 48.622 >= min_delta = 0.0. New best score: 2.349


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5726616978645325
	RegressionCompetitionScore: 0.19846625766871165

Metric val_loss improved by 1.927 >= min_delta = 0.0. New best score: 0.422


Validation scores:
	RegressionAUROC: 0.5022331476211548
	RegressionCompetitionScore: 0.0049079754601227



Validation scores:
	RegressionAUROC: 0.4121621251106262
	RegressionCompetitionScore: 0.08558282208588958

Metric val_loss improved by 0.194 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.228. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.08558282208588958
     Test RegressionAUROC            0.4121621251106262
Test RegressionCompetitionScore      0.08558282208588958
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 09:19:49,558][0m Trial 369 finished with value: 0.08558282208588958 and parameters: {'lr': 0.001254052274096962, 'dropout': 0.41177920715647, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 32, 'dim_feedforward': 259, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0003407122636737229, 'dropout': 0.44180503180002745, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 173, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 43.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
43.2 K    Trainable params
0         Non-trainable params
43.2 K    Total params
0.173     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.39613521099090576
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6643536686897278
	RegressionCompetitionScore: 0.2411042944785276

Metric val_loss improved. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6787665486335754
	RegressionCompetitionScore: 0.20030674846625768



Validation scores:
	RegressionAUROC: 0.6870676279067993
	RegressionCompetitionScore: 0.1558282208588957

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.7194722890853882
	RegressionCompetitionScore: 0.3156441717791411



Validation scores:
	RegressionAUROC: 0.7164685726165771
	RegressionCompetitionScore: 0.35276073619631904



Validation scores:
	RegressionAUROC: 0.7323896884918213
	RegressionCompetitionScore: 0.3806748466257669



Validation scores:
	RegressionAUROC: 0.7353229522705078
	RegressionCompetitionScore: 0.38006134969325156



Validation scores:
	RegressionAUROC: 0.7474299669265747
	RegressionCompetitionScore: 0.39662576687116563



Validation scores:
	RegressionAUROC: 0.7407817244529724
	RegressionCompetitionScore: 0.36901840490797544



Validation scores:
	RegressionAUROC: 0.7535054683685303
	RegressionCompetitionScore: 0.4003067484662577

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.199. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1558282208588957
     Test RegressionAUROC            0.6870676279067993
Test RegressionCompetitionScore      0.1558282208588957
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 09:24:06,586][0m Trial 370 finished with value: 0.1558282208588957 and parameters: {'lr': 0.0003407122636737229, 'dropout': 0.44180503180002745, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 173, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00056244560607646, 'dropout': 0.6714886099424737, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 218, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 39.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
39.7 K    Trainable params
0         Non-trainable params
39.7 K    Total params
0.159     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6676511764526367
	RegressionCompetitionScore: 0.15920245398773006

Metric val_loss improved. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.6254094839096069
	RegressionCompetitionScore: 0.11871165644171779



Validation scores:
	RegressionAUROC: 0.561225950717926
	RegressionCompetitionScore: 0.12883435582822086

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6217432022094727
	RegressionCompetitionScore: 0.08619631901840491



Validation scores:
	RegressionAUROC: 0.6529808044433594
	RegressionCompetitionScore: 0.09202453987730061



Validation scores:
	RegressionAUROC: 0.6443760395050049
	RegressionCompetitionScore: 0.24447852760736197



Validation scores:
	RegressionAUROC: 0.6204102039337158
	RegressionCompetitionScore: 0.18282208588957055



Validation scores:
	RegressionAUROC: 0.6211843490600586
	RegressionCompetitionScore: 0.11595092024539877



Validation scores:
	RegressionAUROC: 0.6281012296676636
	RegressionCompetitionScore: 0.1147239263803681



Validation scores:
	RegressionAUROC: 0.5797258615493774
	RegressionCompetitionScore: 0.09447852760736196

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.208. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.12883435582822086
     Test RegressionAUROC             0.561225950717926
Test RegressionCompetitionScore      0.12883435582822086
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 09:28:22,841][0m Trial 371 finished with value: 0.12883435582822086 and parameters: {'lr': 0.00056244560607646, 'dropout': 0.6714886099424737, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 218, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0899953993934817, 'dropout': 0.6385595812389234, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 142, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 29.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
29.1 K    Trainable params
0         Non-trainable params
29.1 K    Total params
0.116     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5169081687927246
	RegressionCompetitionScore: 0.30434782608695654



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.259


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 09:32:58,541][0m Trial 372 finished with value: 0.0 and parameters: {'lr': 0.0899953993934817, 'dropout': 0.6385595812389234, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 142, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0007689258782010604, 'dropout': 0.6944396894708906, 'd_model_multiplier': 32, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 192, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.1 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
2.1 M     Trainable params
0         Non-trainable params
2.1 M     Total params
8.265     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.39613524079322815
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 10.024


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 7.305 >= min_delta = 0.0. New best score: 2.720


Validation scores:
	RegressionAUROC: 0.5430306196212769
	RegressionCompetitionScore: 0.07699386503067485

Metric val_loss improved by 2.204 >= min_delta = 0.0. New best score: 0.516


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4934324026107788
	RegressionCompetitionScore: 0.08773006134969324

Metric val_loss improved by 0.052 >= min_delta = 0.0. New best score: 0.464


Validation scores:
	RegressionAUROC: 0.4386053681373596
	RegressionCompetitionScore: 0.06656441717791411

Metric val_loss improved by 0.074 >= min_delta = 0.0. New best score: 0.390


Validation scores:
	RegressionAUROC: 0.4878818690776825
	RegressionCompetitionScore: 0.07208588957055215

Metric val_loss improved by 0.071 >= min_delta = 0.0. New best score: 0.319


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.319. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.07208588957055215
     Test RegressionAUROC            0.4878818690776825
Test RegressionCompetitionScore      0.07208588957055215
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 09:40:28,161][0m Trial 373 finished with value: 0.07208588957055215 and parameters: {'lr': 0.0007689258782010604, 'dropout': 0.6944396894708906, 'd_model_multiplier': 32, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 192, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004214771243707265, 'dropout': 0.611033846360238, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 158, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 32.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
32.6 K    Trainable params
0         Non-trainable params
32.6 K    Total params
0.131     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.5991836786270142
	RegressionCompetitionScore: 0.1619631901840491

Metric val_loss improved. New best score: 0.264


Validation scores:
	RegressionAUROC: 0.6382007598876953
	RegressionCompetitionScore: 0.19631901840490798

Metric val_loss improved by 0.062 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.633845329284668
	RegressionCompetitionScore: 0.23067484662576687



Validation scores:
	RegressionAUROC: 0.6342242956161499
	RegressionCompetitionScore: 0.2116564417177914



Validation scores:
	RegressionAUROC: 0.6422094106674194
	RegressionCompetitionScore: 0.22760736196319017



Validation scores:
	RegressionAUROC: 0.6517361998558044
	RegressionCompetitionScore: 0.22085889570552147



Validation scores:
	RegressionAUROC: 0.6703392267227173
	RegressionCompetitionScore: 0.2748466257668712



Validation scores:
	RegressionAUROC: 0.6866418719291687
	RegressionCompetitionScore: 0.2785276073619632



Validation scores:
	RegressionAUROC: 0.6962767839431763
	RegressionCompetitionScore: 0.3168711656441718

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6834959983825684
	RegressionCompetitionScore: 0.2969325153374233



Validation scores:
	RegressionAUROC: 0.699326753616333
	RegressionCompetitionScore: 0.2782208588957055



Validation scores:
	RegressionAUROC: 0.6935594081878662
	RegressionCompetitionScore: 0.29233128834355826



Validation scores:
	RegressionAUROC: 0.7042732238769531
	RegressionCompetitionScore: 0.299079754601227



Validation scores:
	RegressionAUROC: 0.712180495262146
	RegressionCompetitionScore: 0.32607361963190185

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6979973316192627
	RegressionCompetitionScore: 0.3030674846625767

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.6946807503700256
	RegressionCompetitionScore: 0.28680981595092025



Validation scores:
	RegressionAUROC: 0.7086085677146912
	RegressionCompetitionScore: 0.31441717791411045



Validation scores:
	RegressionAUROC: 0.7178469896316528
	RegressionCompetitionScore: 0.35828220858895704



Validation scores:
	RegressionAUROC: 0.7122005224227905
	RegressionCompetitionScore: 0.3392638036809816



Validation scores:
	RegressionAUROC: 0.7200220823287964
	RegressionCompetitionScore: 0.3337423312883436



Validation scores:
	RegressionAUROC: 0.7220690250396729
	RegressionCompetitionScore: 0.3371165644171779



Validation scores:
	RegressionAUROC: 0.7027136087417603
	RegressionCompetitionScore: 0.3398773006134969

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.182. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3030674846625767
     Test RegressionAUROC            0.6979973316192627
Test RegressionCompetitionScore      0.3030674846625767
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 09:49:19,435][0m Trial 374 finished with value: 0.3030674846625767 and parameters: {'lr': 0.0004214771243707265, 'dropout': 0.611033846360238, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 158, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0015305418893073403, 'dropout': 0.43560487851265267, 'd_model_multiplier': 8, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 236, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 406 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
406 K     Trainable params
0         Non-trainable params
406 K     Total params
1.628     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.598


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.770 >= min_delta = 0.0. New best score: 0.828


Validation scores:
	RegressionAUROC: 0.5955603718757629
	RegressionCompetitionScore: 0.0745398773006135

Metric val_loss improved by 0.352 >= min_delta = 0.0. New best score: 0.476


Validation scores:
	RegressionAUROC: 0.4804447293281555
	RegressionCompetitionScore: 0.09263803680981596

Metric val_loss improved by 0.196 >= min_delta = 0.0. New best score: 0.279


Validation scores:
	RegressionAUROC: 0.38715434074401855
	RegressionCompetitionScore: 0.0843558282208589

Metric val_loss improved by 0.047 >= min_delta = 0.0. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.3569544851779938
	RegressionCompetitionScore: 0.02392638036809816



Validation scores:
	RegressionAUROC: 0.6004445552825928
	RegressionCompetitionScore: 0.2549079754601227

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.37537795305252075
	RegressionCompetitionScore: 0.09325153374233129



Validation scores:
	RegressionAUROC: 0.36673760414123535
	RegressionCompetitionScore: 0.06257668711656442



Validation scores:
	RegressionAUROC: 0.36237287521362305
	RegressionCompetitionScore: 0.05030674846625767



Validation scores:
	RegressionAUROC: 0.3547006845474243
	RegressionCompetitionScore: 0.060429447852760734



Validation scores:
	RegressionAUROC: 0.3489028215408325
	RegressionCompetitionScore: 0.04171779141104295



Validation scores:
	RegressionAUROC: 0.32394537329673767
	RegressionCompetitionScore: 0.02852760736196319



Validation scores:
	RegressionAUROC: 0.6443783044815063
	RegressionCompetitionScore: 0.2723926380368098

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.210. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2549079754601227
     Test RegressionAUROC            0.6004445552825928
Test RegressionCompetitionScore      0.2549079754601227
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 09:55:21,502][0m Trial 375 finished with value: 0.2549079754601227 and parameters: {'lr': 0.0015305418893073403, 'dropout': 0.43560487851265267, 'd_model_multiplier': 8, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 236, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 5.02594372633439e-07, 'dropout': 0.5913444997709426, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 130, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 28.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
28.7 K    Trainable params
0         Non-trainable params
28.7 K    Total params
0.115     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7004830837249756
	RegressionCompetitionScore: 0.391304347826087



Validation scores:
	RegressionAUROC: 0.5581399202346802
	RegressionCompetitionScore: 0.12300613496932515

Metric val_loss improved. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.5594547390937805
	RegressionCompetitionScore: 0.12116564417177914

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.243


Validation scores:
	RegressionAUROC: 0.5600242614746094
	RegressionCompetitionScore: 0.12269938650306748

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.240


Validation scores:
	RegressionAUROC: 0.5606805086135864
	RegressionCompetitionScore: 0.12300613496932515

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.239


Validation scores:
	RegressionAUROC: 0.561336874961853
	RegressionCompetitionScore: 0.1245398773006135



Validation scores:
	RegressionAUROC: 0.5619054436683655
	RegressionCompetitionScore: 0.12484662576687117



Validation scores:
	RegressionAUROC: 0.5625425577163696
	RegressionCompetitionScore: 0.1245398773006135



Validation scores:
	RegressionAUROC: 0.562423586845398
	RegressionCompetitionScore: 0.12607361963190183



Validation scores:
	RegressionAUROC: 0.56290602684021
	RegressionCompetitionScore: 0.1276073619631902



Validation scores:
	RegressionAUROC: 0.5620834827423096
	RegressionCompetitionScore: 0.12515337423312883



Validation scores:
	RegressionAUROC: 0.5619828701019287
	RegressionCompetitionScore: 0.1245398773006135

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.239. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.12300613496932515
     Test RegressionAUROC            0.5606805086135864
Test RegressionCompetitionScore      0.12300613496932515
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 10:00:00,536][0m Trial 376 finished with value: 0.12300613496932515 and parameters: {'lr': 5.02594372633439e-07, 'dropout': 0.5913444997709426, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 130, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0009610413395056067, 'dropout': 0.41097434593376636, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 32, 'dim_feedforward': 201, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 115 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
115 K     Trainable params
0         Non-trainable params
115 K     Total params
0.462     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6688109040260315
	RegressionCompetitionScore: 0.18466257668711655

Metric val_loss improved. New best score: 0.525


Validation scores:
	RegressionAUROC: 0.6713196039199829
	RegressionCompetitionScore: 0.22300613496932514

Metric val_loss improved by 0.128 >= min_delta = 0.0. New best score: 0.397


Validation scores:
	RegressionAUROC: 0.7041158080101013
	RegressionCompetitionScore: 0.27116564417177913

Metric val_loss improved by 0.209 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7173278331756592
	RegressionCompetitionScore: 0.3328220858895706

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.715997576713562
	RegressionCompetitionScore: 0.36319018404907977



Validation scores:
	RegressionAUROC: 0.7249209880828857
	RegressionCompetitionScore: 0.350920245398773

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7225768566131592
	RegressionCompetitionScore: 0.36226993865030677



Validation scores:
	RegressionAUROC: 0.7278315424919128
	RegressionCompetitionScore: 0.36533742331288344



Validation scores:
	RegressionAUROC: 0.7102546095848083
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.7239974737167358
	RegressionCompetitionScore: 0.35613496932515337



Validation scores:
	RegressionAUROC: 0.7150850296020508
	RegressionCompetitionScore: 0.35429447852760737



Validation scores:
	RegressionAUROC: 0.6939845681190491
	RegressionCompetitionScore: 0.34662576687116564



Validation scores:
	RegressionAUROC: 0.6934604644775391
	RegressionCompetitionScore: 0.34171779141104297

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.350920245398773
     Test RegressionAUROC            0.7249209880828857
Test RegressionCompetitionScore       0.350920245398773
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 10:06:04,319][0m Trial 377 finished with value: 0.350920245398773 and parameters: {'lr': 0.0009610413395056067, 'dropout': 0.41097434593376636, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 32, 'dim_feedforward': 201, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.026409688998489143, 'dropout': 0.4207667153649023, 'd_model_multiplier': 16, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 150, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 449 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
449 K     Trainable params
0         Non-trainable params
449 K     Total params
1.798     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 3769.810


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 3757.458 >= min_delta = 0.0. New best score: 12.352


Validation scores:
	RegressionAUROC: 0.6159301996231079
	RegressionCompetitionScore: 0.2411042944785276

Metric val_loss improved by 12.056 >= min_delta = 0.0. New best score: 0.296


Validation scores:
	RegressionAUROC: 0.5979355573654175
	RegressionCompetitionScore: 0.2616564417177914

Metric val_loss improved by 0.084 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 10:14:33,382][0m Trial 378 finished with value: 0.0 and parameters: {'lr': 0.026409688998489143, 'dropout': 0.4207667153649023, 'd_model_multiplier': 16, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 150, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 1.9207619183350896e-06, 'dropout': 0.6384511941151148, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 64, 'dim_feedforward': 179, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 235 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
235 K     Trainable params
0         Non-trainable params
235 K     Total params
0.941     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6304347515106201
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.5534034967422485
	RegressionCompetitionScore: 0.13588957055214723

Metric val_loss improved. New best score: 0.602


Validation scores:
	RegressionAUROC: 0.5383802652359009
	RegressionCompetitionScore: 0.1352760736196319

Metric val_loss improved by 0.082 >= min_delta = 0.0. New best score: 0.520


Validation scores:
	RegressionAUROC: 0.5317262411117554
	RegressionCompetitionScore: 0.1334355828220859

Metric val_loss improved by 0.072 >= min_delta = 0.0. New best score: 0.448


Validation scores:
	RegressionAUROC: 0.5298497676849365
	RegressionCompetitionScore: 0.1294478527607362

Metric val_loss improved by 0.062 >= min_delta = 0.0. New best score: 0.386


Validation scores:
	RegressionAUROC: 0.5275391936302185
	RegressionCompetitionScore: 0.12668711656441717

Metric val_loss improved by 0.052 >= min_delta = 0.0. New best score: 0.334


Validation scores:
	RegressionAUROC: 0.525230884552002
	RegressionCompetitionScore: 0.12147239263803682

Metric val_loss improved by 0.042 >= min_delta = 0.0. New best score: 0.292


Validation scores:
	RegressionAUROC: 0.5222836136817932
	RegressionCompetitionScore: 0.12024539877300613

Metric val_loss improved by 0.040 >= min_delta = 0.0. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.520116925239563
	RegressionCompetitionScore: 0.11717791411042945

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.5182605981826782
	RegressionCompetitionScore: 0.11533742331288344

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.5172049403190613
	RegressionCompetitionScore: 0.11226993865030675

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.5164491534233093
	RegressionCompetitionScore: 0.11134969325153374

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5161123871803284
	RegressionCompetitionScore: 0.1116564417177914



Validation scores:
	RegressionAUROC: 0.5160545110702515
	RegressionCompetitionScore: 0.11196319018404909



Validation scores:
	RegressionAUROC: 0.5162662267684937
	RegressionCompetitionScore: 0.11288343558282209



Validation scores:
	RegressionAUROC: 0.5167782306671143
	RegressionCompetitionScore: 0.11349693251533742



Validation scores:
	RegressionAUROC: 0.5175392031669617
	RegressionCompetitionScore: 0.11380368098159509



Validation scores:
	RegressionAUROC: 0.5191942453384399
	RegressionCompetitionScore: 0.11840490797546012



Validation scores:
	RegressionAUROC: 0.5208846926689148
	RegressionCompetitionScore: 0.12177914110429448

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5227395296096802
	RegressionCompetitionScore: 0.12331288343558282



Validation scores:
	RegressionAUROC: 0.5244530439376831
	RegressionCompetitionScore: 0.1254601226993865



Validation scores:
	RegressionAUROC: 0.5260963439941406
	RegressionCompetitionScore: 0.1273006134969325



Validation scores:
	RegressionAUROC: 0.5266878604888916
	RegressionCompetitionScore: 0.12668711656441717



Validation scores:
	RegressionAUROC: 0.5266985893249512
	RegressionCompetitionScore: 0.1273006134969325



Validation scores:
	RegressionAUROC: 0.5262236595153809
	RegressionCompetitionScore: 0.1263803680981595



Validation scores:
	RegressionAUROC: 0.5259068012237549
	RegressionCompetitionScore: 0.1263803680981595

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5258552432060242
	RegressionCompetitionScore: 0.12883435582822086

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.526496171951294
	RegressionCompetitionScore: 0.1294478527607362

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5274378061294556
	RegressionCompetitionScore: 0.13098159509202453

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5286503434181213
	RegressionCompetitionScore: 0.13006134969325153

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5297877788543701
	RegressionCompetitionScore: 0.13374233128834356



Validation scores:
	RegressionAUROC: 0.5309304594993591
	RegressionCompetitionScore: 0.13374233128834356



Validation scores:
	RegressionAUROC: 0.5312108993530273
	RegressionCompetitionScore: 0.1343558282208589



Validation scores:
	RegressionAUROC: 0.5312237739562988
	RegressionCompetitionScore: 0.13404907975460123



Validation scores:
	RegressionAUROC: 0.5310779213905334
	RegressionCompetitionScore: 0.1325153374233129

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5310204029083252
	RegressionCompetitionScore: 0.13098159509202453

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.531365692615509
	RegressionCompetitionScore: 0.13098159509202453



Validation scores:
	RegressionAUROC: 0.5324307084083557
	RegressionCompetitionScore: 0.13558282208588956

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.533609926700592
	RegressionCompetitionScore: 0.13773006134969326



Validation scores:
	RegressionAUROC: 0.534748911857605
	RegressionCompetitionScore: 0.13895705521472393



Validation scores:
	RegressionAUROC: 0.5359981060028076
	RegressionCompetitionScore: 0.14049079754601226



Validation scores:
	RegressionAUROC: 0.5372320413589478
	RegressionCompetitionScore: 0.1432515337423313



Validation scores:
	RegressionAUROC: 0.5377611517906189
	RegressionCompetitionScore: 0.1441717791411043



Validation scores:
	RegressionAUROC: 0.5381316542625427
	RegressionCompetitionScore: 0.14539877300613496



Validation scores:
	RegressionAUROC: 0.5383349657058716
	RegressionCompetitionScore: 0.14478527607361963

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.212. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.13558282208588956
     Test RegressionAUROC            0.5324307084083557
Test RegressionCompetitionScore      0.13558282208588956
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 10:38:56,342][0m Trial 379 finished with value: 0.13558282208588956 and parameters: {'lr': 1.9207619183350896e-06, 'dropout': 0.6384511941151148, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 64, 'dim_feedforward': 179, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 1.0069737436332323e-07, 'dropout': 0.6297458677434218, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 223, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 31.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
31.8 K    Trainable params
0         Non-trainable params
31.8 K    Total params
0.127     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.47342991828918457
	RegressionCompetitionScore: 0.34782608695652173



Validation scores:
	RegressionAUROC: 0.4476718306541443
	RegressionCompetitionScore: 0.1165644171779141

Metric val_loss improved. New best score: 0.488


Validation scores:
	RegressionAUROC: 0.46291667222976685
	RegressionCompetitionScore: 0.10521472392638037

Metric val_loss improved by 0.044 >= min_delta = 0.0. New best score: 0.444


Validation scores:
	RegressionAUROC: 0.44935449957847595
	RegressionCompetitionScore: 0.07177914110429448



Validation scores:
	RegressionAUROC: 0.4568002223968506
	RegressionCompetitionScore: 0.07791411042944785

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.423


Validation scores:
	RegressionAUROC: 0.46550095081329346
	RegressionCompetitionScore: 0.09018404907975461



Validation scores:
	RegressionAUROC: 0.45321738719940186
	RegressionCompetitionScore: 0.07791411042944785



Validation scores:
	RegressionAUROC: 0.4535503387451172
	RegressionCompetitionScore: 0.08312883435582823



Validation scores:
	RegressionAUROC: 0.4550243616104126
	RegressionCompetitionScore: 0.10460122699386504



Validation scores:
	RegressionAUROC: 0.4579735994338989
	RegressionCompetitionScore: 0.07914110429447853



Validation scores:
	RegressionAUROC: 0.4706183969974518
	RegressionCompetitionScore: 0.09969325153374232



Validation scores:
	RegressionAUROC: 0.4337281584739685
	RegressionCompetitionScore: 0.10337423312883436

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.423. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.07791411042944785
     Test RegressionAUROC            0.4568002223968506
Test RegressionCompetitionScore      0.07791411042944785
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 10:43:37,370][0m Trial 380 finished with value: 0.07791411042944785 and parameters: {'lr': 1.0069737436332323e-07, 'dropout': 0.6297458677434218, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 223, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0006067988955460561, 'dropout': 0.7305040195502881, 'd_model_multiplier': 64, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 175, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 4.2 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
4.2 M     Trainable params
0         Non-trainable params
4.2 M     Total params
16.738    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4227053225040436
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5003067255020142
	RegressionCompetitionScore: 0.0006134969325153375

Metric val_loss improved. New best score: 16.834


Validation scores:
	RegressionAUROC: 0.4888416528701782
	RegressionCompetitionScore: 0.10122699386503067

Metric val_loss improved by 16.296 >= min_delta = 0.0. New best score: 0.538


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5766076445579529
	RegressionCompetitionScore: 0.24969325153374233

Metric val_loss improved by 0.033 >= min_delta = 0.0. New best score: 0.505


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5765771865844727
	RegressionCompetitionScore: 0.24386503067484663

Metric val_loss improved by 0.270 >= min_delta = 0.0. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.235. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.24386503067484663
     Test RegressionAUROC            0.5765771865844727
Test RegressionCompetitionScore      0.24386503067484663
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 10:50:42,964][0m Trial 381 finished with value: 0.24386503067484663 and parameters: {'lr': 0.0006067988955460561, 'dropout': 0.7305040195502881, 'd_model_multiplier': 64, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 175, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0003223268237698278, 'dropout': 0.4419069271020145, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 902, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 101 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
101 K     Trainable params
0         Non-trainable params
101 K     Total params
0.408     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6166985034942627
	RegressionCompetitionScore: 0.26319018404907973

Metric val_loss improved. New best score: 0.253


Validation scores:
	RegressionAUROC: 0.6471591591835022
	RegressionCompetitionScore: 0.2552147239263804

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.6432775855064392
	RegressionCompetitionScore: 0.2773006134969325



Validation scores:
	RegressionAUROC: 0.6547566652297974
	RegressionCompetitionScore: 0.2782208588957055

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6803750991821289
	RegressionCompetitionScore: 0.26809815950920246

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7029446363449097
	RegressionCompetitionScore: 0.2880368098159509



Validation scores:
	RegressionAUROC: 0.7058019638061523
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7166601419448853
	RegressionCompetitionScore: 0.3736196319018405



Validation scores:
	RegressionAUROC: 0.7101526856422424
	RegressionCompetitionScore: 0.3273006134969325



Validation scores:
	RegressionAUROC: 0.7206294536590576
	RegressionCompetitionScore: 0.2184049079754601



Validation scores:
	RegressionAUROC: 0.7402989864349365
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7512775659561157
	RegressionCompetitionScore: 0.3355828220858896

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7672079205513
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7633935213088989
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7685238122940063
	RegressionCompetitionScore: 0.3374233128834356



Validation scores:
	RegressionAUROC: 0.7838008403778076
	RegressionCompetitionScore: 0.3843558282208589

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7375962734222412
	RegressionCompetitionScore: 0.4144171779141104



Validation scores:
	RegressionAUROC: 0.7811357975006104
	RegressionCompetitionScore: 0.4119631901840491



Validation scores:
	RegressionAUROC: 0.7425569295883179
	RegressionCompetitionScore: 0.299079754601227



Validation scores:
	RegressionAUROC: 0.7803942561149597
	RegressionCompetitionScore: 0.38282208588957056



Validation scores:
	RegressionAUROC: 0.7878228425979614
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7624772787094116
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7664048671722412
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3843558282208589
     Test RegressionAUROC            0.7838008403778076
Test RegressionCompetitionScore      0.3843558282208589
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 11:00:08,009][0m Trial 382 finished with value: 0.3843558282208589 and parameters: {'lr': 0.0003223268237698278, 'dropout': 0.4419069271020145, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 902, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004632417672035158, 'dropout': 0.5446692823004557, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 134, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 34.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
34.0 K    Trainable params
0         Non-trainable params
34.0 K    Total params
0.136     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5652173757553101
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.5713900923728943
	RegressionCompetitionScore: 0.18957055214723925

Metric val_loss improved. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.5349071621894836
	RegressionCompetitionScore: 0.0950920245398773

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.4536387622356415
	RegressionCompetitionScore: 0.07024539877300613



Validation scores:
	RegressionAUROC: 0.4370240569114685
	RegressionCompetitionScore: 0.08803680981595093



Validation scores:
	RegressionAUROC: 0.46076565980911255
	RegressionCompetitionScore: 0.0834355828220859



Validation scores:
	RegressionAUROC: 0.4846559762954712
	RegressionCompetitionScore: 0.08742331288343558

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5296339392662048
	RegressionCompetitionScore: 0.08251533742331288



Validation scores:
	RegressionAUROC: 0.5589724779129028
	RegressionCompetitionScore: 0.08834355828220859



Validation scores:
	RegressionAUROC: 0.6021121144294739
	RegressionCompetitionScore: 0.1558282208588957



Validation scores:
	RegressionAUROC: 0.6066300272941589
	RegressionCompetitionScore: 0.18680981595092025



Validation scores:
	RegressionAUROC: 0.6067076921463013
	RegressionCompetitionScore: 0.21779141104294478

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6105824708938599
	RegressionCompetitionScore: 0.24386503067484663

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6138191223144531
	RegressionCompetitionScore: 0.25644171779141106



Validation scores:
	RegressionAUROC: 0.6193282604217529
	RegressionCompetitionScore: 0.2656441717791411



Validation scores:
	RegressionAUROC: 0.6229226589202881
	RegressionCompetitionScore: 0.26809815950920246



Validation scores:
	RegressionAUROC: 0.6333163976669312
	RegressionCompetitionScore: 0.26932515337423313



Validation scores:
	RegressionAUROC: 0.6493496894836426
	RegressionCompetitionScore: 0.2647239263803681



Validation scores:
	RegressionAUROC: 0.6547147035598755
	RegressionCompetitionScore: 0.24877300613496933



Validation scores:
	RegressionAUROC: 0.6672911047935486
	RegressionCompetitionScore: 0.24233128834355827

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.206. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.24386503067484663
     Test RegressionAUROC            0.6105824708938599
Test RegressionCompetitionScore      0.24386503067484663
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 11:07:49,339][0m Trial 383 finished with value: 0.24386503067484663 and parameters: {'lr': 0.0004632417672035158, 'dropout': 0.5446692823004557, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 134, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0006596529923869996, 'dropout': 0.6141638476972071, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 4, 'dim_feedforward': 118, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 23.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
23.4 K    Trainable params
0         Non-trainable params
23.4 K    Total params
0.094     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.26570048928260803
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5261365175247192
	RegressionCompetitionScore: 0.06411042944785277

Metric val_loss improved. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.4147827625274658
	RegressionCompetitionScore: 0.10705521472392639

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.40143999457359314
	RegressionCompetitionScore: 0.11319018404907975



Validation scores:
	RegressionAUROC: 0.4677846133708954
	RegressionCompetitionScore: 0.1098159509202454



Validation scores:
	RegressionAUROC: 0.6194493770599365
	RegressionCompetitionScore: 0.12392638036809817



Validation scores:
	RegressionAUROC: 0.6457499861717224
	RegressionCompetitionScore: 0.1294478527607362

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6655076742172241
	RegressionCompetitionScore: 0.14263803680981596



Validation scores:
	RegressionAUROC: 0.6926521062850952
	RegressionCompetitionScore: 0.298159509202454



Validation scores:
	RegressionAUROC: 0.6685760021209717
	RegressionCompetitionScore: 0.2273006134969325



Validation scores:
	RegressionAUROC: 0.6653485894203186
	RegressionCompetitionScore: 0.13496932515337423



Validation scores:
	RegressionAUROC: 0.5410684943199158
	RegressionCompetitionScore: 0.0745398773006135



Validation scores:
	RegressionAUROC: 0.5550272464752197
	RegressionCompetitionScore: 0.09969325153374232



Validation scores:
	RegressionAUROC: 0.6105862259864807
	RegressionCompetitionScore: 0.10736196319018405

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.206. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1294478527607362
     Test RegressionAUROC            0.6457499861717224
Test RegressionCompetitionScore      0.1294478527607362
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 11:13:14,197][0m Trial 384 finished with value: 0.1294478527607362 and parameters: {'lr': 0.0006596529923869996, 'dropout': 0.6141638476972071, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 4, 'dim_feedforward': 118, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 1.8008160688350834e-05, 'dropout': 0.5744679578549129, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 200, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 38.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
38.5 K    Trainable params
0         Non-trainable params
38.5 K    Total params
0.154     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6231883764266968
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.40393054485321045
	RegressionCompetitionScore: 0.04877300613496933

Metric val_loss improved. New best score: 0.236


Validation scores:
	RegressionAUROC: 0.3901960253715515
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.430722713470459
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4959093928337097
	RegressionCompetitionScore: 0.08865030674846626



Validation scores:
	RegressionAUROC: 0.5707472562789917
	RegressionCompetitionScore: 0.12668711656441717



Validation scores:
	RegressionAUROC: 0.597308874130249
	RegressionCompetitionScore: 0.15



Validation scores:
	RegressionAUROC: 0.604392409324646
	RegressionCompetitionScore: 0.15276073619631902



Validation scores:
	RegressionAUROC: 0.6173244714736938
	RegressionCompetitionScore: 0.16165644171779142

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.6299801468849182
	RegressionCompetitionScore: 0.17975460122699385

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.637050986289978
	RegressionCompetitionScore: 0.18496932515337422

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.6470432877540588
	RegressionCompetitionScore: 0.20521472392638038



Validation scores:
	RegressionAUROC: 0.6419236660003662
	RegressionCompetitionScore: 0.21380368098159508



Validation scores:
	RegressionAUROC: 0.6544063091278076
	RegressionCompetitionScore: 0.23865030674846627



Validation scores:
	RegressionAUROC: 0.6638891100883484
	RegressionCompetitionScore: 0.24049079754601227



Validation scores:
	RegressionAUROC: 0.6664080619812012
	RegressionCompetitionScore: 0.24355828220858897



Validation scores:
	RegressionAUROC: 0.6747900247573853
	RegressionCompetitionScore: 0.252760736196319



Validation scores:
	RegressionAUROC: 0.6782993078231812
	RegressionCompetitionScore: 0.25736196319018406

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.214. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.18496932515337422
     Test RegressionAUROC             0.637050986289978
Test RegressionCompetitionScore      0.18496932515337422
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 11:20:09,892][0m Trial 385 finished with value: 0.18496932515337422 and parameters: {'lr': 1.8008160688350834e-05, 'dropout': 0.5744679578549129, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 200, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0024242891103533858, 'dropout': 0.4003243278857836, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 163, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 42.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
42.2 K    Trainable params
0         Non-trainable params
42.2 K    Total params
0.169     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4227639138698578
	RegressionCompetitionScore: 0.10858895705521472

Metric val_loss improved. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.6386470794677734
	RegressionCompetitionScore: 0.11748466257668712

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.6159183979034424
	RegressionCompetitionScore: 0.09079754601226994

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6178048253059387
	RegressionCompetitionScore: 0.0794478527607362



Validation scores:
	RegressionAUROC: 0.625757098197937
	RegressionCompetitionScore: 0.07638036809815951



Validation scores:
	RegressionAUROC: 0.627151370048523
	RegressionCompetitionScore: 0.07760736196319018

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6291735768318176
	RegressionCompetitionScore: 0.07269938650306748



Validation scores:
	RegressionAUROC: 0.6267517805099487
	RegressionCompetitionScore: 0.1067484662576687



Validation scores:
	RegressionAUROC: 0.5989245176315308
	RegressionCompetitionScore: 0.12208588957055215



Validation scores:
	RegressionAUROC: 0.45304542779922485
	RegressionCompetitionScore: 0.04171779141104295



Validation scores:
	RegressionAUROC: 0.5374158620834351
	RegressionCompetitionScore: 0.03343558282208589



Validation scores:
	RegressionAUROC: 0.595897912979126
	RegressionCompetitionScore: 0.05950920245398773



Validation scores:
	RegressionAUROC: 0.49776318669319153
	RegressionCompetitionScore: 0.04447852760736196

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.07760736196319018
     Test RegressionAUROC             0.627151370048523
Test RegressionCompetitionScore      0.07760736196319018
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 11:25:38,085][0m Trial 386 finished with value: 0.07760736196319018 and parameters: {'lr': 0.0024242891103533858, 'dropout': 0.4003243278857836, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 163, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 2.27024821101919e-07, 'dropout': 0.4276761688367895, 'd_model_multiplier': 1, 'num_layers': 8, 'n_heads': 8, 'dim_feedforward': 146, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 46.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
46.1 K    Trainable params
0         Non-trainable params
46.1 K    Total params
0.184     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7874395847320557
	RegressionCompetitionScore: 0.5217391304347826



Validation scores:
	RegressionAUROC: 0.5639688968658447
	RegressionCompetitionScore: 0.10766871165644172

Metric val_loss improved. New best score: 0.279


Validation scores:
	RegressionAUROC: 0.5638582706451416
	RegressionCompetitionScore: 0.10797546012269939

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.271


Validation scores:
	RegressionAUROC: 0.563520073890686
	RegressionCompetitionScore: 0.10828220858895705

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.264


Validation scores:
	RegressionAUROC: 0.5634157657623291
	RegressionCompetitionScore: 0.10858895705521472

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.257


Validation scores:
	RegressionAUROC: 0.5632818937301636
	RegressionCompetitionScore: 0.10950920245398774

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.5633078813552856
	RegressionCompetitionScore: 0.10920245398773006

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.245


Validation scores:
	RegressionAUROC: 0.5632237195968628
	RegressionCompetitionScore: 0.10920245398773006

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.241


Validation scores:
	RegressionAUROC: 0.563174843788147
	RegressionCompetitionScore: 0.10889570552147239

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.237


Validation scores:
	RegressionAUROC: 0.5629139542579651
	RegressionCompetitionScore: 0.10797546012269939

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.5628987550735474
	RegressionCompetitionScore: 0.1067484662576687

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.231


Validation scores:
	RegressionAUROC: 0.5628838539123535
	RegressionCompetitionScore: 0.10644171779141104

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.5628336071968079
	RegressionCompetitionScore: 0.10613496932515337

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.5628229379653931
	RegressionCompetitionScore: 0.1058282208588957

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.5629051923751831
	RegressionCompetitionScore: 0.1058282208588957

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5629969835281372
	RegressionCompetitionScore: 0.1058282208588957

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.5630789399147034
	RegressionCompetitionScore: 0.10766871165644172

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5633152723312378
	RegressionCompetitionScore: 0.10920245398773006

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5633689165115356
	RegressionCompetitionScore: 0.10858895705521472

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5633580684661865
	RegressionCompetitionScore: 0.10858895705521472

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5634311437606812
	RegressionCompetitionScore: 0.10828220858895705

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5634398460388184
	RegressionCompetitionScore: 0.10766871165644172

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.5634924173355103
	RegressionCompetitionScore: 0.10889570552147239

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5635851621627808
	RegressionCompetitionScore: 0.11104294478527607

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5636574029922485
	RegressionCompetitionScore: 0.11104294478527607

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5638078451156616
	RegressionCompetitionScore: 0.11196319018404909

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5636974573135376
	RegressionCompetitionScore: 0.11226993865030675

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5636193752288818
	RegressionCompetitionScore: 0.11196319018404909

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5636871457099915
	RegressionCompetitionScore: 0.1107361963190184

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5637844204902649
	RegressionCompetitionScore: 0.11196319018404909

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5638625621795654
	RegressionCompetitionScore: 0.11196319018404909



Validation scores:
	RegressionAUROC: 0.5639270544052124
	RegressionCompetitionScore: 0.11226993865030675

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.563941478729248
	RegressionCompetitionScore: 0.11288343558282209

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.56395423412323
	RegressionCompetitionScore: 0.1107361963190184



Validation scores:
	RegressionAUROC: 0.5640124082565308
	RegressionCompetitionScore: 0.1098159509202454



Validation scores:
	RegressionAUROC: 0.5641754269599915
	RegressionCompetitionScore: 0.1098159509202454



Validation scores:
	RegressionAUROC: 0.564303994178772
	RegressionCompetitionScore: 0.10889570552147239



Validation scores:
	RegressionAUROC: 0.564259946346283
	RegressionCompetitionScore: 0.1107361963190184



Validation scores:
	RegressionAUROC: 0.5642666220664978
	RegressionCompetitionScore: 0.1107361963190184



Validation scores:
	RegressionAUROC: 0.564373791217804
	RegressionCompetitionScore: 0.11104294478527607

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.208. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.11288343558282209
     Test RegressionAUROC             0.563941478729248
Test RegressionCompetitionScore      0.11288343558282209
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 11:41:34,542][0m Trial 387 finished with value: 0.11288343558282209 and parameters: {'lr': 2.27024821101919e-07, 'dropout': 0.4276761688367895, 'd_model_multiplier': 1, 'num_layers': 8, 'n_heads': 8, 'dim_feedforward': 146, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00032671760432892915, 'dropout': 0.4480228210566635, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 241, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 85.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
85.7 K    Trainable params
0         Non-trainable params
85.7 K    Total params
0.343     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4396134912967682
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.5803643465042114
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.468


Validation scores:
	RegressionAUROC: 0.7094413638114929
	RegressionCompetitionScore: 0.2441717791411043

Metric val_loss improved by 0.270 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6937798261642456
	RegressionCompetitionScore: 0.17515337423312882

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7191133499145508
	RegressionCompetitionScore: 0.35184049079754603

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7220174074172974
	RegressionCompetitionScore: 0.33588957055214724



Validation scores:
	RegressionAUROC: 0.7249011397361755
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7379770278930664
	RegressionCompetitionScore: 0.347239263803681



Validation scores:
	RegressionAUROC: 0.7251213788986206
	RegressionCompetitionScore: 0.32791411042944785



Validation scores:
	RegressionAUROC: 0.7426413893699646
	RegressionCompetitionScore: 0.35429447852760737



Validation scores:
	RegressionAUROC: 0.7208600640296936
	RegressionCompetitionScore: 0.34662576687116564



Validation scores:
	RegressionAUROC: 0.7382501363754272
	RegressionCompetitionScore: 0.3598159509202454

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7208068370819092
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7353208065032959
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7282265424728394
	RegressionCompetitionScore: 0.3414110429447853



Validation scores:
	RegressionAUROC: 0.7449922561645508
	RegressionCompetitionScore: 0.3950920245398773



Validation scores:
	RegressionAUROC: 0.7423291206359863
	RegressionCompetitionScore: 0.3558282208588957



Validation scores:
	RegressionAUROC: 0.7491762638092041
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7456506490707397
	RegressionCompetitionScore: 0.3815950920245399

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.171. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3598159509202454
     Test RegressionAUROC            0.7382501363754272
Test RegressionCompetitionScore      0.3598159509202454
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 11:49:01,187][0m Trial 388 finished with value: 0.3598159509202454 and parameters: {'lr': 0.00032671760432892915, 'dropout': 0.4480228210566635, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 241, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0011189070557608466, 'dropout': 0.41986986919162206, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 105, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 25.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
25.7 K    Trainable params
0         Non-trainable params
25.7 K    Total params
0.103     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6473430395126343
	RegressionCompetitionScore: 0.43478260869565216



Validation scores:
	RegressionAUROC: 0.6821531057357788
	RegressionCompetitionScore: 0.30122699386503066

Metric val_loss improved. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6711591482162476
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7223752737045288
	RegressionCompetitionScore: 0.36411042944785277



Validation scores:
	RegressionAUROC: 0.7441455125808716
	RegressionCompetitionScore: 0.4030674846625767

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7455640435218811
	RegressionCompetitionScore: 0.34386503067484664

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7613944411277771
	RegressionCompetitionScore: 0.39662576687116563



Validation scores:
	RegressionAUROC: 0.7609916925430298
	RegressionCompetitionScore: 0.37975460122699384



Validation scores:
	RegressionAUROC: 0.7622847557067871
	RegressionCompetitionScore: 0.37331288343558283



Validation scores:
	RegressionAUROC: 0.7667034864425659
	RegressionCompetitionScore: 0.3941717791411043



Validation scores:
	RegressionAUROC: 0.7592490911483765
	RegressionCompetitionScore: 0.3647239263803681



Validation scores:
	RegressionAUROC: 0.7415503263473511
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7701174020767212
	RegressionCompetitionScore: 0.40705521472392636

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.34386503067484664
     Test RegressionAUROC            0.7455640435218811
Test RegressionCompetitionScore      0.34386503067484664
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 11:54:00,576][0m Trial 389 finished with value: 0.34386503067484664 and parameters: {'lr': 0.0011189070557608466, 'dropout': 0.41986986919162206, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 105, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004542594888145061, 'dropout': 0.4330940391239147, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 217, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 43.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
43.7 K    Trainable params
0         Non-trainable params
43.7 K    Total params
0.175     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6616836786270142
	RegressionCompetitionScore: 0.2978527607361963

Metric val_loss improved. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6903661489486694
	RegressionCompetitionScore: 0.3226993865030675

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.6530017852783203
	RegressionCompetitionScore: 0.2871165644171779



Validation scores:
	RegressionAUROC: 0.7106882333755493
	RegressionCompetitionScore: 0.2874233128834356



Validation scores:
	RegressionAUROC: 0.7411251068115234
	RegressionCompetitionScore: 0.4030674846625767

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7416782379150391
	RegressionCompetitionScore: 0.38404907975460123



Validation scores:
	RegressionAUROC: 0.7321015000343323
	RegressionCompetitionScore: 0.35460122699386504



Validation scores:
	RegressionAUROC: 0.7461021542549133
	RegressionCompetitionScore: 0.3604294478527607

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7556636333465576
	RegressionCompetitionScore: 0.38282208588957056



Validation scores:
	RegressionAUROC: 0.7639960050582886
	RegressionCompetitionScore: 0.3969325153374233



Validation scores:
	RegressionAUROC: 0.7588496208190918
	RegressionCompetitionScore: 0.38312883435582823

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7631785869598389
	RegressionCompetitionScore: 0.3803680981595092



Validation scores:
	RegressionAUROC: 0.754951000213623
	RegressionCompetitionScore: 0.3825153374233129

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7434792518615723
	RegressionCompetitionScore: 0.35613496932515337



Validation scores:
	RegressionAUROC: 0.7603846788406372
	RegressionCompetitionScore: 0.3726993865030675



Validation scores:
	RegressionAUROC: 0.7639138698577881
	RegressionCompetitionScore: 0.38374233128834356



Validation scores:
	RegressionAUROC: 0.7594808340072632
	RegressionCompetitionScore: 0.38926380368098157



Validation scores:
	RegressionAUROC: 0.7630277872085571
	RegressionCompetitionScore: 0.4226993865030675



Validation scores:
	RegressionAUROC: 0.7607740163803101
	RegressionCompetitionScore: 0.4021472392638037



Validation scores:
	RegressionAUROC: 0.773916482925415
	RegressionCompetitionScore: 0.38926380368098157

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.166. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3825153374233129
     Test RegressionAUROC             0.754951000213623
Test RegressionCompetitionScore      0.3825153374233129
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 12:02:11,012][0m Trial 390 finished with value: 0.3825153374233129 and parameters: {'lr': 0.0004542594888145061, 'dropout': 0.4330940391239147, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 217, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 3.5527635667326266e-06, 'dropout': 0.602211013407252, 'd_model_multiplier': 2, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 197, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 53.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
53.9 K    Trainable params
0         Non-trainable params
53.9 K    Total params
0.216     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5628019571304321
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5330753326416016
	RegressionCompetitionScore: 0.09785276073619632

Metric val_loss improved. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5280897617340088
	RegressionCompetitionScore: 0.09079754601226994



Validation scores:
	RegressionAUROC: 0.5205786824226379
	RegressionCompetitionScore: 0.08312883435582823



Validation scores:
	RegressionAUROC: 0.5180479288101196
	RegressionCompetitionScore: 0.0803680981595092



Validation scores:
	RegressionAUROC: 0.5179935097694397
	RegressionCompetitionScore: 0.07730061349693251



Validation scores:
	RegressionAUROC: 0.5203244686126709
	RegressionCompetitionScore: 0.08128834355828221

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5199036002159119
	RegressionCompetitionScore: 0.07730061349693251

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.525714099407196
	RegressionCompetitionScore: 0.08220858895705521

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.5241293907165527
	RegressionCompetitionScore: 0.07576687116564418

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5274218320846558
	RegressionCompetitionScore: 0.07975460122699386



Validation scores:
	RegressionAUROC: 0.5294866561889648
	RegressionCompetitionScore: 0.08006134969325153

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5366377234458923
	RegressionCompetitionScore: 0.08067484662576688



Validation scores:
	RegressionAUROC: 0.5433188676834106
	RegressionCompetitionScore: 0.0785276073619632

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5537291765213013
	RegressionCompetitionScore: 0.0843558282208589

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.5633666515350342
	RegressionCompetitionScore: 0.09294478527607362

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.5694494247436523
	RegressionCompetitionScore: 0.09386503067484663

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.577052891254425
	RegressionCompetitionScore: 0.09631901840490797



Validation scores:
	RegressionAUROC: 0.5859907269477844
	RegressionCompetitionScore: 0.10030674846625767



Validation scores:
	RegressionAUROC: 0.5964967608451843
	RegressionCompetitionScore: 0.10460122699386504



Validation scores:
	RegressionAUROC: 0.6015819907188416
	RegressionCompetitionScore: 0.11503067484662577



Validation scores:
	RegressionAUROC: 0.6066182851791382
	RegressionCompetitionScore: 0.12177914110429448

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6129233241081238
	RegressionCompetitionScore: 0.1423312883435583

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6172968745231628
	RegressionCompetitionScore: 0.14938650306748466

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6232850551605225
	RegressionCompetitionScore: 0.15858895705521472

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.627601146697998
	RegressionCompetitionScore: 0.17300613496932515

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6329071521759033
	RegressionCompetitionScore: 0.18803680981595092



Validation scores:
	RegressionAUROC: 0.6372072696685791
	RegressionCompetitionScore: 0.19938650306748465



Validation scores:
	RegressionAUROC: 0.642257809638977
	RegressionCompetitionScore: 0.20920245398773007



Validation scores:
	RegressionAUROC: 0.6451656818389893
	RegressionCompetitionScore: 0.2165644171779141



Validation scores:
	RegressionAUROC: 0.6478480100631714
	RegressionCompetitionScore: 0.2245398773006135



Validation scores:
	RegressionAUROC: 0.6502076983451843
	RegressionCompetitionScore: 0.2371165644171779



Validation scores:
	RegressionAUROC: 0.6520393490791321
	RegressionCompetitionScore: 0.2420245398773006

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6549357175827026
	RegressionCompetitionScore: 0.250920245398773

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.65645831823349
	RegressionCompetitionScore: 0.2616564417177914

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6579519510269165
	RegressionCompetitionScore: 0.2733128834355828



Validation scores:
	RegressionAUROC: 0.6584334373474121
	RegressionCompetitionScore: 0.2748466257668712



Validation scores:
	RegressionAUROC: 0.660560131072998
	RegressionCompetitionScore: 0.27975460122699386



Validation scores:
	RegressionAUROC: 0.6613909006118774
	RegressionCompetitionScore: 0.2843558282208589



Validation scores:
	RegressionAUROC: 0.6631887555122375
	RegressionCompetitionScore: 0.27883435582822086



Validation scores:
	RegressionAUROC: 0.6644675731658936
	RegressionCompetitionScore: 0.28159509202453986



Validation scores:
	RegressionAUROC: 0.6638073325157166
	RegressionCompetitionScore: 0.2898773006134969

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.197. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2616564417177914
     Test RegressionAUROC             0.65645831823349
Test RegressionCompetitionScore      0.2616564417177914
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 12:18:27,863][0m Trial 391 finished with value: 0.2616564417177914 and parameters: {'lr': 3.5527635667326266e-06, 'dropout': 0.602211013407252, 'd_model_multiplier': 2, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 197, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0008913596776070522, 'dropout': 0.6875296690248233, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 259, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 37.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
37.8 K    Trainable params
0         Non-trainable params
37.8 K    Total params
0.151     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6086956262588501
	RegressionCompetitionScore: 0.30434782608695654



Validation scores:
	RegressionAUROC: 0.6733801364898682
	RegressionCompetitionScore: 0.15030674846625766

Metric val_loss improved. New best score: 0.257


Validation scores:
	RegressionAUROC: 0.631142795085907
	RegressionCompetitionScore: 0.19141104294478528

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.6321086287498474
	RegressionCompetitionScore: 0.2782208588957055



Validation scores:
	RegressionAUROC: 0.7115346193313599
	RegressionCompetitionScore: 0.3098159509202454



Validation scores:
	RegressionAUROC: 0.6579938530921936
	RegressionCompetitionScore: 0.27085889570552146

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.669152021408081
	RegressionCompetitionScore: 0.2674846625766871



Validation scores:
	RegressionAUROC: 0.6654093265533447
	RegressionCompetitionScore: 0.24570552147239264



Validation scores:
	RegressionAUROC: 0.6581196784973145
	RegressionCompetitionScore: 0.25122699386503067



Validation scores:
	RegressionAUROC: 0.6381890773773193
	RegressionCompetitionScore: 0.25061349693251533



Validation scores:
	RegressionAUROC: 0.6755140423774719
	RegressionCompetitionScore: 0.26012269938650306



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.203. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.27085889570552146
     Test RegressionAUROC            0.6579938530921936
Test RegressionCompetitionScore      0.27085889570552146
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 12:23:33,778][0m Trial 392 finished with value: 0.27085889570552146 and parameters: {'lr': 0.0008913596776070522, 'dropout': 0.6875296690248233, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 259, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005813909273466087, 'dropout': 0.41114713475852105, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 171, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 36.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
36.5 K    Trainable params
0         Non-trainable params
36.5 K    Total params
0.146     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.46859899163246155
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6866313219070435
	RegressionCompetitionScore: 0.2987730061349693

Metric val_loss improved. New best score: 0.248


Validation scores:
	RegressionAUROC: 0.7069318294525146
	RegressionCompetitionScore: 0.29049079754601226



Validation scores:
	RegressionAUROC: 0.7136586904525757
	RegressionCompetitionScore: 0.34754601226993864

Metric val_loss improved by 0.058 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7330242395401001
	RegressionCompetitionScore: 0.37423312883435583



Validation scores:
	RegressionAUROC: 0.7523584365844727
	RegressionCompetitionScore: 0.38128834355828223

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7621763348579407
	RegressionCompetitionScore: 0.39570552147239263

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7653273344039917
	RegressionCompetitionScore: 0.37515337423312883



Validation scores:
	RegressionAUROC: 0.7679630517959595
	RegressionCompetitionScore: 0.3604294478527607



Validation scores:
	RegressionAUROC: 0.7523853182792664
	RegressionCompetitionScore: 0.3365030674846626



Validation scores:
	RegressionAUROC: 0.7652825713157654
	RegressionCompetitionScore: 0.38220858895705523



Validation scores:
	RegressionAUROC: 0.7955427169799805
	RegressionCompetitionScore: 0.401840490797546

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.8014012575149536
	RegressionCompetitionScore: 0.39969325153374236



Validation scores:
	RegressionAUROC: 0.7812100648880005
	RegressionCompetitionScore: 0.447239263803681



Validation scores:
	RegressionAUROC: 0.7713345289230347
	RegressionCompetitionScore: 0.4039877300613497

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7924814224243164
	RegressionCompetitionScore: 0.41134969325153375



Validation scores:
	RegressionAUROC: 0.7965657114982605
	RegressionCompetitionScore: 0.4438650306748466

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.157


Validation scores:
	RegressionAUROC: 0.7821085453033447
	RegressionCompetitionScore: 0.4101226993865031



Validation scores:
	RegressionAUROC: 0.779108464717865
	RegressionCompetitionScore: 0.4110429447852761



Validation scores:
	RegressionAUROC: 0.7784906625747681
	RegressionCompetitionScore: 0.4214723926380368



Validation scores:
	RegressionAUROC: 0.767111599445343
	RegressionCompetitionScore: 0.4153374233128834



Validation scores:
	RegressionAUROC: 0.7822836637496948
	RegressionCompetitionScore: 0.4110429447852761



Validation scores:
	RegressionAUROC: 0.7781256437301636
	RegressionCompetitionScore: 0.37668711656441717



Validation scores:
	RegressionAUROC: 0.77406907081604
	RegressionCompetitionScore: 0.39846625766871163

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.157. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4438650306748466
     Test RegressionAUROC            0.7965657114982605
Test RegressionCompetitionScore      0.4438650306748466
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 12:32:55,069][0m Trial 393 finished with value: 0.4438650306748466 and parameters: {'lr': 0.0005813909273466087, 'dropout': 0.41114713475852105, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 171, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00026865199069083006, 'dropout': 0.45475606601399016, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 164, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 36.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
36.1 K    Trainable params
0         Non-trainable params
36.1 K    Total params
0.144     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.34057968854904175
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.6902166604995728
	RegressionCompetitionScore: 0.2607361963190184

Metric val_loss improved. New best score: 0.236


Validation scores:
	RegressionAUROC: 0.6895139217376709
	RegressionCompetitionScore: 0.31196319018404906



Validation scores:
	RegressionAUROC: 0.7104851603507996
	RegressionCompetitionScore: 0.26012269938650306

Metric val_loss improved by 0.041 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.7367967367172241
	RegressionCompetitionScore: 0.3880368098159509

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7419613599777222
	RegressionCompetitionScore: 0.38865030674846623



Validation scores:
	RegressionAUROC: 0.7542607188224792
	RegressionCompetitionScore: 0.3950920245398773

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7541495561599731
	RegressionCompetitionScore: 0.37975460122699384



Validation scores:
	RegressionAUROC: 0.7534716129302979
	RegressionCompetitionScore: 0.37147239263803683



Validation scores:
	RegressionAUROC: 0.7364686727523804
	RegressionCompetitionScore: 0.3628834355828221



Validation scores:
	RegressionAUROC: 0.7513693571090698
	RegressionCompetitionScore: 0.3726993865030675



Validation scores:
	RegressionAUROC: 0.7542057037353516
	RegressionCompetitionScore: 0.37423312883435583



Validation scores:
	RegressionAUROC: 0.7554879188537598
	RegressionCompetitionScore: 0.39263803680981596

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7596126198768616
	RegressionCompetitionScore: 0.3763803680981595



Validation scores:
	RegressionAUROC: 0.7610560655593872
	RegressionCompetitionScore: 0.37300613496932516



Validation scores:
	RegressionAUROC: 0.7678995132446289
	RegressionCompetitionScore: 0.3929447852760736



Validation scores:
	RegressionAUROC: 0.7692523002624512
	RegressionCompetitionScore: 0.41932515337423315



Validation scores:
	RegressionAUROC: 0.7586908340454102
	RegressionCompetitionScore: 0.3806748466257669



Validation scores:
	RegressionAUROC: 0.7567658424377441
	RegressionCompetitionScore: 0.3969325153374233



Validation scores:
	RegressionAUROC: 0.7556402683258057
	RegressionCompetitionScore: 0.3914110429447853

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.165. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.39263803680981596
     Test RegressionAUROC            0.7554879188537598
Test RegressionCompetitionScore      0.39263803680981596
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 12:40:42,670][0m Trial 394 finished with value: 0.39263803680981596 and parameters: {'lr': 0.00026865199069083006, 'dropout': 0.45475606601399016, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 164, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 1.3095463245439407e-07, 'dropout': 0.5173109992938372, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 138, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 34.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
34.3 K    Trainable params
0         Non-trainable params
34.3 K    Total params
0.137     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5265700817108154
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.5343858003616333
	RegressionCompetitionScore: 0.1588957055214724

Metric val_loss improved. New best score: 0.237


Validation scores:
	RegressionAUROC: 0.5349988341331482
	RegressionCompetitionScore: 0.16165644171779142

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.5351973176002502
	RegressionCompetitionScore: 0.16165644171779142

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.5354794263839722
	RegressionCompetitionScore: 0.16257668711656442

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.53559410572052
	RegressionCompetitionScore: 0.16319018404907976

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.5355603694915771
	RegressionCompetitionScore: 0.16319018404907976

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.5356268882751465
	RegressionCompetitionScore: 0.16319018404907976

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.5358636379241943
	RegressionCompetitionScore: 0.16441717791411042

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.5363262891769409
	RegressionCompetitionScore: 0.1659509202453988

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.223


Validation scores:
	RegressionAUROC: 0.5363490581512451
	RegressionCompetitionScore: 0.1668711656441718

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.223


Validation scores:
	RegressionAUROC: 0.5367079973220825
	RegressionCompetitionScore: 0.16656441717791412

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.5368161797523499
	RegressionCompetitionScore: 0.1656441717791411

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.5372087955474854
	RegressionCompetitionScore: 0.16748466257668712

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.5373989343643188
	RegressionCompetitionScore: 0.16748466257668712

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5374543070793152
	RegressionCompetitionScore: 0.16748466257668712

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5375403165817261
	RegressionCompetitionScore: 0.16717791411042945

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5375088453292847
	RegressionCompetitionScore: 0.1668711656441718

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.5377241373062134
	RegressionCompetitionScore: 0.16656441717791412

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.537898063659668
	RegressionCompetitionScore: 0.16717791411042945

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.5377380847930908
	RegressionCompetitionScore: 0.1668711656441718

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.5377234220504761
	RegressionCompetitionScore: 0.1668711656441718

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.537659764289856
	RegressionCompetitionScore: 0.1668711656441718

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.53788161277771
	RegressionCompetitionScore: 0.16717791411042945

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.5377537608146667
	RegressionCompetitionScore: 0.16717791411042945

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.5378755331039429
	RegressionCompetitionScore: 0.16717791411042945

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.538001298904419
	RegressionCompetitionScore: 0.16748466257668712

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.5378309488296509
	RegressionCompetitionScore: 0.1668711656441718

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.5377504825592041
	RegressionCompetitionScore: 0.1668711656441718

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.5377464294433594
	RegressionCompetitionScore: 0.16748466257668712

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.5375760197639465
	RegressionCompetitionScore: 0.1677914110429448

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.5376183986663818
	RegressionCompetitionScore: 0.16840490797546012

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.5377736687660217
	RegressionCompetitionScore: 0.16748466257668712



Validation scores:
	RegressionAUROC: 0.537669837474823
	RegressionCompetitionScore: 0.16932515337423312



Validation scores:
	RegressionAUROC: 0.5376761555671692
	RegressionCompetitionScore: 0.16901840490797546



Validation scores:
	RegressionAUROC: 0.5377562046051025
	RegressionCompetitionScore: 0.1687116564417178



Validation scores:
	RegressionAUROC: 0.537812352180481
	RegressionCompetitionScore: 0.16840490797546012



Validation scores:
	RegressionAUROC: 0.5376120209693909
	RegressionCompetitionScore: 0.16932515337423312



Validation scores:
	RegressionAUROC: 0.5376067161560059
	RegressionCompetitionScore: 0.16932515337423312

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.216. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.16840490797546012
     Test RegressionAUROC            0.5376183986663818
Test RegressionCompetitionScore      0.16840490797546012
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 12:56:02,023][0m Trial 395 finished with value: 0.16840490797546012 and parameters: {'lr': 1.3095463245439407e-07, 'dropout': 0.5173109992938372, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 138, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004014366835420003, 'dropout': 0.4091137195101534, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 32, 'dim_feedforward': 120, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 94.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
94.4 K    Trainable params
0         Non-trainable params
94.4 K    Total params
0.378     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6376811265945435
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7027441263198853
	RegressionCompetitionScore: 0.31625766871165645

Metric val_loss improved. New best score: 0.340


Validation scores:
	RegressionAUROC: 0.7187801599502563
	RegressionCompetitionScore: 0.34171779141104297

Metric val_loss improved by 0.108 >= min_delta = 0.0. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.7031430602073669
	RegressionCompetitionScore: 0.33220858895705524

Metric val_loss improved by 0.039 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7098695039749146
	RegressionCompetitionScore: 0.3257668711656442



Validation scores:
	RegressionAUROC: 0.7446259260177612
	RegressionCompetitionScore: 0.4012269938650307

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7571507692337036
	RegressionCompetitionScore: 0.4030674846625767

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7538219094276428
	RegressionCompetitionScore: 0.3834355828220859



Validation scores:
	RegressionAUROC: 0.7304936051368713
	RegressionCompetitionScore: 0.3303680981595092



Validation scores:
	RegressionAUROC: 0.7403839826583862
	RegressionCompetitionScore: 0.37699386503067484



Validation scores:
	RegressionAUROC: 0.7483710050582886
	RegressionCompetitionScore: 0.3791411042944785



Validation scores:
	RegressionAUROC: 0.7530659437179565
	RegressionCompetitionScore: 0.3585889570552147

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7538626194000244
	RegressionCompetitionScore: 0.3576687116564417



Validation scores:
	RegressionAUROC: 0.733660101890564
	RegressionCompetitionScore: 0.30030674846625766



Validation scores:
	RegressionAUROC: 0.7543846368789673
	RegressionCompetitionScore: 0.36717791411042944



Validation scores:
	RegressionAUROC: 0.7630337476730347
	RegressionCompetitionScore: 0.37852760736196317



Validation scores:
	RegressionAUROC: 0.7605640888214111
	RegressionCompetitionScore: 0.34202453987730064



Validation scores:
	RegressionAUROC: 0.7688226699829102
	RegressionCompetitionScore: 0.3852760736196319



Validation scores:
	RegressionAUROC: 0.7711833119392395
	RegressionCompetitionScore: 0.39386503067484663

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7718484997749329
	RegressionCompetitionScore: 0.4039877300613497



Validation scores:
	RegressionAUROC: 0.7627297639846802
	RegressionCompetitionScore: 0.3950920245398773



Validation scores:
	RegressionAUROC: 0.7665899991989136
	RegressionCompetitionScore: 0.3987730061349693



Validation scores:
	RegressionAUROC: 0.7621390223503113
	RegressionCompetitionScore: 0.3803680981595092



Validation scores:
	RegressionAUROC: 0.7620036005973816
	RegressionCompetitionScore: 0.399079754601227



Validation scores:
	RegressionAUROC: 0.7625107765197754
	RegressionCompetitionScore: 0.39723926380368096



Validation scores:
	RegressionAUROC: 0.7826823592185974
	RegressionCompetitionScore: 0.3987730061349693

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.160


Validation scores:
	RegressionAUROC: 0.7728466987609863
	RegressionCompetitionScore: 0.3782208588957055



Validation scores:
	RegressionAUROC: 0.7712900042533875
	RegressionCompetitionScore: 0.3861963190184049



Validation scores:
	RegressionAUROC: 0.7830665111541748
	RegressionCompetitionScore: 0.39815950920245397



Validation scores:
	RegressionAUROC: 0.7620301246643066
	RegressionCompetitionScore: 0.39386503067484663



Validation scores:
	RegressionAUROC: 0.7704924941062927
	RegressionCompetitionScore: 0.4279141104294479



Validation scores:
	RegressionAUROC: 0.7760907411575317
	RegressionCompetitionScore: 0.41319018404907976



Validation scores:
	RegressionAUROC: 0.7717844247817993
	RegressionCompetitionScore: 0.3914110429447853

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.160. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3987730061349693
     Test RegressionAUROC            0.7826823592185974
Test RegressionCompetitionScore      0.3987730061349693
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 13:10:28,878][0m Trial 396 finished with value: 0.3987730061349693 and parameters: {'lr': 0.0004014366835420003, 'dropout': 0.4091137195101534, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 32, 'dim_feedforward': 120, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005416921404721806, 'dropout': 0.4436122105860044, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 181, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 33.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
33.8 K    Trainable params
0         Non-trainable params
33.8 K    Total params
0.135     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5169081687927246
	RegressionCompetitionScore: 0.34782608695652173



Validation scores:
	RegressionAUROC: 0.7006049156188965
	RegressionCompetitionScore: 0.26319018404907973

Metric val_loss improved. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.7080768346786499
	RegressionCompetitionScore: 0.31349693251533745

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7379674911499023
	RegressionCompetitionScore: 0.36349693251533743

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7328882813453674
	RegressionCompetitionScore: 0.37116564417177916



Validation scores:
	RegressionAUROC: 0.7313128709793091
	RegressionCompetitionScore: 0.345398773006135



Validation scores:
	RegressionAUROC: 0.7475254535675049
	RegressionCompetitionScore: 0.39447852760736196



Validation scores:
	RegressionAUROC: 0.7726951241493225
	RegressionCompetitionScore: 0.4116564417177914

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7617937326431274
	RegressionCompetitionScore: 0.40950920245398775



Validation scores:
	RegressionAUROC: 0.7639522552490234
	RegressionCompetitionScore: 0.3895705521472393



Validation scores:
	RegressionAUROC: 0.7658016681671143
	RegressionCompetitionScore: 0.37607361963190183



Validation scores:
	RegressionAUROC: 0.7683569192886353
	RegressionCompetitionScore: 0.38312883435582823

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7762266397476196
	RegressionCompetitionScore: 0.40245398773006136

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7609705328941345
	RegressionCompetitionScore: 0.4092024539877301



Validation scores:
	RegressionAUROC: 0.773627519607544
	RegressionCompetitionScore: 0.41042944785276075

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.7751531004905701
	RegressionCompetitionScore: 0.4110429447852761



Validation scores:
	RegressionAUROC: 0.7775607109069824
	RegressionCompetitionScore: 0.37699386503067484

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.160


Validation scores:
	RegressionAUROC: 0.7743746638298035
	RegressionCompetitionScore: 0.37423312883435583



Validation scores:
	RegressionAUROC: 0.7773959040641785
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.776840329170227
	RegressionCompetitionScore: 0.4147239263803681



Validation scores:
	RegressionAUROC: 0.7865294218063354
	RegressionCompetitionScore: 0.4171779141104294



Validation scores:
	RegressionAUROC: 0.7841481566429138
	RegressionCompetitionScore: 0.4260736196319018

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.158


Validation scores:
	RegressionAUROC: 0.7827626466751099
	RegressionCompetitionScore: 0.38374233128834356



Validation scores:
	RegressionAUROC: 0.7828658819198608
	RegressionCompetitionScore: 0.36779141104294477



Validation scores:
	RegressionAUROC: 0.7925158143043518
	RegressionCompetitionScore: 0.4199386503067485



Validation scores:
	RegressionAUROC: 0.7820712327957153
	RegressionCompetitionScore: 0.4251533742331288



Validation scores:
	RegressionAUROC: 0.7946904301643372
	RegressionCompetitionScore: 0.41779141104294476

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.157


Validation scores:
	RegressionAUROC: 0.7941590547561646
	RegressionCompetitionScore: 0.4128834355828221



Validation scores:
	RegressionAUROC: 0.7965137958526611
	RegressionCompetitionScore: 0.3791411042944785



Validation scores:
	RegressionAUROC: 0.7926604747772217
	RegressionCompetitionScore: 0.3950920245398773



Validation scores:
	RegressionAUROC: 0.793083906173706
	RegressionCompetitionScore: 0.404601226993865



Validation scores:
	RegressionAUROC: 0.7915711998939514
	RegressionCompetitionScore: 0.4165644171779141



Validation scores:
	RegressionAUROC: 0.7835180759429932
	RegressionCompetitionScore: 0.32699386503067485



Validation scores:
	RegressionAUROC: 0.7909588813781738
	RegressionCompetitionScore: 0.37331288343558283

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.157. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.41779141104294476
     Test RegressionAUROC            0.7946904301643372
Test RegressionCompetitionScore      0.41779141104294476
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 13:23:38,447][0m Trial 397 finished with value: 0.41779141104294476 and parameters: {'lr': 0.0005416921404721806, 'dropout': 0.4436122105860044, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 181, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 6.323311612201851e-06, 'dropout': 0.4240890010806077, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 151, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 35.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
35.2 K    Trainable params
0         Non-trainable params
35.2 K    Total params
0.141     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4057970941066742
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5330246686935425
	RegressionCompetitionScore: 0.10552147239263804

Metric val_loss improved. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.546703040599823
	RegressionCompetitionScore: 0.11104294478527607



Validation scores:
	RegressionAUROC: 0.520241379737854
	RegressionCompetitionScore: 0.10766871165644172

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5245813131332397
	RegressionCompetitionScore: 0.10950920245398774

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5335301160812378
	RegressionCompetitionScore: 0.10797546012269939

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.528157114982605
	RegressionCompetitionScore: 0.10705521472392639

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5375595092773438
	RegressionCompetitionScore: 0.1067484662576687

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.549792468547821
	RegressionCompetitionScore: 0.1049079754601227

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.5690135955810547
	RegressionCompetitionScore: 0.10858895705521472

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.57757568359375
	RegressionCompetitionScore: 0.10705521472392639



Validation scores:
	RegressionAUROC: 0.5890744924545288
	RegressionCompetitionScore: 0.11012269938650307



Validation scores:
	RegressionAUROC: 0.6037373542785645
	RegressionCompetitionScore: 0.1343558282208589



Validation scores:
	RegressionAUROC: 0.6018702387809753
	RegressionCompetitionScore: 0.1383435582822086



Validation scores:
	RegressionAUROC: 0.6041411757469177
	RegressionCompetitionScore: 0.14662576687116563

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6076843738555908
	RegressionCompetitionScore: 0.1754601226993865

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6125115156173706
	RegressionCompetitionScore: 0.18711656441717792

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6108599901199341
	RegressionCompetitionScore: 0.1754601226993865

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6103217005729675
	RegressionCompetitionScore: 0.17208588957055215



Validation scores:
	RegressionAUROC: 0.6131905913352966
	RegressionCompetitionScore: 0.18588957055214725

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6148936748504639
	RegressionCompetitionScore: 0.19969325153374234



Validation scores:
	RegressionAUROC: 0.6182276010513306
	RegressionCompetitionScore: 0.2236196319018405



Validation scores:
	RegressionAUROC: 0.6189628839492798
	RegressionCompetitionScore: 0.23496932515337424

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6198768019676208
	RegressionCompetitionScore: 0.23282208588957054



Validation scores:
	RegressionAUROC: 0.6196941137313843
	RegressionCompetitionScore: 0.22515337423312884

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6228232979774475
	RegressionCompetitionScore: 0.2383435582822086

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6251525282859802
	RegressionCompetitionScore: 0.23282208588957054

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6279285550117493
	RegressionCompetitionScore: 0.24294478527607363

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6299272775650024
	RegressionCompetitionScore: 0.24263803680981594



Validation scores:
	RegressionAUROC: 0.631546676158905
	RegressionCompetitionScore: 0.24447852760736197



Validation scores:
	RegressionAUROC: 0.6320197582244873
	RegressionCompetitionScore: 0.24263803680981594



Validation scores:
	RegressionAUROC: 0.6315258741378784
	RegressionCompetitionScore: 0.248159509202454



Validation scores:
	RegressionAUROC: 0.6319553852081299
	RegressionCompetitionScore: 0.25



Validation scores:
	RegressionAUROC: 0.6333413124084473
	RegressionCompetitionScore: 0.25337423312883434



Validation scores:
	RegressionAUROC: 0.635672390460968
	RegressionCompetitionScore: 0.24846625766871167

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6388556957244873
	RegressionCompetitionScore: 0.24723926380368097

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6418153047561646
	RegressionCompetitionScore: 0.24846625766871167

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6442798376083374
	RegressionCompetitionScore: 0.24662576687116564



Validation scores:
	RegressionAUROC: 0.6458261609077454
	RegressionCompetitionScore: 0.253680981595092



Validation scores:
	RegressionAUROC: 0.648601770401001
	RegressionCompetitionScore: 0.25552147239263806



Validation scores:
	RegressionAUROC: 0.6498262286186218
	RegressionCompetitionScore: 0.25828220858895706



Validation scores:
	RegressionAUROC: 0.6496020555496216
	RegressionCompetitionScore: 0.26196319018404907



Validation scores:
	RegressionAUROC: 0.650660514831543
	RegressionCompetitionScore: 0.2549079754601227

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.652892529964447
	RegressionCompetitionScore: 0.25061349693251533

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.655308723449707
	RegressionCompetitionScore: 0.25306748466257667

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6568810939788818
	RegressionCompetitionScore: 0.253680981595092



Validation scores:
	RegressionAUROC: 0.6590523719787598
	RegressionCompetitionScore: 0.25552147239263806



Validation scores:
	RegressionAUROC: 0.6611695289611816
	RegressionCompetitionScore: 0.25736196319018406

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.6645444631576538
	RegressionCompetitionScore: 0.254601226993865



Validation scores:
	RegressionAUROC: 0.6669482588768005
	RegressionCompetitionScore: 0.2598159509202454



Validation scores:
	RegressionAUROC: 0.6684296131134033
	RegressionCompetitionScore: 0.25828220858895706

`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.25736196319018406
     Test RegressionAUROC            0.6611695289611816
Test RegressionCompetitionScore      0.25736196319018406
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 13:43:29,909][0m Trial 398 finished with value: 0.25736196319018406 and parameters: {'lr': 6.323311612201851e-06, 'dropout': 0.4240890010806077, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 151, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00033288929812112534, 'dropout': 0.6568778484294976, 'd_model_multiplier': 32, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 135, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 918 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
918 K     Trainable params
0         Non-trainable params
918 K     Total params
3.676     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5362318754196167
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6521549224853516
	RegressionCompetitionScore: 0.32331288343558284

Metric val_loss improved. New best score: 0.777


Validation scores:
	RegressionAUROC: 0.6800739169120789
	RegressionCompetitionScore: 0.30122699386503066



Validation scores:
	RegressionAUROC: 0.6987664103507996
	RegressionCompetitionScore: 0.3432515337423313

Metric val_loss improved by 0.149 >= min_delta = 0.0. New best score: 0.628


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.589999258518219
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.060 >= min_delta = 0.0. New best score: 0.568


Validation scores:
	RegressionAUROC: 0.6708798408508301
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.213 >= min_delta = 0.0. New best score: 0.355


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6886059045791626
	RegressionCompetitionScore: 0.2766871165644172

Metric val_loss improved by 0.170 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.6908237934112549
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6856386661529541
	RegressionCompetitionScore: 0.26809815950920246



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5978044271469116
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6872026324272156
	RegressionCompetitionScore: 0.2549079754601227



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.184. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2766871165644172
     Test RegressionAUROC            0.6886059045791626
Test RegressionCompetitionScore      0.2766871165644172
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 13:49:43,428][0m Trial 399 finished with value: 0.2766871165644172 and parameters: {'lr': 0.00033288929812112534, 'dropout': 0.6568778484294976, 'd_model_multiplier': 32, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 135, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005603344160914471, 'dropout': 0.4001509656610714, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 104, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 25.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
25.7 K    Trainable params
0         Non-trainable params
25.7 K    Total params
0.103     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6663840413093567
	RegressionCompetitionScore: 0.14693251533742333

Metric val_loss improved. New best score: 0.290


Validation scores:
	RegressionAUROC: 0.633838415145874
	RegressionCompetitionScore: 0.12331288343558282

Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.260


Validation scores:
	RegressionAUROC: 0.6305555701255798
	RegressionCompetitionScore: 0.12024539877300613



Validation scores:
	RegressionAUROC: 0.7132158279418945
	RegressionCompetitionScore: 0.3312883435582822

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.7415715456008911
	RegressionCompetitionScore: 0.36625766871165644



Validation scores:
	RegressionAUROC: 0.7042242884635925
	RegressionCompetitionScore: 0.3450920245398773



Validation scores:
	RegressionAUROC: 0.7277547121047974
	RegressionCompetitionScore: 0.3389570552147239



Validation scores:
	RegressionAUROC: 0.6999469995498657
	RegressionCompetitionScore: 0.3076687116564417



Validation scores:
	RegressionAUROC: 0.7091281414031982
	RegressionCompetitionScore: 0.3230061349693252



Validation scores:
	RegressionAUROC: 0.722743570804596
	RegressionCompetitionScore: 0.3647239263803681



Validation scores:
	RegressionAUROC: 0.6973009705543518
	RegressionCompetitionScore: 0.3380368098159509

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.238. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3312883435582822
     Test RegressionAUROC            0.7132158279418945
Test RegressionCompetitionScore      0.3312883435582822
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 13:54:24,755][0m Trial 400 finished with value: 0.3312883435582822 and parameters: {'lr': 0.0005603344160914471, 'dropout': 0.4001509656610714, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 104, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00024001694638245958, 'dropout': 0.5686020041553731, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 168, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 33.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
33.1 K    Trainable params
0         Non-trainable params
33.1 K    Total params
0.133     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.294685959815979
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6427537202835083
	RegressionCompetitionScore: 0.12024539877300613

Metric val_loss improved. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6919450759887695
	RegressionCompetitionScore: 0.2285276073619632

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.7159088253974915
	RegressionCompetitionScore: 0.2950920245398773



Validation scores:
	RegressionAUROC: 0.7257949113845825
	RegressionCompetitionScore: 0.2920245398773006

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.7225773334503174
	RegressionCompetitionScore: 0.3174846625766871



Validation scores:
	RegressionAUROC: 0.7366635799407959
	RegressionCompetitionScore: 0.36687116564417177

Metric val_loss improved by 0.027 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7405226230621338
	RegressionCompetitionScore: 0.37116564417177916



Validation scores:
	RegressionAUROC: 0.7365966439247131
	RegressionCompetitionScore: 0.3254601226993865



Validation scores:
	RegressionAUROC: 0.7465531826019287
	RegressionCompetitionScore: 0.3674846625766871



Validation scores:
	RegressionAUROC: 0.7491166591644287
	RegressionCompetitionScore: 0.3929447852760736



Validation scores:
	RegressionAUROC: 0.7475590705871582
	RegressionCompetitionScore: 0.38098159509202456

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7596631050109863
	RegressionCompetitionScore: 0.39263803680981596

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7563067078590393
	RegressionCompetitionScore: 0.3708588957055215

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7270183563232422
	RegressionCompetitionScore: 0.31993865030674845



Validation scores:
	RegressionAUROC: 0.7474746108055115
	RegressionCompetitionScore: 0.3276073619631902



Validation scores:
	RegressionAUROC: 0.7620373964309692
	RegressionCompetitionScore: 0.39263803680981596

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7536689639091492
	RegressionCompetitionScore: 0.38282208588957056



Validation scores:
	RegressionAUROC: 0.7440516948699951
	RegressionCompetitionScore: 0.35460122699386504



Validation scores:
	RegressionAUROC: 0.7468995451927185
	RegressionCompetitionScore: 0.3595092024539877



Validation scores:
	RegressionAUROC: 0.7550793886184692
	RegressionCompetitionScore: 0.39969325153374236



Validation scores:
	RegressionAUROC: 0.7375887036323547
	RegressionCompetitionScore: 0.3245398773006135



Validation scores:
	RegressionAUROC: 0.7497515678405762
	RegressionCompetitionScore: 0.3773006134969325



Validation scores:
	RegressionAUROC: 0.747365415096283
	RegressionCompetitionScore: 0.33159509202453985

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.168. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.39263803680981596
     Test RegressionAUROC            0.7620373964309692
Test RegressionCompetitionScore      0.39263803680981596
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 14:03:43,970][0m Trial 401 finished with value: 0.39263803680981596 and parameters: {'lr': 0.00024001694638245958, 'dropout': 0.5686020041553731, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 168, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0003751413004212851, 'dropout': 0.777612325023314, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 190, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 37.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
37.8 K    Trainable params
0         Non-trainable params
37.8 K    Total params
0.151     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4637681245803833
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.46624523401260376
	RegressionCompetitionScore: 0.09447852760736196

Metric val_loss improved. New best score: 0.275


Validation scores:
	RegressionAUROC: 0.6084270477294922
	RegressionCompetitionScore: 0.23404907975460124

Metric val_loss improved by 0.061 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.4722742438316345
	RegressionCompetitionScore: 0.09325153374233129



Validation scores:
	RegressionAUROC: 0.5270506739616394
	RegressionCompetitionScore: 0.07975460122699386

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.45318764448165894
	RegressionCompetitionScore: 0.06932515337423313



Validation scores:
	RegressionAUROC: 0.5448347330093384
	RegressionCompetitionScore: 0.08742331288343558



Validation scores:
	RegressionAUROC: 0.6467785835266113
	RegressionCompetitionScore: 0.13404907975460123



Validation scores:
	RegressionAUROC: 0.6715433597564697
	RegressionCompetitionScore: 0.19325153374233128

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6596014499664307
	RegressionCompetitionScore: 0.14049079754601226



Validation scores:
	RegressionAUROC: 0.6305059194564819
	RegressionCompetitionScore: 0.11257668711656442



Validation scores:
	RegressionAUROC: 0.6519950032234192
	RegressionCompetitionScore: 0.20736196319018405



Validation scores:
	RegressionAUROC: 0.6698502898216248
	RegressionCompetitionScore: 0.13067484662576687



Validation scores:
	RegressionAUROC: 0.6746330261230469
	RegressionCompetitionScore: 0.11809815950920245



Validation scores:
	RegressionAUROC: 0.6698979139328003
	RegressionCompetitionScore: 0.10245398773006135



Validation scores:
	RegressionAUROC: 0.6651907563209534
	RegressionCompetitionScore: 0.09417177914110429

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.206. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.19325153374233128
     Test RegressionAUROC            0.6715433597564697
Test RegressionCompetitionScore      0.19325153374233128
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 14:10:00,392][0m Trial 402 finished with value: 0.19325153374233128 and parameters: {'lr': 0.0003751413004212851, 'dropout': 0.777612325023314, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 190, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.000720860754303275, 'dropout': 0.5892521358876651, 'd_model_multiplier': 8, 'num_layers': 4, 'n_heads': 64, 'dim_feedforward': 126, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 5.2 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
5.2 M     Trainable params
0         Non-trainable params
5.2 M     Total params
20.864    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5748792290687561
	RegressionCompetitionScore: 0.391304347826087



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 113.125


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 112.609 >= min_delta = 0.0. New best score: 0.515


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6004146933555603
	RegressionCompetitionScore: 0.2411042944785276

Metric val_loss improved by 0.272 >= min_delta = 0.0. New best score: 0.244


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6678129434585571
	RegressionCompetitionScore: 0.2634969325153374

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5856752991676331
	RegressionCompetitionScore: 0.09877300613496932



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.640312671661377
	RegressionCompetitionScore: 0.2880368098159509

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2880368098159509
     Test RegressionAUROC             0.640312671661377
Test RegressionCompetitionScore      0.2880368098159509
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 14:25:43,279][0m Trial 403 finished with value: 0.2880368098159509 and parameters: {'lr': 0.000720860754303275, 'dropout': 0.5892521358876651, 'd_model_multiplier': 8, 'num_layers': 4, 'n_heads': 64, 'dim_feedforward': 126, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005057182891419944, 'dropout': 0.6461398060454953, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 153, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 29.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
29.4 K    Trainable params
0         Non-trainable params
29.4 K    Total params
0.118     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6924551725387573
	RegressionCompetitionScore: 0.15828220858895706

Metric val_loss improved. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6773539185523987
	RegressionCompetitionScore: 0.26411042944785273



Validation scores:
	RegressionAUROC: 0.6405366659164429
	RegressionCompetitionScore: 0.2907975460122699



Validation scores:
	RegressionAUROC: 0.6921343803405762
	RegressionCompetitionScore: 0.251840490797546



Validation scores:
	RegressionAUROC: 0.6855632066726685
	RegressionCompetitionScore: 0.26993865030674846



Validation scores:
	RegressionAUROC: 0.714082658290863
	RegressionCompetitionScore: 0.3361963190184049



Validation scores:
	RegressionAUROC: 0.7140989303588867
	RegressionCompetitionScore: 0.2411042944785276



Validation scores:
	RegressionAUROC: 0.6811180710792542
	RegressionCompetitionScore: 0.2561349693251534

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.194. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.15828220858895706
     Test RegressionAUROC            0.6924551725387573
Test RegressionCompetitionScore      0.15828220858895706
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 14:29:14,097][0m Trial 404 finished with value: 0.15828220858895706 and parameters: {'lr': 0.0005057182891419944, 'dropout': 0.6461398060454953, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 153, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0009169610583895389, 'dropout': 0.6532087035073362, 'd_model_multiplier': 2, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 582, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 92.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
92.1 K    Trainable params
0         Non-trainable params
92.1 K    Total params
0.368     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4975845217704773
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5927432775497437
	RegressionCompetitionScore: 0.09846625766871166

Metric val_loss improved. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.6293672323226929
	RegressionCompetitionScore: 0.27177914110429446

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6334378719329834
	RegressionCompetitionScore: 0.25766871165644173



Validation scores:
	RegressionAUROC: 0.6187987327575684
	RegressionCompetitionScore: 0.12883435582822086



Validation scores:
	RegressionAUROC: 0.6209043264389038
	RegressionCompetitionScore: 0.09110429447852761



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.206. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.27177914110429446
     Test RegressionAUROC            0.6293672323226929
Test RegressionCompetitionScore      0.27177914110429446
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 14:33:09,923][0m Trial 405 finished with value: 0.27177914110429446 and parameters: {'lr': 0.0009169610583895389, 'dropout': 0.6532087035073362, 'd_model_multiplier': 2, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 582, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0015525183918478542, 'dropout': 0.43279853670671625, 'd_model_multiplier': 64, 'num_layers': 4, 'n_heads': 32, 'dim_feedforward': 89, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 70.5 M
1 | loss_fn | MSELoss | 0     
------------------------------------
70.5 M    Trainable params
0         Non-trainable params
70.5 M    Total params
282.158   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.299516886472702
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 395202.188


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 292620.562 >= min_delta = 0.0. New best score: 102581.625


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 66420.523 >= min_delta = 0.0. New best score: 36161.102


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 32356.455 >= min_delta = 0.0. New best score: 3804.646


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 3741.388 >= min_delta = 0.0. New best score: 63.258


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 63.258. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 14:55:55,840][0m Trial 406 finished with value: 0.0 and parameters: {'lr': 0.0015525183918478542, 'dropout': 0.43279853670671625, 'd_model_multiplier': 64, 'num_layers': 4, 'n_heads': 32, 'dim_feedforward': 89, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00028548267008564164, 'dropout': 0.665380976535983, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 177, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 26.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
26.9 K    Trainable params
0         Non-trainable params
26.9 K    Total params
0.108     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.294685959815979
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6365411281585693
	RegressionCompetitionScore: 0.1432515337423313

Metric val_loss improved. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6553637981414795
	RegressionCompetitionScore: 0.3285276073619632

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.6679866313934326
	RegressionCompetitionScore: 0.32423312883435584



Validation scores:
	RegressionAUROC: 0.6926354169845581
	RegressionCompetitionScore: 0.2776073619631902



Validation scores:
	RegressionAUROC: 0.6835074424743652
	RegressionCompetitionScore: 0.3079754601226994



Validation scores:
	RegressionAUROC: 0.7058417797088623
	RegressionCompetitionScore: 0.3079754601226994

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7050154209136963
	RegressionCompetitionScore: 0.30644171779141105



Validation scores:
	RegressionAUROC: 0.7094011306762695
	RegressionCompetitionScore: 0.30214723926380366



Validation scores:
	RegressionAUROC: 0.6936060190200806
	RegressionCompetitionScore: 0.2917177914110429



Validation scores:
	RegressionAUROC: 0.6831504702568054
	RegressionCompetitionScore: 0.32607361963190185



Validation scores:
	RegressionAUROC: 0.7036657929420471
	RegressionCompetitionScore: 0.33067484662576685



Validation scores:
	RegressionAUROC: 0.6976459622383118
	RegressionCompetitionScore: 0.30214723926380366



Validation scores:
	RegressionAUROC: 0.687713623046875
	RegressionCompetitionScore: 0.3220858895705521

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.182. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3079754601226994
     Test RegressionAUROC            0.7058417797088623
Test RegressionCompetitionScore      0.3079754601226994
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 15:01:24,158][0m Trial 407 finished with value: 0.3079754601226994 and parameters: {'lr': 0.00028548267008564164, 'dropout': 0.665380976535983, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 177, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00041368505059644214, 'dropout': 0.6221129718906026, 'd_model_multiplier': 16, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 608, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 802 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
802 K     Trainable params
0         Non-trainable params
802 K     Total params
3.211     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5869565010070801
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6871535778045654
	RegressionCompetitionScore: 0.31257668711656444

Metric val_loss improved. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6186729669570923
	RegressionCompetitionScore: 0.07576687116564418



Validation scores:
	RegressionAUROC: 0.6598918437957764
	RegressionCompetitionScore: 0.20429447852760735



Validation scores:
	RegressionAUROC: 0.6419870257377625
	RegressionCompetitionScore: 0.25429447852760734



Validation scores:
	RegressionAUROC: 0.6373593807220459
	RegressionCompetitionScore: 0.25337423312883434

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6291900873184204
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6341365575790405
	RegressionCompetitionScore: 0.2579754601226994



Validation scores:
	RegressionAUROC: 0.6348718404769897
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.58769291639328
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5005123615264893
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5948801040649414
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.199. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.25337423312883434
     Test RegressionAUROC            0.6373593807220459
Test RegressionCompetitionScore      0.25337423312883434
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 15:06:31,665][0m Trial 408 finished with value: 0.25337423312883434 and parameters: {'lr': 0.00041368505059644214, 'dropout': 0.6221129718906026, 'd_model_multiplier': 16, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 608, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.000646231777272669, 'dropout': 0.4605885554182128, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 105, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 32.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
32.0 K    Trainable params
0         Non-trainable params
32.0 K    Total params
0.128     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5193237066268921
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5584471225738525
	RegressionCompetitionScore: 0.07331288343558282

Metric val_loss improved. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6704533696174622
	RegressionCompetitionScore: 0.2411042944785276



Validation scores:
	RegressionAUROC: 0.7176474332809448
	RegressionCompetitionScore: 0.3141104294478528

Metric val_loss improved by 0.027 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7127167582511902
	RegressionCompetitionScore: 0.34049079754601225

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7339708209037781
	RegressionCompetitionScore: 0.37147239263803683

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7405552268028259
	RegressionCompetitionScore: 0.37883435582822084

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7473263740539551
	RegressionCompetitionScore: 0.3512269938650307



Validation scores:
	RegressionAUROC: 0.7583448886871338
	RegressionCompetitionScore: 0.39386503067484663

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7709221839904785
	RegressionCompetitionScore: 0.41319018404907976



Validation scores:
	RegressionAUROC: 0.7728894948959351
	RegressionCompetitionScore: 0.399079754601227



Validation scores:
	RegressionAUROC: 0.7706954479217529
	RegressionCompetitionScore: 0.34846625766871164



Validation scores:
	RegressionAUROC: 0.7744653820991516
	RegressionCompetitionScore: 0.3993865030674847



Validation scores:
	RegressionAUROC: 0.7784978151321411
	RegressionCompetitionScore: 0.4457055214723926



Validation scores:
	RegressionAUROC: 0.7808737754821777
	RegressionCompetitionScore: 0.4233128834355828

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7832409143447876
	RegressionCompetitionScore: 0.4269938650306748

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7891619801521301
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7871907353401184
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7877209186553955
	RegressionCompetitionScore: 0.4634969325153374



Validation scores:
	RegressionAUROC: 0.7739145755767822
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7839854955673218
	RegressionCompetitionScore: 0.35153374233128837



Validation scores:
	RegressionAUROC: 0.779138445854187
	RegressionCompetitionScore: 0.4263803680981595



Validation scores:
	RegressionAUROC: 0.7676299810409546
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.165. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4269938650306748
     Test RegressionAUROC            0.7832409143447876
Test RegressionCompetitionScore      0.4269938650306748
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 15:15:29,814][0m Trial 409 finished with value: 0.4269938650306748 and parameters: {'lr': 0.000646231777272669, 'dropout': 0.4605885554182128, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 105, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 1.0819370734070905e-05, 'dropout': 0.4603683589143911, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 105, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 27.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
27.8 K    Trainable params
0         Non-trainable params
27.8 K    Total params
0.111     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.705314040184021
	RegressionCompetitionScore: 0.4782608695652174



Validation scores:
	RegressionAUROC: 0.5589171051979065
	RegressionCompetitionScore: 0.1411042944785276

Metric val_loss improved. New best score: 0.244


Validation scores:
	RegressionAUROC: 0.5745190978050232
	RegressionCompetitionScore: 0.1794478527607362

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.242


Validation scores:
	RegressionAUROC: 0.602273166179657
	RegressionCompetitionScore: 0.2312883435582822

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6269468069076538
	RegressionCompetitionScore: 0.23650306748466257

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6456636190414429
	RegressionCompetitionScore: 0.20889570552147238

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6638710498809814
	RegressionCompetitionScore: 0.2049079754601227

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6744780540466309
	RegressionCompetitionScore: 0.1754601226993865



Validation scores:
	RegressionAUROC: 0.6791292428970337
	RegressionCompetitionScore: 0.17484662576687116

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6833076477050781
	RegressionCompetitionScore: 0.2125766871165644

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.6859990954399109
	RegressionCompetitionScore: 0.2469325153374233



Validation scores:
	RegressionAUROC: 0.6848300695419312
	RegressionCompetitionScore: 0.26226993865030673

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.6854512691497803
	RegressionCompetitionScore: 0.26226993865030673

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.6900026798248291
	RegressionCompetitionScore: 0.2450920245398773



Validation scores:
	RegressionAUROC: 0.6897197961807251
	RegressionCompetitionScore: 0.24723926380368097

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.6904374361038208
	RegressionCompetitionScore: 0.254601226993865

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.6929515600204468
	RegressionCompetitionScore: 0.26717791411042946



Validation scores:
	RegressionAUROC: 0.6961328983306885
	RegressionCompetitionScore: 0.2705521472392638



Validation scores:
	RegressionAUROC: 0.6973934173583984
	RegressionCompetitionScore: 0.26533742331288346



Validation scores:
	RegressionAUROC: 0.6991887092590332
	RegressionCompetitionScore: 0.2776073619631902



Validation scores:
	RegressionAUROC: 0.7009365558624268
	RegressionCompetitionScore: 0.28404907975460125



Validation scores:
	RegressionAUROC: 0.6996489763259888
	RegressionCompetitionScore: 0.2782208588957055

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.6994558572769165
	RegressionCompetitionScore: 0.28067484662576686

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7022329568862915
	RegressionCompetitionScore: 0.28282208588957053

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7028229832649231
	RegressionCompetitionScore: 0.2846625766871166



Validation scores:
	RegressionAUROC: 0.7049694061279297
	RegressionCompetitionScore: 0.2865030674846626



Validation scores:
	RegressionAUROC: 0.7071343660354614
	RegressionCompetitionScore: 0.296319018404908

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7099409103393555
	RegressionCompetitionScore: 0.29386503067484665

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7107998728752136
	RegressionCompetitionScore: 0.29570552147239265



Validation scores:
	RegressionAUROC: 0.7121788859367371
	RegressionCompetitionScore: 0.29938650306748466



Validation scores:
	RegressionAUROC: 0.7151440978050232
	RegressionCompetitionScore: 0.295398773006135



Validation scores:
	RegressionAUROC: 0.7128349542617798
	RegressionCompetitionScore: 0.2978527607361963

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7165135145187378
	RegressionCompetitionScore: 0.29938650306748466

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7162684798240662
	RegressionCompetitionScore: 0.29570552147239265

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7162420153617859
	RegressionCompetitionScore: 0.2969325153374233



Validation scores:
	RegressionAUROC: 0.7171399593353271
	RegressionCompetitionScore: 0.2978527607361963



Validation scores:
	RegressionAUROC: 0.7217934727668762
	RegressionCompetitionScore: 0.3006134969325153



Validation scores:
	RegressionAUROC: 0.7226454615592957
	RegressionCompetitionScore: 0.30644171779141105



Validation scores:
	RegressionAUROC: 0.723147451877594
	RegressionCompetitionScore: 0.3076687116564417



Validation scores:
	RegressionAUROC: 0.7235445380210876
	RegressionCompetitionScore: 0.3058282208588957



Validation scores:
	RegressionAUROC: 0.7273277044296265
	RegressionCompetitionScore: 0.3177914110429448

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.29570552147239265
     Test RegressionAUROC            0.7162684798240662
Test RegressionCompetitionScore      0.29570552147239265
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 15:31:26,755][0m Trial 410 finished with value: 0.29570552147239265 and parameters: {'lr': 1.0819370734070905e-05, 'dropout': 0.4603683589143911, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 105, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00798503042268199, 'dropout': 0.47127784601408856, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 94, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 29.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
29.4 K    Trainable params
0         Non-trainable params
29.4 K    Total params
0.117     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 15:35:13,535][0m Trial 411 finished with value: 0.0 and parameters: {'lr': 0.00798503042268199, 'dropout': 0.47127784601408856, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 94, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0012591127279476147, 'dropout': 0.45087592184489, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 4, 'dim_feedforward': 123, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 21.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
21.1 K    Trainable params
0         Non-trainable params
21.1 K    Total params
0.084     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.683574914932251
	RegressionCompetitionScore: 0.4782608695652174



Validation scores:
	RegressionAUROC: 0.48740580677986145
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.779


Validation scores:
	RegressionAUROC: 0.542019248008728
	RegressionCompetitionScore: 0.08282208588957055

Metric val_loss improved by 0.306 >= min_delta = 0.0. New best score: 0.473


Validation scores:
	RegressionAUROC: 0.5682592391967773
	RegressionCompetitionScore: 0.10337423312883436

Metric val_loss improved by 0.140 >= min_delta = 0.0. New best score: 0.334


Validation scores:
	RegressionAUROC: 0.6083697080612183
	RegressionCompetitionScore: 0.14079754601226993

Metric val_loss improved by 0.129 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6293396949768066
	RegressionCompetitionScore: 0.21012269938650308



Validation scores:
	RegressionAUROC: 0.6536920666694641
	RegressionCompetitionScore: 0.23650306748466257



Validation scores:
	RegressionAUROC: 0.6612451076507568
	RegressionCompetitionScore: 0.18466257668711655



Validation scores:
	RegressionAUROC: 0.6608483195304871
	RegressionCompetitionScore: 0.14693251533742333



Validation scores:
	RegressionAUROC: 0.659802258014679
	RegressionCompetitionScore: 0.12361963190184048



Validation scores:
	RegressionAUROC: 0.6596828699111938
	RegressionCompetitionScore: 0.11932515337423313



Validation scores:
	RegressionAUROC: 0.6571547985076904
	RegressionCompetitionScore: 0.11779141104294479

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.205. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.14079754601226993
     Test RegressionAUROC            0.6083697080612183
Test RegressionCompetitionScore      0.14079754601226993
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 15:39:52,028][0m Trial 412 finished with value: 0.14079754601226993 and parameters: {'lr': 0.0012591127279476147, 'dropout': 0.45087592184489, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 4, 'dim_feedforward': 123, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0007821051779512757, 'dropout': 0.5353763596181601, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 83, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 30.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
30.5 K    Trainable params
0         Non-trainable params
30.5 K    Total params
0.122     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.32367148995399475
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6537691354751587
	RegressionCompetitionScore: 0.09785276073619632

Metric val_loss improved. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6855649352073669
	RegressionCompetitionScore: 0.2331288343558282

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6478399038314819
	RegressionCompetitionScore: 0.25828220858895706

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6847386360168457
	RegressionCompetitionScore: 0.26042944785276073

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6966529488563538
	RegressionCompetitionScore: 0.2871165644171779

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7046264410018921
	RegressionCompetitionScore: 0.26932515337423313

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7276971340179443
	RegressionCompetitionScore: 0.3257668711656442

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7362046241760254
	RegressionCompetitionScore: 0.3579754601226994

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7473845481872559
	RegressionCompetitionScore: 0.33588957055214724



Validation scores:
	RegressionAUROC: 0.7597137689590454
	RegressionCompetitionScore: 0.3754601226993865



Validation scores:
	RegressionAUROC: 0.7920129299163818
	RegressionCompetitionScore: 0.36411042944785277

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7933526039123535
	RegressionCompetitionScore: 0.39662576687116563

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.159


Validation scores:
	RegressionAUROC: 0.7806524634361267
	RegressionCompetitionScore: 0.37699386503067484



Validation scores:
	RegressionAUROC: 0.7947434186935425
	RegressionCompetitionScore: 0.40521472392638036



Validation scores:
	RegressionAUROC: 0.7952876687049866
	RegressionCompetitionScore: 0.4138036809815951



Validation scores:
	RegressionAUROC: 0.8044119477272034
	RegressionCompetitionScore: 0.4460122699386503

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.154


Validation scores:
	RegressionAUROC: 0.773679792881012
	RegressionCompetitionScore: 0.39263803680981596



Validation scores:
	RegressionAUROC: 0.7614591121673584
	RegressionCompetitionScore: 0.42208588957055215



Validation scores:
	RegressionAUROC: 0.7859728336334229
	RegressionCompetitionScore: 0.4226993865030675



Validation scores:
	RegressionAUROC: 0.7814141511917114
	RegressionCompetitionScore: 0.4058282208588957



Validation scores:
	RegressionAUROC: 0.7912087440490723
	RegressionCompetitionScore: 0.39539877300613496



Validation scores:
	RegressionAUROC: 0.7859244346618652
	RegressionCompetitionScore: 0.3619631901840491



Validation scores:
	RegressionAUROC: 0.7815725803375244
	RegressionCompetitionScore: 0.4438650306748466

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.154. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4460122699386503
     Test RegressionAUROC            0.8044119477272034
Test RegressionCompetitionScore      0.4460122699386503
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 15:49:05,849][0m Trial 413 finished with value: 0.4460122699386503 and parameters: {'lr': 0.0007821051779512757, 'dropout': 0.5353763596181601, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 83, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0007031027818693618, 'dropout': 0.5154930346308366, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 93, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 31.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
31.2 K    Trainable params
0         Non-trainable params
31.2 K    Total params
0.125     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6614518165588379
	RegressionCompetitionScore: 0.2616564417177914

Metric val_loss improved. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.6698474884033203
	RegressionCompetitionScore: 0.2809815950920245

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.6937252283096313
	RegressionCompetitionScore: 0.30214723926380366

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.6868215799331665
	RegressionCompetitionScore: 0.3098159509202454



Validation scores:
	RegressionAUROC: 0.7015073895454407
	RegressionCompetitionScore: 0.32791411042944785



Validation scores:
	RegressionAUROC: 0.7175178527832031
	RegressionCompetitionScore: 0.3579754601226994



Validation scores:
	RegressionAUROC: 0.7322496175765991
	RegressionCompetitionScore: 0.3401840490797546

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.738823413848877
	RegressionCompetitionScore: 0.37116564417177916

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7461177706718445
	RegressionCompetitionScore: 0.36349693251533743

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7506516575813293
	RegressionCompetitionScore: 0.3389570552147239



Validation scores:
	RegressionAUROC: 0.771880567073822
	RegressionCompetitionScore: 0.3717791411042945



Validation scores:
	RegressionAUROC: 0.7856404781341553
	RegressionCompetitionScore: 0.4196319018404908

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7666013836860657
	RegressionCompetitionScore: 0.38926380368098157

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7640020847320557
	RegressionCompetitionScore: 0.3895705521472393



Validation scores:
	RegressionAUROC: 0.7998468279838562
	RegressionCompetitionScore: 0.38006134969325156



Validation scores:
	RegressionAUROC: 0.7991639375686646
	RegressionCompetitionScore: 0.42668711656441716

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.154


Validation scores:
	RegressionAUROC: 0.7998839616775513
	RegressionCompetitionScore: 0.37883435582822084



Validation scores:
	RegressionAUROC: 0.7758628129959106
	RegressionCompetitionScore: 0.4205521472392638



Validation scores:
	RegressionAUROC: 0.7748583555221558
	RegressionCompetitionScore: 0.38588957055214723



Validation scores:
	RegressionAUROC: 0.7871822714805603
	RegressionCompetitionScore: 0.4021472392638037



Validation scores:
	RegressionAUROC: 0.7833260297775269
	RegressionCompetitionScore: 0.40950920245398775



Validation scores:
	RegressionAUROC: 0.7914896607398987
	RegressionCompetitionScore: 0.4205521472392638



Validation scores:
	RegressionAUROC: 0.7761595249176025
	RegressionCompetitionScore: 0.38834355828220857

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.154. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.42668711656441716
     Test RegressionAUROC            0.7991639375686646
Test RegressionCompetitionScore      0.42668711656441716
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 15:58:30,325][0m Trial 414 finished with value: 0.42668711656441716 and parameters: {'lr': 0.0007031027818693618, 'dropout': 0.5154930346308366, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 93, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 7.869214907159683e-06, 'dropout': 0.5329180448256595, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 74, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 29.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
29.9 K    Trainable params
0         Non-trainable params
29.9 K    Total params
0.120     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5579710006713867
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.48458027839660645
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.307


Validation scores:
	RegressionAUROC: 0.49982762336730957
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.290


Validation scores:
	RegressionAUROC: 0.5276200771331787
	RegressionCompetitionScore: 0.08496932515337423

Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: 0.261


Validation scores:
	RegressionAUROC: 0.5492393374443054
	RegressionCompetitionScore: 0.09693251533742331

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.261


Validation scores:
	RegressionAUROC: 0.5820050239562988
	RegressionCompetitionScore: 0.11411042944785275

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.253


Validation scores:
	RegressionAUROC: 0.6075636744499207
	RegressionCompetitionScore: 0.12914110429447853

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.233


Validation scores:
	RegressionAUROC: 0.6217691898345947
	RegressionCompetitionScore: 0.14539877300613496

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.6467605233192444
	RegressionCompetitionScore: 0.1726993865030675

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6487768292427063
	RegressionCompetitionScore: 0.1736196319018405



Validation scores:
	RegressionAUROC: 0.6624883413314819
	RegressionCompetitionScore: 0.21319018404907975

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6640450954437256
	RegressionCompetitionScore: 0.24386503067484663



Validation scores:
	RegressionAUROC: 0.6686368584632874
	RegressionCompetitionScore: 0.2625766871165644



Validation scores:
	RegressionAUROC: 0.6816388368606567
	RegressionCompetitionScore: 0.2616564417177914



Validation scores:
	RegressionAUROC: 0.6840403079986572
	RegressionCompetitionScore: 0.2822085889570552

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6925714015960693
	RegressionCompetitionScore: 0.298159509202454

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6966054439544678
	RegressionCompetitionScore: 0.30736196319018405

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7036024928092957
	RegressionCompetitionScore: 0.31196319018404906



Validation scores:
	RegressionAUROC: 0.7088255882263184
	RegressionCompetitionScore: 0.3042944785276074



Validation scores:
	RegressionAUROC: 0.7110984325408936
	RegressionCompetitionScore: 0.3128834355828221

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7034236788749695
	RegressionCompetitionScore: 0.32883435582822085



Validation scores:
	RegressionAUROC: 0.7002589702606201
	RegressionCompetitionScore: 0.3196319018404908

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.708417534828186
	RegressionCompetitionScore: 0.3236196319018405

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7104682922363281
	RegressionCompetitionScore: 0.32699386503067485



Validation scores:
	RegressionAUROC: 0.7124372720718384
	RegressionCompetitionScore: 0.3276073619631902



Validation scores:
	RegressionAUROC: 0.717911958694458
	RegressionCompetitionScore: 0.3220858895705521



Validation scores:
	RegressionAUROC: 0.7214905023574829
	RegressionCompetitionScore: 0.32883435582822085



Validation scores:
	RegressionAUROC: 0.7244142889976501
	RegressionCompetitionScore: 0.3371165644171779



Validation scores:
	RegressionAUROC: 0.7283675670623779
	RegressionCompetitionScore: 0.3374233128834356



Validation scores:
	RegressionAUROC: 0.7299761772155762
	RegressionCompetitionScore: 0.34202453987730064

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.191. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3236196319018405
     Test RegressionAUROC             0.708417534828186
Test RegressionCompetitionScore      0.3236196319018405
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 16:10:08,061][0m Trial 415 finished with value: 0.3236196319018405 and parameters: {'lr': 7.869214907159683e-06, 'dropout': 0.5329180448256595, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 74, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0009172307334436008, 'dropout': 0.4922439041896961, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 32, 'dim_feedforward': 102, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 89.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
89.7 K    Trainable params
0         Non-trainable params
89.7 K    Total params
0.359     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.30434781312942505
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5575799345970154
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.573


Validation scores:
	RegressionAUROC: 0.7067778706550598
	RegressionCompetitionScore: 0.3138036809815951

Metric val_loss improved by 0.374 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.7051576375961304
	RegressionCompetitionScore: 0.2861963190184049



Validation scores:
	RegressionAUROC: 0.7089362144470215
	RegressionCompetitionScore: 0.27791411042944786

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6944972276687622
	RegressionCompetitionScore: 0.23680981595092024



Validation scores:
	RegressionAUROC: 0.6481270790100098
	RegressionCompetitionScore: 0.13496932515337423



Validation scores:
	RegressionAUROC: 0.7198752164840698
	RegressionCompetitionScore: 0.31901840490797545

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7111958265304565
	RegressionCompetitionScore: 0.2754601226993865

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.6790454983711243
	RegressionCompetitionScore: 0.18128834355828222



Validation scores:
	RegressionAUROC: 0.7015863656997681
	RegressionCompetitionScore: 0.3211656441717791



Validation scores:
	RegressionAUROC: 0.7064976692199707
	RegressionCompetitionScore: 0.3104294478527607



Validation scores:
	RegressionAUROC: 0.6562510132789612
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7045058012008667
	RegressionCompetitionScore: 0.3039877300613497



Validation scores:
	RegressionAUROC: 0.7122064232826233
	RegressionCompetitionScore: 0.32607361963190185



Validation scores:
	RegressionAUROC: 0.7170373797416687
	RegressionCompetitionScore: 0.3530674846625767

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.182. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2754601226993865
     Test RegressionAUROC            0.7111958265304565
Test RegressionCompetitionScore      0.2754601226993865
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 16:17:11,856][0m Trial 416 finished with value: 0.2754601226993865 and parameters: {'lr': 0.0009172307334436008, 'dropout': 0.4922439041896961, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 32, 'dim_feedforward': 102, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 3.8722247888026765e-07, 'dropout': 0.5092832930696389, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 72, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 29.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
29.8 K    Trainable params
0         Non-trainable params
29.8 K    Total params
0.119     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5005446076393127
	RegressionCompetitionScore: 0.0015337423312883436

Metric val_loss improved. New best score: 1.533


Validation scores:
	RegressionAUROC: 0.5091185569763184
	RegressionCompetitionScore: 0.03251533742331288

Metric val_loss improved by 0.376 >= min_delta = 0.0. New best score: 1.156


Validation scores:
	RegressionAUROC: 0.5164267420768738
	RegressionCompetitionScore: 0.10276073619631902

Metric val_loss improved by 0.316 >= min_delta = 0.0. New best score: 0.840


Validation scores:
	RegressionAUROC: 0.5282918810844421
	RegressionCompetitionScore: 0.10460122699386504

Metric val_loss improved by 0.228 >= min_delta = 0.0. New best score: 0.612


Validation scores:
	RegressionAUROC: 0.5380245447158813
	RegressionCompetitionScore: 0.10368098159509202

Metric val_loss improved by 0.139 >= min_delta = 0.0. New best score: 0.473


Validation scores:
	RegressionAUROC: 0.5415658950805664
	RegressionCompetitionScore: 0.10521472392638037

Metric val_loss improved by 0.077 >= min_delta = 0.0. New best score: 0.396


Validation scores:
	RegressionAUROC: 0.5450431108474731
	RegressionCompetitionScore: 0.10460122699386504

Metric val_loss improved by 0.044 >= min_delta = 0.0. New best score: 0.352


Validation scores:
	RegressionAUROC: 0.5489355325698853
	RegressionCompetitionScore: 0.10552147239263804

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.328


Validation scores:
	RegressionAUROC: 0.5521979331970215
	RegressionCompetitionScore: 0.10276073619631902

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.312


Validation scores:
	RegressionAUROC: 0.5548011064529419
	RegressionCompetitionScore: 0.10368098159509202

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.308


Validation scores:
	RegressionAUROC: 0.559024453163147
	RegressionCompetitionScore: 0.1107361963190184

Metric val_loss improved by 0.035 >= min_delta = 0.0. New best score: 0.273


Validation scores:
	RegressionAUROC: 0.5617483854293823
	RegressionCompetitionScore: 0.1196319018404908

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.254


Validation scores:
	RegressionAUROC: 0.5633854866027832
	RegressionCompetitionScore: 0.12085889570552147

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.243


Validation scores:
	RegressionAUROC: 0.5667328834533691
	RegressionCompetitionScore: 0.13588957055214723

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.233


Validation scores:
	RegressionAUROC: 0.5688904523849487
	RegressionCompetitionScore: 0.1392638036809816

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.5695586204528809
	RegressionCompetitionScore: 0.13711656441717793



Validation scores:
	RegressionAUROC: 0.5715738534927368
	RegressionCompetitionScore: 0.14049079754601226



Validation scores:
	RegressionAUROC: 0.5738494396209717
	RegressionCompetitionScore: 0.14355828220858896



Validation scores:
	RegressionAUROC: 0.575674831867218
	RegressionCompetitionScore: 0.14539877300613496



Validation scores:
	RegressionAUROC: 0.5775479674339294
	RegressionCompetitionScore: 0.14754601226993866



Validation scores:
	RegressionAUROC: 0.5786916613578796
	RegressionCompetitionScore: 0.1521472392638037

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.5786441564559937
	RegressionCompetitionScore: 0.15

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.5793190598487854
	RegressionCompetitionScore: 0.14938650306748466

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.5818261504173279
	RegressionCompetitionScore: 0.1539877300613497

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.583391547203064
	RegressionCompetitionScore: 0.15674846625766872



Validation scores:
	RegressionAUROC: 0.5856093168258667
	RegressionCompetitionScore: 0.1588957055214724



Validation scores:
	RegressionAUROC: 0.5864640474319458
	RegressionCompetitionScore: 0.1607361963190184



Validation scores:
	RegressionAUROC: 0.5882273316383362
	RegressionCompetitionScore: 0.1659509202453988



Validation scores:
	RegressionAUROC: 0.5906040668487549
	RegressionCompetitionScore: 0.17515337423312882



Validation scores:
	RegressionAUROC: 0.5923720598220825
	RegressionCompetitionScore: 0.17914110429447852



Validation scores:
	RegressionAUROC: 0.5933626294136047
	RegressionCompetitionScore: 0.18435582822085889

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.216. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1539877300613497
     Test RegressionAUROC            0.5818261504173279
Test RegressionCompetitionScore      0.1539877300613497
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 16:31:13,524][0m Trial 417 finished with value: 0.1539877300613497 and parameters: {'lr': 3.8722247888026765e-07, 'dropout': 0.5092832930696389, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 72, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0007391338188651296, 'dropout': 0.5152819356448457, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 92, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 29.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
29.3 K    Trainable params
0         Non-trainable params
29.3 K    Total params
0.117     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4227052927017212
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.37043172121047974
	RegressionCompetitionScore: 0.06073619631901841

Metric val_loss improved. New best score: 0.235


Validation scores:
	RegressionAUROC: 0.665900707244873
	RegressionCompetitionScore: 0.149079754601227

Metric val_loss improved by 0.033 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.5956897139549255
	RegressionCompetitionScore: 0.16012269938650306



Validation scores:
	RegressionAUROC: 0.5236805081367493
	RegressionCompetitionScore: 0.13680981595092023



Validation scores:
	RegressionAUROC: 0.6880208849906921
	RegressionCompetitionScore: 0.2929447852760736

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7085663080215454
	RegressionCompetitionScore: 0.30920245398773005

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7059556841850281
	RegressionCompetitionScore: 0.3579754601226994



Validation scores:
	RegressionAUROC: 0.6509988307952881
	RegressionCompetitionScore: 0.26932515337423313



Validation scores:
	RegressionAUROC: 0.659096360206604
	RegressionCompetitionScore: 0.3374233128834356



Validation scores:
	RegressionAUROC: 0.6695445775985718
	RegressionCompetitionScore: 0.3365030674846626



Validation scores:
	RegressionAUROC: 0.6959841847419739
	RegressionCompetitionScore: 0.28343558282208586



Validation scores:
	RegressionAUROC: 0.6242512464523315
	RegressionCompetitionScore: 0.18220858895705522



Validation scores:
	RegressionAUROC: 0.6929913759231567
	RegressionCompetitionScore: 0.2687116564417178

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.30920245398773005
     Test RegressionAUROC            0.7085663080215454
Test RegressionCompetitionScore      0.30920245398773005
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 16:36:42,279][0m Trial 418 finished with value: 0.30920245398773005 and parameters: {'lr': 0.0007391338188651296, 'dropout': 0.5152819356448457, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 92, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.001933932488500099, 'dropout': 0.5579162435973143, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 80, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 30.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
30.3 K    Trainable params
0         Non-trainable params
30.3 K    Total params
0.121     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4685990512371063
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6598728895187378
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.304


Validation scores:
	RegressionAUROC: 0.6492796540260315
	RegressionCompetitionScore: 0.15644171779141106

Metric val_loss improved by 0.088 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.6074602603912354
	RegressionCompetitionScore: 0.24785276073619633



Validation scores:
	RegressionAUROC: 0.6470291018486023
	RegressionCompetitionScore: 0.2785276073619632



Validation scores:
	RegressionAUROC: 0.6723043918609619
	RegressionCompetitionScore: 0.3205521472392638



Validation scores:
	RegressionAUROC: 0.6819456815719604
	RegressionCompetitionScore: 0.2696319018404908

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6315340995788574
	RegressionCompetitionScore: 0.2871165644171779



Validation scores:
	RegressionAUROC: 0.6408617496490479
	RegressionCompetitionScore: 0.2800613496932515



Validation scores:
	RegressionAUROC: 0.6404165029525757
	RegressionCompetitionScore: 0.24355828220858897



Validation scores:
	RegressionAUROC: 0.6558836102485657
	RegressionCompetitionScore: 0.26226993865030673



Validation scores:
	RegressionAUROC: 0.6547656059265137
	RegressionCompetitionScore: 0.2714723926380368

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.646470308303833
	RegressionCompetitionScore: 0.26042944785276073



Validation scores:
	RegressionAUROC: 0.6576727032661438
	RegressionCompetitionScore: 0.26226993865030673



Validation scores:
	RegressionAUROC: 0.6544592976570129
	RegressionCompetitionScore: 0.2650306748466258



Validation scores:
	RegressionAUROC: 0.648246705532074
	RegressionCompetitionScore: 0.25030674846625767



Validation scores:
	RegressionAUROC: 0.6673214435577393
	RegressionCompetitionScore: 0.2634969325153374



Validation scores:
	RegressionAUROC: 0.63936448097229
	RegressionCompetitionScore: 0.2579754601226994



Validation scores:
	RegressionAUROC: 0.6494103670120239
	RegressionCompetitionScore: 0.26104294478527607

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.199. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2714723926380368
     Test RegressionAUROC            0.6547656059265137
Test RegressionCompetitionScore      0.2714723926380368
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 16:44:07,774][0m Trial 419 finished with value: 0.2714723926380368 and parameters: {'lr': 0.001933932488500099, 'dropout': 0.5579162435973143, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 80, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0009673256712406822, 'dropout': 0.4967203771672456, 'd_model_multiplier': 2, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 113, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 45.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
45.6 K    Trainable params
0         Non-trainable params
45.6 K    Total params
0.183     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4975845217704773
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6975855827331543
	RegressionCompetitionScore: 0.22791411042944784

Metric val_loss improved. New best score: 0.240


Validation scores:
	RegressionAUROC: 0.66748046875
	RegressionCompetitionScore: 0.23558282208588957

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.231


Validation scores:
	RegressionAUROC: 0.6479851603507996
	RegressionCompetitionScore: 0.14969325153374233

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6404949426651001
	RegressionCompetitionScore: 0.14877300613496933



Validation scores:
	RegressionAUROC: 0.699510395526886
	RegressionCompetitionScore: 0.18711656441717792



Validation scores:
	RegressionAUROC: 0.6866668462753296
	RegressionCompetitionScore: 0.24294478527607363



Validation scores:
	RegressionAUROC: 0.6753541827201843
	RegressionCompetitionScore: 0.11809815950920245



Validation scores:
	RegressionAUROC: 0.7048605680465698
	RegressionCompetitionScore: 0.25736196319018406

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.6715541481971741
	RegressionCompetitionScore: 0.14785276073619633



Validation scores:
	RegressionAUROC: 0.6933349370956421
	RegressionCompetitionScore: 0.27177914110429446



Validation scores:
	RegressionAUROC: 0.6826383471488953
	RegressionCompetitionScore: 0.2723926380368098



Validation scores:
	RegressionAUROC: 0.6704411506652832
	RegressionCompetitionScore: 0.23987730061349694



Validation scores:
	RegressionAUROC: 0.6582062244415283
	RegressionCompetitionScore: 0.19079754601226995



Validation scores:
	RegressionAUROC: 0.6392041444778442
	RegressionCompetitionScore: 0.1950920245398773



Validation scores:
	RegressionAUROC: 0.6639804840087891
	RegressionCompetitionScore: 0.19938650306748465

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.186. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.25736196319018406
     Test RegressionAUROC            0.7048605680465698
Test RegressionCompetitionScore      0.25736196319018406
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 16:50:22,324][0m Trial 420 finished with value: 0.25736196319018406 and parameters: {'lr': 0.0009673256712406822, 'dropout': 0.4967203771672456, 'd_model_multiplier': 2, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 113, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0006700141998803662, 'dropout': 0.4687048710392879, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 70, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 29.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
29.7 K    Trainable params
0         Non-trainable params
29.7 K    Total params
0.119     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6503680348396301
	RegressionCompetitionScore: 0.07975460122699386

Metric val_loss improved. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.658564567565918
	RegressionCompetitionScore: 0.25398773006134967

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.684034526348114
	RegressionCompetitionScore: 0.21503067484662577

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6807063817977905
	RegressionCompetitionScore: 0.2674846625766871



Validation scores:
	RegressionAUROC: 0.7038669586181641
	RegressionCompetitionScore: 0.3024539877300613



Validation scores:
	RegressionAUROC: 0.6463470458984375
	RegressionCompetitionScore: 0.27515337423312886



Validation scores:
	RegressionAUROC: 0.6828175783157349
	RegressionCompetitionScore: 0.2763803680981595



Validation scores:
	RegressionAUROC: 0.7115507125854492
	RegressionCompetitionScore: 0.3257668711656442



Validation scores:
	RegressionAUROC: 0.6892554759979248
	RegressionCompetitionScore: 0.3266871165644172



Validation scores:
	RegressionAUROC: 0.7015095353126526
	RegressionCompetitionScore: 0.3039877300613497

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.191. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.21503067484662577
     Test RegressionAUROC             0.684034526348114
Test RegressionCompetitionScore      0.21503067484662577
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 16:54:40,656][0m Trial 421 finished with value: 0.21503067484662577 and parameters: {'lr': 0.0006700141998803662, 'dropout': 0.4687048710392879, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 70, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0038910642173852943, 'dropout': 0.5438866644453326, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 91, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 31.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
31.1 K    Trainable params
0         Non-trainable params
31.1 K    Total params
0.124     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4806763827800751
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.6313333511352539
	RegressionCompetitionScore: 0.11319018404907975

Metric val_loss improved. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.6751520037651062
	RegressionCompetitionScore: 0.16656441717791412

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6127643585205078
	RegressionCompetitionScore: 0.11319018404907975



Validation scores:
	RegressionAUROC: 0.6699388027191162
	RegressionCompetitionScore: 0.15245398773006136



Validation scores:
	RegressionAUROC: 0.6819521188735962
	RegressionCompetitionScore: 0.18558282208588958



Validation scores:
	RegressionAUROC: 0.6821304559707642
	RegressionCompetitionScore: 0.17730061349693252



Validation scores:
	RegressionAUROC: 0.6936757564544678
	RegressionCompetitionScore: 0.2331288343558282



Validation scores:
	RegressionAUROC: 0.6961166262626648
	RegressionCompetitionScore: 0.29141104294478526



Validation scores:
	RegressionAUROC: 0.6969685554504395
	RegressionCompetitionScore: 0.3113496932515337

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6993468403816223
	RegressionCompetitionScore: 0.28496932515337425



Validation scores:
	RegressionAUROC: 0.7010326385498047
	RegressionCompetitionScore: 0.2871165644171779

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.6172301769256592
	RegressionCompetitionScore: 0.2147239263803681



Validation scores:
	RegressionAUROC: 0.6034844517707825
	RegressionCompetitionScore: 0.16993865030674846



Validation scores:
	RegressionAUROC: 0.6086280941963196
	RegressionCompetitionScore: 0.2650306748466258



Validation scores:
	RegressionAUROC: 0.6061656475067139
	RegressionCompetitionScore: 0.23282208588957054



Validation scores:
	RegressionAUROC: 0.6277340650558472
	RegressionCompetitionScore: 0.24263803680981594



Validation scores:
	RegressionAUROC: 0.6318843364715576
	RegressionCompetitionScore: 0.2785276073619632



Validation scores:
	RegressionAUROC: 0.6384732723236084
	RegressionCompetitionScore: 0.2647239263803681

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.187. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2871165644171779
     Test RegressionAUROC            0.7010326385498047
Test RegressionCompetitionScore      0.2871165644171779
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 17:02:01,513][0m Trial 422 finished with value: 0.2871165644171779 and parameters: {'lr': 0.0038910642173852943, 'dropout': 0.5438866644453326, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 91, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 4.563136344593037e-05, 'dropout': 0.5269600532671617, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 107, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 34.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
34.3 K    Trainable params
0         Non-trainable params
34.3 K    Total params
0.137     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.46666663885116577
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6149364113807678
	RegressionCompetitionScore: 0.2785276073619632

Metric val_loss improved. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6179606914520264
	RegressionCompetitionScore: 0.2745398773006135



Validation scores:
	RegressionAUROC: 0.631004810333252
	RegressionCompetitionScore: 0.28588957055214725



Validation scores:
	RegressionAUROC: 0.6627089977264404
	RegressionCompetitionScore: 0.30736196319018405

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6900629997253418
	RegressionCompetitionScore: 0.31012269938650305

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7059080600738525
	RegressionCompetitionScore: 0.2831288343558282

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7149010896682739
	RegressionCompetitionScore: 0.293558282208589

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7142238616943359
	RegressionCompetitionScore: 0.33159509202453985



Validation scores:
	RegressionAUROC: 0.6651894450187683
	RegressionCompetitionScore: 0.23466257668711657



Validation scores:
	RegressionAUROC: 0.7000003457069397
	RegressionCompetitionScore: 0.34386503067484664



Validation scores:
	RegressionAUROC: 0.7095458507537842
	RegressionCompetitionScore: 0.350920245398773



Validation scores:
	RegressionAUROC: 0.7249513268470764
	RegressionCompetitionScore: 0.3398773006134969



Validation scores:
	RegressionAUROC: 0.7318410277366638
	RegressionCompetitionScore: 0.37239263803680983



Validation scores:
	RegressionAUROC: 0.7320207357406616
	RegressionCompetitionScore: 0.35920245398773004

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.178. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.293558282208589
     Test RegressionAUROC            0.7149010896682739
Test RegressionCompetitionScore       0.293558282208589
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 17:08:43,385][0m Trial 423 finished with value: 0.293558282208589 and parameters: {'lr': 4.563136344593037e-05, 'dropout': 0.5269600532671617, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 107, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.001183395968653248, 'dropout': 0.5015961433598162, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 122, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 82.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
82.6 K    Trainable params
0         Non-trainable params
82.6 K    Total params
0.330     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.30434781312942505
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6192104816436768
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.325


Validation scores:
	RegressionAUROC: 0.6507058143615723
	RegressionCompetitionScore: 0.2579754601226994

Metric val_loss improved by 0.131 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6806296706199646
	RegressionCompetitionScore: 0.26226993865030673



Validation scores:
	RegressionAUROC: 0.7003682851791382
	RegressionCompetitionScore: 0.26226993865030673



Validation scores:
	RegressionAUROC: 0.6968578696250916
	RegressionCompetitionScore: 0.25337423312883434



Validation scores:
	RegressionAUROC: 0.6988914012908936
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6829229593276978
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7199521660804749
	RegressionCompetitionScore: 0.3107361963190184



Validation scores:
	RegressionAUROC: 0.7087582945823669
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.193. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2579754601226994
     Test RegressionAUROC            0.6507058143615723
Test RegressionCompetitionScore      0.2579754601226994
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 17:12:44,027][0m Trial 424 finished with value: 0.2579754601226994 and parameters: {'lr': 0.001183395968653248, 'dropout': 0.5015961433598162, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 122, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00048122591435914813, 'dropout': 0.5383444494660025, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 117, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 30.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
30.5 K    Trainable params
0         Non-trainable params
30.5 K    Total params
0.122     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6500589847564697
	RegressionCompetitionScore: 0.26134969325153373

Metric val_loss improved. New best score: 0.286


Validation scores:
	RegressionAUROC: 0.6952309608459473
	RegressionCompetitionScore: 0.2871165644171779

Metric val_loss improved by 0.092 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6892578601837158
	RegressionCompetitionScore: 0.2809815950920245



Validation scores:
	RegressionAUROC: 0.6852555274963379
	RegressionCompetitionScore: 0.29325153374233126



Validation scores:
	RegressionAUROC: 0.7027677893638611
	RegressionCompetitionScore: 0.3257668711656442



Validation scores:
	RegressionAUROC: 0.718067467212677
	RegressionCompetitionScore: 0.36411042944785277

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7125223875045776
	RegressionCompetitionScore: 0.33865030674846625



Validation scores:
	RegressionAUROC: 0.7187687158584595
	RegressionCompetitionScore: 0.3015337423312883



Validation scores:
	RegressionAUROC: 0.6969305276870728
	RegressionCompetitionScore: 0.24049079754601227



Validation scores:
	RegressionAUROC: 0.7485085725784302
	RegressionCompetitionScore: 0.3674846625766871



Validation scores:
	RegressionAUROC: 0.7449794411659241
	RegressionCompetitionScore: 0.3380368098159509

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7420258522033691
	RegressionCompetitionScore: 0.3389570552147239



Validation scores:
	RegressionAUROC: 0.7384089231491089
	RegressionCompetitionScore: 0.35920245398773004



Validation scores:
	RegressionAUROC: 0.7553676962852478
	RegressionCompetitionScore: 0.3923312883435583



Validation scores:
	RegressionAUROC: 0.7506481409072876
	RegressionCompetitionScore: 0.4058282208588957



Validation scores:
	RegressionAUROC: 0.7565908432006836
	RegressionCompetitionScore: 0.39631901840490796



Validation scores:
	RegressionAUROC: 0.749353289604187
	RegressionCompetitionScore: 0.41226993865030676



Validation scores:
	RegressionAUROC: 0.7485924363136292
	RegressionCompetitionScore: 0.3656441717791411

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.171. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3380368098159509
     Test RegressionAUROC            0.7449794411659241
Test RegressionCompetitionScore      0.3380368098159509
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 17:20:04,588][0m Trial 425 finished with value: 0.3380368098159509 and parameters: {'lr': 0.00048122591435914813, 'dropout': 0.5383444494660025, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 117, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0007938018188209053, 'dropout': 0.5220641889717886, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 86, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 30.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
30.7 K    Trainable params
0         Non-trainable params
30.7 K    Total params
0.123     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6131067276000977
	RegressionCompetitionScore: 0.2411042944785276

Metric val_loss improved. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6422276496887207
	RegressionCompetitionScore: 0.2254601226993865

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6024523973464966
	RegressionCompetitionScore: 0.09355828220858896



Validation scores:
	RegressionAUROC: 0.5795615315437317
	RegressionCompetitionScore: 0.12208588957055215



Validation scores:
	RegressionAUROC: 0.6315491199493408
	RegressionCompetitionScore: 0.19263803680981595



Validation scores:
	RegressionAUROC: 0.6334222555160522
	RegressionCompetitionScore: 0.23374233128834357



Validation scores:
	RegressionAUROC: 0.5783801078796387
	RegressionCompetitionScore: 0.19263803680981595



Validation scores:
	RegressionAUROC: 0.6480914354324341
	RegressionCompetitionScore: 0.23374233128834357



Validation scores:
	RegressionAUROC: 0.6438291072845459
	RegressionCompetitionScore: 0.2352760736196319

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6480351686477661
	RegressionCompetitionScore: 0.23987730061349694



Validation scores:
	RegressionAUROC: 0.6530486345291138
	RegressionCompetitionScore: 0.23374233128834357

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6130390167236328
	RegressionCompetitionScore: 0.26012269938650306



Validation scores:
	RegressionAUROC: 0.6112374067306519
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6507428884506226
	RegressionCompetitionScore: 0.2766871165644172

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6614021062850952
	RegressionCompetitionScore: 0.24846625766871167

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.6682956218719482
	RegressionCompetitionScore: 0.2411042944785276



Validation scores:
	RegressionAUROC: 0.6626681089401245
	RegressionCompetitionScore: 0.2579754601226994



Validation scores:
	RegressionAUROC: 0.6750012636184692
	RegressionCompetitionScore: 0.2757668711656442



Validation scores:
	RegressionAUROC: 0.681767463684082
	RegressionCompetitionScore: 0.28190184049079753



Validation scores:
	RegressionAUROC: 0.6716508269309998
	RegressionCompetitionScore: 0.2674846625766871



Validation scores:
	RegressionAUROC: 0.6728236079216003
	RegressionCompetitionScore: 0.27024539877300613



Validation scores:
	RegressionAUROC: 0.6291931867599487
	RegressionCompetitionScore: 0.2460122699386503

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.192. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.24846625766871167
     Test RegressionAUROC            0.6614021062850952
Test RegressionCompetitionScore      0.24846625766871167
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 17:29:12,771][0m Trial 426 finished with value: 0.24846625766871167 and parameters: {'lr': 0.0007938018188209053, 'dropout': 0.5220641889717886, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 86, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0003795336847874529, 'dropout': 0.46095986924053345, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 107, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 27.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
27.9 K    Trainable params
0         Non-trainable params
27.9 K    Total params
0.112     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6908212304115295
	RegressionCompetitionScore: 0.4782608695652174



Validation scores:
	RegressionAUROC: 0.6556869149208069
	RegressionCompetitionScore: 0.2880368098159509

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6886136531829834
	RegressionCompetitionScore: 0.18343558282208589

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7305228114128113
	RegressionCompetitionScore: 0.347239263803681

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7097069025039673
	RegressionCompetitionScore: 0.3095092024539877



Validation scores:
	RegressionAUROC: 0.7468035221099854
	RegressionCompetitionScore: 0.37331288343558283



Validation scores:
	RegressionAUROC: 0.7588818073272705
	RegressionCompetitionScore: 0.3825153374233129



Validation scores:
	RegressionAUROC: 0.7665356397628784
	RegressionCompetitionScore: 0.3726993865030675



Validation scores:
	RegressionAUROC: 0.7588927149772644
	RegressionCompetitionScore: 0.38588957055214723



Validation scores:
	RegressionAUROC: 0.7419037818908691
	RegressionCompetitionScore: 0.3138036809815951



Validation scores:
	RegressionAUROC: 0.7473945617675781
	RegressionCompetitionScore: 0.38680981595092023

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.347239263803681
     Test RegressionAUROC            0.7305228114128113
Test RegressionCompetitionScore       0.347239263803681
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 17:33:28,318][0m Trial 427 finished with value: 0.347239263803681 and parameters: {'lr': 0.0003795336847874529, 'dropout': 0.46095986924053345, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 107, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005242520637589992, 'dropout': 0.8681890149243039, 'd_model_multiplier': 32, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 130, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.6 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.6 M     Trainable params
0         Non-trainable params
1.6 M     Total params
6.304     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3671497702598572
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 2.626


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.143 >= min_delta = 0.0. New best score: 2.483


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.677 >= min_delta = 0.0. New best score: 1.806


Validation scores:
	RegressionAUROC: 0.47670188546180725
	RegressionCompetitionScore: 0.09202453987730061

Metric val_loss improved by 1.563 >= min_delta = 0.0. New best score: 0.243


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.41959547996520996
	RegressionCompetitionScore: 0.10736196319018405



Validation scores:
	RegressionAUROC: 0.4409087896347046
	RegressionCompetitionScore: 0.08987730061349693



Validation scores:
	RegressionAUROC: 0.4640919864177704
	RegressionCompetitionScore: 0.04754601226993865

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.218. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.04754601226993865
     Test RegressionAUROC            0.4640919864177704
Test RegressionCompetitionScore      0.04754601226993865
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 17:42:36,374][0m Trial 428 finished with value: 0.04754601226993865 and parameters: {'lr': 0.0005242520637589992, 'dropout': 0.8681890149243039, 'd_model_multiplier': 32, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 130, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 3.1478829859507344e-05, 'dropout': 0.5789081931901384, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 64, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 226 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
226 K     Trainable params
0         Non-trainable params
226 K     Total params
0.905     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6512413620948792
	RegressionCompetitionScore: 0.24631901840490797

Metric val_loss improved. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.6767870187759399
	RegressionCompetitionScore: 0.20245398773006135

Metric val_loss improved by 0.032 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7002066373825073
	RegressionCompetitionScore: 0.2147239263803681

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6826577186584473
	RegressionCompetitionScore: 0.1460122699386503



Validation scores:
	RegressionAUROC: 0.7197420001029968
	RegressionCompetitionScore: 0.32085889570552145



Validation scores:
	RegressionAUROC: 0.7287552356719971
	RegressionCompetitionScore: 0.32423312883435584

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7276264429092407
	RegressionCompetitionScore: 0.3276073619631902

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7231587767601013
	RegressionCompetitionScore: 0.3



Validation scores:
	RegressionAUROC: 0.7231544256210327
	RegressionCompetitionScore: 0.3239263803680982



Validation scores:
	RegressionAUROC: 0.7155213356018066
	RegressionCompetitionScore: 0.37300613496932516



Validation scores:
	RegressionAUROC: 0.7358627319335938
	RegressionCompetitionScore: 0.3407975460122699



Validation scores:
	RegressionAUROC: 0.7305628657341003
	RegressionCompetitionScore: 0.34049079754601225



Validation scores:
	RegressionAUROC: 0.7360358238220215
	RegressionCompetitionScore: 0.3380368098159509

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7327761650085449
	RegressionCompetitionScore: 0.3131901840490798



Validation scores:
	RegressionAUROC: 0.7410334944725037
	RegressionCompetitionScore: 0.3328220858895706

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7366119623184204
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7317254543304443
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7357261180877686
	RegressionCompetitionScore: 0.33957055214723925



Validation scores:
	RegressionAUROC: 0.741468071937561
	RegressionCompetitionScore: 0.3693251533742331



Validation scores:
	RegressionAUROC: 0.7409877777099609
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7460662126541138
	RegressionCompetitionScore: 0.35245398773006137



Validation scores:
	RegressionAUROC: 0.7471919059753418
	RegressionCompetitionScore: 0.3371165644171779

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3328220858895706
     Test RegressionAUROC            0.7410334944725037
Test RegressionCompetitionScore      0.3328220858895706
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 18:00:15,168][0m Trial 429 finished with value: 0.3328220858895706 and parameters: {'lr': 3.1478829859507344e-05, 'dropout': 0.5789081931901384, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 64, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.001151767122207591, 'dropout': 0.47714153849553975, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 545, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 52.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
52.4 K    Trainable params
0         Non-trainable params
52.4 K    Total params
0.209     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6698135733604431
	RegressionCompetitionScore: 0.09693251533742331

Metric val_loss improved. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.6326442956924438
	RegressionCompetitionScore: 0.09325153374233129

Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.656944751739502
	RegressionCompetitionScore: 0.09079754601226994

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6625813245773315
	RegressionCompetitionScore: 0.0852760736196319

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6818054914474487
	RegressionCompetitionScore: 0.15920245398773006

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6878592371940613
	RegressionCompetitionScore: 0.24355828220858897



Validation scores:
	RegressionAUROC: 0.7029438018798828
	RegressionCompetitionScore: 0.3168711656441718



Validation scores:
	RegressionAUROC: 0.7046379446983337
	RegressionCompetitionScore: 0.31441717791411045



Validation scores:
	RegressionAUROC: 0.7076356410980225
	RegressionCompetitionScore: 0.3159509202453988

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7005746364593506
	RegressionCompetitionScore: 0.30644171779141105



Validation scores:
	RegressionAUROC: 0.698595404624939
	RegressionCompetitionScore: 0.31717791411042945

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7019282579421997
	RegressionCompetitionScore: 0.293558282208589



Validation scores:
	RegressionAUROC: 0.7219511270523071
	RegressionCompetitionScore: 0.37208588957055216

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7338570356369019
	RegressionCompetitionScore: 0.3411042944785276



Validation scores:
	RegressionAUROC: 0.7394837141036987
	RegressionCompetitionScore: 0.37791411042944784



Validation scores:
	RegressionAUROC: 0.7419536113739014
	RegressionCompetitionScore: 0.38742331288343557

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.727809727191925
	RegressionCompetitionScore: 0.38190184049079756



Validation scores:
	RegressionAUROC: 0.7518330812454224
	RegressionCompetitionScore: 0.3656441717791411

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7462019920349121
	RegressionCompetitionScore: 0.3684049079754601



Validation scores:
	RegressionAUROC: 0.7386671304702759
	RegressionCompetitionScore: 0.3325153374233129



Validation scores:
	RegressionAUROC: 0.7324892282485962
	RegressionCompetitionScore: 0.3371165644171779



Validation scores:
	RegressionAUROC: 0.7538584470748901
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.744307279586792
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.7618924379348755
	RegressionCompetitionScore: 0.36073619631901843



Validation scores:
	RegressionAUROC: 0.761177122592926
	RegressionCompetitionScore: 0.4199386503067485

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3656441717791411
     Test RegressionAUROC            0.7518330812454224
Test RegressionCompetitionScore      0.3656441717791411
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 18:10:23,872][0m Trial 430 finished with value: 0.3656441717791411 and parameters: {'lr': 0.001151767122207591, 'dropout': 0.47714153849553975, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 545, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00030281558487717393, 'dropout': 0.5969890818027358, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 134, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 41.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
41.8 K    Trainable params
0         Non-trainable params
41.8 K    Total params
0.167     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.34299516677856445
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6532677412033081
	RegressionCompetitionScore: 0.1263803680981595

Metric val_loss improved. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6412621736526489
	RegressionCompetitionScore: 0.23895705521472393



Validation scores:
	RegressionAUROC: 0.6518740653991699
	RegressionCompetitionScore: 0.30460122699386505

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6769825220108032
	RegressionCompetitionScore: 0.15613496932515336



Validation scores:
	RegressionAUROC: 0.7120559215545654
	RegressionCompetitionScore: 0.3033742331288344

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7214008569717407
	RegressionCompetitionScore: 0.29478527607361965

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7099898457527161
	RegressionCompetitionScore: 0.21809815950920244



Validation scores:
	RegressionAUROC: 0.7329005002975464
	RegressionCompetitionScore: 0.3088957055214724



Validation scores:
	RegressionAUROC: 0.7442436218261719
	RegressionCompetitionScore: 0.32177914110429445



Validation scores:
	RegressionAUROC: 0.7319285869598389
	RegressionCompetitionScore: 0.3177914110429448



Validation scores:
	RegressionAUROC: 0.7375143766403198
	RegressionCompetitionScore: 0.32607361963190185



Validation scores:
	RegressionAUROC: 0.7415300607681274
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7340217232704163
	RegressionCompetitionScore: 0.2677914110429448

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.181. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.29478527607361965
     Test RegressionAUROC            0.7214008569717407
Test RegressionCompetitionScore      0.29478527607361965
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 18:15:55,772][0m Trial 431 finished with value: 0.29478527607361965 and parameters: {'lr': 0.00030281558487717393, 'dropout': 0.5969890818027358, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 134, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0007143807067201491, 'dropout': 0.5022895747889213, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 95, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 33.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
33.3 K    Trainable params
0         Non-trainable params
33.3 K    Total params
0.133     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2995169162750244
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5342086553573608
	RegressionCompetitionScore: 0.04570552147239264

Metric val_loss improved. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.5664176940917969
	RegressionCompetitionScore: 0.06533742331288343

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.247


Validation scores:
	RegressionAUROC: 0.6189014911651611
	RegressionCompetitionScore: 0.21809815950920244

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.6405171155929565
	RegressionCompetitionScore: 0.27177914110429446

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.6636930704116821
	RegressionCompetitionScore: 0.2861963190184049



Validation scores:
	RegressionAUROC: 0.6722847819328308
	RegressionCompetitionScore: 0.3150306748466258

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6892440319061279
	RegressionCompetitionScore: 0.26809815950920246



Validation scores:
	RegressionAUROC: 0.6525213718414307
	RegressionCompetitionScore: 0.2843558282208589

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6462725400924683
	RegressionCompetitionScore: 0.29233128834355826



Validation scores:
	RegressionAUROC: 0.6952185034751892
	RegressionCompetitionScore: 0.2800613496932515



Validation scores:
	RegressionAUROC: 0.6780930757522583
	RegressionCompetitionScore: 0.16809815950920245



Validation scores:
	RegressionAUROC: 0.6838389039039612
	RegressionCompetitionScore: 0.18803680981595092



Validation scores:
	RegressionAUROC: 0.7050740122795105
	RegressionCompetitionScore: 0.28588957055214725

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7037585377693176
	RegressionCompetitionScore: 0.3006134969325153



Validation scores:
	RegressionAUROC: 0.7103908658027649
	RegressionCompetitionScore: 0.2696319018404908



Validation scores:
	RegressionAUROC: 0.712431788444519
	RegressionCompetitionScore: 0.26226993865030673



Validation scores:
	RegressionAUROC: 0.7129727602005005
	RegressionCompetitionScore: 0.2233128834355828



Validation scores:
	RegressionAUROC: 0.7213225960731506
	RegressionCompetitionScore: 0.27423312883435585

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7221198081970215
	RegressionCompetitionScore: 0.27024539877300613

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7281233668327332
	RegressionCompetitionScore: 0.29325153374233126

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7425835132598877
	RegressionCompetitionScore: 0.3273006134969325



Validation scores:
	RegressionAUROC: 0.7477647066116333
	RegressionCompetitionScore: 0.33680981595092024

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7519497871398926
	RegressionCompetitionScore: 0.3380368098159509

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7502230405807495
	RegressionCompetitionScore: 0.3248466257668712



Validation scores:
	RegressionAUROC: 0.7466471195220947
	RegressionCompetitionScore: 0.3024539877300613



Validation scores:
	RegressionAUROC: 0.7476072907447815
	RegressionCompetitionScore: 0.32515337423312884



Validation scores:
	RegressionAUROC: 0.7442281246185303
	RegressionCompetitionScore: 0.32791411042944785



Validation scores:
	RegressionAUROC: 0.7519112825393677
	RegressionCompetitionScore: 0.3214723926380368



Validation scores:
	RegressionAUROC: 0.7464883327484131
	RegressionCompetitionScore: 0.3263803680981595



Validation scores:
	RegressionAUROC: 0.7447946071624756
	RegressionCompetitionScore: 0.3478527607361963

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3380368098159509
     Test RegressionAUROC            0.7519497871398926
Test RegressionCompetitionScore      0.3380368098159509
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 18:27:55,914][0m Trial 432 finished with value: 0.3380368098159509 and parameters: {'lr': 0.0007143807067201491, 'dropout': 0.5022895747889213, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 95, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004331110592783339, 'dropout': 0.4496032427952668, 'd_model_multiplier': 8, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 139, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 214 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
214 K     Trainable params
0         Non-trainable params
214 K     Total params
0.858     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6864603757858276
	RegressionCompetitionScore: 0.27883435582822086

Metric val_loss improved. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6904189586639404
	RegressionCompetitionScore: 0.302760736196319

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7030858993530273
	RegressionCompetitionScore: 0.300920245398773

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7004864811897278
	RegressionCompetitionScore: 0.3319018404907976



Validation scores:
	RegressionAUROC: 0.7042605876922607
	RegressionCompetitionScore: 0.31901840490797545



Validation scores:
	RegressionAUROC: 0.7158215045928955
	RegressionCompetitionScore: 0.3512269938650307



Validation scores:
	RegressionAUROC: 0.7079350352287292
	RegressionCompetitionScore: 0.3285276073619632



Validation scores:
	RegressionAUROC: 0.7160856127738953
	RegressionCompetitionScore: 0.3245398773006135



Validation scores:
	RegressionAUROC: 0.6723370552062988
	RegressionCompetitionScore: 0.18496932515337422



Validation scores:
	RegressionAUROC: 0.7177426815032959
	RegressionCompetitionScore: 0.3398773006134969

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.183. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.300920245398773
     Test RegressionAUROC            0.7030858993530273
Test RegressionCompetitionScore       0.300920245398773
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 18:32:14,561][0m Trial 433 finished with value: 0.300920245398773 and parameters: {'lr': 0.0004331110592783339, 'dropout': 0.4496032427952668, 'd_model_multiplier': 8, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 139, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0006370516091877422, 'dropout': 0.45954682164216115, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 82, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 74.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
74.8 K    Trainable params
0         Non-trainable params
74.8 K    Total params
0.299     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.23188403248786926
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6805627346038818
	RegressionCompetitionScore: 0.2723926380368098

Metric val_loss improved. New best score: 0.333


Validation scores:
	RegressionAUROC: 0.6805943250656128
	RegressionCompetitionScore: 0.26717791411042946

Metric val_loss improved by 0.122 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.679853081703186
	RegressionCompetitionScore: 0.23374233128834357



Validation scores:
	RegressionAUROC: 0.5949562788009644
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6973063945770264
	RegressionCompetitionScore: 0.2696319018404908

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7001073360443115
	RegressionCompetitionScore: 0.28404907975460125



Validation scores:
	RegressionAUROC: 0.6968501806259155
	RegressionCompetitionScore: 0.2861963190184049



Validation scores:
	RegressionAUROC: 0.7056594491004944
	RegressionCompetitionScore: 0.2901840490797546



Validation scores:
	RegressionAUROC: 0.6729342937469482
	RegressionCompetitionScore: 0.29846625766871165



Validation scores:
	RegressionAUROC: 0.6943168044090271
	RegressionCompetitionScore: 0.2809815950920245



Validation scores:
	RegressionAUROC: 0.701635479927063
	RegressionCompetitionScore: 0.30368098159509205

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.6750916838645935
	RegressionCompetitionScore: 0.3006134969325153



Validation scores:
	RegressionAUROC: 0.6777043342590332
	RegressionCompetitionScore: 0.30644171779141105



Validation scores:
	RegressionAUROC: 0.7046552896499634
	RegressionCompetitionScore: 0.3006134969325153



Validation scores:
	RegressionAUROC: 0.7011412382125854
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7154408693313599
	RegressionCompetitionScore: 0.29754601226993865



Validation scores:
	RegressionAUROC: 0.7181434631347656
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7241058349609375
	RegressionCompetitionScore: 0.37239263803680983

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7085703611373901
	RegressionCompetitionScore: 0.3291411042944785



Validation scores:
	RegressionAUROC: 0.705044150352478
	RegressionCompetitionScore: 0.33588957055214724



Validation scores:
	RegressionAUROC: 0.6767091751098633
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6646225452423096
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6746144890785217
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6897372007369995
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6834481358528137
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.183. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37239263803680983
     Test RegressionAUROC            0.7241058349609375
Test RegressionCompetitionScore      0.37239263803680983
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 18:42:48,954][0m Trial 434 finished with value: 0.37239263803680983 and parameters: {'lr': 0.0006370516091877422, 'dropout': 0.45954682164216115, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 82, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00157532609357767, 'dropout': 0.8137960244021846, 'd_model_multiplier': 16, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 585, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.2 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.2 M     Trainable params
0         Non-trainable params
1.2 M     Total params
4.876     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.1497584581375122
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.49800610542297363
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 9.677


Validation scores:
	RegressionAUROC: 0.5964069366455078
	RegressionCompetitionScore: 0.07423312883435583

Metric val_loss improved by 9.458 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.38899341225624084
	RegressionCompetitionScore: 0.09785276073619632



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.219. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.07423312883435583
     Test RegressionAUROC            0.5964069366455078
Test RegressionCompetitionScore      0.07423312883435583
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 18:46:45,938][0m Trial 435 finished with value: 0.07423312883435583 and parameters: {'lr': 0.00157532609357767, 'dropout': 0.8137960244021846, 'd_model_multiplier': 16, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 585, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0009092218182844278, 'dropout': 0.44058152361463754, 'd_model_multiplier': 64, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 113, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 5.2 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
5.2 M     Trainable params
0         Non-trainable params
5.2 M     Total params
20.651    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 292.539


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 273.594 >= min_delta = 0.0. New best score: 18.945


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 9.594 >= min_delta = 0.0. New best score: 9.351


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 5.617 >= min_delta = 0.0. New best score: 3.734


Validation scores:
	RegressionAUROC: 0.4552268385887146
	RegressionCompetitionScore: 0.034662576687116566

Metric val_loss improved by 3.525 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.34100040793418884
	RegressionCompetitionScore: 0.02392638036809816



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4634295105934143
	RegressionCompetitionScore: 0.05061349693251534



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore          0.034662576687116566
     Test RegressionAUROC            0.4552268385887146
Test RegressionCompetitionScore     0.034662576687116566
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 18:52:29,969][0m Trial 436 finished with value: 0.034662576687116566 and parameters: {'lr': 0.0009092218182844278, 'dropout': 0.44058152361463754, 'd_model_multiplier': 64, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 113, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00024504115927388557, 'dropout': 0.47646120213745957, 'd_model_multiplier': 2, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 624, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 74.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
74.5 K    Trainable params
0         Non-trainable params
74.5 K    Total params
0.298     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.52173912525177
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6762874126434326
	RegressionCompetitionScore: 0.27269938650306746

Metric val_loss improved. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.71504807472229
	RegressionCompetitionScore: 0.3113496932515337

Metric val_loss improved by 0.045 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7217066287994385
	RegressionCompetitionScore: 0.32239263803680984

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7274618148803711
	RegressionCompetitionScore: 0.3383435582822086



Validation scores:
	RegressionAUROC: 0.7338602542877197
	RegressionCompetitionScore: 0.37116564417177916

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7398552894592285
	RegressionCompetitionScore: 0.3861963190184049



Validation scores:
	RegressionAUROC: 0.7471897006034851
	RegressionCompetitionScore: 0.38742331288343557



Validation scores:
	RegressionAUROC: 0.7414884567260742
	RegressionCompetitionScore: 0.3773006134969325



Validation scores:
	RegressionAUROC: 0.7305279970169067
	RegressionCompetitionScore: 0.37883435582822084



Validation scores:
	RegressionAUROC: 0.7517872452735901
	RegressionCompetitionScore: 0.39815950920245397



Validation scores:
	RegressionAUROC: 0.746258556842804
	RegressionCompetitionScore: 0.40337423312883436



Validation scores:
	RegressionAUROC: 0.7507494688034058
	RegressionCompetitionScore: 0.40153374233128836

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7470791339874268
	RegressionCompetitionScore: 0.41503067484662576

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7530224323272705
	RegressionCompetitionScore: 0.41042944785276075



Validation scores:
	RegressionAUROC: 0.7607295513153076
	RegressionCompetitionScore: 0.4101226993865031

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7644767165184021
	RegressionCompetitionScore: 0.40950920245398775



Validation scores:
	RegressionAUROC: 0.756883978843689
	RegressionCompetitionScore: 0.4288343558282209



Validation scores:
	RegressionAUROC: 0.7530527114868164
	RegressionCompetitionScore: 0.3889570552147239



Validation scores:
	RegressionAUROC: 0.7408624887466431
	RegressionCompetitionScore: 0.37699386503067484



Validation scores:
	RegressionAUROC: 0.7520172595977783
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.7469288110733032
	RegressionCompetitionScore: 0.4098159509202454



Validation scores:
	RegressionAUROC: 0.7490209937095642
	RegressionCompetitionScore: 0.38926380368098157

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.162. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4101226993865031
     Test RegressionAUROC            0.7607295513153076
Test RegressionCompetitionScore      0.4101226993865031
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 19:01:21,215][0m Trial 437 finished with value: 0.4101226993865031 and parameters: {'lr': 0.00024504115927388557, 'dropout': 0.47646120213745957, 'd_model_multiplier': 2, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 624, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.04749867493809089, 'dropout': 0.5594676075159919, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 4, 'dim_feedforward': 147, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 24.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
24.2 K    Trainable params
0         Non-trainable params
24.2 K    Total params
0.097     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 19:06:02,556][0m Trial 438 finished with value: 0.0 and parameters: {'lr': 0.04749867493809089, 'dropout': 0.5594676075159919, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 4, 'dim_feedforward': 147, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00037543426588355444, 'dropout': 0.5139410336753424, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 565, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 63.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
63.3 K    Trainable params
0         Non-trainable params
63.3 K    Total params
0.253     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2291666567325592
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6730124950408936
	RegressionCompetitionScore: 0.13865030674846626

Metric val_loss improved. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.7044804096221924
	RegressionCompetitionScore: 0.32331288343558284

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.704297661781311
	RegressionCompetitionScore: 0.2773006134969325



Validation scores:
	RegressionAUROC: 0.7204551696777344
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7312502264976501
	RegressionCompetitionScore: 0.36012269938650304



Validation scores:
	RegressionAUROC: 0.7235575914382935
	RegressionCompetitionScore: 0.32791411042944785



Validation scores:
	RegressionAUROC: 0.7308948040008545
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7274397611618042
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7364931702613831
	RegressionCompetitionScore: 0.3693251533742331

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.32331288343558284
     Test RegressionAUROC            0.7044804096221924
Test RegressionCompetitionScore      0.32331288343558284
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 19:10:02,029][0m Trial 439 finished with value: 0.32331288343558284 and parameters: {'lr': 0.00037543426588355444, 'dropout': 0.5139410336753424, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 565, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0006180861315531627, 'dropout': 0.6355131029954815, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 610, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 45.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
45.0 K    Trainable params
0         Non-trainable params
45.0 K    Total params
0.180     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.46666669845581055
	RegressionCompetitionScore: 0.2



Validation scores:
	RegressionAUROC: 0.583213210105896
	RegressionCompetitionScore: 0.10061349693251534

Metric val_loss improved. New best score: 0.292


Validation scores:
	RegressionAUROC: 0.49969324469566345
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5005804896354675
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6001816987991333
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.292. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10061349693251534
     Test RegressionAUROC             0.583213210105896
Test RegressionCompetitionScore      0.10061349693251534
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 19:13:41,249][0m Trial 440 finished with value: 0.10061349693251534 and parameters: {'lr': 0.0006180861315531627, 'dropout': 0.6355131029954815, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 610, 'batch_size': 4, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00046439332711535093, 'dropout': 0.40998908195965944, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 118, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 30.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
30.6 K    Trainable params
0         Non-trainable params
30.6 K    Total params
0.122     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.47342997789382935
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.7012351751327515
	RegressionCompetitionScore: 0.21533742331288344

Metric val_loss improved. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.7195202112197876
	RegressionCompetitionScore: 0.2871165644171779

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7374188899993896
	RegressionCompetitionScore: 0.3803680981595092

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7363266944885254
	RegressionCompetitionScore: 0.35245398773006137



Validation scores:
	RegressionAUROC: 0.7408386468887329
	RegressionCompetitionScore: 0.37484662576687117



Validation scores:
	RegressionAUROC: 0.7481281757354736
	RegressionCompetitionScore: 0.32607361963190185

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7475844621658325
	RegressionCompetitionScore: 0.3693251533742331



Validation scores:
	RegressionAUROC: 0.7512463331222534
	RegressionCompetitionScore: 0.36319018404907977



Validation scores:
	RegressionAUROC: 0.7531588077545166
	RegressionCompetitionScore: 0.3932515337423313



Validation scores:
	RegressionAUROC: 0.7551937103271484
	RegressionCompetitionScore: 0.3539877300613497



Validation scores:
	RegressionAUROC: 0.7639445662498474
	RegressionCompetitionScore: 0.3745398773006135

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7618330717086792
	RegressionCompetitionScore: 0.3469325153374233



Validation scores:
	RegressionAUROC: 0.748874306678772
	RegressionCompetitionScore: 0.36595092024539877



Validation scores:
	RegressionAUROC: 0.7494402527809143
	RegressionCompetitionScore: 0.36257668711656443



Validation scores:
	RegressionAUROC: 0.7581436038017273
	RegressionCompetitionScore: 0.36073619631901843



Validation scores:
	RegressionAUROC: 0.7739883065223694
	RegressionCompetitionScore: 0.37975460122699384



Validation scores:
	RegressionAUROC: 0.7744475603103638
	RegressionCompetitionScore: 0.40613496932515336



Validation scores:
	RegressionAUROC: 0.7545746564865112
	RegressionCompetitionScore: 0.347239263803681

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.164. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3745398773006135
     Test RegressionAUROC            0.7639445662498474
Test RegressionCompetitionScore      0.3745398773006135
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 19:20:59,969][0m Trial 441 finished with value: 0.3745398773006135 and parameters: {'lr': 0.00046439332711535093, 'dropout': 0.40998908195965944, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 118, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0011638129217777968, 'dropout': 0.4556416744653754, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 87, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 30.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
30.8 K    Trainable params
0         Non-trainable params
30.8 K    Total params
0.123     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.705314040184021
	RegressionCompetitionScore: 0.5217391304347826



Validation scores:
	RegressionAUROC: 0.4998466372489929
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 2.046


Validation scores:
	RegressionAUROC: 0.510403037071228
	RegressionCompetitionScore: 0.08558282208588958

Metric val_loss improved by 1.019 >= min_delta = 0.0. New best score: 1.027


Validation scores:
	RegressionAUROC: 0.5069287419319153
	RegressionCompetitionScore: 0.03773006134969325



Validation scores:
	RegressionAUROC: 0.4240463972091675
	RegressionCompetitionScore: 0.10368098159509202

Metric val_loss improved by 0.796 >= min_delta = 0.0. New best score: 0.231


Validation scores:
	RegressionAUROC: 0.46480804681777954
	RegressionCompetitionScore: 0.10214723926380367



Validation scores:
	RegressionAUROC: 0.6266748905181885
	RegressionCompetitionScore: 0.21226993865030674

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.6322147250175476
	RegressionCompetitionScore: 0.29570552147239265



Validation scores:
	RegressionAUROC: 0.6346872448921204
	RegressionCompetitionScore: 0.298159509202454



Validation scores:
	RegressionAUROC: 0.6418915390968323
	RegressionCompetitionScore: 0.2861963190184049



Validation scores:
	RegressionAUROC: 0.5857563018798828
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6582576036453247
	RegressionCompetitionScore: 0.19233128834355828



Validation scores:
	RegressionAUROC: 0.6696571111679077
	RegressionCompetitionScore: 0.24846625766871167



Validation scores:
	RegressionAUROC: 0.6730713844299316
	RegressionCompetitionScore: 0.25736196319018406

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.207. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.21226993865030674
     Test RegressionAUROC            0.6266748905181885
Test RegressionCompetitionScore      0.21226993865030674
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 19:26:31,110][0m Trial 442 finished with value: 0.21226993865030674 and parameters: {'lr': 0.0011638129217777968, 'dropout': 0.4556416744653754, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 87, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00032025598275826195, 'dropout': 0.445976043335117, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 587, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 75.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
75.1 K    Trainable params
0         Non-trainable params
75.1 K    Total params
0.300     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.35748791694641113
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5895406007766724
	RegressionCompetitionScore: 0.18466257668711655

Metric val_loss improved. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6501015424728394
	RegressionCompetitionScore: 0.27883435582822086



Validation scores:
	RegressionAUROC: 0.678908109664917
	RegressionCompetitionScore: 0.2625766871165644

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7071934342384338
	RegressionCompetitionScore: 0.3033742331288344

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.705308198928833
	RegressionCompetitionScore: 0.3245398773006135



Validation scores:
	RegressionAUROC: 0.7173934578895569
	RegressionCompetitionScore: 0.34846625766871164

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7017083168029785
	RegressionCompetitionScore: 0.33312883435582824



Validation scores:
	RegressionAUROC: 0.7316519021987915
	RegressionCompetitionScore: 0.35552147239263804



Validation scores:
	RegressionAUROC: 0.7417792081832886
	RegressionCompetitionScore: 0.37607361963190183

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7384142875671387
	RegressionCompetitionScore: 0.3389570552147239



Validation scores:
	RegressionAUROC: 0.7412603497505188
	RegressionCompetitionScore: 0.36226993865030677



Validation scores:
	RegressionAUROC: 0.7505930662155151
	RegressionCompetitionScore: 0.3708588957055215

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7429686188697815
	RegressionCompetitionScore: 0.35337423312883437



Validation scores:
	RegressionAUROC: 0.755989670753479
	RegressionCompetitionScore: 0.39539877300613496



Validation scores:
	RegressionAUROC: 0.7611089944839478
	RegressionCompetitionScore: 0.4134969325153374



Validation scores:
	RegressionAUROC: 0.7573310732841492
	RegressionCompetitionScore: 0.3619631901840491

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7451993823051453
	RegressionCompetitionScore: 0.4395705521472393



Validation scores:
	RegressionAUROC: 0.7375060319900513
	RegressionCompetitionScore: 0.3871165644171779



Validation scores:
	RegressionAUROC: 0.7383784055709839
	RegressionCompetitionScore: 0.35153374233128837



Validation scores:
	RegressionAUROC: 0.7640884518623352
	RegressionCompetitionScore: 0.4101226993865031



Validation scores:
	RegressionAUROC: 0.7586918473243713
	RegressionCompetitionScore: 0.4331288343558282



Validation scores:
	RegressionAUROC: 0.7518738508224487
	RegressionCompetitionScore: 0.3717791411042945



Validation scores:
	RegressionAUROC: 0.7525861263275146
	RegressionCompetitionScore: 0.3815950920245399

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.169. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3619631901840491
     Test RegressionAUROC            0.7573310732841492
Test RegressionCompetitionScore      0.3619631901840491
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 19:35:59,002][0m Trial 443 finished with value: 0.3619631901840491 and parameters: {'lr': 0.00032025598275826195, 'dropout': 0.445976043335117, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 587, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.000531873396022394, 'dropout': 0.4850104929169512, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 137, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 39.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
39.5 K    Trainable params
0         Non-trainable params
39.5 K    Total params
0.158     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.42995166778564453
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.7041069269180298
	RegressionCompetitionScore: 0.3478527607361963

Metric val_loss improved. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.7015928626060486
	RegressionCompetitionScore: 0.295398773006135



Validation scores:
	RegressionAUROC: 0.6985431909561157
	RegressionCompetitionScore: 0.22760736196319017

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.719847559928894
	RegressionCompetitionScore: 0.34171779141104297



Validation scores:
	RegressionAUROC: 0.7339219450950623
	RegressionCompetitionScore: 0.40736196319018403

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7403178215026855
	RegressionCompetitionScore: 0.39754601226993863

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7552529573440552
	RegressionCompetitionScore: 0.40828220858895703

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7572221755981445
	RegressionCompetitionScore: 0.37331288343558283



Validation scores:
	RegressionAUROC: 0.7378206849098206
	RegressionCompetitionScore: 0.3337423312883436



Validation scores:
	RegressionAUROC: 0.7670002579689026
	RegressionCompetitionScore: 0.40429447852760736



Validation scores:
	RegressionAUROC: 0.7573548555374146
	RegressionCompetitionScore: 0.4098159509202454

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.773773193359375
	RegressionCompetitionScore: 0.41840490797546015

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7717510461807251
	RegressionCompetitionScore: 0.4067484662576687

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7813029289245605
	RegressionCompetitionScore: 0.41932515337423315



Validation scores:
	RegressionAUROC: 0.7858851552009583
	RegressionCompetitionScore: 0.43282208588957055

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.158


Validation scores:
	RegressionAUROC: 0.7934828400611877
	RegressionCompetitionScore: 0.4530674846625767



Validation scores:
	RegressionAUROC: 0.7967044115066528
	RegressionCompetitionScore: 0.43282208588957055



Validation scores:
	RegressionAUROC: 0.7962225079536438
	RegressionCompetitionScore: 0.44969325153374234



Validation scores:
	RegressionAUROC: 0.7936148047447205
	RegressionCompetitionScore: 0.4644171779141104



Validation scores:
	RegressionAUROC: 0.7994600534439087
	RegressionCompetitionScore: 0.46411042944785275



Validation scores:
	RegressionAUROC: 0.7933624386787415
	RegressionCompetitionScore: 0.4539877300613497



Validation scores:
	RegressionAUROC: 0.7984747886657715
	RegressionCompetitionScore: 0.4558282208588957

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.158. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.43282208588957055
     Test RegressionAUROC            0.7858851552009583
Test RegressionCompetitionScore      0.43282208588957055
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 19:45:03,409][0m Trial 444 finished with value: 0.43282208588957055 and parameters: {'lr': 0.000531873396022394, 'dropout': 0.4850104929169512, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 137, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004931615628998237, 'dropout': 0.48838219650787174, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 107, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 113 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
113 K     Trainable params
0         Non-trainable params
113 K     Total params
0.455     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6714975833892822
	RegressionCompetitionScore: 0.34782608695652173



Validation scores:
	RegressionAUROC: 0.671837329864502
	RegressionCompetitionScore: 0.2782208588957055

Metric val_loss improved. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.6814591884613037
	RegressionCompetitionScore: 0.2561349693251534

Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.6943098902702332
	RegressionCompetitionScore: 0.2656441717791411



Validation scores:
	RegressionAUROC: 0.6788631677627563
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7199956178665161
	RegressionCompetitionScore: 0.349079754601227



Validation scores:
	RegressionAUROC: 0.7235934734344482
	RegressionCompetitionScore: 0.3276073619631902



Validation scores:
	RegressionAUROC: 0.7277214527130127
	RegressionCompetitionScore: 0.40797546012269936



Validation scores:
	RegressionAUROC: 0.7152255773544312
	RegressionCompetitionScore: 0.35245398773006137

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7327063083648682
	RegressionCompetitionScore: 0.3904907975460123

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7230969667434692
	RegressionCompetitionScore: 0.36349693251533743



Validation scores:
	RegressionAUROC: 0.6945959329605103
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7114866971969604
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6779755353927612
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7276209592819214
	RegressionCompetitionScore: 0.36012269938650304

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7330999374389648
	RegressionCompetitionScore: 0.37392638036809817



Validation scores:
	RegressionAUROC: 0.7049451470375061
	RegressionCompetitionScore: 0.2852760736196319



Validation scores:
	RegressionAUROC: 0.7204079031944275
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.744168758392334
	RegressionCompetitionScore: 0.38220858895705523

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.738393247127533
	RegressionCompetitionScore: 0.3923312883435583



Validation scores:
	RegressionAUROC: 0.7483161091804504
	RegressionCompetitionScore: 0.36134969325153377



Validation scores:
	RegressionAUROC: 0.7447347044944763
	RegressionCompetitionScore: 0.3834355828220859



Validation scores:
	RegressionAUROC: 0.714386522769928
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7455734014511108
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7570273876190186
	RegressionCompetitionScore: 0.40153374233128836



Validation scores:
	RegressionAUROC: 0.7612804770469666
	RegressionCompetitionScore: 0.36809815950920244

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7497727870941162
	RegressionCompetitionScore: 0.3993865030674847



Validation scores:
	RegressionAUROC: 0.754621148109436
	RegressionCompetitionScore: 0.4147239263803681



Validation scores:
	RegressionAUROC: 0.7473288774490356
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7548972368240356
	RegressionCompetitionScore: 0.38374233128834356



Validation scores:
	RegressionAUROC: 0.7685917615890503
	RegressionCompetitionScore: 0.4303680981595092

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7403737306594849
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7532007694244385
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7304134964942932
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7648510336875916
	RegressionCompetitionScore: 0.40950920245398775



Validation scores:
	RegressionAUROC: 0.7721964120864868
	RegressionCompetitionScore: 0.41319018404907976



Validation scores:
	RegressionAUROC: 0.7713692784309387
	RegressionCompetitionScore: 0.4092024539877301



Validation scores:
	RegressionAUROC: 0.7699218988418579
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4303680981595092
     Test RegressionAUROC            0.7685917615890503
Test RegressionCompetitionScore      0.4303680981595092
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 20:03:41,977][0m Trial 445 finished with value: 0.4303680981595092 and parameters: {'lr': 0.0004931615628998237, 'dropout': 0.48838219650787174, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 107, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.000541173431161813, 'dropout': 0.5006557215572793, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 99, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 110 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
110 K     Trainable params
0         Non-trainable params
110 K     Total params
0.442     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2801932096481323
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.45456844568252563
	RegressionCompetitionScore: 0.1067484662576687

Metric val_loss improved. New best score: 0.223


Validation scores:
	RegressionAUROC: 0.6160934567451477
	RegressionCompetitionScore: 0.21595092024539878



Validation scores:
	RegressionAUROC: 0.6233289241790771
	RegressionCompetitionScore: 0.25674846625766873

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.6977525353431702
	RegressionCompetitionScore: 0.25306748466257667



Validation scores:
	RegressionAUROC: 0.7153667211532593
	RegressionCompetitionScore: 0.33680981595092024



Validation scores:
	RegressionAUROC: 0.7159565687179565
	RegressionCompetitionScore: 0.3276073619631902



Validation scores:
	RegressionAUROC: 0.7263197898864746
	RegressionCompetitionScore: 0.34386503067484664

Metric val_loss improved by 0.036 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7272896766662598
	RegressionCompetitionScore: 0.350920245398773



Validation scores:
	RegressionAUROC: 0.7247852087020874
	RegressionCompetitionScore: 0.3708588957055215



Validation scores:
	RegressionAUROC: 0.74293053150177
	RegressionCompetitionScore: 0.36503067484662577

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7454631328582764
	RegressionCompetitionScore: 0.3220858895705521



Validation scores:
	RegressionAUROC: 0.7362710237503052
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7504644393920898
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7503798007965088
	RegressionCompetitionScore: 0.36503067484662577

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7660109996795654
	RegressionCompetitionScore: 0.3834355828220859

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7654769420623779
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7506664991378784
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7544121742248535
	RegressionCompetitionScore: 0.35644171779141104



Validation scores:
	RegressionAUROC: 0.7629073858261108
	RegressionCompetitionScore: 0.3969325153374233



Validation scores:
	RegressionAUROC: 0.7589466571807861
	RegressionCompetitionScore: 0.401840490797546



Validation scores:
	RegressionAUROC: 0.7510207295417786
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7596472501754761
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.165. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3834355828220859
     Test RegressionAUROC            0.7660109996795654
Test RegressionCompetitionScore      0.3834355828220859
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 20:14:59,705][0m Trial 446 finished with value: 0.3834355828220859 and parameters: {'lr': 0.000541173431161813, 'dropout': 0.5006557215572793, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 99, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00048634436113885866, 'dropout': 0.47932563769020137, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 146, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 128 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
128 K     Trainable params
0         Non-trainable params
128 K     Total params
0.516     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.38164249062538147
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.640417218208313
	RegressionCompetitionScore: 0.11840490797546012

Metric val_loss improved. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.7145847678184509
	RegressionCompetitionScore: 0.346319018404908

Metric val_loss improved by 0.062 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7052322626113892
	RegressionCompetitionScore: 0.3067484662576687



Validation scores:
	RegressionAUROC: 0.7366557121276855
	RegressionCompetitionScore: 0.3595092024539877



Validation scores:
	RegressionAUROC: 0.7248953580856323
	RegressionCompetitionScore: 0.345398773006135



Validation scores:
	RegressionAUROC: 0.7389194965362549
	RegressionCompetitionScore: 0.3530674846625767

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7680095434188843
	RegressionCompetitionScore: 0.40245398773006136

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7656189203262329
	RegressionCompetitionScore: 0.3726993865030675



Validation scores:
	RegressionAUROC: 0.7820473909378052
	RegressionCompetitionScore: 0.4119631901840491



Validation scores:
	RegressionAUROC: 0.7806257009506226
	RegressionCompetitionScore: 0.4223926380368098



Validation scores:
	RegressionAUROC: 0.7701878547668457
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7949028015136719
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.8047330975532532
	RegressionCompetitionScore: 0.44355828220858895

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.153


Validation scores:
	RegressionAUROC: 0.8009955883026123
	RegressionCompetitionScore: 0.4226993865030675



Validation scores:
	RegressionAUROC: 0.7983751893043518
	RegressionCompetitionScore: 0.4067484662576687



Validation scores:
	RegressionAUROC: 0.8050165176391602
	RegressionCompetitionScore: 0.4687116564417178



Validation scores:
	RegressionAUROC: 0.7971396446228027
	RegressionCompetitionScore: 0.43190184049079755



Validation scores:
	RegressionAUROC: 0.7883893251419067
	RegressionCompetitionScore: 0.43006134969325155



Validation scores:
	RegressionAUROC: 0.8038976192474365
	RegressionCompetitionScore: 0.4794478527607362



Validation scores:
	RegressionAUROC: 0.7963032126426697
	RegressionCompetitionScore: 0.4411042944785276

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.153. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.44355828220858895
     Test RegressionAUROC            0.8047330975532532
Test RegressionCompetitionScore      0.44355828220858895
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 20:25:14,878][0m Trial 447 finished with value: 0.44355828220858895 and parameters: {'lr': 0.00048634436113885866, 'dropout': 0.47932563769020137, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 146, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005245678010802453, 'dropout': 0.5071584279035198, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 150, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 144 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
144 K     Trainable params
0         Non-trainable params
144 K     Total params
0.578     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5041140913963318
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.399


Validation scores:
	RegressionAUROC: 0.6432185769081116
	RegressionCompetitionScore: 0.23558282208588957

Metric val_loss improved by 0.193 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6772779226303101
	RegressionCompetitionScore: 0.11012269938650307



Validation scores:
	RegressionAUROC: 0.6853711009025574
	RegressionCompetitionScore: 0.2929447852760736



Validation scores:
	RegressionAUROC: 0.6687285900115967
	RegressionCompetitionScore: 0.32607361963190185

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7184691429138184
	RegressionCompetitionScore: 0.34355828220858897



Validation scores:
	RegressionAUROC: 0.7351853847503662
	RegressionCompetitionScore: 0.37975460122699384



Validation scores:
	RegressionAUROC: 0.7087263464927673
	RegressionCompetitionScore: 0.32699386503067485



Validation scores:
	RegressionAUROC: 0.7331572771072388
	RegressionCompetitionScore: 0.3843558282208589



Validation scores:
	RegressionAUROC: 0.722286581993103
	RegressionCompetitionScore: 0.37239263803680983



Validation scores:
	RegressionAUROC: 0.7390490174293518
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7436287999153137
	RegressionCompetitionScore: 0.37975460122699384

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.190. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.32607361963190185
     Test RegressionAUROC            0.6687285900115967
Test RegressionCompetitionScore      0.32607361963190185
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 20:32:01,891][0m Trial 448 finished with value: 0.32607361963190185 and parameters: {'lr': 0.0005245678010802453, 'dropout': 0.5071584279035198, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 150, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0007258521682158325, 'dropout': 0.4919796513986339, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 139, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 126 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
126 K     Trainable params
0         Non-trainable params
126 K     Total params
0.505     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4052622318267822
	RegressionCompetitionScore: 0.08251533742331288

Metric val_loss improved. New best score: 0.239


Validation scores:
	RegressionAUROC: 0.6553769111633301
	RegressionCompetitionScore: 0.13159509202453987

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.6854785680770874
	RegressionCompetitionScore: 0.202760736196319

Metric val_loss improved by 0.033 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6767423152923584
	RegressionCompetitionScore: 0.1628834355828221



Validation scores:
	RegressionAUROC: 0.6765884757041931
	RegressionCompetitionScore: 0.22975460122699387



Validation scores:
	RegressionAUROC: 0.6965559720993042
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7017102837562561
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7012593746185303
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.712070107460022
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7052993178367615
	RegressionCompetitionScore: 0.33220858895705524

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.205. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.202760736196319
     Test RegressionAUROC            0.6854785680770874
Test RegressionCompetitionScore       0.202760736196319
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 20:37:22,683][0m Trial 449 finished with value: 0.202760736196319 and parameters: {'lr': 0.0007258521682158325, 'dropout': 0.4919796513986339, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 139, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.017751175793030174, 'dropout': 0.48918434993217746, 'd_model_multiplier': 2, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 159, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 299 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
299 K     Trainable params
0         Non-trainable params
299 K     Total params
1.200     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4251207709312439
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 315.964


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 298.116 >= min_delta = 0.0. New best score: 17.848


Validation scores:
	RegressionAUROC: 0.49755778908729553
	RegressionCompetitionScore: 0.057975460122699385

Metric val_loss improved by 17.436 >= min_delta = 0.0. New best score: 0.413


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: 0.384


Validation scores:
	RegressionAUROC: 0.49824970960617065
	RegressionCompetitionScore: 0.04723926380368098

Metric val_loss improved by 0.143 >= min_delta = 0.0. New best score: 0.240


Validation scores:
	RegressionAUROC: 0.5025850534439087
	RegressionCompetitionScore: 0.03773006134969325



Validation scores:
	RegressionAUROC: 0.5021505951881409
	RegressionCompetitionScore: 0.0558282208588957

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.49993401765823364
	RegressionCompetitionScore: 0.049079754601226995



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.510981559753418
	RegressionCompetitionScore: 0.07239263803680981



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.215. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.0558282208588957
     Test RegressionAUROC            0.5021505951881409
Test RegressionCompetitionScore      0.0558282208588957
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 20:46:45,129][0m Trial 450 finished with value: 0.0558282208588957 and parameters: {'lr': 0.017751175793030174, 'dropout': 0.48918434993217746, 'd_model_multiplier': 2, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 159, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004433736275146334, 'dropout': 0.4838176038185285, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 139, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 126 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
126 K     Trainable params
0         Non-trainable params
126 K     Total params
0.505     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.40096619725227356
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.6910274028778076
	RegressionCompetitionScore: 0.24478527607361963

Metric val_loss improved. New best score: 0.304


Validation scores:
	RegressionAUROC: 0.7224298119544983
	RegressionCompetitionScore: 0.20153374233128835

Metric val_loss improved by 0.061 >= min_delta = 0.0. New best score: 0.243


Validation scores:
	RegressionAUROC: 0.7172712683677673
	RegressionCompetitionScore: 0.28067484662576686

Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.7382693290710449
	RegressionCompetitionScore: 0.35521472392638037

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.7545778751373291
	RegressionCompetitionScore: 0.3745398773006135



Validation scores:
	RegressionAUROC: 0.7478767037391663
	RegressionCompetitionScore: 0.38128834355828223



Validation scores:
	RegressionAUROC: 0.7471042275428772
	RegressionCompetitionScore: 0.37208588957055216

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7463850975036621
	RegressionCompetitionScore: 0.37147239263803683

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.753343939781189
	RegressionCompetitionScore: 0.38650306748466257



Validation scores:
	RegressionAUROC: 0.7510323524475098
	RegressionCompetitionScore: 0.3638036809815951



Validation scores:
	RegressionAUROC: 0.7516771554946899
	RegressionCompetitionScore: 0.399079754601227

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7491232752799988
	RegressionCompetitionScore: 0.3834355828220859

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7503517866134644
	RegressionCompetitionScore: 0.3843558282208589



Validation scores:
	RegressionAUROC: 0.7527772188186646
	RegressionCompetitionScore: 0.43742331288343556



Validation scores:
	RegressionAUROC: 0.767020046710968
	RegressionCompetitionScore: 0.451840490797546



Validation scores:
	RegressionAUROC: 0.7692227363586426
	RegressionCompetitionScore: 0.4530674846625767

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.7747291922569275
	RegressionCompetitionScore: 0.46656441717791414



Validation scores:
	RegressionAUROC: 0.7655305862426758
	RegressionCompetitionScore: 0.43558282208588955



Validation scores:
	RegressionAUROC: 0.7693780064582825
	RegressionCompetitionScore: 0.41042944785276075



Validation scores:
	RegressionAUROC: 0.7745581865310669
	RegressionCompetitionScore: 0.4315950920245399



Validation scores:
	RegressionAUROC: 0.7664028406143188
	RegressionCompetitionScore: 0.45613496932515335



Validation scores:
	RegressionAUROC: 0.7637122869491577
	RegressionCompetitionScore: 0.4325153374233129



Validation scores:
	RegressionAUROC: 0.7598257064819336
	RegressionCompetitionScore: 0.4190184049079755

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.162. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4530674846625767
     Test RegressionAUROC            0.7692227363586426
Test RegressionCompetitionScore      0.4530674846625767
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 20:58:31,320][0m Trial 451 finished with value: 0.4530674846625767 and parameters: {'lr': 0.0004433736275146334, 'dropout': 0.4838176038185285, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 139, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00039527346157863205, 'dropout': 0.48554539914596184, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 157, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 133 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
133 K     Trainable params
0         Non-trainable params
133 K     Total params
0.533     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5314009785652161
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.6698609590530396
	RegressionCompetitionScore: 0.23773006134969324

Metric val_loss improved. New best score: 0.281


Validation scores:
	RegressionAUROC: 0.6807984113693237
	RegressionCompetitionScore: 0.29049079754601226

Metric val_loss improved by 0.079 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.660539448261261
	RegressionCompetitionScore: 0.31441717791411045



Validation scores:
	RegressionAUROC: 0.721723735332489
	RegressionCompetitionScore: 0.3202453987730061

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7292588949203491
	RegressionCompetitionScore: 0.3226993865030675



Validation scores:
	RegressionAUROC: 0.7334002256393433
	RegressionCompetitionScore: 0.3371165644171779



Validation scores:
	RegressionAUROC: 0.7359228730201721
	RegressionCompetitionScore: 0.349079754601227



Validation scores:
	RegressionAUROC: 0.7149683237075806
	RegressionCompetitionScore: 0.31625766871165645



Validation scores:
	RegressionAUROC: 0.7371443510055542
	RegressionCompetitionScore: 0.37116564417177916



Validation scores:
	RegressionAUROC: 0.7423166632652283
	RegressionCompetitionScore: 0.35828220858895704



Validation scores:
	RegressionAUROC: 0.7409642934799194
	RegressionCompetitionScore: 0.3423312883435583

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.176. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3202453987730061
     Test RegressionAUROC             0.721723735332489
Test RegressionCompetitionScore      0.3202453987730061
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 21:04:25,133][0m Trial 452 finished with value: 0.3202453987730061 and parameters: {'lr': 0.00039527346157863205, 'dropout': 0.48554539914596184, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 157, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00048520010596603285, 'dropout': 0.47349263096280636, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 143, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 127 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
127 K     Trainable params
0         Non-trainable params
127 K     Total params
0.511     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5120773315429688
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.5694661140441895
	RegressionCompetitionScore: 0.07760736196319018

Metric val_loss improved. New best score: 0.294


Validation scores:
	RegressionAUROC: 0.6564734578132629
	RegressionCompetitionScore: 0.26993865030674846

Metric val_loss improved by 0.085 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6842453479766846
	RegressionCompetitionScore: 0.3

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7008464932441711
	RegressionCompetitionScore: 0.28680981595092025



Validation scores:
	RegressionAUROC: 0.6638494729995728
	RegressionCompetitionScore: 0.2785276073619632



Validation scores:
	RegressionAUROC: 0.6980614066123962
	RegressionCompetitionScore: 0.2598159509202454

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.6972008943557739
	RegressionCompetitionScore: 0.28865030674846626



Validation scores:
	RegressionAUROC: 0.7115362286567688
	RegressionCompetitionScore: 0.36901840490797544



Validation scores:
	RegressionAUROC: 0.6993159055709839
	RegressionCompetitionScore: 0.33865030674846625



Validation scores:
	RegressionAUROC: 0.7076637744903564
	RegressionCompetitionScore: 0.346319018404908



Validation scores:
	RegressionAUROC: 0.7167237401008606
	RegressionCompetitionScore: 0.3414110429447853



Validation scores:
	RegressionAUROC: 0.7246774435043335
	RegressionCompetitionScore: 0.34294478527607364



Validation scores:
	RegressionAUROC: 0.7326555252075195
	RegressionCompetitionScore: 0.348159509202454

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7309095859527588
	RegressionCompetitionScore: 0.3843558282208589



Validation scores:
	RegressionAUROC: 0.7486118078231812
	RegressionCompetitionScore: 0.37392638036809817



Validation scores:
	RegressionAUROC: 0.7338702082633972
	RegressionCompetitionScore: 0.37668711656441717



Validation scores:
	RegressionAUROC: 0.7438704967498779
	RegressionCompetitionScore: 0.3911042944785276



Validation scores:
	RegressionAUROC: 0.7348882555961609
	RegressionCompetitionScore: 0.37699386503067484



Validation scores:
	RegressionAUROC: 0.7253019213676453
	RegressionCompetitionScore: 0.36257668711656443



Validation scores:
	RegressionAUROC: 0.7324723601341248
	RegressionCompetitionScore: 0.35736196319018404

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.348159509202454
     Test RegressionAUROC            0.7326555252075195
Test RegressionCompetitionScore       0.348159509202454
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 21:14:45,497][0m Trial 453 finished with value: 0.348159509202454 and parameters: {'lr': 0.00048520010596603285, 'dropout': 0.47349263096280636, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 143, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00030074069676091835, 'dropout': 0.4856297897494099, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 132, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 123 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
123 K     Trainable params
0         Non-trainable params
123 K     Total params
0.494     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.782608687877655
	RegressionCompetitionScore: 0.5652173913043478



Validation scores:
	RegressionAUROC: 0.6731966733932495
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.253


Validation scores:
	RegressionAUROC: 0.6973561644554138
	RegressionCompetitionScore: 0.2812883435582822

Metric val_loss improved by 0.050 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.7075104713439941
	RegressionCompetitionScore: 0.2294478527607362

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7173673510551453
	RegressionCompetitionScore: 0.3187116564417178

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7250959873199463
	RegressionCompetitionScore: 0.348159509202454

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7324680089950562
	RegressionCompetitionScore: 0.3389570552147239



Validation scores:
	RegressionAUROC: 0.7374494671821594
	RegressionCompetitionScore: 0.35429447852760737



Validation scores:
	RegressionAUROC: 0.7364518046379089
	RegressionCompetitionScore: 0.32177914110429445

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7394909262657166
	RegressionCompetitionScore: 0.3257668711656442



Validation scores:
	RegressionAUROC: 0.7487905025482178
	RegressionCompetitionScore: 0.3610429447852761



Validation scores:
	RegressionAUROC: 0.7447428703308105
	RegressionCompetitionScore: 0.36134969325153377

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7542546987533569
	RegressionCompetitionScore: 0.3588957055214724



Validation scores:
	RegressionAUROC: 0.7423307299613953
	RegressionCompetitionScore: 0.3214723926380368



Validation scores:
	RegressionAUROC: 0.7507665157318115
	RegressionCompetitionScore: 0.349079754601227



Validation scores:
	RegressionAUROC: 0.7553156614303589
	RegressionCompetitionScore: 0.3585889570552147

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7551496028900146
	RegressionCompetitionScore: 0.38773006134969323

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7423851490020752
	RegressionCompetitionScore: 0.3628834355828221



Validation scores:
	RegressionAUROC: 0.7417519688606262
	RegressionCompetitionScore: 0.35153374233128837



Validation scores:
	RegressionAUROC: 0.7435188293457031
	RegressionCompetitionScore: 0.3579754601226994



Validation scores:
	RegressionAUROC: 0.7525370121002197
	RegressionCompetitionScore: 0.345398773006135



Validation scores:
	RegressionAUROC: 0.7482426166534424
	RegressionCompetitionScore: 0.37331288343558283



Validation scores:
	RegressionAUROC: 0.7496720552444458
	RegressionCompetitionScore: 0.3736196319018405



Validation scores:
	RegressionAUROC: 0.7342520952224731
	RegressionCompetitionScore: 0.3116564417177914

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.166. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38773006134969323
     Test RegressionAUROC            0.7551496028900146
Test RegressionCompetitionScore      0.38773006134969323
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 21:26:32,469][0m Trial 454 finished with value: 0.38773006134969323 and parameters: {'lr': 0.00030074069676091835, 'dropout': 0.4856297897494099, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 132, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.000364618414733639, 'dropout': 0.4782393181643033, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 165, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 136 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
136 K     Trainable params
0         Non-trainable params
136 K     Total params
0.545     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6570048332214355
	RegressionCompetitionScore: 0.391304347826087



Validation scores:
	RegressionAUROC: 0.6885862350463867
	RegressionCompetitionScore: 0.1705521472392638

Metric val_loss improved. New best score: 0.350


Validation scores:
	RegressionAUROC: 0.6921346783638
	RegressionCompetitionScore: 0.1558282208588957

Metric val_loss improved by 0.134 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.7104290127754211
	RegressionCompetitionScore: 0.2401840490797546

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6874626874923706
	RegressionCompetitionScore: 0.14570552147239263



Validation scores:
	RegressionAUROC: 0.7371733784675598
	RegressionCompetitionScore: 0.345398773006135



Validation scores:
	RegressionAUROC: 0.7386597990989685
	RegressionCompetitionScore: 0.349079754601227

Metric val_loss improved by 0.034 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7291470766067505
	RegressionCompetitionScore: 0.32699386503067485



Validation scores:
	RegressionAUROC: 0.7347782850265503
	RegressionCompetitionScore: 0.34294478527607364



Validation scores:
	RegressionAUROC: 0.7461027503013611
	RegressionCompetitionScore: 0.3763803680981595

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7538700103759766
	RegressionCompetitionScore: 0.3871165644171779



Validation scores:
	RegressionAUROC: 0.7271137237548828
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7529798746109009
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7514957785606384
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7537286877632141
	RegressionCompetitionScore: 0.37760736196319017



Validation scores:
	RegressionAUROC: 0.7589691877365112
	RegressionCompetitionScore: 0.40521472392638036



Validation scores:
	RegressionAUROC: 0.7508174180984497
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.174. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3763803680981595
     Test RegressionAUROC            0.7461027503013611
Test RegressionCompetitionScore      0.3763803680981595
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 21:34:50,299][0m Trial 455 finished with value: 0.3763803680981595 and parameters: {'lr': 0.000364618414733639, 'dropout': 0.4782393181643033, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 165, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005246266334958503, 'dropout': 0.4990597532095537, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 997, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 529 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
529 K     Trainable params
0         Non-trainable params
529 K     Total params
2.120     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6324881315231323
	RegressionCompetitionScore: 0.28251533742331286

Metric val_loss improved. New best score: 0.339


Validation scores:
	RegressionAUROC: 0.6484252214431763
	RegressionCompetitionScore: 0.2960122699386503

Metric val_loss improved by 0.024 >= min_delta = 0.0. New best score: 0.316


Validation scores:
	RegressionAUROC: 0.6565548181533813
	RegressionCompetitionScore: 0.29662576687116565



Validation scores:
	RegressionAUROC: 0.6990765333175659
	RegressionCompetitionScore: 0.18895705521472392

Metric val_loss improved by 0.035 >= min_delta = 0.0. New best score: 0.281


Validation scores:
	RegressionAUROC: 0.7093454003334045
	RegressionCompetitionScore: 0.3588957055214724

Metric val_loss improved by 0.069 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.7204711437225342
	RegressionCompetitionScore: 0.37300613496932516

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.7124649286270142
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7258015871047974
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7206641435623169
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7331815958023071
	RegressionCompetitionScore: 0.31104294478527605



Validation scores:
	RegressionAUROC: 0.658966064453125
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7279165983200073
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7174977660179138
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.206. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37300613496932516
     Test RegressionAUROC            0.7204711437225342
Test RegressionCompetitionScore      0.37300613496932516
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 21:42:16,544][0m Trial 456 finished with value: 0.37300613496932516 and parameters: {'lr': 0.0005246266334958503, 'dropout': 0.4990597532095537, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 997, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00043055933099911945, 'dropout': 0.4670860915337218, 'd_model_multiplier': 32, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 127, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 27.7 M
1 | loss_fn | MSELoss | 0     
------------------------------------
27.7 M    Trainable params
0         Non-trainable params
27.7 M    Total params
110.959   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.711


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.711. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 21:49:51,432][0m Trial 457 finished with value: 0.0 and parameters: {'lr': 0.00043055933099911945, 'dropout': 0.4670860915337218, 'd_model_multiplier': 32, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 127, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 2.2184656471439776e-05, 'dropout': 0.40968093510844955, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 148, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 129 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
129 K     Trainable params
0         Non-trainable params
129 K     Total params
0.519     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5919698476791382
	RegressionCompetitionScore: 0.18067484662576688

Metric val_loss improved. New best score: 0.334


Validation scores:
	RegressionAUROC: 0.6144009828567505
	RegressionCompetitionScore: 0.1736196319018405

Metric val_loss improved by 0.055 >= min_delta = 0.0. New best score: 0.279


Validation scores:
	RegressionAUROC: 0.6452068090438843
	RegressionCompetitionScore: 0.18773006134969325

Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.6606264710426331
	RegressionCompetitionScore: 0.21687116564417178

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.6715152859687805
	RegressionCompetitionScore: 0.2782208588957055



Validation scores:
	RegressionAUROC: 0.6899253129959106
	RegressionCompetitionScore: 0.24294478527607363



Validation scores:
	RegressionAUROC: 0.6695788502693176
	RegressionCompetitionScore: 0.2757668711656442



Validation scores:
	RegressionAUROC: 0.6977823376655579
	RegressionCompetitionScore: 0.297239263803681



Validation scores:
	RegressionAUROC: 0.6914435029029846
	RegressionCompetitionScore: 0.29325153374233126



Validation scores:
	RegressionAUROC: 0.6901148557662964
	RegressionCompetitionScore: 0.2684049079754601



Validation scores:
	RegressionAUROC: 0.6837026476860046
	RegressionCompetitionScore: 0.2831288343558282

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.238. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.21687116564417178
     Test RegressionAUROC            0.6606264710426331
Test RegressionCompetitionScore      0.21687116564417178
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 21:55:54,539][0m Trial 458 finished with value: 0.21687116564417178 and parameters: {'lr': 2.2184656471439776e-05, 'dropout': 0.40968093510844955, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 148, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 2.1139885845447956e-07, 'dropout': 0.4921267382507356, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 645, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 323 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
323 K     Trainable params
0         Non-trainable params
323 K     Total params
1.294     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.294


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.086 >= min_delta = 0.0. New best score: 1.208


Validation scores:
	RegressionAUROC: 0.5009202361106873
	RegressionCompetitionScore: 0.0018404907975460123

Metric val_loss improved by 0.083 >= min_delta = 0.0. New best score: 1.125


Validation scores:
	RegressionAUROC: 0.5017723441123962
	RegressionCompetitionScore: 0.003987730061349694

Metric val_loss improved by 0.082 >= min_delta = 0.0. New best score: 1.043


Validation scores:
	RegressionAUROC: 0.5058450698852539
	RegressionCompetitionScore: 0.012576687116564417

Metric val_loss improved by 0.075 >= min_delta = 0.0. New best score: 0.968


Validation scores:
	RegressionAUROC: 0.5116409063339233
	RegressionCompetitionScore: 0.029447852760736196

Metric val_loss improved by 0.071 >= min_delta = 0.0. New best score: 0.896


Validation scores:
	RegressionAUROC: 0.5259684920310974
	RegressionCompetitionScore: 0.06656441717791411

Metric val_loss improved by 0.068 >= min_delta = 0.0. New best score: 0.829


Validation scores:
	RegressionAUROC: 0.5442734956741333
	RegressionCompetitionScore: 0.1334355828220859

Metric val_loss improved by 0.066 >= min_delta = 0.0. New best score: 0.762


Validation scores:
	RegressionAUROC: 0.5690308809280396
	RegressionCompetitionScore: 0.17116564417177915

Metric val_loss improved by 0.061 >= min_delta = 0.0. New best score: 0.702


Validation scores:
	RegressionAUROC: 0.5864113569259644
	RegressionCompetitionScore: 0.17331288343558282

Metric val_loss improved by 0.057 >= min_delta = 0.0. New best score: 0.645


Validation scores:
	RegressionAUROC: 0.5887151956558228
	RegressionCompetitionScore: 0.17423312883435582

Metric val_loss improved by 0.057 >= min_delta = 0.0. New best score: 0.587


Validation scores:
	RegressionAUROC: 0.5879358649253845
	RegressionCompetitionScore: 0.1745398773006135

Metric val_loss improved by 0.049 >= min_delta = 0.0. New best score: 0.539


Validation scores:
	RegressionAUROC: 0.5899280309677124
	RegressionCompetitionScore: 0.17576687116564418

Metric val_loss improved by 0.046 >= min_delta = 0.0. New best score: 0.493


Validation scores:
	RegressionAUROC: 0.5883356928825378
	RegressionCompetitionScore: 0.17760736196319019

Metric val_loss improved by 0.044 >= min_delta = 0.0. New best score: 0.449


Validation scores:
	RegressionAUROC: 0.586555004119873
	RegressionCompetitionScore: 0.1794478527607362

Metric val_loss improved by 0.039 >= min_delta = 0.0. New best score: 0.410


Validation scores:
	RegressionAUROC: 0.5861220359802246
	RegressionCompetitionScore: 0.18067484662576688

Metric val_loss improved by 0.035 >= min_delta = 0.0. New best score: 0.375


Validation scores:
	RegressionAUROC: 0.585975170135498
	RegressionCompetitionScore: 0.18098159509202455

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.344


Validation scores:
	RegressionAUROC: 0.5860083103179932
	RegressionCompetitionScore: 0.18036809815950922

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.316


Validation scores:
	RegressionAUROC: 0.5865563154220581
	RegressionCompetitionScore: 0.18190184049079755

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.293


Validation scores:
	RegressionAUROC: 0.5872942209243774
	RegressionCompetitionScore: 0.18343558282208589

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.274


Validation scores:
	RegressionAUROC: 0.5881814956665039
	RegressionCompetitionScore: 0.18435582822085889

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.258


Validation scores:
	RegressionAUROC: 0.5889232754707336
	RegressionCompetitionScore: 0.18588957055214725

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.244


Validation scores:
	RegressionAUROC: 0.5894278883934021
	RegressionCompetitionScore: 0.18558282208588958

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.5899698734283447
	RegressionCompetitionScore: 0.18680981595092025

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.5904190540313721
	RegressionCompetitionScore: 0.18803680981595092

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.222


Validation scores:
	RegressionAUROC: 0.5909044146537781
	RegressionCompetitionScore: 0.18803680981595092

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.5909637212753296
	RegressionCompetitionScore: 0.18803680981595092

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.591454029083252
	RegressionCompetitionScore: 0.18926380368098158

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5918400883674622
	RegressionCompetitionScore: 0.1901840490797546

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5921002626419067
	RegressionCompetitionScore: 0.1901840490797546

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5925993323326111
	RegressionCompetitionScore: 0.19263803680981595



Validation scores:
	RegressionAUROC: 0.5931375622749329
	RegressionCompetitionScore: 0.19662576687116565



Validation scores:
	RegressionAUROC: 0.5935326218605042
	RegressionCompetitionScore: 0.1950920245398773



Validation scores:
	RegressionAUROC: 0.5939671993255615
	RegressionCompetitionScore: 0.19570552147239265



Validation scores:
	RegressionAUROC: 0.5943837761878967
	RegressionCompetitionScore: 0.19785276073619631



Validation scores:
	RegressionAUROC: 0.5946662425994873
	RegressionCompetitionScore: 0.19877300613496932



Validation scores:
	RegressionAUROC: 0.5950669646263123
	RegressionCompetitionScore: 0.19877300613496932

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.219. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1901840490797546
     Test RegressionAUROC            0.5921002626419067
Test RegressionCompetitionScore      0.1901840490797546
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 22:14:57,802][0m Trial 459 finished with value: 0.1901840490797546 and parameters: {'lr': 2.1139885845447956e-07, 'dropout': 0.4921267382507356, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 645, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005968625503109452, 'dropout': 0.4787151732599882, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 170, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 153 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
153 K     Trainable params
0         Non-trainable params
153 K     Total params
0.615     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.31884056329727173
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5375480651855469
	RegressionCompetitionScore: 0.09110429447852761

Metric val_loss improved. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.6885690689086914
	RegressionCompetitionScore: 0.202760736196319



Validation scores:
	RegressionAUROC: 0.6678144931793213
	RegressionCompetitionScore: 0.24631901840490797

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.7109758257865906
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7150771617889404
	RegressionCompetitionScore: 0.35828220858895704

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.720586895942688
	RegressionCompetitionScore: 0.36809815950920244



Validation scores:
	RegressionAUROC: 0.7126204371452332
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7265170812606812
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6849995851516724
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.737939715385437
	RegressionCompetitionScore: 0.36779141104294477

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7286326885223389
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7232106924057007
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7186374664306641
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7246789932250977
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7608708739280701
	RegressionCompetitionScore: 0.37423312883435583

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7187146544456482
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7099628448486328
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.718731164932251
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.751570463180542
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.773703932762146
	RegressionCompetitionScore: 0.37760736196319017



Validation scores:
	RegressionAUROC: 0.7311429381370544
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7597907185554504
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.167. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.37423312883435583
     Test RegressionAUROC            0.7608708739280701
Test RegressionCompetitionScore      0.37423312883435583
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 22:26:58,027][0m Trial 460 finished with value: 0.37423312883435583 and parameters: {'lr': 0.0005968625503109452, 'dropout': 0.4787151732599882, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 170, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 2.3678063195217225e-06, 'dropout': 0.46569345053367434, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 134, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 124 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
124 K     Trainable params
0         Non-trainable params
124 K     Total params
0.497     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.512077271938324
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.5040322542190552
	RegressionCompetitionScore: 0.10429447852760736

Metric val_loss improved. New best score: 0.277


Validation scores:
	RegressionAUROC: 0.5033994317054749
	RegressionCompetitionScore: 0.10705521472392639



Validation scores:
	RegressionAUROC: 0.5120959281921387
	RegressionCompetitionScore: 0.11533742331288344



Validation scores:
	RegressionAUROC: 0.5145776271820068
	RegressionCompetitionScore: 0.11748466257668712

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.266


Validation scores:
	RegressionAUROC: 0.5186148881912231
	RegressionCompetitionScore: 0.11871165644171779

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.261


Validation scores:
	RegressionAUROC: 0.5223419666290283
	RegressionCompetitionScore: 0.12361963190184048

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.249


Validation scores:
	RegressionAUROC: 0.5264168977737427
	RegressionCompetitionScore: 0.1285276073619632

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.241


Validation scores:
	RegressionAUROC: 0.5335232019424438
	RegressionCompetitionScore: 0.13680981595092023

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.5344026684761047
	RegressionCompetitionScore: 0.1352760736196319



Validation scores:
	RegressionAUROC: 0.5398367643356323
	RegressionCompetitionScore: 0.13374233128834356

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5406913757324219
	RegressionCompetitionScore: 0.13404907975460123



Validation scores:
	RegressionAUROC: 0.5447245836257935
	RegressionCompetitionScore: 0.13558282208588956



Validation scores:
	RegressionAUROC: 0.5535051226615906
	RegressionCompetitionScore: 0.14355828220858896



Validation scores:
	RegressionAUROC: 0.5542048215866089
	RegressionCompetitionScore: 0.1450920245398773



Validation scores:
	RegressionAUROC: 0.555098295211792
	RegressionCompetitionScore: 0.14631901840490796



Validation scores:
	RegressionAUROC: 0.5585103034973145
	RegressionCompetitionScore: 0.147239263803681



Validation scores:
	RegressionAUROC: 0.5587298274040222
	RegressionCompetitionScore: 0.15184049079754602

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.219. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.13374233128834356
     Test RegressionAUROC            0.5398367643356323
Test RegressionCompetitionScore      0.13374233128834356
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 22:35:49,417][0m Trial 461 finished with value: 0.13374233128834356 and parameters: {'lr': 2.3678063195217225e-06, 'dropout': 0.46569345053367434, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 134, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 8.643140247245966e-06, 'dropout': 0.6543880759420505, 'd_model_multiplier': 8, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 773, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 4.2 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
4.2 M     Trainable params
0         Non-trainable params
4.2 M     Total params
16.870    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.24637679755687714
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.4059599041938782
	RegressionCompetitionScore: 0.05828220858895705

Metric val_loss improved. New best score: 0.282


Validation scores:
	RegressionAUROC: 0.49392950534820557
	RegressionCompetitionScore: 0.08006134969325153

Metric val_loss improved by 0.043 >= min_delta = 0.0. New best score: 0.239


Validation scores:
	RegressionAUROC: 0.5453557968139648
	RegressionCompetitionScore: 0.09631901840490797

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5862579941749573
	RegressionCompetitionScore: 0.11625766871165644

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.5845515131950378
	RegressionCompetitionScore: 0.08650306748466258



Validation scores:
	RegressionAUROC: 0.6282202005386353
	RegressionCompetitionScore: 0.14969325153374233

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6386282444000244
	RegressionCompetitionScore: 0.16257668711656442

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6290753483772278
	RegressionCompetitionScore: 0.11380368098159509



Validation scores:
	RegressionAUROC: 0.616703987121582
	RegressionCompetitionScore: 0.09386503067484663



Validation scores:
	RegressionAUROC: 0.6642903089523315
	RegressionCompetitionScore: 0.27883435582822086



Validation scores:
	RegressionAUROC: 0.6673585176467896
	RegressionCompetitionScore: 0.2684049079754601



Validation scores:
	RegressionAUROC: 0.672545313835144
	RegressionCompetitionScore: 0.29662576687116565

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6752862930297852
	RegressionCompetitionScore: 0.2837423312883436



Validation scores:
	RegressionAUROC: 0.6775269508361816
	RegressionCompetitionScore: 0.25736196319018406



Validation scores:
	RegressionAUROC: 0.6758916974067688
	RegressionCompetitionScore: 0.2282208588957055



Validation scores:
	RegressionAUROC: 0.6808790564537048
	RegressionCompetitionScore: 0.23466257668711657



Validation scores:
	RegressionAUROC: 0.682876706123352
	RegressionCompetitionScore: 0.24171779141104294



Validation scores:
	RegressionAUROC: 0.6834907531738281
	RegressionCompetitionScore: 0.23466257668711657



Validation scores:
	RegressionAUROC: 0.6915186047554016
	RegressionCompetitionScore: 0.2871165644171779

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.195. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.29662576687116565
     Test RegressionAUROC             0.672545313835144
Test RegressionCompetitionScore      0.29662576687116565
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 22:47:09,713][0m Trial 462 finished with value: 0.29662576687116565 and parameters: {'lr': 8.643140247245966e-06, 'dropout': 0.6543880759420505, 'd_model_multiplier': 8, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 773, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00030906808117203417, 'dropout': 0.41733947337858723, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 188, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 145 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
145 K     Trainable params
0         Non-trainable params
145 K     Total params
0.581     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.30917873978614807
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6730961799621582
	RegressionCompetitionScore: 0.12914110429447853

Metric val_loss improved. New best score: 0.224


Validation scores:
	RegressionAUROC: 0.6843430995941162
	RegressionCompetitionScore: 0.2696319018404908

Metric val_loss improved by 0.026 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.7066053748130798
	RegressionCompetitionScore: 0.2898773006134969



Validation scores:
	RegressionAUROC: 0.7146848440170288
	RegressionCompetitionScore: 0.3147239263803681



Validation scores:
	RegressionAUROC: 0.7348031997680664
	RegressionCompetitionScore: 0.3693251533742331

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7487775087356567
	RegressionCompetitionScore: 0.4085889570552147

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7522658109664917
	RegressionCompetitionScore: 0.39815950920245397



Validation scores:
	RegressionAUROC: 0.7474260330200195
	RegressionCompetitionScore: 0.39723926380368096



Validation scores:
	RegressionAUROC: 0.7482407689094543
	RegressionCompetitionScore: 0.4223926380368098

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7594825029373169
	RegressionCompetitionScore: 0.4180981595092024

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7508683204650879
	RegressionCompetitionScore: 0.41840490797546015

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7694665789604187
	RegressionCompetitionScore: 0.42484662576687116



Validation scores:
	RegressionAUROC: 0.7605699300765991
	RegressionCompetitionScore: 0.402760736196319



Validation scores:
	RegressionAUROC: 0.761397123336792
	RegressionCompetitionScore: 0.42760736196319016



Validation scores:
	RegressionAUROC: 0.7672327160835266
	RegressionCompetitionScore: 0.41134969325153375

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7638064622879028
	RegressionCompetitionScore: 0.4530674846625767



Validation scores:
	RegressionAUROC: 0.7686764001846313
	RegressionCompetitionScore: 0.4377300613496933



Validation scores:
	RegressionAUROC: 0.7559435367584229
	RegressionCompetitionScore: 0.4285276073619632



Validation scores:
	RegressionAUROC: 0.7606103420257568
	RegressionCompetitionScore: 0.4171779141104294



Validation scores:
	RegressionAUROC: 0.7537021636962891
	RegressionCompetitionScore: 0.38404907975460123



Validation scores:
	RegressionAUROC: 0.7557835578918457
	RegressionCompetitionScore: 0.42300613496932515



Validation scores:
	RegressionAUROC: 0.7554153203964233
	RegressionCompetitionScore: 0.4174846625766871

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.168. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.41134969325153375
     Test RegressionAUROC            0.7672327160835266
Test RegressionCompetitionScore      0.41134969325153375
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 22:58:30,847][0m Trial 463 finished with value: 0.41134969325153375 and parameters: {'lr': 0.00030906808117203417, 'dropout': 0.41733947337858723, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 188, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 2.602743961427239e-05, 'dropout': 0.552257829265684, 'd_model_multiplier': 16, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 157, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 7.8 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
7.8 M     Trainable params
0         Non-trainable params
7.8 M     Total params
31.086    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.35748791694641113
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.67624431848526
	RegressionCompetitionScore: 0.25214723926380367

Metric val_loss improved. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6844469904899597
	RegressionCompetitionScore: 0.254601226993865



Validation scores:
	RegressionAUROC: 0.7056279182434082
	RegressionCompetitionScore: 0.2116564417177914

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7046913504600525
	RegressionCompetitionScore: 0.20245398773006135



Validation scores:
	RegressionAUROC: 0.7137007117271423
	RegressionCompetitionScore: 0.2322085889570552



Validation scores:
	RegressionAUROC: 0.7022806406021118
	RegressionCompetitionScore: 0.18435582822085889



Validation scores:
	RegressionAUROC: 0.7007172107696533
	RegressionCompetitionScore: 0.20828220858895705



Validation scores:
	RegressionAUROC: 0.724972128868103
	RegressionCompetitionScore: 0.3346625766871166

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7302038073539734
	RegressionCompetitionScore: 0.35644171779141104



Validation scores:
	RegressionAUROC: 0.725266695022583
	RegressionCompetitionScore: 0.3374233128834356



Validation scores:
	RegressionAUROC: 0.6985636949539185
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7273504734039307
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7295148372650146
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7321311235427856
	RegressionCompetitionScore: 0.3337423312883436



Validation scores:
	RegressionAUROC: 0.7246671319007874
	RegressionCompetitionScore: 0.3423312883435583

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3346625766871166
     Test RegressionAUROC             0.724972128868103
Test RegressionCompetitionScore      0.3346625766871166
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 23:08:06,392][0m Trial 464 finished with value: 0.3346625766871166 and parameters: {'lr': 2.602743961427239e-05, 'dropout': 0.552257829265684, 'd_model_multiplier': 16, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 157, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0008059499040155535, 'dropout': 0.8917675199917625, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 113, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 127 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
127 K     Trainable params
0         Non-trainable params
127 K     Total params
0.511     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5603864192962646
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5135833024978638
	RegressionCompetitionScore: 0.12484662576687117

Metric val_loss improved. New best score: 0.231


Validation scores:
	RegressionAUROC: 0.5095474720001221
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.37562015652656555
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4346418082714081
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49969324469566345
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.231. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.12484662576687117
     Test RegressionAUROC            0.5135833024978638
Test RegressionCompetitionScore      0.12484662576687117
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 23:12:45,516][0m Trial 465 finished with value: 0.12484662576687117 and parameters: {'lr': 0.0008059499040155535, 'dropout': 0.8917675199917625, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 113, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.013487874423303481, 'dropout': 0.40080569815691824, 'd_model_multiplier': 2, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 130, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 277 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
277 K     Trainable params
0         Non-trainable params
277 K     Total params
1.110     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 6.398


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 5.325 >= min_delta = 0.0. New best score: 1.073


Validation scores:
	RegressionAUROC: 0.4944288730621338
	RegressionCompetitionScore: 0.03987730061349693

Metric val_loss improved by 0.859 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5096542835235596
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.48824062943458557
	RegressionCompetitionScore: 0.04631901840490798



Validation scores:
	RegressionAUROC: 0.5131394863128662
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.214. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.03987730061349693
     Test RegressionAUROC            0.4944288730621338
Test RegressionCompetitionScore      0.03987730061349693
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 23:19:01,229][0m Trial 466 finished with value: 0.03987730061349693 and parameters: {'lr': 0.013487874423303481, 'dropout': 0.40080569815691824, 'd_model_multiplier': 2, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 130, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00023729938996324245, 'dropout': 0.5637011889889385, 'd_model_multiplier': 64, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 172, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 124 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
124 M     Trainable params
0         Non-trainable params
124 M     Total params
497.603   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5193237066268921
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 372.346


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 364.642 >= min_delta = 0.0. New best score: 7.703


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 5.972 >= min_delta = 0.0. New best score: 1.731


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 1.235 >= min_delta = 0.0. New best score: 0.496


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.496. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-06 23:58:51,041][0m Trial 467 finished with value: 0.0 and parameters: {'lr': 0.00023729938996324245, 'dropout': 0.5637011889889385, 'd_model_multiplier': 64, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 172, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 8.119062324060649e-05, 'dropout': 0.7076688386474721, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 148, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 129 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
129 K     Trainable params
0         Non-trainable params
129 K     Total params
0.519     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6521738767623901
	RegressionCompetitionScore: 0.43478260869565216



Validation scores:
	RegressionAUROC: 0.5384106040000916
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.418


Validation scores:
	RegressionAUROC: 0.5688103437423706
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.082 >= min_delta = 0.0. New best score: 0.336


Validation scores:
	RegressionAUROC: 0.5990029573440552
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.060 >= min_delta = 0.0. New best score: 0.275


Validation scores:
	RegressionAUROC: 0.6122565865516663
	RegressionCompetitionScore: 0.2598159509202454

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.6341241598129272
	RegressionCompetitionScore: 0.27361963190184047

Metric val_loss improved by 0.048 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6260882616043091
	RegressionCompetitionScore: 0.26411042944785273



Validation scores:
	RegressionAUROC: 0.6406035423278809
	RegressionCompetitionScore: 0.2766871165644172

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6616018414497375
	RegressionCompetitionScore: 0.249079754601227

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6828727722167969
	RegressionCompetitionScore: 0.22085889570552147

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6823469400405884
	RegressionCompetitionScore: 0.22699386503067484



Validation scores:
	RegressionAUROC: 0.681128978729248
	RegressionCompetitionScore: 0.21871165644171778

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.673105001449585
	RegressionCompetitionScore: 0.23466257668711657



Validation scores:
	RegressionAUROC: 0.6639506816864014
	RegressionCompetitionScore: 0.2634969325153374



Validation scores:
	RegressionAUROC: 0.6741001605987549
	RegressionCompetitionScore: 0.2634969325153374



Validation scores:
	RegressionAUROC: 0.6949350833892822
	RegressionCompetitionScore: 0.2263803680981595

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.702703595161438
	RegressionCompetitionScore: 0.2303680981595092



Validation scores:
	RegressionAUROC: 0.6981515288352966
	RegressionCompetitionScore: 0.24355828220858897



Validation scores:
	RegressionAUROC: 0.6982840299606323
	RegressionCompetitionScore: 0.24846625766871167



Validation scores:
	RegressionAUROC: 0.7035884857177734
	RegressionCompetitionScore: 0.254601226993865



Validation scores:
	RegressionAUROC: 0.6867419481277466
	RegressionCompetitionScore: 0.254601226993865



Validation scores:
	RegressionAUROC: 0.7000834345817566
	RegressionCompetitionScore: 0.2625766871165644



Validation scores:
	RegressionAUROC: 0.6991881132125854
	RegressionCompetitionScore: 0.27208588957055213

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.187. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2263803680981595
     Test RegressionAUROC            0.6949350833892822
Test RegressionCompetitionScore      0.2263803680981595
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 00:11:10,538][0m Trial 468 finished with value: 0.2263803680981595 and parameters: {'lr': 8.119062324060649e-05, 'dropout': 0.7076688386474721, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 148, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004446224262482887, 'dropout': 0.4334585931491157, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 106, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 258 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
258 K     Trainable params
0         Non-trainable params
258 K     Total params
1.035     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.656303882598877
	RegressionCompetitionScore: 0.2625766871165644

Metric val_loss improved. New best score: 0.234


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7224830389022827
	RegressionCompetitionScore: 0.3095092024539877

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.7311239242553711
	RegressionCompetitionScore: 0.3319018404907976



Validation scores:
	RegressionAUROC: 0.7485791444778442
	RegressionCompetitionScore: 0.37331288343558283

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.754208505153656
	RegressionCompetitionScore: 0.42116564417177915

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7486766576766968
	RegressionCompetitionScore: 0.3638036809815951



Validation scores:
	RegressionAUROC: 0.7456130981445312
	RegressionCompetitionScore: 0.40429447852760736



Validation scores:
	RegressionAUROC: 0.7399023175239563
	RegressionCompetitionScore: 0.3901840490797546



Validation scores:
	RegressionAUROC: 0.6622516512870789
	RegressionCompetitionScore: 0.3895705521472393



Validation scores:
	RegressionAUROC: 0.7358007431030273
	RegressionCompetitionScore: 0.38006134969325156



Validation scores:
	RegressionAUROC: 0.7523156404495239
	RegressionCompetitionScore: 0.3806748466257669



Validation scores:
	RegressionAUROC: 0.7377567887306213
	RegressionCompetitionScore: 0.37607361963190183

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.180. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.42116564417177915
     Test RegressionAUROC             0.754208505153656
Test RegressionCompetitionScore      0.42116564417177915
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 00:21:31,605][0m Trial 469 finished with value: 0.42116564417177915 and parameters: {'lr': 0.0004446224262482887, 'dropout': 0.4334585931491157, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 106, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0006172320110671216, 'dropout': 0.46917059384873144, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 32, 'dim_feedforward': 636, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 274 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
274 K     Trainable params
0         Non-trainable params
274 K     Total params
1.097     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.28502413630485535
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5775141716003418
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.353


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6750246286392212
	RegressionCompetitionScore: 0.253680981595092

Metric val_loss improved by 0.117 >= min_delta = 0.0. New best score: 0.236


Validation scores:
	RegressionAUROC: 0.6767457127571106
	RegressionCompetitionScore: 0.27883435582822086



Validation scores:
	RegressionAUROC: 0.7002052068710327
	RegressionCompetitionScore: 0.293558282208589

Metric val_loss improved by 0.053 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7178108096122742
	RegressionCompetitionScore: 0.37055214723926383



Validation scores:
	RegressionAUROC: 0.7273640632629395
	RegressionCompetitionScore: 0.36319018404907977



Validation scores:
	RegressionAUROC: 0.7273198366165161
	RegressionCompetitionScore: 0.35337423312883437



Validation scores:
	RegressionAUROC: 0.7080341577529907
	RegressionCompetitionScore: 0.35429447852760737



Validation scores:
	RegressionAUROC: 0.7019394636154175
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7153923511505127
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7302118539810181
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.182. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore            0.293558282208589
     Test RegressionAUROC            0.7002052068710327
Test RegressionCompetitionScore       0.293558282208589
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 00:27:56,218][0m Trial 470 finished with value: 0.293558282208589 and parameters: {'lr': 0.0006172320110671216, 'dropout': 0.46917059384873144, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 32, 'dim_feedforward': 636, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0008880336163799994, 'dropout': 0.6109408847274119, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 4, 'dim_feedforward': 318, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 37.7 K
1 | loss_fn | MSELoss | 0     
------------------------------------
37.7 K    Trainable params
0         Non-trainable params
37.7 K    Total params
0.151     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.39855071902275085
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6478626728057861
	RegressionCompetitionScore: 0.10920245398773006

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5504962205886841
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.39247968792915344
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4349673390388489
	RegressionCompetitionScore: 0.08895705521472393



Validation scores:
	RegressionAUROC: 0.44499659538269043
	RegressionCompetitionScore: 0.10828220858895705



Validation scores:
	RegressionAUROC: 0.5182644724845886
	RegressionCompetitionScore: 0.11319018404907975

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5478583574295044
	RegressionCompetitionScore: 0.12914110429447853



Validation scores:
	RegressionAUROC: 0.5094386339187622
	RegressionCompetitionScore: 0.041104294478527606

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.5022699236869812
	RegressionCompetitionScore: 0.08159509202453988



Validation scores:
	RegressionAUROC: 0.41954728960990906
	RegressionCompetitionScore: 0.03374233128834356



Validation scores:
	RegressionAUROC: 0.4317489266395569
	RegressionCompetitionScore: 0.05214723926380368



Validation scores:
	RegressionAUROC: 0.526357889175415
	RegressionCompetitionScore: 0.07791411042944785



Validation scores:
	RegressionAUROC: 0.5363990664482117
	RegressionCompetitionScore: 0.10306748466257669



Validation scores:
	RegressionAUROC: 0.5191173553466797
	RegressionCompetitionScore: 0.10460122699386504



Validation scores:
	RegressionAUROC: 0.48809272050857544
	RegressionCompetitionScore: 0.10736196319018405

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.207. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore          0.041104294478527606
     Test RegressionAUROC            0.5094386339187622
Test RegressionCompetitionScore     0.041104294478527606
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 00:34:59,582][0m Trial 471 finished with value: 0.041104294478527606 and parameters: {'lr': 0.0008880336163799994, 'dropout': 0.6109408847274119, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 4, 'dim_feedforward': 318, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 3.560651725816112e-05, 'dropout': 0.41267210494013307, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 195, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 147 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
147 K     Trainable params
0         Non-trainable params
147 K     Total params
0.592     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4251207411289215
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6106201410293579
	RegressionCompetitionScore: 0.1588957055214724

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6591668725013733
	RegressionCompetitionScore: 0.23190184049079754



Validation scores:
	RegressionAUROC: 0.6649584770202637
	RegressionCompetitionScore: 0.22484662576687117

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6859315037727356
	RegressionCompetitionScore: 0.25736196319018406

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6990485787391663
	RegressionCompetitionScore: 0.27607361963190186



Validation scores:
	RegressionAUROC: 0.7044385671615601
	RegressionCompetitionScore: 0.2607361963190184



Validation scores:
	RegressionAUROC: 0.7346236705780029
	RegressionCompetitionScore: 0.35337423312883437

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7291017770767212
	RegressionCompetitionScore: 0.33404907975460124



Validation scores:
	RegressionAUROC: 0.7384743690490723
	RegressionCompetitionScore: 0.33865030674846625



Validation scores:
	RegressionAUROC: 0.7449882626533508
	RegressionCompetitionScore: 0.37515337423312883



Validation scores:
	RegressionAUROC: 0.7426539659500122
	RegressionCompetitionScore: 0.350920245398773

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7484489679336548
	RegressionCompetitionScore: 0.38098159509202456

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7406315803527832
	RegressionCompetitionScore: 0.35828220858895704



Validation scores:
	RegressionAUROC: 0.7404147386550903
	RegressionCompetitionScore: 0.36012269938650304



Validation scores:
	RegressionAUROC: 0.7407693862915039
	RegressionCompetitionScore: 0.33159509202453985



Validation scores:
	RegressionAUROC: 0.7421420216560364
	RegressionCompetitionScore: 0.3469325153374233



Validation scores:
	RegressionAUROC: 0.745796799659729
	RegressionCompetitionScore: 0.34754601226993864



Validation scores:
	RegressionAUROC: 0.7404896020889282
	RegressionCompetitionScore: 0.3328220858895706



Validation scores:
	RegressionAUROC: 0.7425287961959839
	RegressionCompetitionScore: 0.3294478527607362

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.180. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38098159509202456
     Test RegressionAUROC            0.7484489679336548
Test RegressionCompetitionScore      0.38098159509202456
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 00:44:43,725][0m Trial 472 finished with value: 0.38098159509202456 and parameters: {'lr': 3.560651725816112e-05, 'dropout': 0.41267210494013307, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 195, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0003681406066042789, 'dropout': 0.49508255755558384, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 32, 'dim_feedforward': 287, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 160 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
160 K     Trainable params
0         Non-trainable params
160 K     Total params
0.643     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7536232471466064
	RegressionCompetitionScore: 0.43478260869565216



Validation scores:
	RegressionAUROC: 0.6158888339996338
	RegressionCompetitionScore: 0.2794478527607362

Metric val_loss improved. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.6574820280075073
	RegressionCompetitionScore: 0.24877300613496933



Validation scores:
	RegressionAUROC: 0.705973207950592
	RegressionCompetitionScore: 0.30920245398773005



Validation scores:
	RegressionAUROC: 0.709267258644104
	RegressionCompetitionScore: 0.3006134969325153

Metric val_loss improved by 0.039 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7352746725082397
	RegressionCompetitionScore: 0.36687116564417177



Validation scores:
	RegressionAUROC: 0.73748779296875
	RegressionCompetitionScore: 0.3708588957055215



Validation scores:
	RegressionAUROC: 0.7469398975372314
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7399808168411255
	RegressionCompetitionScore: 0.36625766871165644



Validation scores:
	RegressionAUROC: 0.7360590696334839
	RegressionCompetitionScore: 0.36779141104294477

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7530572414398193
	RegressionCompetitionScore: 0.37576687116564417



Validation scores:
	RegressionAUROC: 0.7496461272239685
	RegressionCompetitionScore: 0.38128834355828223

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7459419965744019
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7527053952217102
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7644325494766235
	RegressionCompetitionScore: 0.37699386503067484



Validation scores:
	RegressionAUROC: 0.7746196985244751
	RegressionCompetitionScore: 0.38496932515337423



Validation scores:
	RegressionAUROC: 0.768887996673584
	RegressionCompetitionScore: 0.39969325153374236



Validation scores:
	RegressionAUROC: 0.7728737592697144
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.772162914276123
	RegressionCompetitionScore: 0.39263803680981596

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.176. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38128834355828223
     Test RegressionAUROC            0.7496461272239685
Test RegressionCompetitionScore      0.38128834355828223
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 00:53:29,132][0m Trial 473 finished with value: 0.38128834355828223 and parameters: {'lr': 0.0003681406066042789, 'dropout': 0.49508255755558384, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 32, 'dim_feedforward': 287, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0002867607060016629, 'dropout': 0.5855617720430519, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 611, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 354 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
354 K     Trainable params
0         Non-trainable params
354 K     Total params
1.417     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4444444179534912
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.48559853434562683
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.379


Validation scores:
	RegressionAUROC: 0.4868983030319214
	RegressionCompetitionScore: 0.08558282208588958

Metric val_loss improved by 0.160 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5176330208778381
	RegressionCompetitionScore: 0.09478527607361963

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.433475136756897
	RegressionCompetitionScore: 0.1058282208588957

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.577489972114563
	RegressionCompetitionScore: 0.10613496932515337



Validation scores:
	RegressionAUROC: 0.6120655536651611
	RegressionCompetitionScore: 0.10429447852760736



Validation scores:
	RegressionAUROC: 0.6425399780273438
	RegressionCompetitionScore: 0.249079754601227



Validation scores:
	RegressionAUROC: 0.6352994441986084
	RegressionCompetitionScore: 0.27208588957055213



Validation scores:
	RegressionAUROC: 0.6254433989524841
	RegressionCompetitionScore: 0.2085889570552147



Validation scores:
	RegressionAUROC: 0.629050612449646
	RegressionCompetitionScore: 0.14202453987730063



Validation scores:
	RegressionAUROC: 0.6265386939048767
	RegressionCompetitionScore: 0.21042944785276074

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.210. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1058282208588957
     Test RegressionAUROC             0.433475136756897
Test RegressionCompetitionScore      0.1058282208588957
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 00:59:49,143][0m Trial 474 finished with value: 0.1058282208588957 and parameters: {'lr': 0.0002867607060016629, 'dropout': 0.5855617720430519, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 611, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005366293595232082, 'dropout': 0.5727148975325459, 'd_model_multiplier': 1, 'num_layers': 8, 'n_heads': 8, 'dim_feedforward': 123, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 42.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
42.9 K    Trainable params
0         Non-trainable params
42.9 K    Total params
0.172     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.44059333205223083
	RegressionCompetitionScore: 0.10398773006134969

Metric val_loss improved. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.6592133045196533
	RegressionCompetitionScore: 0.29570552147239265

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6887797117233276
	RegressionCompetitionScore: 0.2809815950920245

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6059302091598511
	RegressionCompetitionScore: 0.15429447852760736



Validation scores:
	RegressionAUROC: 0.4304518699645996
	RegressionCompetitionScore: 0.1196319018404908



Validation scores:
	RegressionAUROC: 0.6876364946365356
	RegressionCompetitionScore: 0.10858895705521472



Validation scores:
	RegressionAUROC: 0.6746189594268799
	RegressionCompetitionScore: 0.11932515337423313



Validation scores:
	RegressionAUROC: 0.6986973285675049
	RegressionCompetitionScore: 0.23251533742331287



Validation scores:
	RegressionAUROC: 0.7087748050689697
	RegressionCompetitionScore: 0.3285276073619632

Metric val_loss improved by 0.018 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7264398336410522
	RegressionCompetitionScore: 0.299079754601227



Validation scores:
	RegressionAUROC: 0.7180765867233276
	RegressionCompetitionScore: 0.34355828220858897

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.735254168510437
	RegressionCompetitionScore: 0.32423312883435584

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7277311086654663
	RegressionCompetitionScore: 0.2843558282208589



Validation scores:
	RegressionAUROC: 0.7309799790382385
	RegressionCompetitionScore: 0.29325153374233126



Validation scores:
	RegressionAUROC: 0.7262765169143677
	RegressionCompetitionScore: 0.3236196319018405



Validation scores:
	RegressionAUROC: 0.7348523736000061
	RegressionCompetitionScore: 0.3205521472392638

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7289080023765564
	RegressionCompetitionScore: 0.3128834355828221



Validation scores:
	RegressionAUROC: 0.7279601097106934
	RegressionCompetitionScore: 0.3401840490797546



Validation scores:
	RegressionAUROC: 0.7459809184074402
	RegressionCompetitionScore: 0.3334355828220859



Validation scores:
	RegressionAUROC: 0.7429049015045166
	RegressionCompetitionScore: 0.3337423312883436



Validation scores:
	RegressionAUROC: 0.7470548152923584
	RegressionCompetitionScore: 0.3585889570552147

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7312090992927551
	RegressionCompetitionScore: 0.37055214723926383



Validation scores:
	RegressionAUROC: 0.7186884880065918
	RegressionCompetitionScore: 0.29325153374233126



Validation scores:
	RegressionAUROC: 0.7432911396026611
	RegressionCompetitionScore: 0.36134969325153377

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7383888363838196
	RegressionCompetitionScore: 0.3496932515337423



Validation scores:
	RegressionAUROC: 0.7409224510192871
	RegressionCompetitionScore: 0.3138036809815951



Validation scores:
	RegressionAUROC: 0.7417004704475403
	RegressionCompetitionScore: 0.347239263803681



Validation scores:
	RegressionAUROC: 0.741524338722229
	RegressionCompetitionScore: 0.346319018404908



Validation scores:
	RegressionAUROC: 0.732247531414032
	RegressionCompetitionScore: 0.2800613496932515



Validation scores:
	RegressionAUROC: 0.7382737994194031
	RegressionCompetitionScore: 0.37024539877300616



Validation scores:
	RegressionAUROC: 0.7218697667121887
	RegressionCompetitionScore: 0.2846625766871166

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.171. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.36134969325153377
     Test RegressionAUROC            0.7432911396026611
Test RegressionCompetitionScore      0.36134969325153377
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 01:12:24,692][0m Trial 475 finished with value: 0.36134969325153377 and parameters: {'lr': 0.0005366293595232082, 'dropout': 0.5727148975325459, 'd_model_multiplier': 1, 'num_layers': 8, 'n_heads': 8, 'dim_feedforward': 123, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 5.762952739376619e-05, 'dropout': 0.4821482677710443, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 162, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 39.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
39.0 K    Trainable params
0         Non-trainable params
39.0 K    Total params
0.156     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5137816071510315
	RegressionCompetitionScore: 0.09631901840490797

Metric val_loss improved. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.5962560176849365
	RegressionCompetitionScore: 0.18588957055214725

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.6333133578300476
	RegressionCompetitionScore: 0.10030674846625767



Validation scores:
	RegressionAUROC: 0.6776536107063293
	RegressionCompetitionScore: 0.2634969325153374

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6926987767219543
	RegressionCompetitionScore: 0.2656441717791411

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.70980304479599
	RegressionCompetitionScore: 0.2684049079754601

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.729561448097229
	RegressionCompetitionScore: 0.36687116564417177

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7350142598152161
	RegressionCompetitionScore: 0.36441717791411044



Validation scores:
	RegressionAUROC: 0.7437084913253784
	RegressionCompetitionScore: 0.3512269938650307



Validation scores:
	RegressionAUROC: 0.7619890570640564
	RegressionCompetitionScore: 0.35736196319018404



Validation scores:
	RegressionAUROC: 0.7495105266571045
	RegressionCompetitionScore: 0.3380368098159509

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7442086935043335
	RegressionCompetitionScore: 0.33773006134969324



Validation scores:
	RegressionAUROC: 0.7328041791915894
	RegressionCompetitionScore: 0.3334355828220859



Validation scores:
	RegressionAUROC: 0.739532470703125
	RegressionCompetitionScore: 0.3174846625766871



Validation scores:
	RegressionAUROC: 0.7623063325881958
	RegressionCompetitionScore: 0.3539877300613497

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.761506199836731
	RegressionCompetitionScore: 0.3401840490797546



Validation scores:
	RegressionAUROC: 0.7521544694900513
	RegressionCompetitionScore: 0.34355828220858897



Validation scores:
	RegressionAUROC: 0.7627196311950684
	RegressionCompetitionScore: 0.3343558282208589



Validation scores:
	RegressionAUROC: 0.7680718898773193
	RegressionCompetitionScore: 0.345398773006135



Validation scores:
	RegressionAUROC: 0.7689992189407349
	RegressionCompetitionScore: 0.34662576687116564



Validation scores:
	RegressionAUROC: 0.7625035643577576
	RegressionCompetitionScore: 0.3214723926380368



Validation scores:
	RegressionAUROC: 0.7601248025894165
	RegressionCompetitionScore: 0.36871165644171777

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.164. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3539877300613497
     Test RegressionAUROC            0.7623063325881958
Test RegressionCompetitionScore      0.3539877300613497
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 01:21:33,920][0m Trial 476 finished with value: 0.3539877300613497 and parameters: {'lr': 5.762952739376619e-05, 'dropout': 0.4821482677710443, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 162, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0010602706023900002, 'dropout': 0.4648052894409197, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 142, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 40.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
40.0 K    Trainable params
0         Non-trainable params
40.0 K    Total params
0.160     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.30917873978614807
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6626660823822021
	RegressionCompetitionScore: 0.10705521472392639

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6057513356208801
	RegressionCompetitionScore: 0.13987730061349693

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.4263160526752472
	RegressionCompetitionScore: 0.013803680981595092



Validation scores:
	RegressionAUROC: 0.5875582695007324
	RegressionCompetitionScore: 0.06533742331288343



Validation scores:
	RegressionAUROC: 0.5496506094932556
	RegressionCompetitionScore: 0.06932515337423313



Validation scores:
	RegressionAUROC: 0.6611952185630798
	RegressionCompetitionScore: 0.2588957055214724



Validation scores:
	RegressionAUROC: 0.631331205368042
	RegressionCompetitionScore: 0.1549079754601227

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6588479280471802
	RegressionCompetitionScore: 0.24233128834355827



Validation scores:
	RegressionAUROC: 0.6899234056472778
	RegressionCompetitionScore: 0.25030674846625767



Validation scores:
	RegressionAUROC: 0.6516009569168091
	RegressionCompetitionScore: 0.19263803680981595

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6807278394699097
	RegressionCompetitionScore: 0.2558282208588957

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.6576864123344421
	RegressionCompetitionScore: 0.19846625766871165



Validation scores:
	RegressionAUROC: 0.679069995880127
	RegressionCompetitionScore: 0.2809815950920245



Validation scores:
	RegressionAUROC: 0.6638064384460449
	RegressionCompetitionScore: 0.26533742331288346



Validation scores:
	RegressionAUROC: 0.6547136902809143
	RegressionCompetitionScore: 0.21993865030674847



Validation scores:
	RegressionAUROC: 0.6593654155731201
	RegressionCompetitionScore: 0.21012269938650308



Validation scores:
	RegressionAUROC: 0.6229254007339478
	RegressionCompetitionScore: 0.07024539877300613



Validation scores:
	RegressionAUROC: 0.6529273986816406
	RegressionCompetitionScore: 0.08680981595092024

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.187. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2558282208588957
     Test RegressionAUROC            0.6807278394699097
Test RegressionCompetitionScore      0.2558282208588957
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 01:29:00,962][0m Trial 477 finished with value: 0.2558282208588957 and parameters: {'lr': 0.0010602706023900002, 'dropout': 0.4648052894409197, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 142, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0006670310834367618, 'dropout': 0.5471575163035952, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 178, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 77.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
77.6 K    Trainable params
0         Non-trainable params
77.6 K    Total params
0.310     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5893719792366028
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.4172792136669159
	RegressionCompetitionScore: 0.11748466257668712

Metric val_loss improved. New best score: 0.340


Validation scores:
	RegressionAUROC: 0.5708842277526855
	RegressionCompetitionScore: 0.1049079754601227

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.327


Validation scores:
	RegressionAUROC: 0.5088682174682617
	RegressionCompetitionScore: 0.10950920245398774



Validation scores:
	RegressionAUROC: 0.5296179056167603
	RegressionCompetitionScore: 0.11104294478527607

Metric val_loss improved by 0.109 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.5083948373794556
	RegressionCompetitionScore: 0.10736196319018405



Validation scores:
	RegressionAUROC: 0.5423440933227539
	RegressionCompetitionScore: 0.12177914110429448



Validation scores:
	RegressionAUROC: 0.5142327547073364
	RegressionCompetitionScore: 0.12515337423312883



Validation scores:
	RegressionAUROC: 0.6294002532958984
	RegressionCompetitionScore: 0.17822085889570552

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6857548356056213
	RegressionCompetitionScore: 0.25245398773006134

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6222026944160461
	RegressionCompetitionScore: 0.26380368098159507



Validation scores:
	RegressionAUROC: 0.6657429933547974
	RegressionCompetitionScore: 0.2588957055214724



Validation scores:
	RegressionAUROC: 0.6440828442573547
	RegressionCompetitionScore: 0.20705521472392638



Validation scores:
	RegressionAUROC: 0.6357663869857788
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6090315580368042
	RegressionCompetitionScore: 0.21288343558282208



Validation scores:
	RegressionAUROC: 0.6983743906021118
	RegressionCompetitionScore: 0.293558282208589

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7150806188583374
	RegressionCompetitionScore: 0.31196319018404906

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7244974970817566
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.577775239944458
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7052788734436035
	RegressionCompetitionScore: 0.23159509202453987



Validation scores:
	RegressionAUROC: 0.7179571390151978
	RegressionCompetitionScore: 0.3230061349693252



Validation scores:
	RegressionAUROC: 0.6603364944458008
	RegressionCompetitionScore: 0.14079754601226993



Validation scores:
	RegressionAUROC: 0.6734781861305237
	RegressionCompetitionScore: 0.1950920245398773



Validation scores:
	RegressionAUROC: 0.6957145929336548
	RegressionCompetitionScore: 0.2644171779141104

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.186. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.31196319018404906
     Test RegressionAUROC            0.7150806188583374
Test RegressionCompetitionScore      0.31196319018404906
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 01:38:20,859][0m Trial 478 finished with value: 0.31196319018404906 and parameters: {'lr': 0.0006670310834367618, 'dropout': 0.5471575163035952, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 178, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 6.154748568029135e-06, 'dropout': 0.5327457778337008, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 102, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 33.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
33.9 K    Trainable params
0         Non-trainable params
33.9 K    Total params
0.136     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4557989537715912
	RegressionCompetitionScore: 0.06503067484662577

Metric val_loss improved. New best score: 0.442


Validation scores:
	RegressionAUROC: 0.46900975704193115
	RegressionCompetitionScore: 0.07085889570552147

Metric val_loss improved by 0.172 >= min_delta = 0.0. New best score: 0.270


Validation scores:
	RegressionAUROC: 0.47864145040512085
	RegressionCompetitionScore: 0.07484662576687116

Metric val_loss improved by 0.056 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.48126089572906494
	RegressionCompetitionScore: 0.07638036809815951



Validation scores:
	RegressionAUROC: 0.49715492129325867
	RegressionCompetitionScore: 0.08251533742331288

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5134881734848022
	RegressionCompetitionScore: 0.09325153374233129

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5273842811584473
	RegressionCompetitionScore: 0.10398773006134969

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5419602394104004
	RegressionCompetitionScore: 0.11042944785276074



Validation scores:
	RegressionAUROC: 0.5528680086135864
	RegressionCompetitionScore: 0.12177914110429448



Validation scores:
	RegressionAUROC: 0.5638055801391602
	RegressionCompetitionScore: 0.1352760736196319



Validation scores:
	RegressionAUROC: 0.5725558400154114
	RegressionCompetitionScore: 0.14877300613496933

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.5789083242416382
	RegressionCompetitionScore: 0.15061349693251533

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.5878152847290039
	RegressionCompetitionScore: 0.16012269938650306

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.592833399772644
	RegressionCompetitionScore: 0.16748466257668712



Validation scores:
	RegressionAUROC: 0.5980939269065857
	RegressionCompetitionScore: 0.16932515337423312



Validation scores:
	RegressionAUROC: 0.5999978184700012
	RegressionCompetitionScore: 0.1607361963190184



Validation scores:
	RegressionAUROC: 0.602846086025238
	RegressionCompetitionScore: 0.16503067484662576



Validation scores:
	RegressionAUROC: 0.6072499752044678
	RegressionCompetitionScore: 0.18006134969325152



Validation scores:
	RegressionAUROC: 0.609143853187561
	RegressionCompetitionScore: 0.18036809815950922



Validation scores:
	RegressionAUROC: 0.6105712652206421
	RegressionCompetitionScore: 0.17883435582822085

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.204. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.16012269938650306
     Test RegressionAUROC            0.5878152847290039
Test RegressionCompetitionScore      0.16012269938650306
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 01:46:31,684][0m Trial 479 finished with value: 0.16012269938650306 and parameters: {'lr': 6.154748568029135e-06, 'dropout': 0.5327457778337008, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 102, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 4.7590549947709455e-07, 'dropout': 0.5948797210652101, 'd_model_multiplier': 2, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 116, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 40.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
40.9 K    Trainable params
0         Non-trainable params
40.9 K    Total params
0.164     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.7246376872062683
	RegressionCompetitionScore: 0.4782608695652174



Validation scores:
	RegressionAUROC: 0.516301691532135
	RegressionCompetitionScore: 0.12607361963190183

Metric val_loss improved. New best score: 0.305


Validation scores:
	RegressionAUROC: 0.5171331167221069
	RegressionCompetitionScore: 0.12883435582822086

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.290


Validation scores:
	RegressionAUROC: 0.5182317495346069
	RegressionCompetitionScore: 0.1322085889570552

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.277


Validation scores:
	RegressionAUROC: 0.519054651260376
	RegressionCompetitionScore: 0.1325153374233129

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.268


Validation scores:
	RegressionAUROC: 0.5198262333869934
	RegressionCompetitionScore: 0.13404907975460123

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.261


Validation scores:
	RegressionAUROC: 0.5206104516983032
	RegressionCompetitionScore: 0.13650306748466257

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.257


Validation scores:
	RegressionAUROC: 0.5213941335678101
	RegressionCompetitionScore: 0.13588957055214723

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.254


Validation scores:
	RegressionAUROC: 0.5221247673034668
	RegressionCompetitionScore: 0.13680981595092023

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.5226975679397583
	RegressionCompetitionScore: 0.13680981595092023

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.251


Validation scores:
	RegressionAUROC: 0.5228010416030884
	RegressionCompetitionScore: 0.13650306748466257

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.5235401391983032
	RegressionCompetitionScore: 0.13711656441717793

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.5243587493896484
	RegressionCompetitionScore: 0.13773006134969326



Validation scores:
	RegressionAUROC: 0.5251607298851013
	RegressionCompetitionScore: 0.14049079754601226



Validation scores:
	RegressionAUROC: 0.5257186889648438
	RegressionCompetitionScore: 0.13987730061349693



Validation scores:
	RegressionAUROC: 0.5261739492416382
	RegressionCompetitionScore: 0.1401840490797546



Validation scores:
	RegressionAUROC: 0.5266305208206177
	RegressionCompetitionScore: 0.13987730061349693



Validation scores:
	RegressionAUROC: 0.527043342590332
	RegressionCompetitionScore: 0.14049079754601226



Validation scores:
	RegressionAUROC: 0.5274472236633301
	RegressionCompetitionScore: 0.14202453987730063

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.250. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.13711656441717793
     Test RegressionAUROC            0.5235401391983032
Test RegressionCompetitionScore      0.13711656441717793
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 01:53:50,815][0m Trial 480 finished with value: 0.13711656441717793 and parameters: {'lr': 4.7590549947709455e-07, 'dropout': 0.5948797210652101, 'd_model_multiplier': 2, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 116, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00041038094607638836, 'dropout': 0.4297184183064013, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 148, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 291 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
291 K     Trainable params
0         Non-trainable params
291 K     Total params
1.165     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4202898442745209
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 16.836


Validation scores:
	RegressionAUROC: 0.4930494427680969
	RegressionCompetitionScore: 0.05368098159509203

Metric val_loss improved by 15.992 >= min_delta = 0.0. New best score: 0.845


Validation scores:
	RegressionAUROC: 0.4998466372489929
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5735310912132263
	RegressionCompetitionScore: 0.19539877300613498



Validation scores:
	RegressionAUROC: 0.5006617903709412
	RegressionCompetitionScore: 0.003987730061349694



Validation scores:
	RegressionAUROC: 0.5971969962120056
	RegressionCompetitionScore: 0.14631901840490796

Metric val_loss improved by 0.631 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5079530477523804
	RegressionCompetitionScore: 0.02392638036809816



Validation scores:
	RegressionAUROC: 0.6962109804153442
	RegressionCompetitionScore: 0.250920245398773

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6529596447944641
	RegressionCompetitionScore: 0.2748466257668712



Validation scores:
	RegressionAUROC: 0.6834907531738281
	RegressionCompetitionScore: 0.26993865030674846



Validation scores:
	RegressionAUROC: 0.6843411922454834
	RegressionCompetitionScore: 0.2677914110429448



Validation scores:
	RegressionAUROC: 0.6979978084564209
	RegressionCompetitionScore: 0.23865030674846627



Validation scores:
	RegressionAUROC: 0.702737033367157
	RegressionCompetitionScore: 0.23466257668711657

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.707444429397583
	RegressionCompetitionScore: 0.2312883435582822

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7095568180084229
	RegressionCompetitionScore: 0.24785276073619633



Validation scores:
	RegressionAUROC: 0.714415967464447
	RegressionCompetitionScore: 0.26625766871165646



Validation scores:
	RegressionAUROC: 0.7095964550971985
	RegressionCompetitionScore: 0.25306748466257667



Validation scores:
	RegressionAUROC: 0.7088544368743896
	RegressionCompetitionScore: 0.25



Validation scores:
	RegressionAUROC: 0.7194454669952393
	RegressionCompetitionScore: 0.26717791411042946

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.6603624820709229
	RegressionCompetitionScore: 0.26901840490797546



Validation scores:
	RegressionAUROC: 0.7223002314567566
	RegressionCompetitionScore: 0.2812883435582822



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6455139517784119
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.722052812576294
	RegressionCompetitionScore: 0.3039877300613497



Validation scores:
	RegressionAUROC: 0.72383713722229
	RegressionCompetitionScore: 0.2785276073619632



Validation scores:
	RegressionAUROC: 0.7030860185623169
	RegressionCompetitionScore: 0.14785276073619633

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.183. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.26717791411042946
     Test RegressionAUROC            0.7194454669952393
Test RegressionCompetitionScore      0.26717791411042946
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 02:12:33,067][0m Trial 481 finished with value: 0.26717791411042946 and parameters: {'lr': 0.00041038094607638836, 'dropout': 0.4297184183064013, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 64, 'dim_feedforward': 148, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0002434846292549893, 'dropout': 0.506277942263357, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 201, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 42.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
42.3 K    Trainable params
0         Non-trainable params
42.3 K    Total params
0.169     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4202898442745209
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.6038066744804382
	RegressionCompetitionScore: 0.21717791411042944

Metric val_loss improved. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6428046822547913
	RegressionCompetitionScore: 0.27300613496932513

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.691737174987793
	RegressionCompetitionScore: 0.2776073619631902

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.6989864110946655
	RegressionCompetitionScore: 0.28680981595092025

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.6898015737533569
	RegressionCompetitionScore: 0.3006134969325153



Validation scores:
	RegressionAUROC: 0.7153537273406982
	RegressionCompetitionScore: 0.3205521472392638

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7272029519081116
	RegressionCompetitionScore: 0.33957055214723925



Validation scores:
	RegressionAUROC: 0.7316815257072449
	RegressionCompetitionScore: 0.3245398773006135



Validation scores:
	RegressionAUROC: 0.7448498606681824
	RegressionCompetitionScore: 0.3588957055214724



Validation scores:
	RegressionAUROC: 0.7499786019325256
	RegressionCompetitionScore: 0.37576687116564417



Validation scores:
	RegressionAUROC: 0.7516194581985474
	RegressionCompetitionScore: 0.35368098159509204



Validation scores:
	RegressionAUROC: 0.7506274580955505
	RegressionCompetitionScore: 0.3300613496932515

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7558464407920837
	RegressionCompetitionScore: 0.3380368098159509



Validation scores:
	RegressionAUROC: 0.7523149847984314
	RegressionCompetitionScore: 0.34294478527607364

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7574896812438965
	RegressionCompetitionScore: 0.35644171779141104



Validation scores:
	RegressionAUROC: 0.7579107880592346
	RegressionCompetitionScore: 0.38404907975460123



Validation scores:
	RegressionAUROC: 0.7609553933143616
	RegressionCompetitionScore: 0.38128834355828223



Validation scores:
	RegressionAUROC: 0.7478296756744385
	RegressionCompetitionScore: 0.35429447852760737



Validation scores:
	RegressionAUROC: 0.7572851181030273
	RegressionCompetitionScore: 0.39662576687116563



Validation scores:
	RegressionAUROC: 0.7632194757461548
	RegressionCompetitionScore: 0.37607361963190183



Validation scores:
	RegressionAUROC: 0.7575263977050781
	RegressionCompetitionScore: 0.3647239263803681

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.34294478527607364
     Test RegressionAUROC            0.7523149847984314
Test RegressionCompetitionScore      0.34294478527607364
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 02:21:04,167][0m Trial 482 finished with value: 0.34294478527607364 and parameters: {'lr': 0.0002434846292549893, 'dropout': 0.506277942263357, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 201, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0008591301024883028, 'dropout': 0.6217003734921683, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 81, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 33.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
33.8 K    Trainable params
0         Non-trainable params
33.8 K    Total params
0.135     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4271063208580017
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.372


Validation scores:
	RegressionAUROC: 0.46037983894348145
	RegressionCompetitionScore: 0.10030674846625767

Metric val_loss improved by 0.065 >= min_delta = 0.0. New best score: 0.306


Validation scores:
	RegressionAUROC: 0.4242320954799652
	RegressionCompetitionScore: 0.09662576687116564

Metric val_loss improved by 0.080 >= min_delta = 0.0. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.46873968839645386
	RegressionCompetitionScore: 0.10521472392638037

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.43033692240715027
	RegressionCompetitionScore: 0.057975460122699385

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.44716691970825195
	RegressionCompetitionScore: 0.04693251533742331

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.49062293767929077
	RegressionCompetitionScore: 0.04539877300613497



Validation scores:
	RegressionAUROC: 0.5656050443649292
	RegressionCompetitionScore: 0.0736196319018405



Validation scores:
	RegressionAUROC: 0.5709142684936523
	RegressionCompetitionScore: 0.0803680981595092

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6149771213531494
	RegressionCompetitionScore: 0.18128834355828222



Validation scores:
	RegressionAUROC: 0.6349765062332153
	RegressionCompetitionScore: 0.25306748466257667

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6391723155975342
	RegressionCompetitionScore: 0.24631901840490797



Validation scores:
	RegressionAUROC: 0.6758404970169067
	RegressionCompetitionScore: 0.27791411042944786



Validation scores:
	RegressionAUROC: 0.6662030220031738
	RegressionCompetitionScore: 0.2570552147239264

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.678279459476471
	RegressionCompetitionScore: 0.17760736196319019



Validation scores:
	RegressionAUROC: 0.6712124943733215
	RegressionCompetitionScore: 0.09079754601226994

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.658663272857666
	RegressionCompetitionScore: 0.08957055214723926



Validation scores:
	RegressionAUROC: 0.655533492565155
	RegressionCompetitionScore: 0.08895705521472393



Validation scores:
	RegressionAUROC: 0.6591953039169312
	RegressionCompetitionScore: 0.08773006134969324



Validation scores:
	RegressionAUROC: 0.651423990726471
	RegressionCompetitionScore: 0.08987730061349693



Validation scores:
	RegressionAUROC: 0.6302130818367004
	RegressionCompetitionScore: 0.09018404907975461



Validation scores:
	RegressionAUROC: 0.6102523803710938
	RegressionCompetitionScore: 0.09355828220858896



Validation scores:
	RegressionAUROC: 0.6049689054489136
	RegressionCompetitionScore: 0.09478527607361963

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5983775854110718
	RegressionCompetitionScore: 0.09447852760736196



Validation scores:
	RegressionAUROC: 0.5965253114700317
	RegressionCompetitionScore: 0.0950920245398773



Validation scores:
	RegressionAUROC: 0.5927977561950684
	RegressionCompetitionScore: 0.09631901840490797



Validation scores:
	RegressionAUROC: 0.5834336280822754
	RegressionCompetitionScore: 0.0950920245398773



Validation scores:
	RegressionAUROC: 0.5879725217819214
	RegressionCompetitionScore: 0.0950920245398773



Validation scores:
	RegressionAUROC: 0.5919876098632812
	RegressionCompetitionScore: 0.09601226993865031



Validation scores:
	RegressionAUROC: 0.5940173268318176
	RegressionCompetitionScore: 0.09662576687116564

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.208. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.09478527607361963
     Test RegressionAUROC            0.6049689054489136
Test RegressionCompetitionScore      0.09478527607361963
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 02:33:03,307][0m Trial 483 finished with value: 0.09478527607361963 and parameters: {'lr': 0.0008591301024883028, 'dropout': 0.6217003734921683, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 81, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0019721083301610376, 'dropout': 0.40909555421186033, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 181, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 158 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
158 K     Trainable params
0         Non-trainable params
158 K     Total params
0.635     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5652173757553101
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.38688525557518005
	RegressionCompetitionScore: 0.02361963190184049

Metric val_loss improved. New best score: 0.257


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6207362413406372
	RegressionCompetitionScore: 0.11993865030674847



Validation scores:
	RegressionAUROC: 0.5947705507278442
	RegressionCompetitionScore: 0.13190184049079753



Validation scores:
	RegressionAUROC: 0.6713697910308838
	RegressionCompetitionScore: 0.14079754601226993

Metric val_loss improved by 0.044 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.6725953817367554
	RegressionCompetitionScore: 0.11441717791411044



Validation scores:
	RegressionAUROC: 0.5302581787109375
	RegressionCompetitionScore: 0.09785276073619632



Validation scores:
	RegressionAUROC: 0.6333427429199219
	RegressionCompetitionScore: 0.08496932515337423



Validation scores:
	RegressionAUROC: 0.6378542184829712
	RegressionCompetitionScore: 0.0950920245398773

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6227681636810303
	RegressionCompetitionScore: 0.09969325153374232



Validation scores:
	RegressionAUROC: 0.5797703862190247
	RegressionCompetitionScore: 0.09478527607361963



Validation scores:
	RegressionAUROC: 0.6580001711845398
	RegressionCompetitionScore: 0.19846625766871165



Validation scores:
	RegressionAUROC: 0.5838567614555359
	RegressionCompetitionScore: 0.08588957055214724



Validation scores:
	RegressionAUROC: 0.5665351748466492
	RegressionCompetitionScore: 0.11380368098159509



Validation scores:
	RegressionAUROC: 0.6343628168106079
	RegressionCompetitionScore: 0.1067484662576687



Validation scores:
	RegressionAUROC: 0.643242597579956
	RegressionCompetitionScore: 0.1745398773006135

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6169057488441467
	RegressionCompetitionScore: 0.26411042944785273



Validation scores:
	RegressionAUROC: 0.6139837503433228
	RegressionCompetitionScore: 0.2634969325153374



Validation scores:
	RegressionAUROC: 0.5441015362739563
	RegressionCompetitionScore: 0.1352760736196319



Validation scores:
	RegressionAUROC: 0.6133871078491211
	RegressionCompetitionScore: 0.23098159509202454



Validation scores:
	RegressionAUROC: 0.4849433898925781
	RegressionCompetitionScore: 0.027300613496932514



Validation scores:
	RegressionAUROC: 0.6178030967712402
	RegressionCompetitionScore: 0.10552147239263804



Validation scores:
	RegressionAUROC: 0.43346524238586426
	RegressionCompetitionScore: 0.09969325153374232

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1745398773006135
     Test RegressionAUROC             0.643242597579956
Test RegressionCompetitionScore      0.1745398773006135
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 02:47:08,830][0m Trial 484 finished with value: 0.1745398773006135 and parameters: {'lr': 0.0019721083301610376, 'dropout': 0.40909555421186033, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 32, 'dim_feedforward': 181, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004935748744617231, 'dropout': 0.4000163099790714, 'd_model_multiplier': 32, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 604, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 1.4 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
1.4 M     Trainable params
0         Non-trainable params
1.4 M     Total params
5.600     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2946859896183014
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6071227788925171
	RegressionCompetitionScore: 0.24846625766871167

Metric val_loss improved. New best score: 1.828


Validation scores:
	RegressionAUROC: 0.498446524143219
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.524 >= min_delta = 0.0. New best score: 1.304


Validation scores:
	RegressionAUROC: 0.6779372692108154
	RegressionCompetitionScore: 0.11901840490797547

Metric val_loss improved by 0.953 >= min_delta = 0.0. New best score: 0.351


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6781153678894043
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.345


Validation scores:
	RegressionAUROC: 0.6970356702804565
	RegressionCompetitionScore: 0.19907975460122698

Metric val_loss improved by 0.033 >= min_delta = 0.0. New best score: 0.312


Validation scores:
	RegressionAUROC: 0.6950730681419373
	RegressionCompetitionScore: 0.21993865030674847



Validation scores:
	RegressionAUROC: 0.6408271789550781
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5279589891433716
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7138368487358093
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.046 >= min_delta = 0.0. New best score: 0.266


Validation scores:
	RegressionAUROC: 0.7237908244132996
	RegressionCompetitionScore: 0.35736196319018404

Metric val_loss improved by 0.076 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.6717780232429504
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6591835618019104
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7268886566162109
	RegressionCompetitionScore: 0.3312883435582822

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.6917442083358765
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7263692021369934
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.61724853515625
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6723911166191101
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7239722609519958
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7331135272979736
	RegressionCompetitionScore: 0.37331288343558283



Validation scores:
	RegressionAUROC: 0.5833508968353271
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.180. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3312883435582822
     Test RegressionAUROC            0.7268886566162109
Test RegressionCompetitionScore      0.3312883435582822
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 02:55:38,693][0m Trial 485 finished with value: 0.3312883435582822 and parameters: {'lr': 0.0004935748744617231, 'dropout': 0.4000163099790714, 'd_model_multiplier': 32, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 604, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00034803729485233855, 'dropout': 0.4406443998732746, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 133, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 36.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
36.5 K    Trainable params
0         Non-trainable params
36.5 K    Total params
0.146     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5964237451553345
	RegressionCompetitionScore: 0.09079754601226994

Metric val_loss improved. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.6359384059906006
	RegressionCompetitionScore: 0.12423312883435583

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6744868755340576
	RegressionCompetitionScore: 0.26380368098159507

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6788572669029236
	RegressionCompetitionScore: 0.28159509202453986

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.6852730512619019
	RegressionCompetitionScore: 0.2763803680981595

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7212862968444824
	RegressionCompetitionScore: 0.36073619631901843

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7179262042045593
	RegressionCompetitionScore: 0.3401840490797546

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7206417322158813
	RegressionCompetitionScore: 0.36319018404907977



Validation scores:
	RegressionAUROC: 0.7328860759735107
	RegressionCompetitionScore: 0.400920245398773



Validation scores:
	RegressionAUROC: 0.7072215676307678
	RegressionCompetitionScore: 0.2987730061349693



Validation scores:
	RegressionAUROC: 0.7367963194847107
	RegressionCompetitionScore: 0.34570552147239264



Validation scores:
	RegressionAUROC: 0.7335564494132996
	RegressionCompetitionScore: 0.3803680981595092

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7421436309814453
	RegressionCompetitionScore: 0.3693251533742331



Validation scores:
	RegressionAUROC: 0.746813178062439
	RegressionCompetitionScore: 0.39662576687116563

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7555127143859863
	RegressionCompetitionScore: 0.4116564417177914

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7566443681716919
	RegressionCompetitionScore: 0.43650306748466255



Validation scores:
	RegressionAUROC: 0.7479364275932312
	RegressionCompetitionScore: 0.40705521472392636



Validation scores:
	RegressionAUROC: 0.7428747415542603
	RegressionCompetitionScore: 0.3960122699386503



Validation scores:
	RegressionAUROC: 0.7551324963569641
	RegressionCompetitionScore: 0.4021472392638037



Validation scores:
	RegressionAUROC: 0.7512321472167969
	RegressionCompetitionScore: 0.40644171779141103



Validation scores:
	RegressionAUROC: 0.7647089958190918
	RegressionCompetitionScore: 0.4312883435582822

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7627639770507812
	RegressionCompetitionScore: 0.43006134969325155



Validation scores:
	RegressionAUROC: 0.7512283325195312
	RegressionCompetitionScore: 0.3441717791411043



Validation scores:
	RegressionAUROC: 0.7544979453086853
	RegressionCompetitionScore: 0.39969325153374236



Validation scores:
	RegressionAUROC: 0.7786317467689514
	RegressionCompetitionScore: 0.4352760736196319



Validation scores:
	RegressionAUROC: 0.7691928744316101
	RegressionCompetitionScore: 0.4156441717791411



Validation scores:
	RegressionAUROC: 0.7575955986976624
	RegressionCompetitionScore: 0.4223926380368098



Validation scores:
	RegressionAUROC: 0.7731078863143921
	RegressionCompetitionScore: 0.4539877300613497

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.163. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4312883435582822
     Test RegressionAUROC            0.7647089958190918
Test RegressionCompetitionScore      0.4312883435582822
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 03:06:56,095][0m Trial 486 finished with value: 0.4312883435582822 and parameters: {'lr': 0.00034803729485233855, 'dropout': 0.4406443998732746, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 133, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00019828500429914855, 'dropout': 0.4377776849609309, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 162, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 39.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
39.0 K    Trainable params
0         Non-trainable params
39.0 K    Total params
0.156     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.461352676153183
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5340665578842163
	RegressionCompetitionScore: 0.0803680981595092

Metric val_loss improved. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.637017548084259
	RegressionCompetitionScore: 0.19355828220858895

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6526985168457031
	RegressionCompetitionScore: 0.2803680981595092

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6605147123336792
	RegressionCompetitionScore: 0.27423312883435585

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6768864393234253
	RegressionCompetitionScore: 0.28251533742331286

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6943207383155823
	RegressionCompetitionScore: 0.3070552147239264

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7020024657249451
	RegressionCompetitionScore: 0.3236196319018405

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.187


Validation scores:
	RegressionAUROC: 0.7081753015518188
	RegressionCompetitionScore: 0.3165644171779141



Validation scores:
	RegressionAUROC: 0.7175453305244446
	RegressionCompetitionScore: 0.350920245398773



Validation scores:
	RegressionAUROC: 0.7154342532157898
	RegressionCompetitionScore: 0.3254601226993865



Validation scores:
	RegressionAUROC: 0.7159625291824341
	RegressionCompetitionScore: 0.33312883435582824



Validation scores:
	RegressionAUROC: 0.7151697874069214
	RegressionCompetitionScore: 0.3276073619631902

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7278538942337036
	RegressionCompetitionScore: 0.3312883435582822

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7297028303146362
	RegressionCompetitionScore: 0.3300613496932515



Validation scores:
	RegressionAUROC: 0.7290045022964478
	RegressionCompetitionScore: 0.3371165644171779



Validation scores:
	RegressionAUROC: 0.7313480973243713
	RegressionCompetitionScore: 0.3088957055214724



Validation scores:
	RegressionAUROC: 0.7471225261688232
	RegressionCompetitionScore: 0.3411042944785276

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7363114356994629
	RegressionCompetitionScore: 0.3239263803680982



Validation scores:
	RegressionAUROC: 0.7438068389892578
	RegressionCompetitionScore: 0.33957055214723925



Validation scores:
	RegressionAUROC: 0.7403903007507324
	RegressionCompetitionScore: 0.33312883435582824



Validation scores:
	RegressionAUROC: 0.7499245405197144
	RegressionCompetitionScore: 0.346319018404908

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7449902296066284
	RegressionCompetitionScore: 0.3441717791411043

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7483401298522949
	RegressionCompetitionScore: 0.3337423312883436



Validation scores:
	RegressionAUROC: 0.7457025647163391
	RegressionCompetitionScore: 0.3042944785276074



Validation scores:
	RegressionAUROC: 0.7399611473083496
	RegressionCompetitionScore: 0.2996932515337423



Validation scores:
	RegressionAUROC: 0.7537800073623657
	RegressionCompetitionScore: 0.34294478527607364



Validation scores:
	RegressionAUROC: 0.7477396726608276
	RegressionCompetitionScore: 0.3187116564417178



Validation scores:
	RegressionAUROC: 0.7426502108573914
	RegressionCompetitionScore: 0.32699386503067485



Validation scores:
	RegressionAUROC: 0.7522571086883545
	RegressionCompetitionScore: 0.34570552147239264

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.171. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3441717791411043
     Test RegressionAUROC            0.7449902296066284
Test RegressionCompetitionScore      0.3441717791411043
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 03:18:30,358][0m Trial 487 finished with value: 0.3441717791411043 and parameters: {'lr': 0.00019828500429914855, 'dropout': 0.4377776849609309, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 162, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00034360287072462585, 'dropout': 0.4215824847523932, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 4, 'dim_feedforward': 149, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 27.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
27.1 K    Trainable params
0         Non-trainable params
27.1 K    Total params
0.108     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5833333134651184
	RegressionCompetitionScore: 0.3333333333333333



Validation scores:
	RegressionAUROC: 0.6217248439788818
	RegressionCompetitionScore: 0.24233128834355827

Metric val_loss improved. New best score: 0.223


Validation scores:
	RegressionAUROC: 0.6664276719093323
	RegressionCompetitionScore: 0.2705521472392638

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6645357608795166
	RegressionCompetitionScore: 0.24171779141104294

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6196120977401733
	RegressionCompetitionScore: 0.2165644171779141



Validation scores:
	RegressionAUROC: 0.6418414115905762
	RegressionCompetitionScore: 0.2312883435582822



Validation scores:
	RegressionAUROC: 0.6490790843963623
	RegressionCompetitionScore: 0.24969325153374233

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6643077731132507
	RegressionCompetitionScore: 0.2656441717791411

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6705695986747742
	RegressionCompetitionScore: 0.2883435582822086



Validation scores:
	RegressionAUROC: 0.664908766746521
	RegressionCompetitionScore: 0.24171779141104294



Validation scores:
	RegressionAUROC: 0.669609546661377
	RegressionCompetitionScore: 0.28282208588957053



Validation scores:
	RegressionAUROC: 0.6785690784454346
	RegressionCompetitionScore: 0.28190184049079753



Validation scores:
	RegressionAUROC: 0.6899818181991577
	RegressionCompetitionScore: 0.2809815950920245

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6910415887832642
	RegressionCompetitionScore: 0.27208588957055213

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6927434206008911
	RegressionCompetitionScore: 0.28159509202453986



Validation scores:
	RegressionAUROC: 0.6847202777862549
	RegressionCompetitionScore: 0.298159509202454



Validation scores:
	RegressionAUROC: 0.6816763877868652
	RegressionCompetitionScore: 0.29754601226993865



Validation scores:
	RegressionAUROC: 0.6883656978607178
	RegressionCompetitionScore: 0.300920245398773



Validation scores:
	RegressionAUROC: 0.7091196179389954
	RegressionCompetitionScore: 0.31257668711656444



Validation scores:
	RegressionAUROC: 0.7127440571784973
	RegressionCompetitionScore: 0.2865030674846626



Validation scores:
	RegressionAUROC: 0.6893970966339111
	RegressionCompetitionScore: 0.3187116564417178

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.195. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.27208588957055213
     Test RegressionAUROC            0.6910415887832642
Test RegressionCompetitionScore      0.27208588957055213
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 03:26:38,003][0m Trial 488 finished with value: 0.27208588957055213 and parameters: {'lr': 0.00034360287072462585, 'dropout': 0.4215824847523932, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 4, 'dim_feedforward': 149, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0002925042282501302, 'dropout': 0.4184916077473759, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 133, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 36.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
36.5 K    Trainable params
0         Non-trainable params
36.5 K    Total params
0.146     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.46859902143478394
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.6604136824607849
	RegressionCompetitionScore: 0.2757668711656442

Metric val_loss improved. New best score: 0.272


Validation scores:
	RegressionAUROC: 0.6954250931739807
	RegressionCompetitionScore: 0.2757668711656442

Metric val_loss improved by 0.064 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6870737075805664
	RegressionCompetitionScore: 0.2696319018404908

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.7110177278518677
	RegressionCompetitionScore: 0.28957055214723926

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7229223847389221
	RegressionCompetitionScore: 0.301840490797546

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7444943785667419
	RegressionCompetitionScore: 0.37791411042944784



Validation scores:
	RegressionAUROC: 0.7442396879196167
	RegressionCompetitionScore: 0.34754601226993864



Validation scores:
	RegressionAUROC: 0.7530750036239624
	RegressionCompetitionScore: 0.38128834355828223

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.75185227394104
	RegressionCompetitionScore: 0.3825153374233129

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.173


Validation scores:
	RegressionAUROC: 0.7559006214141846
	RegressionCompetitionScore: 0.40061349693251536



Validation scores:
	RegressionAUROC: 0.7663863301277161
	RegressionCompetitionScore: 0.38128834355828223

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7717024087905884
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7738377451896667
	RegressionCompetitionScore: 0.4251533742331288



Validation scores:
	RegressionAUROC: 0.748167872428894
	RegressionCompetitionScore: 0.3052147239263804



Validation scores:
	RegressionAUROC: 0.7721496224403381
	RegressionCompetitionScore: 0.4285276073619632



Validation scores:
	RegressionAUROC: 0.7806003093719482
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7641026973724365
	RegressionCompetitionScore: 0.42300613496932515



Validation scores:
	RegressionAUROC: 0.7720110416412354
	RegressionCompetitionScore: 0.4049079754601227

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.172. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38128834355828223
     Test RegressionAUROC            0.7663863301277161
Test RegressionCompetitionScore      0.38128834355828223
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 03:33:49,789][0m Trial 489 finished with value: 0.38128834355828223 and parameters: {'lr': 0.0002925042282501302, 'dropout': 0.4184916077473759, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 133, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.009258772904536193, 'dropout': 0.6312136781045502, 'd_model_multiplier': 8, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 202, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 2.5 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
2.5 M     Trainable params
0         Non-trainable params
2.5 M     Total params
9.840     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6666666269302368
	RegressionCompetitionScore: 0.30434782608695654



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 67615.297


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 45239.617 >= min_delta = 0.0. New best score: 22375.678


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 19956.365 >= min_delta = 0.0. New best score: 2419.312


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 1982.570 >= min_delta = 0.0. New best score: 436.743


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 432.471 >= min_delta = 0.0. New best score: 4.272


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 2.912 >= min_delta = 0.0. New best score: 1.360


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4986320734024048
	RegressionCompetitionScore: 0.06748466257668712

Metric val_loss improved by 1.016 >= min_delta = 0.0. New best score: 0.345


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49310988187789917
	RegressionCompetitionScore: 0.026993865030674847



Validation scores:
	RegressionAUROC: 0.48443493247032166
	RegressionCompetitionScore: 0.04478527607361963

Metric val_loss improved by 0.133 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5067839026451111
	RegressionCompetitionScore: 0.04325153374233129



Validation scores:
	RegressionAUROC: 0.49901676177978516
	RegressionCompetitionScore: 0.03987730061349693



Validation scores:
	RegressionAUROC: 0.4962840974330902
	RegressionCompetitionScore: 0.03128834355828221



Validation scores:
	RegressionAUROC: 0.5069707632064819
	RegressionCompetitionScore: 0.07177914110429448



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.212. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.04478527607361963
     Test RegressionAUROC            0.48443493247032166
Test RegressionCompetitionScore      0.04478527607361963
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 03:46:48,477][0m Trial 490 finished with value: 0.04478527607361963 and parameters: {'lr': 0.009258772904536193, 'dropout': 0.6312136781045502, 'd_model_multiplier': 8, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 202, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0003619306011839907, 'dropout': 0.44004712837355164, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 168, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 39.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
39.5 K    Trainable params
0         Non-trainable params
39.5 K    Total params
0.158     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.685077428817749
	RegressionCompetitionScore: 0.2294478527607362

Metric val_loss improved. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6887210607528687
	RegressionCompetitionScore: 0.26411042944785273



Validation scores:
	RegressionAUROC: 0.7161960601806641
	RegressionCompetitionScore: 0.34263803680981597

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7277213335037231
	RegressionCompetitionScore: 0.31257668711656444



Validation scores:
	RegressionAUROC: 0.7365970611572266
	RegressionCompetitionScore: 0.37668711656441717

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7499758005142212
	RegressionCompetitionScore: 0.38098159509202456



Validation scores:
	RegressionAUROC: 0.7499889135360718
	RegressionCompetitionScore: 0.4134969325153374



Validation scores:
	RegressionAUROC: 0.7655678987503052
	RegressionCompetitionScore: 0.37331288343558283

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.164


Validation scores:
	RegressionAUROC: 0.7549921274185181
	RegressionCompetitionScore: 0.3969325153374233



Validation scores:
	RegressionAUROC: 0.766703188419342
	RegressionCompetitionScore: 0.36901840490797544



Validation scores:
	RegressionAUROC: 0.7693873643875122
	RegressionCompetitionScore: 0.37392638036809817



Validation scores:
	RegressionAUROC: 0.7845987677574158
	RegressionCompetitionScore: 0.4187116564417178



Validation scores:
	RegressionAUROC: 0.7766663432121277
	RegressionCompetitionScore: 0.42392638036809815



Validation scores:
	RegressionAUROC: 0.7566781044006348
	RegressionCompetitionScore: 0.344478527607362



Validation scores:
	RegressionAUROC: 0.7800334692001343
	RegressionCompetitionScore: 0.4180981595092024

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.162


Validation scores:
	RegressionAUROC: 0.780868649482727
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7796596884727478
	RegressionCompetitionScore: 0.42116564417177915



Validation scores:
	RegressionAUROC: 0.7714414596557617
	RegressionCompetitionScore: 0.40644171779141103



Validation scores:
	RegressionAUROC: 0.7847232818603516
	RegressionCompetitionScore: 0.38865030674846623



Validation scores:
	RegressionAUROC: 0.7741572260856628
	RegressionCompetitionScore: 0.3815950920245399



Validation scores:
	RegressionAUROC: 0.7823910713195801
	RegressionCompetitionScore: 0.4404907975460123



Validation scores:
	RegressionAUROC: 0.7803481817245483
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.162. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4180981595092024
     Test RegressionAUROC            0.7800334692001343
Test RegressionCompetitionScore      0.4180981595092024
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 03:55:30,110][0m Trial 491 finished with value: 0.4180981595092024 and parameters: {'lr': 0.0003619306011839907, 'dropout': 0.44004712837355164, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 168, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00020167185388699654, 'dropout': 0.4308810560584758, 'd_model_multiplier': 64, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 129, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 7.6 M 
1 | loss_fn | MSELoss | 0     
------------------------------------
7.6 M     Trainable params
0         Non-trainable params
7.6 M     Total params
30.397    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4589371681213379
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.380


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6111205220222473
	RegressionCompetitionScore: 0.27883435582822086

Metric val_loss improved by 1.117 >= min_delta = 0.0. New best score: 0.262


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5152762532234192
	RegressionCompetitionScore: 0.0892638036809816



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.262. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.27883435582822086
     Test RegressionAUROC            0.6111205220222473
Test RegressionCompetitionScore      0.27883435582822086
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 04:01:10,168][0m Trial 492 finished with value: 0.27883435582822086 and parameters: {'lr': 0.00020167185388699654, 'dropout': 0.4308810560584758, 'd_model_multiplier': 64, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 129, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004574738344004058, 'dropout': 0.4472389649962424, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 142, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 29.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
29.1 K    Trainable params
0         Non-trainable params
29.1 K    Total params
0.116     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7111082077026367
	RegressionCompetitionScore: 0.3104294478527607

Metric val_loss improved. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7295627593994141
	RegressionCompetitionScore: 0.3245398773006135

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7351022958755493
	RegressionCompetitionScore: 0.3506134969325153



Validation scores:
	RegressionAUROC: 0.7333762645721436
	RegressionCompetitionScore: 0.3257668711656442



Validation scores:
	RegressionAUROC: 0.7435991764068604
	RegressionCompetitionScore: 0.3371165644171779



Validation scores:
	RegressionAUROC: 0.746937096118927
	RegressionCompetitionScore: 0.3355828220858896



Validation scores:
	RegressionAUROC: 0.7342665195465088
	RegressionCompetitionScore: 0.30368098159509205



Validation scores:
	RegressionAUROC: 0.7170902490615845
	RegressionCompetitionScore: 0.2659509202453988



Validation scores:
	RegressionAUROC: 0.7180435657501221
	RegressionCompetitionScore: 0.2331288343558282

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.177. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3245398773006135
     Test RegressionAUROC            0.7295627593994141
Test RegressionCompetitionScore      0.3245398773006135
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 04:04:55,431][0m Trial 493 finished with value: 0.3245398773006135 and parameters: {'lr': 0.0004574738344004058, 'dropout': 0.4472389649962424, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 142, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.002874523606052185, 'dropout': 0.416284905821496, 'd_model_multiplier': 16, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 185, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 705 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
705 K     Trainable params
0         Non-trainable params
705 K     Total params
2.820     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2801932394504547
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 4.603


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 2.325 >= min_delta = 0.0. New best score: 2.279


Validation scores:
	RegressionAUROC: 0.45993947982788086
	RegressionCompetitionScore: 0.05828220858895705

Metric val_loss improved by 1.923 >= min_delta = 0.0. New best score: 0.356


Validation scores:
	RegressionAUROC: 0.5092788934707642
	RegressionCompetitionScore: 0.1058282208588957

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.331


Validation scores:
	RegressionAUROC: 0.40516984462738037
	RegressionCompetitionScore: 0.053067484662576686



Validation scores:
	RegressionAUROC: 0.41838639974594116
	RegressionCompetitionScore: 0.0549079754601227

Metric val_loss improved by 0.119 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5302655696868896
	RegressionCompetitionScore: 0.09539877300613497



Validation scores:
	RegressionAUROC: 0.4546358585357666
	RegressionCompetitionScore: 0.025153374233128835

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5871429443359375
	RegressionCompetitionScore: 0.1785276073619632



Validation scores:
	RegressionAUROC: 0.4445428252220154
	RegressionCompetitionScore: 0.09018404907975461



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore          0.025153374233128835
     Test RegressionAUROC            0.4546358585357666
Test RegressionCompetitionScore     0.025153374233128835
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 04:11:06,145][0m Trial 494 finished with value: 0.025153374233128835 and parameters: {'lr': 0.002874523606052185, 'dropout': 0.416284905821496, 'd_model_multiplier': 16, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 185, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 1.7159630961710822e-07, 'dropout': 0.5217504497809007, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 32, 'dim_feedforward': 589, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 88.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
88.3 K    Trainable params
0         Non-trainable params
88.3 K    Total params
0.353     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4396135210990906
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.4007759690284729
	RegressionCompetitionScore: 0.09785276073619632

Metric val_loss improved. New best score: 0.333


Validation scores:
	RegressionAUROC: 0.40071165561676025
	RegressionCompetitionScore: 0.09631901840490797

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.313


Validation scores:
	RegressionAUROC: 0.40068456530570984
	RegressionCompetitionScore: 0.09601226993865031

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.295


Validation scores:
	RegressionAUROC: 0.4006115794181824
	RegressionCompetitionScore: 0.09570552147239264

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.281


Validation scores:
	RegressionAUROC: 0.40059393644332886
	RegressionCompetitionScore: 0.09417177914110429

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.270


Validation scores:
	RegressionAUROC: 0.4006690979003906
	RegressionCompetitionScore: 0.09355828220858896

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.260


Validation scores:
	RegressionAUROC: 0.4008867144584656
	RegressionCompetitionScore: 0.09325153374233129

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.254


Validation scores:
	RegressionAUROC: 0.40129297971725464
	RegressionCompetitionScore: 0.09294478527607362

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.249


Validation scores:
	RegressionAUROC: 0.4017065763473511
	RegressionCompetitionScore: 0.09171779141104294

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.245


Validation scores:
	RegressionAUROC: 0.40209776163101196
	RegressionCompetitionScore: 0.09141104294478528

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.243


Validation scores:
	RegressionAUROC: 0.40269023180007935
	RegressionCompetitionScore: 0.09110429447852761

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.240


Validation scores:
	RegressionAUROC: 0.40314918756484985
	RegressionCompetitionScore: 0.08957055214723926

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.4036162495613098
	RegressionCompetitionScore: 0.08957055214723926

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.238


Validation scores:
	RegressionAUROC: 0.40401285886764526
	RegressionCompetitionScore: 0.08650306748466258



Validation scores:
	RegressionAUROC: 0.4048224091529846
	RegressionCompetitionScore: 0.08619631901840491



Validation scores:
	RegressionAUROC: 0.4055388569831848
	RegressionCompetitionScore: 0.08650306748466258



Validation scores:
	RegressionAUROC: 0.40642061829566956
	RegressionCompetitionScore: 0.08588957055214724



Validation scores:
	RegressionAUROC: 0.4076926112174988
	RegressionCompetitionScore: 0.08558282208588958



Validation scores:
	RegressionAUROC: 0.4088131785392761
	RegressionCompetitionScore: 0.08558282208588958



Validation scores:
	RegressionAUROC: 0.410043865442276
	RegressionCompetitionScore: 0.08496932515337423

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.238. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.08957055214723926
     Test RegressionAUROC            0.4036162495613098
Test RegressionCompetitionScore      0.08957055214723926
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 04:19:06,807][0m Trial 495 finished with value: 0.08957055214723926 and parameters: {'lr': 1.7159630961710822e-07, 'dropout': 0.5217504497809007, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 32, 'dim_feedforward': 589, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00390737701650888, 'dropout': 0.4894198629059441, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 620, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 88.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
88.8 K    Trainable params
0         Non-trainable params
88.8 K    Total params
0.355     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3478260934352875
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6211799383163452
	RegressionCompetitionScore: 0.26809815950920246

Metric val_loss improved. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.40150412917137146
	RegressionCompetitionScore: 0.06779141104294478



Validation scores:
	RegressionAUROC: 0.5728596448898315
	RegressionCompetitionScore: 0.2085889570552147



Validation scores:
	RegressionAUROC: 0.5467804670333862
	RegressionCompetitionScore: 0.150920245398773



Validation scores:
	RegressionAUROC: 0.45901376008987427
	RegressionCompetitionScore: 0.0803680981595092



Validation scores:
	RegressionAUROC: 0.4741796851158142
	RegressionCompetitionScore: 0.08190184049079755



Validation scores:
	RegressionAUROC: 0.4352453947067261
	RegressionCompetitionScore: 0.08987730061349693



Validation scores:
	RegressionAUROC: 0.44612547755241394
	RegressionCompetitionScore: 0.08957055214723926

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.212. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.26809815950920246
     Test RegressionAUROC            0.6211799383163452
Test RegressionCompetitionScore      0.26809815950920246
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 04:22:35,627][0m Trial 496 finished with value: 0.26809815950920246 and parameters: {'lr': 0.00390737701650888, 'dropout': 0.4894198629059441, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 620, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.001404068405261215, 'dropout': 0.7286185543434276, 'd_model_multiplier': 2, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 116, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 40.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
40.9 K    Trainable params
0         Non-trainable params
40.9 K    Total params
0.164     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6618357300758362
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.5590608716011047
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.593


Validation scores:
	RegressionAUROC: 0.5932793617248535
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.094 >= min_delta = 0.0. New best score: 0.499


Validation scores:
	RegressionAUROC: 0.590572714805603
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6328533291816711
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.254 >= min_delta = 0.0. New best score: 0.244


Validation scores:
	RegressionAUROC: 0.655612587928772
	RegressionCompetitionScore: 0.25920245398773006

Metric val_loss improved by 0.054 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.642970085144043
	RegressionCompetitionScore: 0.13466257668711656



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.190. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.25920245398773006
     Test RegressionAUROC             0.655612587928772
Test RegressionCompetitionScore      0.25920245398773006
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 04:27:29,046][0m Trial 497 finished with value: 0.25920245398773006 and parameters: {'lr': 0.001404068405261215, 'dropout': 0.7286185543434276, 'd_model_multiplier': 2, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 116, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0002830741995269033, 'dropout': 0.4795963053595644, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 484, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 74.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
74.9 K    Trainable params
0         Non-trainable params
74.9 K    Total params
0.300     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6458333134651184
	RegressionCompetitionScore: 0.16666666666666666



Validation scores:
	RegressionAUROC: 0.6556029319763184
	RegressionCompetitionScore: 0.26625766871165646

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.707832932472229
	RegressionCompetitionScore: 0.29233128834355826

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6240646839141846
	RegressionCompetitionScore: 0.11226993865030675



Validation scores:
	RegressionAUROC: 0.6762171983718872
	RegressionCompetitionScore: 0.14631901840490796

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6890448331832886
	RegressionCompetitionScore: 0.2776073619631902



Validation scores:
	RegressionAUROC: 0.7063896059989929
	RegressionCompetitionScore: 0.2831288343558282

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.689233124256134
	RegressionCompetitionScore: 0.3150306748466258



Validation scores:
	RegressionAUROC: 0.6894705295562744
	RegressionCompetitionScore: 0.3052147239263804



Validation scores:
	RegressionAUROC: 0.6591450572013855
	RegressionCompetitionScore: 0.17822085889570552



Validation scores:
	RegressionAUROC: 0.7078068256378174
	RegressionCompetitionScore: 0.3273006134969325



Validation scores:
	RegressionAUROC: 0.7141504287719727
	RegressionCompetitionScore: 0.23374233128834357



Validation scores:
	RegressionAUROC: 0.7026228904724121
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.710407018661499
	RegressionCompetitionScore: 0.2809815950920245

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.196. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2831288343558282
     Test RegressionAUROC            0.7063896059989929
Test RegressionCompetitionScore      0.2831288343558282
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 04:33:02,420][0m Trial 498 finished with value: 0.2831288343558282 and parameters: {'lr': 0.0002830741995269033, 'dropout': 0.4795963053595644, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 484, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.048151496525003404, 'dropout': 0.4266678486244996, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 219, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 43.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
43.8 K    Trainable params
0         Non-trainable params
43.8 K    Total params
0.175     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.511


Validation scores:
	RegressionAUROC: 0.5534949898719788
	RegressionCompetitionScore: 0.0852760736196319

Metric val_loss improved by 0.281 >= min_delta = 0.0. New best score: 0.231


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.45341700315475464
	RegressionCompetitionScore: 0.034662576687116566



Validation scores:
	RegressionAUROC: 0.5067270398139954
	RegressionCompetitionScore: 0.0687116564417178

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5159686803817749
	RegressionCompetitionScore: 0.026993865030674847



Validation scores:
	RegressionAUROC: 0.5191901326179504
	RegressionCompetitionScore: 0.03098159509202454



Validation scores:
	RegressionAUROC: 0.49905627965927124
	RegressionCompetitionScore: 0.0696319018404908



Validation scores:
	RegressionAUROC: 0.5052506327629089
	RegressionCompetitionScore: 0.020858895705521473



Validation scores:
	RegressionAUROC: 0.4867117404937744
	RegressionCompetitionScore: 0.03067484662576687



Validation scores:
	RegressionAUROC: 0.4414835572242737
	RegressionCompetitionScore: 0.03251533742331288

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.210. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.0687116564417178
     Test RegressionAUROC            0.5067270398139954
Test RegressionCompetitionScore      0.0687116564417178
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 04:38:02,706][0m Trial 499 finished with value: 0.0687116564417178 and parameters: {'lr': 0.048151496525003404, 'dropout': 0.4266678486244996, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 219, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 1.45316878847124e-07, 'dropout': 0.40778436149206426, 'd_model_multiplier': 1, 'num_layers': 8, 'n_heads': 32, 'dim_feedforward': 64, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 113 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
113 K     Trainable params
0         Non-trainable params
113 K     Total params
0.456     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.33816424012184143
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.4118044078350067
	RegressionCompetitionScore: 0.06226993865030675

Metric val_loss improved. New best score: 0.431


Validation scores:
	RegressionAUROC: 0.4115484058856964
	RegressionCompetitionScore: 0.06134969325153374

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.408


Validation scores:
	RegressionAUROC: 0.4113580882549286
	RegressionCompetitionScore: 0.06226993865030675

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.388


Validation scores:
	RegressionAUROC: 0.41142797470092773
	RegressionCompetitionScore: 0.06196319018404908

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.368


Validation scores:
	RegressionAUROC: 0.41151654720306396
	RegressionCompetitionScore: 0.06165644171779141

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.351


Validation scores:
	RegressionAUROC: 0.4118459224700928
	RegressionCompetitionScore: 0.06226993865030675

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.335


Validation scores:
	RegressionAUROC: 0.412253737449646
	RegressionCompetitionScore: 0.06226993865030675

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.321


Validation scores:
	RegressionAUROC: 0.4125223755836487
	RegressionCompetitionScore: 0.06288343558282208

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.309


Validation scores:
	RegressionAUROC: 0.41273367404937744
	RegressionCompetitionScore: 0.06257668711656442

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.298


Validation scores:
	RegressionAUROC: 0.4130343794822693
	RegressionCompetitionScore: 0.06257668711656442

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.288


Validation scores:
	RegressionAUROC: 0.4134904742240906
	RegressionCompetitionScore: 0.06319018404907975

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.280


Validation scores:
	RegressionAUROC: 0.41393351554870605
	RegressionCompetitionScore: 0.06288343558282208

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.273


Validation scores:
	RegressionAUROC: 0.4142952561378479
	RegressionCompetitionScore: 0.06257668711656442

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.268


Validation scores:
	RegressionAUROC: 0.41464897990226746
	RegressionCompetitionScore: 0.06288343558282208

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.265


Validation scores:
	RegressionAUROC: 0.4150179624557495
	RegressionCompetitionScore: 0.06319018404907975

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.262


Validation scores:
	RegressionAUROC: 0.4153134226799011
	RegressionCompetitionScore: 0.06319018404907975

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.261


Validation scores:
	RegressionAUROC: 0.4156675338745117
	RegressionCompetitionScore: 0.0638036809815951



Validation scores:
	RegressionAUROC: 0.41584867238998413
	RegressionCompetitionScore: 0.0638036809815951



Validation scores:
	RegressionAUROC: 0.4162672162055969
	RegressionCompetitionScore: 0.06319018404907975



Validation scores:
	RegressionAUROC: 0.41692596673965454
	RegressionCompetitionScore: 0.06349693251533742



Validation scores:
	RegressionAUROC: 0.417549729347229
	RegressionCompetitionScore: 0.06165644171779141



Validation scores:
	RegressionAUROC: 0.41809535026550293
	RegressionCompetitionScore: 0.06257668711656442



Validation scores:
	RegressionAUROC: 0.4187285304069519
	RegressionCompetitionScore: 0.06349693251533742

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.261. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.06319018404907975
     Test RegressionAUROC            0.4153134226799011
Test RegressionCompetitionScore      0.06319018404907975
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 04:51:04,022][0m Trial 500 finished with value: 0.06319018404907975 and parameters: {'lr': 1.45316878847124e-07, 'dropout': 0.40778436149206426, 'd_model_multiplier': 1, 'num_layers': 8, 'n_heads': 32, 'dim_feedforward': 64, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004988008427920235, 'dropout': 0.45650064754948516, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 166, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 33.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
33.0 K    Trainable params
0         Non-trainable params
33.0 K    Total params
0.132     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6370590329170227
	RegressionCompetitionScore: 0.1285276073619632

Metric val_loss improved. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.691148042678833
	RegressionCompetitionScore: 0.30552147239263805

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7008446455001831
	RegressionCompetitionScore: 0.24386503067484663

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7026751637458801
	RegressionCompetitionScore: 0.3015337423312883



Validation scores:
	RegressionAUROC: 0.7175724506378174
	RegressionCompetitionScore: 0.3193251533742331



Validation scores:
	RegressionAUROC: 0.7209267616271973
	RegressionCompetitionScore: 0.3294478527607362

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.733784556388855
	RegressionCompetitionScore: 0.38588957055214723



Validation scores:
	RegressionAUROC: 0.7047765254974365
	RegressionCompetitionScore: 0.36687116564417177



Validation scores:
	RegressionAUROC: 0.7363511919975281
	RegressionCompetitionScore: 0.35245398773006137



Validation scores:
	RegressionAUROC: 0.7430819272994995
	RegressionCompetitionScore: 0.3273006134969325



Validation scores:
	RegressionAUROC: 0.7378894686698914
	RegressionCompetitionScore: 0.3220858895705521

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7535812258720398
	RegressionCompetitionScore: 0.37852760736196317

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7671952247619629
	RegressionCompetitionScore: 0.38220858895705523



Validation scores:
	RegressionAUROC: 0.7604543566703796
	RegressionCompetitionScore: 0.39631901840490796



Validation scores:
	RegressionAUROC: 0.7753385305404663
	RegressionCompetitionScore: 0.3803680981595092



Validation scores:
	RegressionAUROC: 0.7682217955589294
	RegressionCompetitionScore: 0.3726993865030675

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7760381698608398
	RegressionCompetitionScore: 0.4165644171779141



Validation scores:
	RegressionAUROC: 0.7694090604782104
	RegressionCompetitionScore: 0.39969325153374236



Validation scores:
	RegressionAUROC: 0.7634097337722778
	RegressionCompetitionScore: 0.4039877300613497



Validation scores:
	RegressionAUROC: 0.7858445644378662
	RegressionCompetitionScore: 0.41779141104294476



Validation scores:
	RegressionAUROC: 0.7759101390838623
	RegressionCompetitionScore: 0.3960122699386503



Validation scores:
	RegressionAUROC: 0.796290397644043
	RegressionCompetitionScore: 0.4116564417177914

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.153


Validation scores:
	RegressionAUROC: 0.784439206123352
	RegressionCompetitionScore: 0.43098159509202455



Validation scores:
	RegressionAUROC: 0.7791604995727539
	RegressionCompetitionScore: 0.4171779141104294



Validation scores:
	RegressionAUROC: 0.8033403158187866
	RegressionCompetitionScore: 0.4269938650306748



Validation scores:
	RegressionAUROC: 0.7925980091094971
	RegressionCompetitionScore: 0.42484662576687116



Validation scores:
	RegressionAUROC: 0.7873814105987549
	RegressionCompetitionScore: 0.4174846625766871



Validation scores:
	RegressionAUROC: 0.7759085893630981
	RegressionCompetitionScore: 0.4361963190184049



Validation scores:
	RegressionAUROC: 0.7689882516860962
	RegressionCompetitionScore: 0.4190184049079755

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.153. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4116564417177914
     Test RegressionAUROC             0.796290397644043
Test RegressionCompetitionScore      0.4116564417177914
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 05:02:30,261][0m Trial 501 finished with value: 0.4116564417177914 and parameters: {'lr': 0.0004988008427920235, 'dropout': 0.45650064754948516, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 166, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0001486323279286288, 'dropout': 0.679554512321859, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 629, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 100 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
100 K     Trainable params
0         Non-trainable params
100 K     Total params
0.403     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.2753623127937317
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.5127776861190796
	RegressionCompetitionScore: 0.11319018404907975

Metric val_loss improved. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5513597726821899
	RegressionCompetitionScore: 0.10153374233128834



Validation scores:
	RegressionAUROC: 0.5226182341575623
	RegressionCompetitionScore: 0.1



Validation scores:
	RegressionAUROC: 0.5766111016273499
	RegressionCompetitionScore: 0.0892638036809816



Validation scores:
	RegressionAUROC: 0.6678996086120605
	RegressionCompetitionScore: 0.1441717791411043



Validation scores:
	RegressionAUROC: 0.66945481300354
	RegressionCompetitionScore: 0.1273006134969325



Validation scores:
	RegressionAUROC: 0.6723694205284119
	RegressionCompetitionScore: 0.21012269938650308



Validation scores:
	RegressionAUROC: 0.672528862953186
	RegressionCompetitionScore: 0.10460122699386504

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.210. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.11319018404907975
     Test RegressionAUROC            0.5127776861190796
Test RegressionCompetitionScore      0.11319018404907975
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 05:05:59,856][0m Trial 502 finished with value: 0.11319018404907975 and parameters: {'lr': 0.0001486323279286288, 'dropout': 0.679554512321859, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 629, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00035539978156613896, 'dropout': 0.7559362491939052, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 151, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 26.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
26.5 K    Trainable params
0         Non-trainable params
26.5 K    Total params
0.106     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5373431444168091
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.436


Validation scores:
	RegressionAUROC: 0.5512439608573914
	RegressionCompetitionScore: 0.12822085889570553

Metric val_loss improved by 0.176 >= min_delta = 0.0. New best score: 0.260


Validation scores:
	RegressionAUROC: 0.49576884508132935
	RegressionCompetitionScore: 0.06349693251533742



Validation scores:
	RegressionAUROC: 0.533436119556427
	RegressionCompetitionScore: 0.10644171779141104

Metric val_loss improved by 0.044 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.5476206541061401
	RegressionCompetitionScore: 0.12085889570552147



Validation scores:
	RegressionAUROC: 0.5029727816581726
	RegressionCompetitionScore: 0.06687116564417178



Validation scores:
	RegressionAUROC: 0.4857717752456665
	RegressionCompetitionScore: 0.06441717791411043

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5189520120620728
	RegressionCompetitionScore: 0.07331288343558282



Validation scores:
	RegressionAUROC: 0.5533055067062378
	RegressionCompetitionScore: 0.09417177914110429

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5707558989524841
	RegressionCompetitionScore: 0.10950920245398774

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.5910307765007019
	RegressionCompetitionScore: 0.12423312883435583



Validation scores:
	RegressionAUROC: 0.6067219972610474
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6371855139732361
	RegressionCompetitionScore: 0.20122699386503068



Validation scores:
	RegressionAUROC: 0.6555861234664917
	RegressionCompetitionScore: 0.24447852760736197

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6449248194694519
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6236536502838135
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6527932286262512
	RegressionCompetitionScore: 0.29233128834355826



Validation scores:
	RegressionAUROC: 0.6544157266616821
	RegressionCompetitionScore: 0.29754601226993865



Validation scores:
	RegressionAUROC: 0.6535806655883789
	RegressionCompetitionScore: 0.293558282208589



Validation scores:
	RegressionAUROC: 0.6575092077255249
	RegressionCompetitionScore: 0.29662576687116565



Validation scores:
	RegressionAUROC: 0.6015193462371826
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.204. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.24447852760736197
     Test RegressionAUROC            0.6555861234664917
Test RegressionCompetitionScore      0.24447852760736197
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 05:14:17,270][0m Trial 503 finished with value: 0.24447852760736197 and parameters: {'lr': 0.00035539978156613896, 'dropout': 0.7559362491939052, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 151, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 9.4758624950872e-05, 'dropout': 0.47241337786463106, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 130, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 71.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
71.3 K    Trainable params
0         Non-trainable params
71.3 K    Total params
0.285     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4637680947780609
	RegressionCompetitionScore: 0.34782608695652173



Validation scores:
	RegressionAUROC: 0.6846445798873901
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.229


Validation scores:
	RegressionAUROC: 0.6929463744163513
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6978697180747986
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7173715233802795
	RegressionCompetitionScore: 0.2665644171779141

Metric val_loss improved by 0.044 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7192656993865967
	RegressionCompetitionScore: 0.30828220858895705

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7204663753509521
	RegressionCompetitionScore: 0.2812883435582822



Validation scores:
	RegressionAUROC: 0.7372947931289673
	RegressionCompetitionScore: 0.32331288343558284



Validation scores:
	RegressionAUROC: 0.7360447645187378
	RegressionCompetitionScore: 0.3291411042944785



Validation scores:
	RegressionAUROC: 0.7467433214187622
	RegressionCompetitionScore: 0.3567484662576687



Validation scores:
	RegressionAUROC: 0.7446396946907043
	RegressionCompetitionScore: 0.34754601226993864



Validation scores:
	RegressionAUROC: 0.7460471391677856
	RegressionCompetitionScore: 0.3245398773006135

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7501581907272339
	RegressionCompetitionScore: 0.3294478527607362

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7576326131820679
	RegressionCompetitionScore: 0.36595092024539877



Validation scores:
	RegressionAUROC: 0.7515860795974731
	RegressionCompetitionScore: 0.3371165644171779



Validation scores:
	RegressionAUROC: 0.7622271180152893
	RegressionCompetitionScore: 0.35337423312883437



Validation scores:
	RegressionAUROC: 0.7554255723953247
	RegressionCompetitionScore: 0.3521472392638037



Validation scores:
	RegressionAUROC: 0.7607463598251343
	RegressionCompetitionScore: 0.37944785276073617



Validation scores:
	RegressionAUROC: 0.754173755645752
	RegressionCompetitionScore: 0.36687116564417177



Validation scores:
	RegressionAUROC: 0.7593556642532349
	RegressionCompetitionScore: 0.3815950920245399

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.170. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3294478527607362
     Test RegressionAUROC            0.7501581907272339
Test RegressionCompetitionScore      0.3294478527607362
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 05:22:01,403][0m Trial 504 finished with value: 0.3294478527607362 and parameters: {'lr': 9.4758624950872e-05, 'dropout': 0.47241337786463106, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 32, 'dim_feedforward': 130, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0006353855251832381, 'dropout': 0.5005043094219435, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 665, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 93.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
93.4 K    Trainable params
0         Non-trainable params
93.4 K    Total params
0.374     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.43478256464004517
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.5138418078422546
	RegressionCompetitionScore: 0.0696319018404908

Metric val_loss improved. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.583258867263794
	RegressionCompetitionScore: 0.12392638036809817



Validation scores:
	RegressionAUROC: 0.5740070939064026
	RegressionCompetitionScore: 0.10276073619631902



Validation scores:
	RegressionAUROC: 0.5440952777862549
	RegressionCompetitionScore: 0.07638036809815951



Validation scores:
	RegressionAUROC: 0.5595394372940063
	RegressionCompetitionScore: 0.08496932515337423



Validation scores:
	RegressionAUROC: 0.4473113417625427
	RegressionCompetitionScore: 0.11441717791411044

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.6066133379936218
	RegressionCompetitionScore: 0.21809815950920244



Validation scores:
	RegressionAUROC: 0.43923383951187134
	RegressionCompetitionScore: 0.12822085889570553



Validation scores:
	RegressionAUROC: 0.6010589599609375
	RegressionCompetitionScore: 0.22760736196319017



Validation scores:
	RegressionAUROC: 0.6100326776504517
	RegressionCompetitionScore: 0.22423312883435584



Validation scores:
	RegressionAUROC: 0.5997559428215027
	RegressionCompetitionScore: 0.2322085889570552



Validation scores:
	RegressionAUROC: 0.6032595634460449
	RegressionCompetitionScore: 0.23742331288343557



Validation scores:
	RegressionAUROC: 0.5671167373657227
	RegressionCompetitionScore: 0.10245398773006135

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.210. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.11441717791411044
     Test RegressionAUROC            0.4473113417625427
Test RegressionCompetitionScore      0.11441717791411044
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 05:27:27,532][0m Trial 505 finished with value: 0.11441717791411044 and parameters: {'lr': 0.0006353855251832381, 'dropout': 0.5005043094219435, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 665, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.020616937043014826, 'dropout': 0.40008057457005014, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 64, 'dim_feedforward': 188, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 198 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
198 K     Trainable params
0         Non-trainable params
198 K     Total params
0.795     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5869565010070801
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 877.983


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 876.403 >= min_delta = 0.0. New best score: 1.580


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5316541194915771
	RegressionCompetitionScore: 0.07484662576687116

Metric val_loss improved by 1.287 >= min_delta = 0.0. New best score: 0.293


Validation scores:
	RegressionAUROC: 0.4763096570968628
	RegressionCompetitionScore: 0.043558282208588955

Metric val_loss improved by 0.083 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4849507808685303
	RegressionCompetitionScore: 0.036503067484662574



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4889272451400757
	RegressionCompetitionScore: 0.06717791411042945

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5040591955184937
	RegressionCompetitionScore: 0.06441717791411043



Validation scores:
	RegressionAUROC: 0.47933924198150635
	RegressionCompetitionScore: 0.03987730061349693



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.48607775568962097
	RegressionCompetitionScore: 0.04815950920245399



Validation scores:
	RegressionAUROC: 0.48574674129486084
	RegressionCompetitionScore: 0.044171779141104296



Validation scores:
	RegressionAUROC: 0.4782314598560333
	RegressionCompetitionScore: 0.02883435582822086



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.06717791411042945
     Test RegressionAUROC            0.4889272451400757
Test RegressionCompetitionScore      0.06717791411042945
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 05:36:32,486][0m Trial 506 finished with value: 0.06717791411042945 and parameters: {'lr': 0.020616937043014826, 'dropout': 0.40008057457005014, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 64, 'dim_feedforward': 188, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0008569312382964612, 'dropout': 0.6532780176729642, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 210, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 43.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
43.1 K    Trainable params
0         Non-trainable params
43.1 K    Total params
0.172     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3526569604873657
	RegressionCompetitionScore: 0.13043478260869565



Validation scores:
	RegressionAUROC: 0.5429040193557739
	RegressionCompetitionScore: 0.09110429447852761

Metric val_loss improved. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.590324878692627
	RegressionCompetitionScore: 0.13650306748466257

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6348723769187927
	RegressionCompetitionScore: 0.27269938650306746



Validation scores:
	RegressionAUROC: 0.6346979141235352
	RegressionCompetitionScore: 0.28282208588957053



Validation scores:
	RegressionAUROC: 0.6392982006072998
	RegressionCompetitionScore: 0.29478527607361965



Validation scores:
	RegressionAUROC: 0.6768363118171692
	RegressionCompetitionScore: 0.31012269938650305



Validation scores:
	RegressionAUROC: 0.7057466506958008
	RegressionCompetitionScore: 0.33957055214723925



Validation scores:
	RegressionAUROC: 0.7009032964706421
	RegressionCompetitionScore: 0.345398773006135



Validation scores:
	RegressionAUROC: 0.7028663754463196
	RegressionCompetitionScore: 0.3423312883435583

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.206. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.13650306748466257
     Test RegressionAUROC             0.590324878692627
Test RegressionCompetitionScore      0.13650306748466257
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 05:40:23,590][0m Trial 507 finished with value: 0.13650306748466257 and parameters: {'lr': 0.0008569312382964612, 'dropout': 0.6532780176729642, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 210, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 1.6879828129341393e-05, 'dropout': 0.6616510563556618, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 110, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 36.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
36.8 K    Trainable params
0         Non-trainable params
36.8 K    Total params
0.147     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3526569604873657
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5679364204406738
	RegressionCompetitionScore: 0.16533742331288342

Metric val_loss improved. New best score: 0.337


Validation scores:
	RegressionAUROC: 0.5813149213790894
	RegressionCompetitionScore: 0.18588957055214725

Metric val_loss improved by 0.062 >= min_delta = 0.0. New best score: 0.275


Validation scores:
	RegressionAUROC: 0.5839531421661377
	RegressionCompetitionScore: 0.16533742331288342



Validation scores:
	RegressionAUROC: 0.5888974666595459
	RegressionCompetitionScore: 0.13588957055214723

Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: 0.256


Validation scores:
	RegressionAUROC: 0.5845516920089722
	RegressionCompetitionScore: 0.10858895705521472



Validation scores:
	RegressionAUROC: 0.5921501517295837
	RegressionCompetitionScore: 0.1147239263803681



Validation scores:
	RegressionAUROC: 0.5634064674377441
	RegressionCompetitionScore: 0.06717791411042945

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.240


Validation scores:
	RegressionAUROC: 0.5115237832069397
	RegressionCompetitionScore: 0.05276073619631902

Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.5267722010612488
	RegressionCompetitionScore: 0.05276073619631902



Validation scores:
	RegressionAUROC: 0.5486984252929688
	RegressionCompetitionScore: 0.05705521472392638

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5962378978729248
	RegressionCompetitionScore: 0.09325153374233129



Validation scores:
	RegressionAUROC: 0.6006943583488464
	RegressionCompetitionScore: 0.10398773006134969



Validation scores:
	RegressionAUROC: 0.6039575338363647
	RegressionCompetitionScore: 0.11871165644171779



Validation scores:
	RegressionAUROC: 0.6130194664001465
	RegressionCompetitionScore: 0.1579754601226994



Validation scores:
	RegressionAUROC: 0.6122887134552002
	RegressionCompetitionScore: 0.1423312883435583



Validation scores:
	RegressionAUROC: 0.6213647127151489
	RegressionCompetitionScore: 0.1521472392638037



Validation scores:
	RegressionAUROC: 0.6241351366043091
	RegressionCompetitionScore: 0.13987730061349693

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.213. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.05705521472392638
     Test RegressionAUROC            0.5486984252929688
Test RegressionCompetitionScore      0.05705521472392638
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 05:47:07,914][0m Trial 508 finished with value: 0.05705521472392638 and parameters: {'lr': 1.6879828129341393e-05, 'dropout': 0.6616510563556618, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 110, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 3.053325915691071e-07, 'dropout': 0.5831630233660676, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 160, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 90.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
90.0 K    Trainable params
0         Non-trainable params
90.0 K    Total params
0.360     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.555555522441864
	RegressionCompetitionScore: 0.34782608695652173



Validation scores:
	RegressionAUROC: 0.400505930185318
	RegressionCompetitionScore: 0.0558282208588957

Metric val_loss improved. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.40189194679260254
	RegressionCompetitionScore: 0.0549079754601227



Validation scores:
	RegressionAUROC: 0.40268367528915405
	RegressionCompetitionScore: 0.05460122699386503



Validation scores:
	RegressionAUROC: 0.4043692350387573
	RegressionCompetitionScore: 0.05368098159509203



Validation scores:
	RegressionAUROC: 0.40505748987197876
	RegressionCompetitionScore: 0.05460122699386503



Validation scores:
	RegressionAUROC: 0.4058453142642975
	RegressionCompetitionScore: 0.05521472392638037



Validation scores:
	RegressionAUROC: 0.4075391888618469
	RegressionCompetitionScore: 0.055521472392638035



Validation scores:
	RegressionAUROC: 0.40893423557281494
	RegressionCompetitionScore: 0.056134969325153376

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.227. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.0558282208588957
     Test RegressionAUROC             0.400505930185318
Test RegressionCompetitionScore      0.0558282208588957
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 05:50:38,584][0m Trial 509 finished with value: 0.0558282208588957 and parameters: {'lr': 3.053325915691071e-07, 'dropout': 0.5831630233660676, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 160, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00023405010655931763, 'dropout': 0.43983004534177256, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 240, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 45.6 K
1 | loss_fn | MSELoss | 0     
------------------------------------
45.6 K    Trainable params
0         Non-trainable params
45.6 K    Total params
0.183     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4106280207633972
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.39344316720962524
	RegressionCompetitionScore: 0.07883435582822086

Metric val_loss improved. New best score: 0.285


Validation scores:
	RegressionAUROC: 0.5002054572105408
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.49867185950279236
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5031469464302063
	RegressionCompetitionScore: 0.08711656441717791

Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: 0.248


Validation scores:
	RegressionAUROC: 0.5372428894042969
	RegressionCompetitionScore: 0.08987730061349693

Metric val_loss improved by 0.038 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6100944876670837
	RegressionCompetitionScore: 0.10214723926380367

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6503141522407532
	RegressionCompetitionScore: 0.17576687116564418



Validation scores:
	RegressionAUROC: 0.6526181697845459
	RegressionCompetitionScore: 0.2432515337423313



Validation scores:
	RegressionAUROC: 0.6502567529678345
	RegressionCompetitionScore: 0.24969325153374233



Validation scores:
	RegressionAUROC: 0.652779757976532
	RegressionCompetitionScore: 0.2361963190184049



Validation scores:
	RegressionAUROC: 0.6578937768936157
	RegressionCompetitionScore: 0.2



Validation scores:
	RegressionAUROC: 0.6618285179138184
	RegressionCompetitionScore: 0.23680981595092024



Validation scores:
	RegressionAUROC: 0.6611173152923584
	RegressionCompetitionScore: 0.26809815950920246

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.10214723926380367
     Test RegressionAUROC            0.6100944876670837
Test RegressionCompetitionScore      0.10214723926380367
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 05:55:51,354][0m Trial 510 finished with value: 0.10214723926380367 and parameters: {'lr': 0.00023405010655931763, 'dropout': 0.43983004534177256, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 240, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004193774042202858, 'dropout': 0.6039951924395663, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 136, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 28.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
28.9 K    Trainable params
0         Non-trainable params
28.9 K    Total params
0.115     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4637681245803833
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.538763701915741
	RegressionCompetitionScore: 0.08558282208588958

Metric val_loss improved. New best score: 0.260


Validation scores:
	RegressionAUROC: 0.6299649477005005
	RegressionCompetitionScore: 0.14785276073619633

Metric val_loss improved by 0.055 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6533852815628052
	RegressionCompetitionScore: 0.07760736196319018



Validation scores:
	RegressionAUROC: 0.6559120416641235
	RegressionCompetitionScore: 0.10214723926380367



Validation scores:
	RegressionAUROC: 0.6396523714065552
	RegressionCompetitionScore: 0.30644171779141105

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.7074828147888184
	RegressionCompetitionScore: 0.3085889570552147

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6946519613265991
	RegressionCompetitionScore: 0.30828220858895705



Validation scores:
	RegressionAUROC: 0.7036962509155273
	RegressionCompetitionScore: 0.3122699386503067



Validation scores:
	RegressionAUROC: 0.7149353623390198
	RegressionCompetitionScore: 0.3506134969325153



Validation scores:
	RegressionAUROC: 0.7365700602531433
	RegressionCompetitionScore: 0.35644171779141104



Validation scores:
	RegressionAUROC: 0.7313364744186401
	RegressionCompetitionScore: 0.3530674846625767

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7345070838928223
	RegressionCompetitionScore: 0.37024539877300616



Validation scores:
	RegressionAUROC: 0.7426645755767822
	RegressionCompetitionScore: 0.38926380368098157

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7391754388809204
	RegressionCompetitionScore: 0.37852760736196317



Validation scores:
	RegressionAUROC: 0.7385475635528564
	RegressionCompetitionScore: 0.38312883435582823



Validation scores:
	RegressionAUROC: 0.7446437478065491
	RegressionCompetitionScore: 0.4125766871165644



Validation scores:
	RegressionAUROC: 0.7522871494293213
	RegressionCompetitionScore: 0.39478527607361963



Validation scores:
	RegressionAUROC: 0.7475917339324951
	RegressionCompetitionScore: 0.3696319018404908



Validation scores:
	RegressionAUROC: 0.7593324184417725
	RegressionCompetitionScore: 0.37116564417177916



Validation scores:
	RegressionAUROC: 0.7524235844612122
	RegressionCompetitionScore: 0.36809815950920244

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38926380368098157
     Test RegressionAUROC            0.7426645755767822
Test RegressionCompetitionScore      0.38926380368098157
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 06:03:29,532][0m Trial 511 finished with value: 0.38926380368098157 and parameters: {'lr': 0.0004193774042202858, 'dropout': 0.6039951924395663, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 136, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.001526238066972806, 'dropout': 0.5386895024186955, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 598, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 34.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
34.1 K    Trainable params
0         Non-trainable params
34.1 K    Total params
0.136     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.33816424012184143
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.6504807472229004
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.360


Validation scores:
	RegressionAUROC: 0.5301899313926697
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4998466372489929
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5488009452819824
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6820647716522217
	RegressionCompetitionScore: 0.2766871165644172

Metric val_loss improved by 0.092 >= min_delta = 0.0. New best score: 0.267


Validation scores:
	RegressionAUROC: 0.5173699855804443
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5061404705047607
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5010242462158203
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5422015190124512
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.267. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2766871165644172
     Test RegressionAUROC            0.6820647716522217
Test RegressionCompetitionScore      0.2766871165644172
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 06:08:15,348][0m Trial 512 finished with value: 0.2766871165644172 and parameters: {'lr': 0.001526238066972806, 'dropout': 0.5386895024186955, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 598, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005586955110337202, 'dropout': 0.42627600271500116, 'd_model_multiplier': 32, 'num_layers': 7, 'n_heads': 4, 'dim_feedforward': 118, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 812 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
812 K     Trainable params
0         Non-trainable params
812 K     Total params
3.252     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3854166865348816
	RegressionCompetitionScore: 0.08333333333333333



Validation scores:
	RegressionAUROC: 0.5908194184303284
	RegressionCompetitionScore: 0.0794478527607362

Metric val_loss improved. New best score: 0.337


Validation scores:
	RegressionAUROC: 0.6646394729614258
	RegressionCompetitionScore: 0.18865030674846625

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.336


Validation scores:
	RegressionAUROC: 0.6183170080184937
	RegressionCompetitionScore: 0.19570552147239265

Metric val_loss improved by 0.126 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.626011312007904
	RegressionCompetitionScore: 0.3039877300613497



Validation scores:
	RegressionAUROC: 0.6591005325317383
	RegressionCompetitionScore: 0.2263803680981595



Validation scores:
	RegressionAUROC: 0.6098580360412598
	RegressionCompetitionScore: 0.07883435582822086



Validation scores:
	RegressionAUROC: 0.6377736330032349
	RegressionCompetitionScore: 0.23190184049079754

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.560761034488678
	RegressionCompetitionScore: 0.1116564417177914



Validation scores:
	RegressionAUROC: 0.6777993440628052
	RegressionCompetitionScore: 0.2634969325153374



Validation scores:
	RegressionAUROC: 0.6141607761383057
	RegressionCompetitionScore: 0.21196319018404908



Validation scores:
	RegressionAUROC: 0.5846301913261414
	RegressionCompetitionScore: 0.22024539877300614



Validation scores:
	RegressionAUROC: 0.5916252732276917
	RegressionCompetitionScore: 0.19723926380368098



Validation scores:
	RegressionAUROC: 0.6012265086174011
	RegressionCompetitionScore: 0.20552147239263804



Validation scores:
	RegressionAUROC: 0.5806414484977722
	RegressionCompetitionScore: 0.18527607361963191

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.23190184049079754
     Test RegressionAUROC            0.6377736330032349
Test RegressionCompetitionScore      0.23190184049079754
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 06:14:12,825][0m Trial 513 finished with value: 0.23190184049079754 and parameters: {'lr': 0.0005586955110337202, 'dropout': 0.42627600271500116, 'd_model_multiplier': 32, 'num_layers': 7, 'n_heads': 4, 'dim_feedforward': 118, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.001079605817433469, 'dropout': 0.5110477583190384, 'd_model_multiplier': 2, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 181, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 52.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
52.4 K    Trainable params
0         Non-trainable params
52.4 K    Total params
0.209     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6588749885559082
	RegressionCompetitionScore: 0.24723926380368097

Metric val_loss improved. New best score: 0.263


Validation scores:
	RegressionAUROC: 0.660228967666626
	RegressionCompetitionScore: 0.20736196319018405

Metric val_loss improved by 0.045 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.6887455582618713
	RegressionCompetitionScore: 0.27392638036809813

Metric val_loss improved by 0.030 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.6942059397697449
	RegressionCompetitionScore: 0.2920245398773006



Validation scores:
	RegressionAUROC: 0.6956206560134888
	RegressionCompetitionScore: 0.18190184049079755



Validation scores:
	RegressionAUROC: 0.6863898038864136
	RegressionCompetitionScore: 0.2156441717791411



Validation scores:
	RegressionAUROC: 0.6811020374298096
	RegressionCompetitionScore: 0.249079754601227



Validation scores:
	RegressionAUROC: 0.6830014586448669
	RegressionCompetitionScore: 0.1156441717791411



Validation scores:
	RegressionAUROC: 0.6998929381370544
	RegressionCompetitionScore: 0.25398773006134967



Validation scores:
	RegressionAUROC: 0.6292118430137634
	RegressionCompetitionScore: 0.1285276073619632

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.188. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.27392638036809813
     Test RegressionAUROC            0.6887455582618713
Test RegressionCompetitionScore      0.27392638036809813
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 06:18:15,481][0m Trial 514 finished with value: 0.27392638036809813 and parameters: {'lr': 0.001079605817433469, 'dropout': 0.5110477583190384, 'd_model_multiplier': 2, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 181, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00029427503476172587, 'dropout': 0.8166046672102601, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 32, 'dim_feedforward': 91, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 97.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
97.1 K    Trainable params
0         Non-trainable params
97.1 K    Total params
0.389     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.578072726726532
	RegressionCompetitionScore: 0.2361963190184049

Metric val_loss improved. New best score: 0.453


Validation scores:
	RegressionAUROC: 0.5956770181655884
	RegressionCompetitionScore: 0.2579754601226994

Metric val_loss improved by 0.074 >= min_delta = 0.0. New best score: 0.379


Validation scores:
	RegressionAUROC: 0.58562171459198
	RegressionCompetitionScore: 0.251840490797546

Metric val_loss improved by 0.050 >= min_delta = 0.0. New best score: 0.329


Validation scores:
	RegressionAUROC: 0.5840071439743042
	RegressionCompetitionScore: 0.248159509202454

Metric val_loss improved by 0.044 >= min_delta = 0.0. New best score: 0.285


Validation scores:
	RegressionAUROC: 0.6282370090484619
	RegressionCompetitionScore: 0.2852760736196319

Metric val_loss improved by 0.033 >= min_delta = 0.0. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.599637508392334
	RegressionCompetitionScore: 0.26625766871165646

Metric val_loss improved by 0.027 >= min_delta = 0.0. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.6098906397819519
	RegressionCompetitionScore: 0.2579754601226994



Validation scores:
	RegressionAUROC: 0.6056837439537048
	RegressionCompetitionScore: 0.2714723926380368

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.6158462762832642
	RegressionCompetitionScore: 0.26411042944785273



Validation scores:
	RegressionAUROC: 0.6218146681785583
	RegressionCompetitionScore: 0.16932515337423312



Validation scores:
	RegressionAUROC: 0.5679596066474915
	RegressionCompetitionScore: 0.09294478527607362

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.4880768656730652
	RegressionCompetitionScore: 0.10245398773006135

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.4148738384246826
	RegressionCompetitionScore: 0.10521472392638037

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.40576013922691345
	RegressionCompetitionScore: 0.10521472392638037



Validation scores:
	RegressionAUROC: 0.4047980308532715
	RegressionCompetitionScore: 0.10368098159509202



Validation scores:
	RegressionAUROC: 0.39711713790893555
	RegressionCompetitionScore: 0.09539877300613497

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.41494742035865784
	RegressionCompetitionScore: 0.10337423312883436



Validation scores:
	RegressionAUROC: 0.4410584270954132
	RegressionCompetitionScore: 0.10306748466257669



Validation scores:
	RegressionAUROC: 0.45000407099723816
	RegressionCompetitionScore: 0.11134969325153374



Validation scores:
	RegressionAUROC: 0.429095983505249
	RegressionCompetitionScore: 0.10920245398773006



Validation scores:
	RegressionAUROC: 0.4311698079109192
	RegressionCompetitionScore: 0.11042944785276074



Validation scores:
	RegressionAUROC: 0.45909297466278076
	RegressionCompetitionScore: 0.1098159509202454



Validation scores:
	RegressionAUROC: 0.4497370719909668
	RegressionCompetitionScore: 0.1067484662576687

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.210. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.09539877300613497
     Test RegressionAUROC            0.39711713790893555
Test RegressionCompetitionScore      0.09539877300613497
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 06:29:05,407][0m Trial 515 finished with value: 0.09539877300613497 and parameters: {'lr': 0.00029427503476172587, 'dropout': 0.8166046672102601, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 32, 'dim_feedforward': 91, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0006955152574871983, 'dropout': 0.5647823324438015, 'd_model_multiplier': 8, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 148, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 291 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
291 K     Trainable params
0         Non-trainable params
291 K     Total params
1.165     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.48792266845703125
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.886


Validation scores:
	RegressionAUROC: 0.6444041728973389
	RegressionCompetitionScore: 0.28957055214723926

Metric val_loss improved by 0.671 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.6775226593017578
	RegressionCompetitionScore: 0.2794478527607362



Validation scores:
	RegressionAUROC: 0.6866212487220764
	RegressionCompetitionScore: 0.2843558282208589

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.5564687848091125
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.688987672328949
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5710155963897705
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6698336005210876
	RegressionCompetitionScore: 0.30552147239263805



Validation scores:
	RegressionAUROC: 0.6420681476593018
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6661663055419922
	RegressionCompetitionScore: 0.1116564417177914



Validation scores:
	RegressionAUROC: 0.5544346570968628
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.196. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2843558282208589
     Test RegressionAUROC            0.6866212487220764
Test RegressionCompetitionScore      0.2843558282208589
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 06:33:34,733][0m Trial 516 finished with value: 0.2843558282208589 and parameters: {'lr': 0.0006955152574871983, 'dropout': 0.5647823324438015, 'd_model_multiplier': 8, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 148, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 4.59641660677805e-05, 'dropout': 0.44810009547864976, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 438, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 39.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
39.1 K    Trainable params
0         Non-trainable params
39.1 K    Total params
0.157     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4589371681213379
	RegressionCompetitionScore: 0.043478260869565216



Validation scores:
	RegressionAUROC: 0.5715330839157104
	RegressionCompetitionScore: 0.12024539877300613

Metric val_loss improved. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5979358553886414
	RegressionCompetitionScore: 0.1325153374233129

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6495242714881897
	RegressionCompetitionScore: 0.2723926380368098

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6681452989578247
	RegressionCompetitionScore: 0.30214723926380366



Validation scores:
	RegressionAUROC: 0.6782499551773071
	RegressionCompetitionScore: 0.30828220858895705

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6875200271606445
	RegressionCompetitionScore: 0.31809815950920245

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.6913039684295654
	RegressionCompetitionScore: 0.3024539877300613

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.6901893615722656
	RegressionCompetitionScore: 0.3039877300613497

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.707163393497467
	RegressionCompetitionScore: 0.3469325153374233



Validation scores:
	RegressionAUROC: 0.7119433283805847
	RegressionCompetitionScore: 0.3521472392638037



Validation scores:
	RegressionAUROC: 0.7168697118759155
	RegressionCompetitionScore: 0.35

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7204883098602295
	RegressionCompetitionScore: 0.346319018404908

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7259377241134644
	RegressionCompetitionScore: 0.35337423312883437



Validation scores:
	RegressionAUROC: 0.7252033352851868
	RegressionCompetitionScore: 0.36012269938650304

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7283827066421509
	RegressionCompetitionScore: 0.36687116564417177

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7305271029472351
	RegressionCompetitionScore: 0.3852760736196319



Validation scores:
	RegressionAUROC: 0.7322227358818054
	RegressionCompetitionScore: 0.37607361963190183

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7314420938491821
	RegressionCompetitionScore: 0.38650306748466257



Validation scores:
	RegressionAUROC: 0.7405154705047607
	RegressionCompetitionScore: 0.37331288343558283

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7518907189369202
	RegressionCompetitionScore: 0.3923312883435583



Validation scores:
	RegressionAUROC: 0.7494734525680542
	RegressionCompetitionScore: 0.38006134969325156

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7539575099945068
	RegressionCompetitionScore: 0.37331288343558283

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7506470084190369
	RegressionCompetitionScore: 0.3969325153374233



Validation scores:
	RegressionAUROC: 0.7498663663864136
	RegressionCompetitionScore: 0.3923312883435583



Validation scores:
	RegressionAUROC: 0.760288417339325
	RegressionCompetitionScore: 0.3871165644171779



Validation scores:
	RegressionAUROC: 0.761803388595581
	RegressionCompetitionScore: 0.4110429447852761

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.170


Validation scores:
	RegressionAUROC: 0.7578129768371582
	RegressionCompetitionScore: 0.4092024539877301

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7587190866470337
	RegressionCompetitionScore: 0.38404907975460123



Validation scores:
	RegressionAUROC: 0.7623650431632996
	RegressionCompetitionScore: 0.4144171779141104



Validation scores:
	RegressionAUROC: 0.7768850326538086
	RegressionCompetitionScore: 0.4119631901840491



Validation scores:
	RegressionAUROC: 0.7700273990631104
	RegressionCompetitionScore: 0.405521472392638

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7750341296195984
	RegressionCompetitionScore: 0.39754601226993863

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.167


Validation scores:
	RegressionAUROC: 0.7693359851837158
	RegressionCompetitionScore: 0.4138036809815951

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.166


Validation scores:
	RegressionAUROC: 0.7753459811210632
	RegressionCompetitionScore: 0.4138036809815951

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.165


Validation scores:
	RegressionAUROC: 0.7828623056411743
	RegressionCompetitionScore: 0.41319018404907976



Validation scores:
	RegressionAUROC: 0.78249192237854
	RegressionCompetitionScore: 0.4263803680981595



Validation scores:
	RegressionAUROC: 0.7778757810592651
	RegressionCompetitionScore: 0.4098159509202454



Validation scores:
	RegressionAUROC: 0.7811172008514404
	RegressionCompetitionScore: 0.4058282208588957



Validation scores:
	RegressionAUROC: 0.7771542072296143
	RegressionCompetitionScore: 0.4162576687116564



Validation scores:
	RegressionAUROC: 0.7924144268035889
	RegressionCompetitionScore: 0.4392638036809816



Validation scores:
	RegressionAUROC: 0.7856121063232422
	RegressionCompetitionScore: 0.42024539877300615

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7908653616905212
	RegressionCompetitionScore: 0.4190184049079755

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.159


Validation scores:
	RegressionAUROC: 0.7676354646682739
	RegressionCompetitionScore: 0.4187116564417178



Validation scores:
	RegressionAUROC: 0.7919507026672363
	RegressionCompetitionScore: 0.42116564417177915



Validation scores:
	RegressionAUROC: 0.7996290922164917
	RegressionCompetitionScore: 0.4279141104294479



Validation scores:
	RegressionAUROC: 0.7959456443786621
	RegressionCompetitionScore: 0.42668711656441716



Validation scores:
	RegressionAUROC: 0.796352744102478
	RegressionCompetitionScore: 0.4251533742331288



Validation scores:
	RegressionAUROC: 0.7999114990234375
	RegressionCompetitionScore: 0.4269938650306748



Validation scores:
	RegressionAUROC: 0.8014072179794312
	RegressionCompetitionScore: 0.4420245398773006

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.159. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4190184049079755
     Test RegressionAUROC            0.7908653616905212
Test RegressionCompetitionScore      0.4190184049079755
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 06:51:49,658][0m Trial 517 finished with value: 0.4190184049079755 and parameters: {'lr': 4.59641660677805e-05, 'dropout': 0.44810009547864976, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 438, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00016515686771551865, 'dropout': 0.41633680877923424, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 572, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 83.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
83.9 K    Trainable params
0         Non-trainable params
83.9 K    Total params
0.336     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4492753744125366
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.6283348202705383
	RegressionCompetitionScore: 0.19386503067484662

Metric val_loss improved. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6235476732254028
	RegressionCompetitionScore: 0.2687116564417178



Validation scores:
	RegressionAUROC: 0.6731761693954468
	RegressionCompetitionScore: 0.26411042944785273

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6857165098190308
	RegressionCompetitionScore: 0.254601226993865

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.722649335861206
	RegressionCompetitionScore: 0.32607361963190185

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7410955429077148
	RegressionCompetitionScore: 0.3834355828220859

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.740578830242157
	RegressionCompetitionScore: 0.3665644171779141



Validation scores:
	RegressionAUROC: 0.7485459446907043
	RegressionCompetitionScore: 0.38312883435582823



Validation scores:
	RegressionAUROC: 0.7519797086715698
	RegressionCompetitionScore: 0.37239263803680983



Validation scores:
	RegressionAUROC: 0.7561484575271606
	RegressionCompetitionScore: 0.39631901840490796



Validation scores:
	RegressionAUROC: 0.7551474571228027
	RegressionCompetitionScore: 0.4012269938650307



Validation scores:
	RegressionAUROC: 0.7561742663383484
	RegressionCompetitionScore: 0.39631901840490796



Validation scores:
	RegressionAUROC: 0.7281776666641235
	RegressionCompetitionScore: 0.32515337423312884

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.171. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3834355828220859
     Test RegressionAUROC            0.7410955429077148
Test RegressionCompetitionScore      0.3834355828220859
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 06:57:05,086][0m Trial 518 finished with value: 0.3834355828220859 and parameters: {'lr': 0.00016515686771551865, 'dropout': 0.41633680877923424, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 572, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0004332757018872839, 'dropout': 0.6157702254126365, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 166, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 91.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
91.2 K    Trainable params
0         Non-trainable params
91.2 K    Total params
0.365     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6839120984077454
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.290


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6658550500869751
	RegressionCompetitionScore: 0.2558282208588957

Metric val_loss improved by 0.044 >= min_delta = 0.0. New best score: 0.245


Validation scores:
	RegressionAUROC: 0.6700618267059326
	RegressionCompetitionScore: 0.23190184049079754

Metric val_loss improved by 0.055 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.6878053545951843
	RegressionCompetitionScore: 0.2588957055214724



Validation scores:
	RegressionAUROC: 0.7149619460105896
	RegressionCompetitionScore: 0.29754601226993865



Validation scores:
	RegressionAUROC: 0.7083464860916138
	RegressionCompetitionScore: 0.29386503067484665



Validation scores:
	RegressionAUROC: 0.7183547019958496
	RegressionCompetitionScore: 0.3398773006134969

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7199183702468872
	RegressionCompetitionScore: 0.3598159509202454

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7318050861358643
	RegressionCompetitionScore: 0.3598159509202454

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7094568014144897
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.669029712677002
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7084730267524719
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7382137775421143
	RegressionCompetitionScore: 0.35



Validation scores:
	RegressionAUROC: 0.7473564743995667
	RegressionCompetitionScore: 0.4116564417177914



Validation scores:
	RegressionAUROC: 0.615128219127655
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6474103331565857
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.179. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3598159509202454
     Test RegressionAUROC            0.7318050861358643
Test RegressionCompetitionScore      0.3598159509202454
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 07:04:06,104][0m Trial 519 finished with value: 0.3598159509202454 and parameters: {'lr': 0.0004332757018872839, 'dropout': 0.6157702254126365, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 166, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 9.861355766608533e-07, 'dropout': 0.4857455381315732, 'd_model_multiplier': 16, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 650, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 367 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
367 K     Trainable params
0         Non-trainable params
367 K     Total params
1.470     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.27053138613700867
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.5007279515266418
	RegressionCompetitionScore: 0.0950920245398773

Metric val_loss improved. New best score: 0.230


Validation scores:
	RegressionAUROC: 0.5071638822555542
	RegressionCompetitionScore: 0.09601226993865031



Validation scores:
	RegressionAUROC: 0.5233949422836304
	RegressionCompetitionScore: 0.09938650306748466



Validation scores:
	RegressionAUROC: 0.5464953184127808
	RegressionCompetitionScore: 0.10644171779141104

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.226


Validation scores:
	RegressionAUROC: 0.5706692337989807
	RegressionCompetitionScore: 0.11687116564417178

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.588889479637146
	RegressionCompetitionScore: 0.1254601226993865

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6018267869949341
	RegressionCompetitionScore: 0.13190184049079753

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6152763366699219
	RegressionCompetitionScore: 0.13865030674846626

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6252377033233643
	RegressionCompetitionScore: 0.1450920245398773

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.633099377155304
	RegressionCompetitionScore: 0.1521472392638037

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.6405705809593201
	RegressionCompetitionScore: 0.16717791411042945

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.6490986347198486
	RegressionCompetitionScore: 0.19386503067484662



Validation scores:
	RegressionAUROC: 0.655350923538208
	RegressionCompetitionScore: 0.20398773006134968



Validation scores:
	RegressionAUROC: 0.6608976721763611
	RegressionCompetitionScore: 0.21901840490797547

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.192


Validation scores:
	RegressionAUROC: 0.6650710105895996
	RegressionCompetitionScore: 0.2214723926380368

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.668396532535553
	RegressionCompetitionScore: 0.22607361963190184

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.671252965927124
	RegressionCompetitionScore: 0.23067484662576687

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6736844778060913
	RegressionCompetitionScore: 0.2285276073619632



Validation scores:
	RegressionAUROC: 0.6762220859527588
	RegressionCompetitionScore: 0.2331288343558282



Validation scores:
	RegressionAUROC: 0.6794368028640747
	RegressionCompetitionScore: 0.2549079754601227

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.6817445755004883
	RegressionCompetitionScore: 0.2644171779141104

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.6840364933013916
	RegressionCompetitionScore: 0.27361963190184047



Validation scores:
	RegressionAUROC: 0.6862679719924927
	RegressionCompetitionScore: 0.2794478527607362

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.6881738901138306
	RegressionCompetitionScore: 0.2822085889570552

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.6896674036979675
	RegressionCompetitionScore: 0.28251533742331286

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.6910820007324219
	RegressionCompetitionScore: 0.28282208588957053

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.6922475695610046
	RegressionCompetitionScore: 0.2812883435582822



Validation scores:
	RegressionAUROC: 0.6929758191108704
	RegressionCompetitionScore: 0.2794478527607362



Validation scores:
	RegressionAUROC: 0.6930974125862122
	RegressionCompetitionScore: 0.27791411042944786



Validation scores:
	RegressionAUROC: 0.693486213684082
	RegressionCompetitionScore: 0.2763803680981595



Validation scores:
	RegressionAUROC: 0.694725751876831
	RegressionCompetitionScore: 0.28190184049079753



Validation scores:
	RegressionAUROC: 0.6957211494445801
	RegressionCompetitionScore: 0.28404907975460125

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.6964665651321411
	RegressionCompetitionScore: 0.2837423312883436



Validation scores:
	RegressionAUROC: 0.6974737048149109
	RegressionCompetitionScore: 0.28865030674846626

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.6980428695678711
	RegressionCompetitionScore: 0.28773006134969326



Validation scores:
	RegressionAUROC: 0.6989507675170898
	RegressionCompetitionScore: 0.28957055214723926



Validation scores:
	RegressionAUROC: 0.6996157765388489
	RegressionCompetitionScore: 0.2855828220858896



Validation scores:
	RegressionAUROC: 0.6997195482254028
	RegressionCompetitionScore: 0.28159509202453986



Validation scores:
	RegressionAUROC: 0.6996639966964722
	RegressionCompetitionScore: 0.27883435582822086



Validation scores:
	RegressionAUROC: 0.7005927562713623
	RegressionCompetitionScore: 0.2837423312883436



Validation scores:
	RegressionAUROC: 0.7015061378479004
	RegressionCompetitionScore: 0.28680981595092025

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.182. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.28865030674846626
     Test RegressionAUROC            0.6974737048149109
Test RegressionCompetitionScore      0.28865030674846626
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 07:19:37,365][0m Trial 520 finished with value: 0.28865030674846626 and parameters: {'lr': 9.861355766608533e-07, 'dropout': 0.4857455381315732, 'd_model_multiplier': 16, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 650, 'batch_size': 128, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0003359665731435195, 'dropout': 0.4613393272142837, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 97, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 33.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
33.5 K    Trainable params
0         Non-trainable params
33.5 K    Total params
0.134     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6038647294044495
	RegressionCompetitionScore: 0.43478260869565216



Validation scores:
	RegressionAUROC: 0.5832434892654419
	RegressionCompetitionScore: 0.13006134969325153

Metric val_loss improved. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.6091323494911194
	RegressionCompetitionScore: 0.2450920245398773



Validation scores:
	RegressionAUROC: 0.6678521633148193
	RegressionCompetitionScore: 0.20613496932515338



Validation scores:
	RegressionAUROC: 0.6806528568267822
	RegressionCompetitionScore: 0.22269938650306748



Validation scores:
	RegressionAUROC: 0.6908495426177979
	RegressionCompetitionScore: 0.2687116564417178



Validation scores:
	RegressionAUROC: 0.7082959413528442
	RegressionCompetitionScore: 0.25766871165644173



Validation scores:
	RegressionAUROC: 0.718154788017273
	RegressionCompetitionScore: 0.2865030674846626

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.7108981609344482
	RegressionCompetitionScore: 0.2668711656441718



Validation scores:
	RegressionAUROC: 0.7330589890480042
	RegressionCompetitionScore: 0.3070552147239264



Validation scores:
	RegressionAUROC: 0.740186333656311
	RegressionCompetitionScore: 0.300920245398773



Validation scores:
	RegressionAUROC: 0.7361708879470825
	RegressionCompetitionScore: 0.30368098159509205

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.197


Validation scores:
	RegressionAUROC: 0.7384711503982544
	RegressionCompetitionScore: 0.3337423312883436

Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7371184229850769
	RegressionCompetitionScore: 0.30368098159509205



Validation scores:
	RegressionAUROC: 0.7360451221466064
	RegressionCompetitionScore: 0.2987730061349693



Validation scores:
	RegressionAUROC: 0.7564414143562317
	RegressionCompetitionScore: 0.35613496932515337



Validation scores:
	RegressionAUROC: 0.7589393854141235
	RegressionCompetitionScore: 0.3512269938650307



Validation scores:
	RegressionAUROC: 0.7626957893371582
	RegressionCompetitionScore: 0.3567484662576687



Validation scores:
	RegressionAUROC: 0.7548874616622925
	RegressionCompetitionScore: 0.33312883435582824



Validation scores:
	RegressionAUROC: 0.7509042024612427
	RegressionCompetitionScore: 0.36533742331288344

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.176. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3337423312883436
     Test RegressionAUROC            0.7384711503982544
Test RegressionCompetitionScore      0.3337423312883436
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 07:27:07,015][0m Trial 521 finished with value: 0.3337423312883436 and parameters: {'lr': 0.0003359665731435195, 'dropout': 0.4613393272142837, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 8, 'dim_feedforward': 97, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0007923516240426211, 'dropout': 0.4732099727265353, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 933, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 56.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
56.0 K    Trainable params
0         Non-trainable params
56.0 K    Total params
0.224     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5072463750839233
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.6704748272895813
	RegressionCompetitionScore: 0.2214723926380368

Metric val_loss improved. New best score: 0.193


Validation scores:
	RegressionAUROC: 0.7045260071754456
	RegressionCompetitionScore: 0.32085889570552145



Validation scores:
	RegressionAUROC: 0.6914818286895752
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7286111116409302
	RegressionCompetitionScore: 0.350920245398773



Validation scores:
	RegressionAUROC: 0.7332844138145447
	RegressionCompetitionScore: 0.3567484662576687



Validation scores:
	RegressionAUROC: 0.6841256022453308
	RegressionCompetitionScore: 0.2361963190184049



Validation scores:
	RegressionAUROC: 0.6868300437927246
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7107574939727783
	RegressionCompetitionScore: 0.3478527607361963

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.193. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.2214723926380368
     Test RegressionAUROC            0.6704748272895813
Test RegressionCompetitionScore      0.2214723926380368
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 07:30:30,256][0m Trial 522 finished with value: 0.2214723926380368 and parameters: {'lr': 0.0007923516240426211, 'dropout': 0.4732099727265353, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 933, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0005516297686962417, 'dropout': 0.6476714271725034, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 201, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 34.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
34.8 K    Trainable params
0         Non-trainable params
34.8 K    Total params
0.139     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.46859902143478394
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6336146593093872
	RegressionCompetitionScore: 0.24079754601226994

Metric val_loss improved. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6518625617027283
	RegressionCompetitionScore: 0.25858895705521473



Validation scores:
	RegressionAUROC: 0.6487524509429932
	RegressionCompetitionScore: 0.2677914110429448



Validation scores:
	RegressionAUROC: 0.6543148756027222
	RegressionCompetitionScore: 0.2782208588957055



Validation scores:
	RegressionAUROC: 0.665985107421875
	RegressionCompetitionScore: 0.29754601226993865



Validation scores:
	RegressionAUROC: 0.6887091398239136
	RegressionCompetitionScore: 0.3128834355828221



Validation scores:
	RegressionAUROC: 0.6964411735534668
	RegressionCompetitionScore: 0.3273006134969325



Validation scores:
	RegressionAUROC: 0.7096589803695679
	RegressionCompetitionScore: 0.348159509202454

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.199. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.24079754601226994
     Test RegressionAUROC            0.6336146593093872
Test RegressionCompetitionScore      0.24079754601226994
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 07:33:51,873][0m Trial 523 finished with value: 0.24079754601226994 and parameters: {'lr': 0.0005516297686962417, 'dropout': 0.6476714271725034, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 201, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.014655725669513045, 'dropout': 0.5501021787044363, 'd_model_multiplier': 64, 'num_layers': 5, 'n_heads': 32, 'dim_feedforward': 271, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 91.4 M
1 | loss_fn | MSELoss | 0     
------------------------------------
91.4 M    Trainable params
0         Non-trainable params
91.4 M    Total params
365.712   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6425120830535889
	RegressionCompetitionScore: 0.5652173913043478



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 20109.947


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 19883.762 >= min_delta = 0.0. New best score: 226.186


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 65.007 >= min_delta = 0.0. New best score: 161.179


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 125.071 >= min_delta = 0.0. New best score: 36.108


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 36.108. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 07:56:36,760][0m Trial 524 finished with value: 0.0 and parameters: {'lr': 0.014655725669513045, 'dropout': 0.5501021787044363, 'd_model_multiplier': 64, 'num_layers': 5, 'n_heads': 32, 'dim_feedforward': 271, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'AdamW', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0002459372107900898, 'dropout': 0.43338686899042983, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 127, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 38.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
38.5 K    Trainable params
0         Non-trainable params
38.5 K    Total params
0.154     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.662964940071106
	RegressionCompetitionScore: 0.25030674846625767

Metric val_loss improved. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6502286195755005
	RegressionCompetitionScore: 0.2273006134969325

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6700451374053955
	RegressionCompetitionScore: 0.2714723926380368

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.6998647451400757
	RegressionCompetitionScore: 0.25214723926380367

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7283844947814941
	RegressionCompetitionScore: 0.33773006134969324

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.184


Validation scores:
	RegressionAUROC: 0.7249025106430054
	RegressionCompetitionScore: 0.35644171779141104

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.711251437664032
	RegressionCompetitionScore: 0.295398773006135



Validation scores:
	RegressionAUROC: 0.7262108325958252
	RegressionCompetitionScore: 0.2920245398773006



Validation scores:
	RegressionAUROC: 0.7399095296859741
	RegressionCompetitionScore: 0.3294478527607362

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7378427982330322
	RegressionCompetitionScore: 0.3039877300613497



Validation scores:
	RegressionAUROC: 0.7295801639556885
	RegressionCompetitionScore: 0.3039877300613497

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.174


Validation scores:
	RegressionAUROC: 0.7437798380851746
	RegressionCompetitionScore: 0.3058282208588957



Validation scores:
	RegressionAUROC: 0.730312705039978
	RegressionCompetitionScore: 0.30368098159509205



Validation scores:
	RegressionAUROC: 0.7426171898841858
	RegressionCompetitionScore: 0.3374233128834356

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7438513040542603
	RegressionCompetitionScore: 0.3165644171779141



Validation scores:
	RegressionAUROC: 0.7371209263801575
	RegressionCompetitionScore: 0.30214723926380366



Validation scores:
	RegressionAUROC: 0.736337423324585
	RegressionCompetitionScore: 0.31441717791411045



Validation scores:
	RegressionAUROC: 0.7308642864227295
	RegressionCompetitionScore: 0.3033742331288344



Validation scores:
	RegressionAUROC: 0.7443473935127258
	RegressionCompetitionScore: 0.3407975460122699



Validation scores:
	RegressionAUROC: 0.7255734205245972
	RegressionCompetitionScore: 0.3285276073619632



Validation scores:
	RegressionAUROC: 0.729374885559082
	RegressionCompetitionScore: 0.34049079754601225

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.172. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3374233128834356
     Test RegressionAUROC            0.7426171898841858
Test RegressionCompetitionScore      0.3374233128834356
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 08:04:53,371][0m Trial 525 finished with value: 0.3374233128834356 and parameters: {'lr': 0.0002459372107900898, 'dropout': 0.43338686899042983, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 127, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 1.4128994036366208e-05, 'dropout': 0.412080522707689, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 140, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 29.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
29.0 K    Trainable params
0         Non-trainable params
29.0 K    Total params
0.116     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4670296907424927
	RegressionCompetitionScore: 0.05950920245398773

Metric val_loss improved. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.5089092254638672
	RegressionCompetitionScore: 0.08987730061349693



Validation scores:
	RegressionAUROC: 0.5229148864746094
	RegressionCompetitionScore: 0.09723926380368098

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.5423074960708618
	RegressionCompetitionScore: 0.1098159509202454

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.5722829103469849
	RegressionCompetitionScore: 0.15920245398773006

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5715569257736206
	RegressionCompetitionScore: 0.09846625766871166



Validation scores:
	RegressionAUROC: 0.5970669984817505
	RegressionCompetitionScore: 0.1325153374233129



Validation scores:
	RegressionAUROC: 0.6100766062736511
	RegressionCompetitionScore: 0.15061349693251533



Validation scores:
	RegressionAUROC: 0.6253738403320312
	RegressionCompetitionScore: 0.19355828220858895



Validation scores:
	RegressionAUROC: 0.6310909986495972
	RegressionCompetitionScore: 0.23895705521472393



Validation scores:
	RegressionAUROC: 0.6379095315933228
	RegressionCompetitionScore: 0.23588957055214724

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6421374678611755
	RegressionCompetitionScore: 0.2263803680981595

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6503217220306396
	RegressionCompetitionScore: 0.22914110429447854

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6561590433120728
	RegressionCompetitionScore: 0.22699386503067484



Validation scores:
	RegressionAUROC: 0.6603800654411316
	RegressionCompetitionScore: 0.25



Validation scores:
	RegressionAUROC: 0.6650248765945435
	RegressionCompetitionScore: 0.2432515337423313



Validation scores:
	RegressionAUROC: 0.6705405712127686
	RegressionCompetitionScore: 0.26901840490797546



Validation scores:
	RegressionAUROC: 0.6737173199653625
	RegressionCompetitionScore: 0.2911042944785276



Validation scores:
	RegressionAUROC: 0.6806725263595581
	RegressionCompetitionScore: 0.28865030674846626



Validation scores:
	RegressionAUROC: 0.68548983335495
	RegressionCompetitionScore: 0.2763803680981595

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.201. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.22914110429447854
     Test RegressionAUROC            0.6503217220306396
Test RegressionCompetitionScore      0.22914110429447854
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 08:12:31,233][0m Trial 526 finished with value: 0.22914110429447854 and parameters: {'lr': 1.4128994036366208e-05, 'dropout': 0.412080522707689, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 140, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 3.3724917672826017e-06, 'dropout': 0.6713635377777756, 'd_model_multiplier': 2, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 173, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 37.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
37.8 K    Trainable params
0         Non-trainable params
37.8 K    Total params
0.151     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5024154186248779
	RegressionCompetitionScore: 0.2608695652173913



Validation scores:
	RegressionAUROC: 0.4841214418411255
	RegressionCompetitionScore: 0.09693251533742331

Metric val_loss improved. New best score: 0.258


Validation scores:
	RegressionAUROC: 0.48961788415908813
	RegressionCompetitionScore: 0.10061349693251534

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.227


Validation scores:
	RegressionAUROC: 0.496645987033844
	RegressionCompetitionScore: 0.10521472392638037

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.5052204132080078
	RegressionCompetitionScore: 0.1067484662576687

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.5176308155059814
	RegressionCompetitionScore: 0.1098159509202454



Validation scores:
	RegressionAUROC: 0.5262757539749146
	RegressionCompetitionScore: 0.11319018404907975



Validation scores:
	RegressionAUROC: 0.5274536609649658
	RegressionCompetitionScore: 0.11196319018404909



Validation scores:
	RegressionAUROC: 0.546149730682373
	RegressionCompetitionScore: 0.11717791411042945



Validation scores:
	RegressionAUROC: 0.5556429624557495
	RegressionCompetitionScore: 0.1156441717791411



Validation scores:
	RegressionAUROC: 0.5665874481201172
	RegressionCompetitionScore: 0.11717791411042945



Validation scores:
	RegressionAUROC: 0.5733098983764648
	RegressionCompetitionScore: 0.1254601226993865

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.217. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1067484662576687
     Test RegressionAUROC            0.5052204132080078
Test RegressionCompetitionScore      0.1067484662576687
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 08:16:54,930][0m Trial 527 finished with value: 0.1067484662576687 and parameters: {'lr': 3.3724917672826017e-06, 'dropout': 0.6713635377777756, 'd_model_multiplier': 2, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 173, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 1.2457498845869248e-05, 'dropout': 0.49889930086300044, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 627, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 181 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
181 K     Trainable params
0         Non-trainable params
181 K     Total params
0.724     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.28502413630485535
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.45542794466018677
	RegressionCompetitionScore: 0.06165644171779141

Metric val_loss improved. New best score: 0.241


Validation scores:
	RegressionAUROC: 0.5777295827865601
	RegressionCompetitionScore: 0.1659509202453988

Metric val_loss improved by 0.028 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.6148709058761597
	RegressionCompetitionScore: 0.21042944785276074

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6317740082740784
	RegressionCompetitionScore: 0.22392638036809817

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.198


Validation scores:
	RegressionAUROC: 0.6466083526611328
	RegressionCompetitionScore: 0.25828220858895706

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.6682167649269104
	RegressionCompetitionScore: 0.25245398773006134

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.6747548580169678
	RegressionCompetitionScore: 0.2352760736196319

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.6713362336158752
	RegressionCompetitionScore: 0.22392638036809817



Validation scores:
	RegressionAUROC: 0.6886574625968933
	RegressionCompetitionScore: 0.23742331288343557

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.694413959980011
	RegressionCompetitionScore: 0.2469325153374233



Validation scores:
	RegressionAUROC: 0.7022143006324768
	RegressionCompetitionScore: 0.24662576687116564

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.183


Validation scores:
	RegressionAUROC: 0.7036226987838745
	RegressionCompetitionScore: 0.25153374233128833

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7034531235694885
	RegressionCompetitionScore: 0.2684049079754601

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.7017669081687927
	RegressionCompetitionScore: 0.26809815950920246



Validation scores:
	RegressionAUROC: 0.7050819396972656
	RegressionCompetitionScore: 0.2705521472392638

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.181


Validation scores:
	RegressionAUROC: 0.6998655200004578
	RegressionCompetitionScore: 0.27085889570552146



Validation scores:
	RegressionAUROC: 0.7024869918823242
	RegressionCompetitionScore: 0.2843558282208589



Validation scores:
	RegressionAUROC: 0.7060063481330872
	RegressionCompetitionScore: 0.29233128834355826



Validation scores:
	RegressionAUROC: 0.7053365707397461
	RegressionCompetitionScore: 0.293558282208589



Validation scores:
	RegressionAUROC: 0.7105406522750854
	RegressionCompetitionScore: 0.3015337423312883



Validation scores:
	RegressionAUROC: 0.7139419317245483
	RegressionCompetitionScore: 0.30460122699386505

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7130563259124756
	RegressionCompetitionScore: 0.3088957055214724

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.179


Validation scores:
	RegressionAUROC: 0.7114516496658325
	RegressionCompetitionScore: 0.31441717791411045



Validation scores:
	RegressionAUROC: 0.7126880884170532
	RegressionCompetitionScore: 0.31349693251533745



Validation scores:
	RegressionAUROC: 0.7158935070037842
	RegressionCompetitionScore: 0.301840490797546

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.178


Validation scores:
	RegressionAUROC: 0.7145857810974121
	RegressionCompetitionScore: 0.3138036809815951



Validation scores:
	RegressionAUROC: 0.7138881683349609
	RegressionCompetitionScore: 0.3282208588957055



Validation scores:
	RegressionAUROC: 0.7094285488128662
	RegressionCompetitionScore: 0.3122699386503067



Validation scores:
	RegressionAUROC: 0.7163560390472412
	RegressionCompetitionScore: 0.3248466257668712



Validation scores:
	RegressionAUROC: 0.7182922959327698
	RegressionCompetitionScore: 0.31993865030674845



Validation scores:
	RegressionAUROC: 0.7171303033828735
	RegressionCompetitionScore: 0.33588957055214724



Validation scores:
	RegressionAUROC: 0.7202584147453308
	RegressionCompetitionScore: 0.32331288343558284

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7200984358787537
	RegressionCompetitionScore: 0.3291411042944785

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7146874666213989
	RegressionCompetitionScore: 0.3116564417177914



Validation scores:
	RegressionAUROC: 0.71940678358078
	RegressionCompetitionScore: 0.32239263803680984



Validation scores:
	RegressionAUROC: 0.7184406518936157
	RegressionCompetitionScore: 0.3273006134969325



Validation scores:
	RegressionAUROC: 0.7183407545089722
	RegressionCompetitionScore: 0.3245398773006135



Validation scores:
	RegressionAUROC: 0.7201579213142395
	RegressionCompetitionScore: 0.3380368098159509



Validation scores:
	RegressionAUROC: 0.7248905897140503
	RegressionCompetitionScore: 0.3365030674846626

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.176


Validation scores:
	RegressionAUROC: 0.7245265245437622
	RegressionCompetitionScore: 0.347239263803681



Validation scores:
	RegressionAUROC: 0.7266136407852173
	RegressionCompetitionScore: 0.34294478527607364

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7225321531295776
	RegressionCompetitionScore: 0.3361963190184049



Validation scores:
	RegressionAUROC: 0.7179186940193176
	RegressionCompetitionScore: 0.3325153374233129



Validation scores:
	RegressionAUROC: 0.7225296497344971
	RegressionCompetitionScore: 0.33773006134969324



Validation scores:
	RegressionAUROC: 0.7260545492172241
	RegressionCompetitionScore: 0.34049079754601225



Validation scores:
	RegressionAUROC: 0.7229524254798889
	RegressionCompetitionScore: 0.3383435582822086



Validation scores:
	RegressionAUROC: 0.722217857837677
	RegressionCompetitionScore: 0.3401840490797546



Validation scores:
	RegressionAUROC: 0.721409797668457
	RegressionCompetitionScore: 0.3423312883435583

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.175. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.34294478527607364
     Test RegressionAUROC            0.7266136407852173
Test RegressionCompetitionScore      0.34294478527607364
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 08:36:26,139][0m Trial 528 finished with value: 0.34294478527607364 and parameters: {'lr': 1.2457498845869248e-05, 'dropout': 0.49889930086300044, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 627, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0011278359971545295, 'dropout': 0.4574806143818348, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 229, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 53.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
53.1 K    Trainable params
0         Non-trainable params
53.1 K    Total params
0.213     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5027893781661987
	RegressionCompetitionScore: 0.049079754601226995

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.3657650053501129
	RegressionCompetitionScore: 0.0754601226993865



Validation scores:
	RegressionAUROC: 0.6128341555595398
	RegressionCompetitionScore: 0.07269938650306748



Validation scores:
	RegressionAUROC: 0.3334302604198456
	RegressionCompetitionScore: 0.022699386503067485



Validation scores:
	RegressionAUROC: 0.48828408122062683
	RegressionCompetitionScore: 0.023006134969325152



Validation scores:
	RegressionAUROC: 0.39868777990341187
	RegressionCompetitionScore: 0.032208588957055216



Validation scores:
	RegressionAUROC: 0.3541752099990845
	RegressionCompetitionScore: 0.03496932515337423



Validation scores:
	RegressionAUROC: 0.35622644424438477
	RegressionCompetitionScore: 0.04263803680981595

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore          0.049079754601226995
     Test RegressionAUROC            0.5027893781661987
Test RegressionCompetitionScore     0.049079754601226995
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 08:40:04,294][0m Trial 529 finished with value: 0.049079754601226995 and parameters: {'lr': 0.0011278359971545295, 'dropout': 0.4574806143818348, 'd_model_multiplier': 1, 'num_layers': 7, 'n_heads': 8, 'dim_feedforward': 229, 'batch_size': 8, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 4.529077747428487e-06, 'dropout': 0.528914786944712, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 371, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 63.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
63.4 K    Trainable params
0         Non-trainable params
63.4 K    Total params
0.254     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.4444444477558136
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.43363094329833984
	RegressionCompetitionScore: 0.07147239263803681

Metric val_loss improved. New best score: 0.393


Validation scores:
	RegressionAUROC: 0.44895029067993164
	RegressionCompetitionScore: 0.07300613496932515

Metric val_loss improved by 0.161 >= min_delta = 0.0. New best score: 0.232


Validation scores:
	RegressionAUROC: 0.4610217213630676
	RegressionCompetitionScore: 0.0754601226993865

Metric val_loss improved by 0.017 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.47495853900909424
	RegressionCompetitionScore: 0.07515337423312883



Validation scores:
	RegressionAUROC: 0.4883265495300293
	RegressionCompetitionScore: 0.07484662576687116

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.49598047137260437
	RegressionCompetitionScore: 0.07423312883435583

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.212


Validation scores:
	RegressionAUROC: 0.5076394081115723
	RegressionCompetitionScore: 0.0736196319018405

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.5190659761428833
	RegressionCompetitionScore: 0.0736196319018405



Validation scores:
	RegressionAUROC: 0.5314357280731201
	RegressionCompetitionScore: 0.07638036809815951

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5364631414413452
	RegressionCompetitionScore: 0.07760736196319018



Validation scores:
	RegressionAUROC: 0.5500048398971558
	RegressionCompetitionScore: 0.07607361963190185

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.5588661432266235
	RegressionCompetitionScore: 0.07730061349693251



Validation scores:
	RegressionAUROC: 0.5728521347045898
	RegressionCompetitionScore: 0.0803680981595092



Validation scores:
	RegressionAUROC: 0.5853902697563171
	RegressionCompetitionScore: 0.08404907975460123

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.207


Validation scores:
	RegressionAUROC: 0.5914561748504639
	RegressionCompetitionScore: 0.08711656441717791

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6039259433746338
	RegressionCompetitionScore: 0.09325153374233129

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6046266555786133
	RegressionCompetitionScore: 0.09049079754601227



Validation scores:
	RegressionAUROC: 0.60627281665802
	RegressionCompetitionScore: 0.09171779141104294



Validation scores:
	RegressionAUROC: 0.6103613376617432
	RegressionCompetitionScore: 0.09539877300613497



Validation scores:
	RegressionAUROC: 0.6090993285179138
	RegressionCompetitionScore: 0.09539877300613497



Validation scores:
	RegressionAUROC: 0.6148948669433594
	RegressionCompetitionScore: 0.09570552147239264

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6208215951919556
	RegressionCompetitionScore: 0.11104294478527607



Validation scores:
	RegressionAUROC: 0.6245001554489136
	RegressionCompetitionScore: 0.11042944785276074



Validation scores:
	RegressionAUROC: 0.626278281211853
	RegressionCompetitionScore: 0.11104294478527607



Validation scores:
	RegressionAUROC: 0.6269639730453491
	RegressionCompetitionScore: 0.11134969325153374

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.204


Validation scores:
	RegressionAUROC: 0.6330598592758179
	RegressionCompetitionScore: 0.1107361963190184

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6363242864608765
	RegressionCompetitionScore: 0.11349693251533742



Validation scores:
	RegressionAUROC: 0.6426098346710205
	RegressionCompetitionScore: 0.15122699386503066



Validation scores:
	RegressionAUROC: 0.6427072882652283
	RegressionCompetitionScore: 0.14754601226993866



Validation scores:
	RegressionAUROC: 0.6444489359855652
	RegressionCompetitionScore: 0.14662576687116563



Validation scores:
	RegressionAUROC: 0.6472341418266296
	RegressionCompetitionScore: 0.16993865030674846

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.203


Validation scores:
	RegressionAUROC: 0.6530237197875977
	RegressionCompetitionScore: 0.22116564417177914



Validation scores:
	RegressionAUROC: 0.656112790107727
	RegressionCompetitionScore: 0.24233128834355827



Validation scores:
	RegressionAUROC: 0.6577143669128418
	RegressionCompetitionScore: 0.2460122699386503

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.202


Validation scores:
	RegressionAUROC: 0.6596132516860962
	RegressionCompetitionScore: 0.2450920245398773

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6601622104644775
	RegressionCompetitionScore: 0.24447852760736197



Validation scores:
	RegressionAUROC: 0.661277711391449
	RegressionCompetitionScore: 0.24386503067484663



Validation scores:
	RegressionAUROC: 0.6621868014335632
	RegressionCompetitionScore: 0.2420245398773006



Validation scores:
	RegressionAUROC: 0.6621071100234985
	RegressionCompetitionScore: 0.23190184049079754



Validation scores:
	RegressionAUROC: 0.6633179783821106
	RegressionCompetitionScore: 0.2273006134969325



Validation scores:
	RegressionAUROC: 0.6662193536758423
	RegressionCompetitionScore: 0.26717791411042946

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6668162941932678
	RegressionCompetitionScore: 0.27300613496932513



Validation scores:
	RegressionAUROC: 0.6673687696456909
	RegressionCompetitionScore: 0.2861963190184049



Validation scores:
	RegressionAUROC: 0.6688918471336365
	RegressionCompetitionScore: 0.27883435582822086



Validation scores:
	RegressionAUROC: 0.6695713400840759
	RegressionCompetitionScore: 0.26717791411042946

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.201


Validation scores:
	RegressionAUROC: 0.6706032156944275
	RegressionCompetitionScore: 0.27269938650306746

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.671487033367157
	RegressionCompetitionScore: 0.26319018404907973



Validation scores:
	RegressionAUROC: 0.6718236207962036
	RegressionCompetitionScore: 0.25644171779141106



Validation scores:
	RegressionAUROC: 0.6732220649719238
	RegressionCompetitionScore: 0.25736196319018406



Validation scores:
	RegressionAUROC: 0.6731938123703003
	RegressionCompetitionScore: 0.250920245398773

`Trainer.fit` stopped: `max_epochs=5` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.27269938650306746
     Test RegressionAUROC            0.6706032156944275
Test RegressionCompetitionScore      0.27269938650306746
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 08:59:21,648][0m Trial 530 finished with value: 0.27269938650306746 and parameters: {'lr': 4.529077747428487e-06, 'dropout': 0.528914786944712, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 371, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 6.829283192398143e-05, 'dropout': 0.4208687079399615, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 64, 'dim_feedforward': 110, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 230 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
230 K     Trainable params
0         Non-trainable params
230 K     Total params
0.923     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5725389122962952
	RegressionCompetitionScore: 0.16840490797546012

Metric val_loss improved. New best score: 0.208


Validation scores:
	RegressionAUROC: 0.6847647428512573
	RegressionCompetitionScore: 0.29938650306748466



Validation scores:
	RegressionAUROC: 0.6960407495498657
	RegressionCompetitionScore: 0.26196319018404907



Validation scores:
	RegressionAUROC: 0.707122266292572
	RegressionCompetitionScore: 0.27392638036809813



Validation scores:
	RegressionAUROC: 0.708344042301178
	RegressionCompetitionScore: 0.28680981595092025



Validation scores:
	RegressionAUROC: 0.6820107698440552
	RegressionCompetitionScore: 0.2205521472392638



Validation scores:
	RegressionAUROC: 0.7291806936264038
	RegressionCompetitionScore: 0.3107361963190184

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.7270978689193726
	RegressionCompetitionScore: 0.29938650306748466



Validation scores:
	RegressionAUROC: 0.7333611249923706
	RegressionCompetitionScore: 0.32239263803680984



Validation scores:
	RegressionAUROC: 0.733562707901001
	RegressionCompetitionScore: 0.3398773006134969



Validation scores:
	RegressionAUROC: 0.7358121871948242
	RegressionCompetitionScore: 0.3095092024539877

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7351632118225098
	RegressionCompetitionScore: 0.3266871165644172



Validation scores:
	RegressionAUROC: 0.7307909727096558
	RegressionCompetitionScore: 0.3024539877300613



Validation scores:
	RegressionAUROC: 0.7314319610595703
	RegressionCompetitionScore: 0.3006134969325153



Validation scores:
	RegressionAUROC: 0.737919807434082
	RegressionCompetitionScore: 0.3346625766871166



Validation scores:
	RegressionAUROC: 0.7367072701454163
	RegressionCompetitionScore: 0.3245398773006135



Validation scores:
	RegressionAUROC: 0.7369558215141296
	RegressionCompetitionScore: 0.30736196319018405



Validation scores:
	RegressionAUROC: 0.727806031703949
	RegressionCompetitionScore: 0.3067484662576687

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.191. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3095092024539877
     Test RegressionAUROC            0.7358121871948242
Test RegressionCompetitionScore      0.3095092024539877
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 09:10:45,849][0m Trial 531 finished with value: 0.3095092024539877 and parameters: {'lr': 6.829283192398143e-05, 'dropout': 0.4208687079399615, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 64, 'dim_feedforward': 110, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00044197359845274127, 'dropout': 0.4437955760617626, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 340, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 41.9 K
1 | loss_fn | MSELoss | 0     
------------------------------------
41.9 K    Trainable params
0         Non-trainable params
41.9 K    Total params
0.168     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5024154186248779
	RegressionCompetitionScore: 0.30434782608695654



Validation scores:
	RegressionAUROC: 0.6934031248092651
	RegressionCompetitionScore: 0.251840490797546

Metric val_loss improved. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7117583155632019
	RegressionCompetitionScore: 0.35644171779141104

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.716288685798645
	RegressionCompetitionScore: 0.3478527607361963



Validation scores:
	RegressionAUROC: 0.7204792499542236
	RegressionCompetitionScore: 0.3248466257668712



Validation scores:
	RegressionAUROC: 0.7449737787246704
	RegressionCompetitionScore: 0.3610429447852761



Validation scores:
	RegressionAUROC: 0.7505402565002441
	RegressionCompetitionScore: 0.3834355828220859

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7535091638565063
	RegressionCompetitionScore: 0.3889570552147239



Validation scores:
	RegressionAUROC: 0.7425196170806885
	RegressionCompetitionScore: 0.36226993865030677



Validation scores:
	RegressionAUROC: 0.7350650429725647
	RegressionCompetitionScore: 0.34294478527607364



Validation scores:
	RegressionAUROC: 0.7575658559799194
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.7631687521934509
	RegressionCompetitionScore: 0.36595092024539877



Validation scores:
	RegressionAUROC: 0.7614701390266418
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.7595111727714539
	RegressionCompetitionScore: 0.3595092024539877

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.169. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3834355828220859
     Test RegressionAUROC            0.7505402565002441
Test RegressionCompetitionScore      0.3834355828220859
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 09:15:59,976][0m Trial 532 finished with value: 0.3834355828220859 and parameters: {'lr': 0.00044197359845274127, 'dropout': 0.4437955760617626, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 340, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0006247900406961921, 'dropout': 0.47369179112076726, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 83, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 27.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
27.1 K    Trainable params
0         Non-trainable params
27.1 K    Total params
0.108     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6604193449020386
	RegressionCompetitionScore: 0.20245398773006135

Metric val_loss improved. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6675555109977722
	RegressionCompetitionScore: 0.2634969325153374

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.217


Validation scores:
	RegressionAUROC: 0.6798155307769775
	RegressionCompetitionScore: 0.2773006134969325



Validation scores:
	RegressionAUROC: 0.7208661437034607
	RegressionCompetitionScore: 0.29938650306748466

Metric val_loss improved by 0.022 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.7399757504463196
	RegressionCompetitionScore: 0.39386503067484663

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.191


Validation scores:
	RegressionAUROC: 0.7545755505561829
	RegressionCompetitionScore: 0.3911042944785276

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7302654981613159
	RegressionCompetitionScore: 0.34938650306748464



Validation scores:
	RegressionAUROC: 0.7475630044937134
	RegressionCompetitionScore: 0.35276073619631904



Validation scores:
	RegressionAUROC: 0.7689549922943115
	RegressionCompetitionScore: 0.3950920245398773



Validation scores:
	RegressionAUROC: 0.7800628542900085
	RegressionCompetitionScore: 0.37576687116564417



Validation scores:
	RegressionAUROC: 0.7820338010787964
	RegressionCompetitionScore: 0.37883435582822084

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.7760004997253418
	RegressionCompetitionScore: 0.39631901840490796



Validation scores:
	RegressionAUROC: 0.7846314907073975
	RegressionCompetitionScore: 0.4098159509202454

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.161


Validation scores:
	RegressionAUROC: 0.7844829559326172
	RegressionCompetitionScore: 0.4395705521472393



Validation scores:
	RegressionAUROC: 0.7982597351074219
	RegressionCompetitionScore: 0.4377300613496933



Validation scores:
	RegressionAUROC: 0.802574098110199
	RegressionCompetitionScore: 0.43466257668711655

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.157


Validation scores:
	RegressionAUROC: 0.7939872145652771
	RegressionCompetitionScore: 0.4128834355828221



Validation scores:
	RegressionAUROC: 0.7798511981964111
	RegressionCompetitionScore: 0.39539877300613496



Validation scores:
	RegressionAUROC: 0.7789509296417236
	RegressionCompetitionScore: 0.3803680981595092



Validation scores:
	RegressionAUROC: 0.7866302728652954
	RegressionCompetitionScore: 0.3521472392638037



Validation scores:
	RegressionAUROC: 0.7969286441802979
	RegressionCompetitionScore: 0.40705521472392636

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.156


Validation scores:
	RegressionAUROC: 0.7983292937278748
	RegressionCompetitionScore: 0.4153374233128834



Validation scores:
	RegressionAUROC: 0.7889231443405151
	RegressionCompetitionScore: 0.38680981595092023



Validation scores:
	RegressionAUROC: 0.7614184617996216
	RegressionCompetitionScore: 0.28588957055214725



Validation scores:
	RegressionAUROC: 0.7915735244750977
	RegressionCompetitionScore: 0.3889570552147239



Validation scores:
	RegressionAUROC: 0.7779589891433716
	RegressionCompetitionScore: 0.3487730061349693



Validation scores:
	RegressionAUROC: 0.7908326983451843
	RegressionCompetitionScore: 0.3969325153374233



Validation scores:
	RegressionAUROC: 0.7801492214202881
	RegressionCompetitionScore: 0.37607361963190183

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.156. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.40705521472392636
     Test RegressionAUROC            0.7969286441802979
Test RegressionCompetitionScore      0.40705521472392636
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 09:26:32,726][0m Trial 533 finished with value: 0.40705521472392636 and parameters: {'lr': 0.0006247900406961921, 'dropout': 0.47369179112076726, 'd_model_multiplier': 1, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 83, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0026205356947986863, 'dropout': 0.4096198814885425, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 877, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 413 K 
1 | loss_fn | MSELoss | 0     
------------------------------------
413 K     Trainable params
0         Non-trainable params
413 K     Total params
1.656     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.41545891761779785
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.4395276606082916
	RegressionCompetitionScore: 0.09969325153374232

Metric val_loss improved. New best score: 0.225


Validation scores:
	RegressionAUROC: 0.5880747437477112
	RegressionCompetitionScore: 0.2558282208588957



Validation scores:
	RegressionAUROC: 0.6144030094146729
	RegressionCompetitionScore: 0.2733128834355828

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6762887239456177
	RegressionCompetitionScore: 0.20306748466257668

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.206


Validation scores:
	RegressionAUROC: 0.6194815635681152
	RegressionCompetitionScore: 0.2647239263803681



Validation scores:
	RegressionAUROC: 0.6878663301467896
	RegressionCompetitionScore: 0.2812883435582822



Validation scores:
	RegressionAUROC: 0.6862766742706299
	RegressionCompetitionScore: 0.24171779141104294

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.4800207018852234
	RegressionCompetitionScore: 0.07331288343558282



Validation scores:
	RegressionAUROC: 0.48896121978759766
	RegressionCompetitionScore: 0.09386503067484663



Validation scores:
	RegressionAUROC: 0.39818626642227173
	RegressionCompetitionScore: 0.07392638036809816



Validation scores:
	RegressionAUROC: 0.46459317207336426
	RegressionCompetitionScore: 0.0705521472392638



Validation scores:
	RegressionAUROC: 0.41909629106521606
	RegressionCompetitionScore: 0.1058282208588957



Validation scores:
	RegressionAUROC: 0.3905107378959656
	RegressionCompetitionScore: 0.1098159509202454



Validation scores:
	RegressionAUROC: 0.4929044842720032
	RegressionCompetitionScore: 0.10368098159509202

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.196. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.24171779141104294
     Test RegressionAUROC            0.6862766742706299
Test RegressionCompetitionScore      0.24171779141104294
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 09:33:59,194][0m Trial 534 finished with value: 0.24171779141104294 and parameters: {'lr': 0.0026205356947986863, 'dropout': 0.4096198814885425, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 32, 'dim_feedforward': 877, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'BatchNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00037693590039321724, 'dropout': 0.7349270901136667, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 607, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 55.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
55.5 K    Trainable params
0         Non-trainable params
55.5 K    Total params
0.222     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.512077271938324
	RegressionCompetitionScore: 0.21739130434782608



Validation scores:
	RegressionAUROC: 0.6065853834152222
	RegressionCompetitionScore: 0.09018404907975461

Metric val_loss improved. New best score: 0.269


Validation scores:
	RegressionAUROC: 0.6273555159568787
	RegressionCompetitionScore: 0.11104294478527607

Metric val_loss improved by 0.069 >= min_delta = 0.0. New best score: 0.200


Validation scores:
	RegressionAUROC: 0.6430584192276001
	RegressionCompetitionScore: 0.23957055214723927



Validation scores:
	RegressionAUROC: 0.6265709400177002
	RegressionCompetitionScore: 0.17668711656441718



Validation scores:
	RegressionAUROC: 0.6530871987342834
	RegressionCompetitionScore: 0.25030674846625767



Validation scores:
	RegressionAUROC: 0.6678422689437866
	RegressionCompetitionScore: 0.25306748466257667



Validation scores:
	RegressionAUROC: 0.671452522277832
	RegressionCompetitionScore: 0.26319018404907973



Validation scores:
	RegressionAUROC: 0.6795930862426758
	RegressionCompetitionScore: 0.2205521472392638



Validation scores:
	RegressionAUROC: 0.6741505265235901
	RegressionCompetitionScore: 0.2134969325153374

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.200. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.11104294478527607
     Test RegressionAUROC            0.6273555159568787
Test RegressionCompetitionScore      0.11104294478527607
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 09:37:41,031][0m Trial 535 finished with value: 0.11104294478527607 and parameters: {'lr': 0.00037693590039321724, 'dropout': 0.7349270901136667, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 8, 'dim_feedforward': 607, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00012435912829912154, 'dropout': 0.4880654804587217, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 547, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 81.4 K
1 | loss_fn | MSELoss | 0     
------------------------------------
81.4 K    Trainable params
0         Non-trainable params
81.4 K    Total params
0.325     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6787439584732056
	RegressionCompetitionScore: 0.5217391304347826



Validation scores:
	RegressionAUROC: 0.5948806405067444
	RegressionCompetitionScore: 0.08865030674846626

Metric val_loss improved. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.6341463327407837
	RegressionCompetitionScore: 0.2184049079754601

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.205


Validation scores:
	RegressionAUROC: 0.6738427877426147
	RegressionCompetitionScore: 0.2561349693251534



Validation scores:
	RegressionAUROC: 0.6631193161010742
	RegressionCompetitionScore: 0.21932515337423314



Validation scores:
	RegressionAUROC: 0.6751017570495605
	RegressionCompetitionScore: 0.25429447852760734

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.196


Validation scores:
	RegressionAUROC: 0.6932954788208008
	RegressionCompetitionScore: 0.3049079754601227

Metric val_loss improved by 0.006 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.7032302618026733
	RegressionCompetitionScore: 0.29478527607361965



Validation scores:
	RegressionAUROC: 0.7138157486915588
	RegressionCompetitionScore: 0.3202453987730061



Validation scores:
	RegressionAUROC: 0.7178393006324768
	RegressionCompetitionScore: 0.36134969325153377

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.189


Validation scores:
	RegressionAUROC: 0.7341543436050415
	RegressionCompetitionScore: 0.33312883435582824



Validation scores:
	RegressionAUROC: 0.7344930171966553
	RegressionCompetitionScore: 0.3319018404907976

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.180


Validation scores:
	RegressionAUROC: 0.7388554811477661
	RegressionCompetitionScore: 0.3193251533742331

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.175


Validation scores:
	RegressionAUROC: 0.7489789724349976
	RegressionCompetitionScore: 0.4003067484662577



Validation scores:
	RegressionAUROC: 0.7428963780403137
	RegressionCompetitionScore: 0.3717791411042945



Validation scores:
	RegressionAUROC: 0.7596603631973267
	RegressionCompetitionScore: 0.3889570552147239

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.171


Validation scores:
	RegressionAUROC: 0.7595198154449463
	RegressionCompetitionScore: 0.3914110429447853



Validation scores:
	RegressionAUROC: 0.7539905905723572
	RegressionCompetitionScore: 0.38374233128834356



Validation scores:
	RegressionAUROC: 0.7626544237136841
	RegressionCompetitionScore: 0.3803680981595092



Validation scores:
	RegressionAUROC: 0.7572253346443176
	RegressionCompetitionScore: 0.3665644171779141



Validation scores:
	RegressionAUROC: 0.7504974007606506
	RegressionCompetitionScore: 0.3708588957055215



Validation scores:
	RegressionAUROC: 0.7591267824172974
	RegressionCompetitionScore: 0.401840490797546



Validation scores:
	RegressionAUROC: 0.7616725564002991
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.171. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3889570552147239
     Test RegressionAUROC            0.7596603631973267
Test RegressionCompetitionScore      0.3889570552147239
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 09:46:20,374][0m Trial 536 finished with value: 0.3889570552147239 and parameters: {'lr': 0.00012435912829912154, 'dropout': 0.4880654804587217, 'd_model_multiplier': 1, 'num_layers': 6, 'n_heads': 8, 'dim_feedforward': 547, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0008493029961271029, 'dropout': 0.46585496492420586, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 185, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 27.1 K
1 | loss_fn | MSELoss | 0     
------------------------------------
27.1 K    Trainable params
0         Non-trainable params
27.1 K    Total params
0.108     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.3285024166107178
	RegressionCompetitionScore: 0.17391304347826086



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 1.961


Validation scores:
	RegressionAUROC: 0.48145386576652527
	RegressionCompetitionScore: 0.10521472392638037

Metric val_loss improved by 1.246 >= min_delta = 0.0. New best score: 0.715


Validation scores:
	RegressionAUROC: 0.5199764370918274
	RegressionCompetitionScore: 0.10950920245398774



Validation scores:
	RegressionAUROC: 0.3900316059589386
	RegressionCompetitionScore: 0.07914110429447853

Metric val_loss improved by 0.450 >= min_delta = 0.0. New best score: 0.265


Validation scores:
	RegressionAUROC: 0.39432549476623535
	RegressionCompetitionScore: 0.056134969325153376

Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: 0.252


Validation scores:
	RegressionAUROC: 0.3984123170375824
	RegressionCompetitionScore: 0.03742331288343558



Validation scores:
	RegressionAUROC: 0.5005616545677185
	RegressionCompetitionScore: 0.00245398773006135



Validation scores:
	RegressionAUROC: 0.5053618550300598
	RegressionCompetitionScore: 0.03834355828220859



Validation scores:
	RegressionAUROC: 0.5442492961883545
	RegressionCompetitionScore: 0.07730061349693251

Metric val_loss improved by 0.031 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.5748510360717773
	RegressionCompetitionScore: 0.07914110429447853

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6120231747627258
	RegressionCompetitionScore: 0.0754601226993865



Validation scores:
	RegressionAUROC: 0.6278102397918701
	RegressionCompetitionScore: 0.08803680981595093



Validation scores:
	RegressionAUROC: 0.6317894458770752
	RegressionCompetitionScore: 0.09417177914110429



Validation scores:
	RegressionAUROC: 0.6429427862167358
	RegressionCompetitionScore: 0.1294478527607362



Validation scores:
	RegressionAUROC: 0.6475967168807983
	RegressionCompetitionScore: 0.14846625766871166



Validation scores:
	RegressionAUROC: 0.6598458290100098
	RegressionCompetitionScore: 0.20521472392638038



Validation scores:
	RegressionAUROC: 0.6750562191009521
	RegressionCompetitionScore: 0.27699386503067486

Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.190


Validation scores:
	RegressionAUROC: 0.6793145537376404
	RegressionCompetitionScore: 0.27975460122699386

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.6874170303344727
	RegressionCompetitionScore: 0.2800613496932515



Validation scores:
	RegressionAUROC: 0.691508948802948
	RegressionCompetitionScore: 0.2757668711656442



Validation scores:
	RegressionAUROC: 0.6967791318893433
	RegressionCompetitionScore: 0.27208588957055213

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.6945667266845703
	RegressionCompetitionScore: 0.26226993865030673



Validation scores:
	RegressionAUROC: 0.6850639581680298
	RegressionCompetitionScore: 0.2634969325153374



Validation scores:
	RegressionAUROC: 0.6730400323867798
	RegressionCompetitionScore: 0.2352760736196319



Validation scores:
	RegressionAUROC: 0.6788813471794128
	RegressionCompetitionScore: 0.21380368098159508



Validation scores:
	RegressionAUROC: 0.690009593963623
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.6940770149230957
	RegressionCompetitionScore: 0.21380368098159508



Validation scores:
	RegressionAUROC: 0.6987375020980835
	RegressionCompetitionScore: 0.2233128834355828

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.186. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.27208588957055213
     Test RegressionAUROC            0.6967791318893433
Test RegressionCompetitionScore      0.27208588957055213
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 09:56:57,886][0m Trial 537 finished with value: 0.27208588957055213 and parameters: {'lr': 0.0008493029961271029, 'dropout': 0.46585496492420586, 'd_model_multiplier': 1, 'num_layers': 1, 'n_heads': 8, 'dim_feedforward': 185, 'batch_size': 1024, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0019254792363085306, 'dropout': 0.43348790671066234, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 4, 'dim_feedforward': 147, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 27.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
27.0 K    Trainable params
0         Non-trainable params
27.0 K    Total params
0.108     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.3889012336730957
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 0.681


Validation scores:
	RegressionAUROC: 0.3956940174102783
	RegressionCompetitionScore: 0.09355828220858896

Metric val_loss improved by 0.460 >= min_delta = 0.0. New best score: 0.221


Validation scores:
	RegressionAUROC: 0.5691739320755005
	RegressionCompetitionScore: 0.1450920245398773

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5005125999450684
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5903298258781433
	RegressionCompetitionScore: 0.10276073619631902



Validation scores:
	RegressionAUROC: 0.6091735363006592
	RegressionCompetitionScore: 0.10460122699386504



Validation scores:
	RegressionAUROC: 0.5466806888580322
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5931705236434937
	RegressionCompetitionScore: 0.10337423312883436



Validation scores:
	RegressionAUROC: 0.573052167892456
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.1450920245398773
     Test RegressionAUROC            0.5691739320755005
Test RegressionCompetitionScore      0.1450920245398773
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 10:01:03,973][0m Trial 538 finished with value: 0.1450920245398773 and parameters: {'lr': 0.0019254792363085306, 'dropout': 0.43348790671066234, 'd_model_multiplier': 1, 'num_layers': 5, 'n_heads': 4, 'dim_feedforward': 147, 'batch_size': 512, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.028576856948178096, 'dropout': 0.44816059310263084, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 123, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 82.8 K
1 | loss_fn | MSELoss | 0     
------------------------------------
82.8 K    Trainable params
0         Non-trainable params
82.8 K    Total params
0.331     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved. New best score: 11.410


Validation scores:
	RegressionAUROC: 0.6067520380020142
	RegressionCompetitionScore: 0.10122699386503067

Metric val_loss improved by 10.960 >= min_delta = 0.0. New best score: 0.450


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.123 >= min_delta = 0.0. New best score: 0.327


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.077 >= min_delta = 0.0. New best score: 0.250


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.035 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore                   0.0
     Test RegressionAUROC                    0.5
Test RegressionCompetitionScore              0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 10:09:35,409][0m Trial 539 finished with value: 0.0 and parameters: {'lr': 0.028576856948178096, 'dropout': 0.44816059310263084, 'd_model_multiplier': 1, 'num_layers': 3, 'n_heads': 32, 'dim_feedforward': 123, 'batch_size': 64, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.0002543333477413838, 'dropout': 0.48057205079163395, 'd_model_multiplier': 2, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 829, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 88.0 K
1 | loss_fn | MSELoss | 0     
------------------------------------
88.0 K    Trainable params
0         Non-trainable params
88.0 K    Total params
0.352     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5603864789009094
	RegressionCompetitionScore: 0.391304347826087



Validation scores:
	RegressionAUROC: 0.5499521493911743
	RegressionCompetitionScore: 0.11595092024539877

Metric val_loss improved. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.6306895017623901
	RegressionCompetitionScore: 0.25644171779141106

Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.211


Validation scores:
	RegressionAUROC: 0.6912683844566345
	RegressionCompetitionScore: 0.3202453987730061

Metric val_loss improved by 0.023 >= min_delta = 0.0. New best score: 0.188


Validation scores:
	RegressionAUROC: 0.7248300313949585
	RegressionCompetitionScore: 0.25429447852760734



Validation scores:
	RegressionAUROC: 0.7395505905151367
	RegressionCompetitionScore: 0.34846625766871164

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.186


Validation scores:
	RegressionAUROC: 0.7355351448059082
	RegressionCompetitionScore: 0.3104294478527607



Validation scores:
	RegressionAUROC: 0.7353407144546509
	RegressionCompetitionScore: 0.30828220858895705



Validation scores:
	RegressionAUROC: 0.7438322305679321
	RegressionCompetitionScore: 0.3604294478527607



Validation scores:
	RegressionAUROC: 0.7307811975479126
	RegressionCompetitionScore: 0.3549079754601227



Validation scores:
	RegressionAUROC: 0.7466784715652466
	RegressionCompetitionScore: 0.3598159509202454



Validation scores:
	RegressionAUROC: 0.7480249404907227
	RegressionCompetitionScore: 0.37484662576687117

Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: 0.172


Validation scores:
	RegressionAUROC: 0.7408301830291748
	RegressionCompetitionScore: 0.37484662576687117



Validation scores:
	RegressionAUROC: 0.7387409806251526
	RegressionCompetitionScore: 0.3726993865030675



Validation scores:
	RegressionAUROC: 0.7454898357391357
	RegressionCompetitionScore: 0.3717791411042945



Validation scores:
	RegressionAUROC: 0.7434030771255493
	RegressionCompetitionScore: 0.3806748466257669



Validation scores:
	RegressionAUROC: 0.7524622082710266
	RegressionCompetitionScore: 0.38496932515337423

Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7566589117050171
	RegressionCompetitionScore: 0.39263803680981596



Validation scores:
	RegressionAUROC: 0.7580384016036987
	RegressionCompetitionScore: 0.38987730061349696



Validation scores:
	RegressionAUROC: 0.7375999093055725
	RegressionCompetitionScore: 0.3920245398773006



Validation scores:
	RegressionAUROC: 0.7606699466705322
	RegressionCompetitionScore: 0.4076687116564417



Validation scores:
	RegressionAUROC: 0.7571326494216919
	RegressionCompetitionScore: 0.38773006134969323



Validation scores:
	RegressionAUROC: 0.7663647532463074
	RegressionCompetitionScore: 0.4190184049079755



Validation scores:
	RegressionAUROC: 0.763116717338562
	RegressionCompetitionScore: 0.38496932515337423

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.169. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.38496932515337423
     Test RegressionAUROC            0.7524622082710266
Test RegressionCompetitionScore      0.38496932515337423
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 10:18:30,757][0m Trial 540 finished with value: 0.38496932515337423 and parameters: {'lr': 0.0002543333477413838, 'dropout': 0.48057205079163395, 'd_model_multiplier': 2, 'num_layers': 2, 'n_heads': 8, 'dim_feedforward': 829, 'batch_size': 32, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'RAdam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00018700166507215664, 'dropout': 0.5199357209802105, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 211, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 39.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
39.2 K    Trainable params
0         Non-trainable params
39.2 K    Total params
0.157     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6280193328857422
	RegressionCompetitionScore: 0.4782608695652174



Validation scores:
	RegressionAUROC: 0.631240725517273
	RegressionCompetitionScore: 0.28067484662576686

Metric val_loss improved. New best score: 0.199


Validation scores:
	RegressionAUROC: 0.6481708288192749
	RegressionCompetitionScore: 0.29386503067484665



Validation scores:
	RegressionAUROC: 0.6823217272758484
	RegressionCompetitionScore: 0.15858895705521472

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.195


Validation scores:
	RegressionAUROC: 0.7112886905670166
	RegressionCompetitionScore: 0.2383435582822086



Validation scores:
	RegressionAUROC: 0.7322244048118591
	RegressionCompetitionScore: 0.3312883435582822

Metric val_loss improved by 0.010 >= min_delta = 0.0. New best score: 0.185


Validation scores:
	RegressionAUROC: 0.7524867057800293
	RegressionCompetitionScore: 0.3693251533742331

Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7441691160202026
	RegressionCompetitionScore: 0.35521472392638037



Validation scores:
	RegressionAUROC: 0.7482856512069702
	RegressionCompetitionScore: 0.37300613496932516



Validation scores:
	RegressionAUROC: 0.7177243828773499
	RegressionCompetitionScore: 0.3174846625766871



Validation scores:
	RegressionAUROC: 0.7655506730079651
	RegressionCompetitionScore: 0.38926380368098157



Validation scores:
	RegressionAUROC: 0.7839846611022949
	RegressionCompetitionScore: 0.40644171779141103

Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: 0.158


Validation scores:
	RegressionAUROC: 0.7782754898071289
	RegressionCompetitionScore: 0.4153374233128834



Validation scores:
	RegressionAUROC: 0.7726048827171326
	RegressionCompetitionScore: 0.39386503067484663



Validation scores:
	RegressionAUROC: 0.7881385087966919
	RegressionCompetitionScore: 0.42484662576687116



Validation scores:
	RegressionAUROC: 0.7937520742416382
	RegressionCompetitionScore: 0.4263803680981595

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.157


Validation scores:
	RegressionAUROC: 0.7989046573638916
	RegressionCompetitionScore: 0.4312883435582822

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.156


Validation scores:
	RegressionAUROC: 0.790287971496582
	RegressionCompetitionScore: 0.43803680981595094



Validation scores:
	RegressionAUROC: 0.7942783832550049
	RegressionCompetitionScore: 0.43466257668711655



Validation scores:
	RegressionAUROC: 0.7782114744186401
	RegressionCompetitionScore: 0.4128834355828221



Validation scores:
	RegressionAUROC: 0.7637277245521545
	RegressionCompetitionScore: 0.4156441717791411



Validation scores:
	RegressionAUROC: 0.7875639200210571
	RegressionCompetitionScore: 0.40705521472392636



Validation scores:
	RegressionAUROC: 0.7970335483551025
	RegressionCompetitionScore: 0.44447852760736195

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.156


Validation scores:
	RegressionAUROC: 0.794763445854187
	RegressionCompetitionScore: 0.4303680981595092

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.154


Validation scores:
	RegressionAUROC: 0.7946724891662598
	RegressionCompetitionScore: 0.4582822085889571



Validation scores:
	RegressionAUROC: 0.7951914072036743
	RegressionCompetitionScore: 0.4325153374233129



Validation scores:
	RegressionAUROC: 0.791467547416687
	RegressionCompetitionScore: 0.402760736196319



Validation scores:
	RegressionAUROC: 0.7989147901535034
	RegressionCompetitionScore: 0.456441717791411



Validation scores:
	RegressionAUROC: 0.797620952129364
	RegressionCompetitionScore: 0.4466257668711656



Validation scores:
	RegressionAUROC: 0.7766868472099304
	RegressionCompetitionScore: 0.3684049079754601



Validation scores:
	RegressionAUROC: 0.7885753512382507
	RegressionCompetitionScore: 0.4447852760736196

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.154. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.4303680981595092
     Test RegressionAUROC             0.794763445854187
Test RegressionCompetitionScore      0.4303680981595092
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 10:30:03,127][0m Trial 541 finished with value: 0.4303680981595092 and parameters: {'lr': 0.00018700166507215664, 'dropout': 0.5199357209802105, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 211, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00017769921156345726, 'dropout': 0.5122069763859368, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 256, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 42.3 K
1 | loss_fn | MSELoss | 0     
------------------------------------
42.3 K    Trainable params
0         Non-trainable params
42.3 K    Total params
0.169     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.34299516677856445
	RegressionCompetitionScore: 0.08695652173913043



Validation scores:
	RegressionAUROC: 0.6609705090522766
	RegressionCompetitionScore: 0.251840490797546

Metric val_loss improved. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.6751947402954102
	RegressionCompetitionScore: 0.302760736196319

Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: 0.194


Validation scores:
	RegressionAUROC: 0.690357506275177
	RegressionCompetitionScore: 0.2322085889570552



Validation scores:
	RegressionAUROC: 0.6937108635902405
	RegressionCompetitionScore: 0.20552147239263804



Validation scores:
	RegressionAUROC: 0.7353240251541138
	RegressionCompetitionScore: 0.3604294478527607

Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.182


Validation scores:
	RegressionAUROC: 0.7505820989608765
	RegressionCompetitionScore: 0.3901840490797546

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.177


Validation scores:
	RegressionAUROC: 0.7504470944404602
	RegressionCompetitionScore: 0.3736196319018405

Metric val_loss improved by 0.007 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7432376742362976
	RegressionCompetitionScore: 0.3312883435582822



Validation scores:
	RegressionAUROC: 0.7132193446159363
	RegressionCompetitionScore: 0.3052147239263804



Validation scores:
	RegressionAUROC: 0.7511633634567261
	RegressionCompetitionScore: 0.37944785276073617



Validation scores:
	RegressionAUROC: 0.7616539001464844
	RegressionCompetitionScore: 0.4021472392638037



Validation scores:
	RegressionAUROC: 0.754951000213623
	RegressionCompetitionScore: 0.3745398773006135

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.169


Validation scores:
	RegressionAUROC: 0.7677241563796997
	RegressionCompetitionScore: 0.38742331288343557

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.168


Validation scores:
	RegressionAUROC: 0.7444779872894287
	RegressionCompetitionScore: 0.3276073619631902



Validation scores:
	RegressionAUROC: 0.7686188220977783
	RegressionCompetitionScore: 0.4



Validation scores:
	RegressionAUROC: 0.7533519268035889
	RegressionCompetitionScore: 0.38374233128834356



Validation scores:
	RegressionAUROC: 0.7683298587799072
	RegressionCompetitionScore: 0.3904907975460123

Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.163


Validation scores:
	RegressionAUROC: 0.7653921246528625
	RegressionCompetitionScore: 0.38006134969325156



Validation scores:
	RegressionAUROC: 0.7574958801269531
	RegressionCompetitionScore: 0.36503067484662577



Validation scores:
	RegressionAUROC: 0.7654902935028076
	RegressionCompetitionScore: 0.40828220858895703



Validation scores:
	RegressionAUROC: 0.7643103003501892
	RegressionCompetitionScore: 0.405521472392638



Validation scores:
	RegressionAUROC: 0.7731796503067017
	RegressionCompetitionScore: 0.43190184049079755



Validation scores:
	RegressionAUROC: 0.7603634595870972
	RegressionCompetitionScore: 0.38282208588957056



Validation scores:
	RegressionAUROC: 0.7470191717147827
	RegressionCompetitionScore: 0.33865030674846625

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.163. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.3904907975460123
     Test RegressionAUROC            0.7683298587799072
Test RegressionCompetitionScore      0.3904907975460123
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 10:39:25,587][0m Trial 542 finished with value: 0.3904907975460123 and parameters: {'lr': 0.00017769921156345726, 'dropout': 0.5122069763859368, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 256, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 0.00032508762635347023, 'dropout': 0.8012685644695785, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 211, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 39.2 K
1 | loss_fn | MSELoss | 0     
------------------------------------
39.2 K    Trainable params
0         Non-trainable params
39.2 K    Total params
0.157     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.5
	RegressionCompetitionScore: 0.0



Validation scores:
	RegressionAUROC: 0.5515056252479553
	RegressionCompetitionScore: 0.12085889570552147

Metric val_loss improved. New best score: 0.214


Validation scores:
	RegressionAUROC: 0.5006023049354553
	RegressionCompetitionScore: 0.026993865030674847



Validation scores:
	RegressionAUROC: 0.6223422288894653
	RegressionCompetitionScore: 0.2236196319018405



Validation scores:
	RegressionAUROC: 0.6196085214614868
	RegressionCompetitionScore: 0.20828220858895705



Validation scores:
	RegressionAUROC: 0.495148241519928
	RegressionCompetitionScore: 0.13190184049079753



Validation scores:
	RegressionAUROC: 0.5364581346511841
	RegressionCompetitionScore: 0.10460122699386504



Validation scores:
	RegressionAUROC: 0.5231952667236328
	RegressionCompetitionScore: 0.10368098159509202



Validation scores:
	RegressionAUROC: 0.4693661332130432
	RegressionCompetitionScore: 0.08251533742331288

Metric val_loss improved by 0.004 >= min_delta = 0.0. New best score: 0.210


Validation scores:
	RegressionAUROC: 0.5119426250457764
	RegressionCompetitionScore: 0.09355828220858896

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.209


Validation scores:
	RegressionAUROC: 0.633216142654419
	RegressionCompetitionScore: 0.12607361963190183



Validation scores:
	RegressionAUROC: 0.5317251682281494
	RegressionCompetitionScore: 0.08895705521472393



Validation scores:
	RegressionAUROC: 0.43024277687072754
	RegressionCompetitionScore: 0.04723926380368098



Validation scores:
	RegressionAUROC: 0.44404086470603943
	RegressionCompetitionScore: 0.0656441717791411



Validation scores:
	RegressionAUROC: 0.5194710493087769
	RegressionCompetitionScore: 0.07822085889570553



Validation scores:
	RegressionAUROC: 0.45934826135635376
	RegressionCompetitionScore: 0.09202453987730061



Validation scores:
	RegressionAUROC: 0.4566652774810791
	RegressionCompetitionScore: 0.1254601226993865

Monitored metric val_loss did not improve in the last 7 records. Best score: 0.209. Signaling Trainer to stop.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Test metric                   DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Test CompetitionScore           0.09355828220858896
     Test RegressionAUROC            0.5119426250457764
Test RegressionCompetitionScore      0.09355828220858896
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[32m[I 2023-04-07 10:45:51,402][0m Trial 543 finished with value: 0.09355828220858896 and parameters: {'lr': 0.00032508762635347023, 'dropout': 0.8012685644695785, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 211, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'gelu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 1e-05}. Best is trial 337 with value: 0.4852760736196319.[0m
Starting trial with params:
{'lr': 1.5606224360229698e-06, 'dropout': 0.4963183694939846, 'd_model_multiplier': 1, 'num_layers': 4, 'n_heads': 8, 'dim_feedforward': 244, 'batch_size': 16, 'pos_encoding': 'learnable', 'activation': 'relu', 'norm': 'LayerNorm', 'optimizer_name': 'Adam', 'weight_decay': 0.0001}
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/users/isears1/anaconda3/envs/ecmo-interpretability/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /gpfs/scratch/isears1/physionet2023/cache/tuning_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type    | Params
------------------------------------
0 | tst     | ConvTST | 41.5 K
1 | loss_fn | MSELoss | 0     
------------------------------------
41.5 K    Trainable params
0         Non-trainable params
41.5 K    Total params
0.166     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.


Validation scores:
	RegressionAUROC: 0.6280193328857422
	RegressionCompetitionScore: 0.34782608695652173



Validation scores:
	RegressionAUROC: 0.4364456236362457
	RegressionCompetitionScore: 0.05

Metric val_loss improved. New best score: 0.276


Validation scores:
	RegressionAUROC: 0.44907137751579285
	RegressionCompetitionScore: 0.04693251533742331

Metric val_loss improved by 0.048 >= min_delta = 0.0. New best score: 0.228


Validation scores:
	RegressionAUROC: 0.455985963344574
	RegressionCompetitionScore: 0.04815950920245399

Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.458706259727478
	RegressionCompetitionScore: 0.04693251533742331

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.220


Validation scores:
	RegressionAUROC: 0.46010705828666687
	RegressionCompetitionScore: 0.04723926380368098

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.46052831411361694
	RegressionCompetitionScore: 0.049079754601226995

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.219


Validation scores:
	RegressionAUROC: 0.46568426489830017
	RegressionCompetitionScore: 0.04969325153374233

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.218


Validation scores:
	RegressionAUROC: 0.4632292687892914
	RegressionCompetitionScore: 0.050920245398773004



Validation scores:
	RegressionAUROC: 0.4682265520095825
	RegressionCompetitionScore: 0.05245398773006135



Validation scores:
	RegressionAUROC: 0.46854084730148315
	RegressionCompetitionScore: 0.05521472392638037



Validation scores:
	RegressionAUROC: 0.4746357500553131
	RegressionCompetitionScore: 0.05460122699386503

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.481759637594223
	RegressionCompetitionScore: 0.05429447852760736

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.216


Validation scores:
	RegressionAUROC: 0.4845939576625824
	RegressionCompetitionScore: 0.0558282208588957



Validation scores:
	RegressionAUROC: 0.491371214389801
	RegressionCompetitionScore: 0.05521472392638037



Validation scores:
	RegressionAUROC: 0.4959546625614166
	RegressionCompetitionScore: 0.05644171779141104

Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.215


Validation scores:
	RegressionAUROC: 0.5011411309242249
	RegressionCompetitionScore: 0.056134969325153376

Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5031082630157471
	RegressionCompetitionScore: 0.06012269938650307

Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.213


Validation scores:
	RegressionAUROC: 0.5027849078178406
	RegressionCompetitionScore: 0.06503067484662577



Validation scores:
	RegressionAUROC: 0.5077003240585327
	RegressionCompetitionScore: 0.06595092024539877



Validation scores:
	RegressionAUROC: 0.5091511011123657
	RegressionCompetitionScore: 0.06779141104294478

slurmstepd: error: *** JOB 9453124 ON gpu2001 CANCELLED AT 2023-04-07T10:53:26 DUE TO TIME LIMIT ***
